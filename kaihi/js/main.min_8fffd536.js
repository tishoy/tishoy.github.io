var __reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var s in e)e.hasOwnProperty(s)&&(t[s]=e[s]);i.prototype=e.prototype,t.prototype=new i},__awaiter=this&&this.__awaiter||function(t,e,i,s){return new(i||(i=Promise))(function(h,a){function o(t){try{r(s.next(t))}catch(e){a(e)}}function n(t){try{r(s["throw"](t))}catch(e){a(e)}}function r(t){t.done?h(t.value):new i(function(e){e(t.value)}).then(o,n)}r((s=s.apply(t,e||[])).next())})},__generator=this&&this.__generator||function(t,e){function i(t){return function(e){return s([t,e])}}function s(i){if(h)throw new TypeError("Generator is already executing.");for(;r;)try{if(h=1,a&&(o=a[2&i[0]?"return":i[0]?"throw":"next"])&&!(o=o.call(a,i[1])).done)return o;switch(a=0,o&&(i=[0,o.value]),i[0]){case 0:case 1:o=i;break;case 4:return r.label++,{value:i[1],done:!1};case 5:r.label++,a=i[1],i=[0];continue;case 7:i=r.ops.pop(),r.trys.pop();continue;default:if(o=r.trys,!(o=o.length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){r=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){r.label=i[1];break}if(6===i[0]&&r.label<o[1]){r.label=o[1],o=i;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(i);break}o[2]&&r.ops.pop(),r.trys.pop();continue}i=e.call(t,r)}catch(s){i=[6,s],a=0}finally{h=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}var h,a,o,n,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return n={next:i(0),"throw":i(1),"return":i(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n},LoadingUI=function(t){function e(){var e=t.call(this)||this;return e.createView(),e}return __extends(e,t),e.prototype.createView=function(){return __awaiter(this,void 0,void 0,function(){var t,e,i,s,h,a,o,n,r;return __generator(this,function(l){return t=new egret.Bitmap,e=RES.getRes("loading_bg_png"),t.texture=e,t.x=-120,t.y=-120,t.touchEnabled=!0,this.addChild(t),i=RES.getRes("loading_boy_json"),s=RES.getRes("loading_boy_png"),h=new egret.MovieClipDataFactory(i,s),this.loadingBoy=new egret.MovieClip(h.generateMovieClipData("runningboy")),this.loadingBoy.anchorOffsetX=this.loadingBoy.width/2,this.loadingBoy.anchorOffsetY=this.loadingBoy.height/2,this.loadingBoy.scaleX=.52,this.loadingBoy.scaleY=.52,this.loadingBoy.x=436,this.loadingBoy.y=514,this.addChild(this.loadingBoy),a=RES.getRes("loading_word_json"),o=RES.getRes("loading_word_png"),n=new egret.MovieClipDataFactory(a,o),this.loadingWord=new egret.MovieClip(n.generateMovieClipData("word")),this.loadingWord.x=0,this.loadingWord.y=100,this.addChild(this.loadingWord),this.x=Util.x_fix(),this.y=(Util.curHeight()-this.height)/2+120,r=new egret.Timer(5e3,1),r.addEventListener(egret.TimerEvent.COMPLETE,this.networkNotConnect,this),[2]})})},e.prototype.networkNotConnect=function(){var t=new egret.TextField;t.x=100,t.y=100,t.text="您当前网络状况很差，请联网再试"},e.prototype.onShow=function(){this.loadingBoy.play(-1),this.loadingWord.play(-1)},e.prototype.onHide=function(){this.loadingBoy.stop(),this.loadingWord.stop()},e.prototype.onProgress=function(t,e){},e}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI");var Main=function(t){function e(){var e=t.call(this)||this;return e.addEventListener(egret.Event.ADDED_TO_STAGE,e.onAddToStage,e),e}return __extends(e,t),e.prototype.onAddToStage=function(t){Util.curWidth()/Util.curHeight()<Util.displayWidth()/Util.displayHeight()?this.stage.scaleMode=egret.StageScaleMode.FIXED_WIDTH:this.stage.scaleMode=egret.StageScaleMode.FIXED_HEIGHT,platform.setLifeCycleCallBack(function(){SoundManager.getInstance().stopBGM(),"oppo"!==platform.name&&egret.ticker.pause()},function(){SoundManager.getInstance().playBGM(),egret.ticker.resume()}),egret.lifecycle.addLifecycleListener(function(t){t.onUpdate=function(){}}),this.runGame()["catch"](function(t){})},e.prototype.runGame=function(){return __awaiter(this,void 0,void 0,function(){var t,e,i;return __generator(this,function(s){switch(s.label){case 0:return platform.setLoadingProgress(0),[4,RES.loadConfig("resource/default.res.json","resource/")];case 1:return s.sent(),"qqplay"!==platform.name?[3,7]:[4,RES.loadConfig("resource/stage4.res.json","resource/")];case 2:return s.sent(),[4,RES.loadConfig("resource/stage5.res.json","resource/")];case 3:return s.sent(),[4,RES.loadConfig("resource/stage6.res.json","resource/")];case 4:return s.sent(),[4,AdManager.getInstance().fetchBanner()];case 5:return s.sent(),[4,AdManager.getInstance().fetchVedio()];case 6:return s.sent(),[3,18];case 7:return"oppo"!==platform.name?[3,17]:[4,RES.loadConfig("resource/stage1.res.json","resource/")];case 8:return s.sent(),platform.setLoadingProgress(10),[4,RES.loadConfig("resource/stage2.res.json","resource/")];case 9:return s.sent(),platform.setLoadingProgress(20),[4,RES.loadConfig("resource/stage3.res.json","resource/")];case 10:return s.sent(),platform.setLoadingProgress(40),[4,RES.loadConfig("resource/stage4.res.json","resource/")];case 11:return s.sent(),platform.setLoadingProgress(50),[4,RES.loadConfig("resource/stage5.res.json","resource/")];case 12:return s.sent(),platform.setLoadingProgress(60),[4,RES.loadConfig("resource/stage6.res.json","resource/")];case 13:return s.sent(),platform.setLoadingProgress(70),[4,AdManager.getInstance().fetchBanner()];case 14:return s.sent(),[4,AdManager.getInstance().fetchVedio()];case 15:return s.sent(),[4,AdManager.getInstance().fetchInterstitial()];case 16:return s.sent(),platform.setLoadingProgress(80),[3,18];case 17:"mi"===platform.name&&(AdManager.getInstance().vedioLoaded=!0),s.label=18;case 18:return[4,RES.loadGroup("loading_ui",0)];case 19:return s.sent(),this.ui_manager=UIManager.getInstance(),this.ui_manager.init(this.stage),this.ui_manager.showLoading(),[4,RES.loadGroup("title_scene")];case 20:return s.sent(),[4,RES.loadGroup("config")];case 21:return s.sent(),this.ui_manager.toTitleScene(),platform.loadingComplete(),t=Config.getInstance(),SaveData.getInstance(),e=ItemController.getInstance(),i=StageController.getInstance(),[2]}})})},e.prototype.testStage=function(){},e.prototype.onTapStage=function(t){},e}(egret.DisplayObjectContainer);__reflect(Main.prototype,"Main");var Util;!function(t){function e(){return egret.MainContext.instance.stage.stageWidth/640}function i(){return(egret.MainContext.instance.stage.stageWidth-640)/2}function s(){return(egret.MainContext.instance.stage.stageHeight-1080)/2}function h(){return egret.MainContext.instance.stage}function a(){return egret.MainContext.instance.stage.stageWidth}function o(){return egret.MainContext.instance.stage.stageHeight}function n(){return 640}function r(){return 1080}function l(){return egret.MainContext.instance.stage.scaleMode}function c(t,e,i){void 0===e&&(e=1),void 0===i&&(i=0),0===i&&(i=t.totalFrames),t.currentFrame<e||t.currentFrame>=i?t.gotoAndStop(e):t.nextFrame()}function d(t,e){-1===t.indexOf(e)&&t.push(e)}function _(t,e){var i=function(t){var e={r:-1,g:-1,b:-1};return e.b=t%256,e.g=Math.floor(t/256)%256,e.r=Math.floor(t/256/256),e},s=i(e),h=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0];h[0]=s.r/255,h[6]=s.g/255,h[12]=s.b/255;var a=new egret.ColorMatrixFilter(h);t.filters=[a]}t.TOTAL_STAGES=30,t.factor=e,t.x_fix=i,t.y_fix=s,t.gameStage=h,t.curWidth=a,t.curHeight=o,t.displayWidth=n,t.displayHeight=r,t.scaleMode=l,t.loopPlay=c,t.singletonPush=d,t.setImageColor=_}(Util||(Util={}));var BlinkEffect=function(t){function e(e,i,s){void 0===s&&(s=!0);var h=t.call(this)||this;return h._target=e,h._time=i,s&&h.start(),h}return __extends(e,t),e.prototype.start=function(){this._currTime=egret.getTimer(),this._target.addEventListener(egret.Event.ENTER_FRAME,this.runDown,this)},e.prototype.runDown=function(t){this._target.alpha-=.045,this.checkOver()||this._target.alpha<=.6&&(this._target.removeEventListener(egret.Event.ENTER_FRAME,this.runDown,this),this._target.addEventListener(egret.Event.ENTER_FRAME,this.runUp,this))},e.prototype.runUp=function(t){this._target.alpha+=.045,this.checkOver()||this._target.alpha>=1&&(this._target.removeEventListener(egret.Event.ENTER_FRAME,this.runUp,this),this._target.addEventListener(egret.Event.ENTER_FRAME,this.runDown,this))},e.prototype.checkOver=function(){var t=egret.getTimer();return t-this._currTime>=this._time?(this.destroy(),!0):!1},e.prototype.destroy=function(){this._target.alpha=1,this._target.removeEventListener(egret.Event.ENTER_FRAME,this.runDown,this),this._target.removeEventListener(egret.Event.ENTER_FRAME,this.runUp,this),this.dispatchEventWith(egret.Event.COMPLETE,!1,this._target),this._target=null},e}(egret.EventDispatcher);__reflect(BlinkEffect.prototype,"BlinkEffect");var BreathEffect=function(t){function e(e,i,s){void 0===s&&(s=!0);var h=t.call(this)||this;return h._target=e,h._target.anchorOffsetX=h._target.width/2,h._target.anchorOffsetY=h._target.height/2,h._time=i,s&&h.start(),h}return __extends(e,t),e.prototype.start=function(){this._currTime=egret.getTimer(),this._target.addEventListener(egret.Event.ENTER_FRAME,this.runDown,this)},e.prototype.runDown=function(t){this._target.scaleX-=.01,this._target.scaleY-=.01,this.checkOver()||this._target.scaleX<=1&&(this._target.removeEventListener(egret.Event.ENTER_FRAME,this.runDown,this),this._target.addEventListener(egret.Event.ENTER_FRAME,this.runUp,this))},e.prototype.runUp=function(t){this._target.scaleX+=.01,this._target.scaleY+=.01,this.checkOver()||this._target.scaleX>=1.05&&(this._target.removeEventListener(egret.Event.ENTER_FRAME,this.runUp,this),this._target.addEventListener(egret.Event.ENTER_FRAME,this.runDown,this))},e.prototype.checkOver=function(){if(-1===this._time)return!1;var t=egret.getTimer();return t-this._currTime>=this._time?(this.destroy(),!0):!1},e.prototype.destroy=function(){this._target.scaleX=1,this._target.scaleY=1,this._target.removeEventListener(egret.Event.ENTER_FRAME,this.runDown,this),this._target.removeEventListener(egret.Event.ENTER_FRAME,this.runUp,this),this.dispatchEventWith(egret.Event.COMPLETE,!1,this._target),this._target=null},e}(egret.EventDispatcher);__reflect(BreathEffect.prototype,"BreathEffect");var PopEffect;!function(t){function e(t,e,i,s,h,a){if(void 0===e&&(e=!1),void 0===i&&(i=0),void 0===s&&(s=0),void 0===h&&(h=0),void 0===a&&(a=!1),!UIManager.getInstance().getPopLayer().contains(t)){e&&(this.darkSprite=new egret.Sprite,this.darkSprite.graphics.clear(),this.darkSprite.graphics.beginFill(0,.3),this.darkSprite.graphics.drawRect(0,0,Util.curWidth(),Util.curHeight()),this.darkSprite.graphics.endFill(),this.darkSprite.width=Util.curWidth(),this.darkSprite.height=Util.curHeight(),UIManager.getInstance().getPopLayer().contains(this.darkSprite)||UIManager.getInstance().getPopLayer().addChild(this.darkSprite),this.darkSprite.touchEnabled=!0,egret.Tween.get(this.darkSprite).to({alpha:1},150),this.darkSprite.visible=!0),UIManager.getInstance().getPopLayer().addChild(t),UIManager.getInstance().setCurrentPop(t),0!=i?(t.x=Util.curWidth()/2-i/2,t.y=Util.curHeight()/2-s/2):(i=t.width,s=t.height);var o=Util.curWidth()/2-i/2,n=Util.curHeight()/2-s/2;switch(h){case 0:break;case 1:t.alpha=0,t.scaleX=.5,t.scaleY=.5,t.x=t.x+i/4,t.y=t.y+s/4,egret.Tween.get(t).to({alpha:1,scaleX:1,scaleY:1,x:t.x-i/4,y:t.y-s/4},300,egret.Ease.backOut);break;case 2:t.alpha=0,t.scaleX=.5,t.scaleY=.5,t.x=t.x+i/4,t.y=t.y+s/4,egret.Tween.get(t).to({alpha:1,scaleX:1,scaleY:1,x:t.x-i/4,y:t.y-s/4},600,egret.Ease.elasticOut);break;case 3:a?(t.x=-i,egret.Tween.get(t).to({x:o},500,egret.Ease.cubicOut)):(t.x=-i,egret.Tween.get(t).to({x:0},500,egret.Ease.cubicOut));break;case 4:a?(t.x=i,egret.Tween.get(t).to({x:o},500,egret.Ease.cubicOut)):(t.x=i,egret.Tween.get(t).to({x:0},500,egret.Ease.cubicOut));break;case 5:a?(t.y=-s,egret.Tween.get(t).to({y:n},500,egret.Ease.cubicOut)):(t.y=-s,egret.Tween.get(t).to({y:0},500,egret.Ease.cubicOut));break;case 6:a?(t.y=Util.curHeight(),egret.Tween.get(t).to({y:n},500,egret.Ease.cubicOut)):(t.y=s,egret.Tween.get(t).to({y:0},500,egret.Ease.cubicOut))}}}function i(t,e){void 0===e&&(e=0);var i=function(){UIManager.getInstance().getPopLayer().contains(this.darkSprite)&&UIManager.getInstance().getPopLayer().removeChild(this.darkSprite)};switch(this.darkSprite&&egret.Tween.get(this.darkSprite).to({alpha:0},100).call(i,this),e){case 0:break;case 1:egret.Tween.get(t).to({alpha:0,scaleX:0,scaleY:0,x:t.x+t.getWidth()/2,y:t.y+t.getHeight()/2},300);break;case 2:break;case 3:egret.Tween.get(t).to({x:t.getWidth()},500,egret.Ease.cubicOut);break;case 4:egret.Tween.get(t).to({x:-t.getWidth()},500,egret.Ease.cubicOut);break;case 5:egret.Tween.get(t).to({y:t.getHeight()},500,egret.Ease.cubicOut);break;case 6:egret.Tween.get(t).to({y:-t.getHeight()},500,egret.Ease.cubicOut)}egret.setTimeout(function(){UIManager.getInstance().getPopLayer().contains(t)&&UIManager.getInstance().getPopLayer().removeChild(t)},this,500)}t.addPopUp=e,t.removePopUp=i}(PopEffect||(PopEffect={}));var TSBitmap=function(t){function e(e,i,s){void 0===i&&(i=null),void 0===s&&(s=!1);var h=t.call(this)||this;return h.init(e,i,s),h}return __extends(e,t),e.prototype.init=function(t,e,i){void 0===e&&(e=null),void 0===i&&(i=!1),null===e?RES.hasRes(t)&&(this.texture=RES.getRes(t)):this.texture=e.getTexture(t),i&&(this.anchorOffsetX=this.width/2,this.anchorOffsetY=this.height/2)},e}(egret.Bitmap);__reflect(TSBitmap.prototype,"TSBitmap");var TSButton=function(t){function e(e,i,s,h,a,o,n){void 0===s&&(s="assets"),void 0===h&&(h=null),void 0===a&&(a=""),void 0===o&&(o=30),void 0===n&&(n=1);var r=t.call(this)||this;return r.assets=RES.getRes("assets"),r.isPlayCartoon=!1,r.cartoonType=1,r.param={context:null,data:null},r._cooldownTime=0,r.param.context=e,r.init(i,h,a,o,n,s),r}return __extends(e,t),e.prototype.init=function(t,e,i,s,h,a){void 0===e&&(e=null),void 0===i&&(i=""),void 0===s&&(s=30),void 0===h&&(h=1),void 0===a&&(a="assets"),this.cartoonType=h,this.backFun=e,this.btnImg=new egret.Bitmap,"assets"!=a&&(this.assets=RES.getRes(a)),this.btnImg.texture=this.assets.getTexture(t),this.addChild(this.btnImg),""!=i&&(this.textField=new egret.TextField,this.addChild(this.textField),this.textField.size=s,this.textField.textAlign="center",this.textField.stroke=1,this.textField.strokeColor=0,this.textField.text=i,this.textField.width=this.btnImg.width,this.textField.x=this.btnImg.width/2-this.textField.width/2,this.textField.y=this.btnImg.height/2-this.textField.height/2),this.touchEnabled=!0,this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onbuttonTouchTap,this)},e.prototype.onbuttonTouchTap=function(t){if(!this.isPlayCartoon){this.isPlayCartoon=!0;var e=function(){this.isPlayCartoon=!1},i=function(){1==this.cartoonType?egret.Tween.get(this).to({scaleX:1,scaleY:1,x:this.x-this.btnImg.width/4,y:this.y-this.btnImg.height/4},500,egret.Ease.elasticOut).call(e,this):2==this.cartoonType?egret.Tween.get(this).to({scaleX:1,scaleY:1,x:this.x-this.btnImg.width/4,y:this.y-this.btnImg.height/4},500,egret.Ease.backOut).call(e,this):3==this.cartoonType&&egret.Tween.get(this).to({scaleX:1,scaleY:1,x:this.x-this.btnImg.width/4,y:this.y-this.btnImg.height/4},100).call(e,this)};egret.Tween.get(this).to({scaleX:.5,scaleY:.5,x:this.x+this.btnImg.width/4,y:this.y+this.btnImg.height/4},100,egret.Ease.sineIn).call(i,this),egret.setTimeout(function(){null!=this.backFun&&this.backFun.apply(this.param.context,[this.param.data])},this,300)}},e.prototype.onClick=function(t){this.cdEffect.start(this._cooldownTime),this.touchEnabled=!1},e.prototype.initCooldownEffect=function(){null==this.cdEffect&&(this.cdEffect=new TSEffect.CooldownEffect(this.width,this.height),this.addChild(this.cdEffect),this.cdEffect.addEventListener(TSEffect.CooldownEffect.COOLDOWN_END,this.onCDEnd,this))},e.prototype.onCDEnd=function(t){this.touchEnabled=!0},Object.defineProperty(e.prototype,"cooldownTime",{get:function(){return this._cooldownTime},set:function(t){this._cooldownTime!=t&&(this._cooldownTime=t,this._cooldownTime>0?(this.initCooldownEffect(),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this)):(this.cdEffect&&(this.cdEffect.parent&&this.removeChild(this.cdEffect),this.cdEffect.removeEventListener(TSEffect.CooldownEffect.COOLDOWN_END,this.onCDEnd,this),this.cdEffect=null),this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this)))},enumerable:!0,configurable:!0}),e.prototype.startCooldown=function(t){void 0===t&&(t=0),this.initCooldownEffect(),this.cdEffect.start(t),this.touchEnabled=!1},e.prototype.setBindData=function(t){this.param.data=t},e.prototype.getBindData=function(){return this.param.data},e.prototype.getBitmap=function(){return this.btnImg},e}(egret.DisplayObjectContainer);__reflect(TSButton.prototype,"TSButton");var TSEffect;!function(t){function e(t,e){void 0===e&&(e=1e3),new BlinkEffect(t,e)}function i(t,e){return void 0===e&&(e=1e3),new BreathEffect(t,e)}function s(){}t.blinkEffect=e,t.breathEffect=i,t.splash=s;var h=function(t){function e(e,i,s,h){void 0===i&&(i=0),void 0===s&&(s=!0),void 0===h&&(h=!1);var a=t.call(this)||this;return a.color=0,a.alphaC=.6,a.isAnti=!1,a.isRect=!1,a.startFrom=270,a.delay=0,a.duration=0,a.isCooling=!1,a.startTime=0,a.touchChildren=!1,a.touchEnabled=!1,a.isRect=s,a.isAnti=h,a.setSize(e,i),a}return __extends(e,t),e.prototype.setSize=function(t,e){0==e&&(e=t),this.isRect?(this.a=t*Math.SQRT1_2,this.b=e*Math.SQRT1_2):(this.a=.5*t,this.b=.5*e),this.basePos=new egret.Point(.5*t,.5*e),this.rect=new egret.Rectangle(0,0,t,e),this.scrollRect=this.rect},e.prototype.start=function(t,i,s){void 0===i&&(i=0),void 0===s&&(s=!1);var h=egret.getTimer();if(!s&&this.isCooling){if(t+i<this.duration+this.delay-(h-this.startTime))return;this.stop()}this.duration=t,this.delay=i,this.startTime=h,this.isCooling=!0,this.addEventListener(egret.Event.ENTER_FRAME,this.draw,this),this.dispatchEvent(new egret.Event(e.COOLDOWN_START))},e.prototype.stop=function(){this.isCooling=!1,this.removeEventListener(egret.Event.ENTER_FRAME,this.draw,this),this.dispatchEvent(new egret.Event(e.COOLDOWN_END))},e.prototype.reset=function(){this.stop(),this.clear()},e.prototype.clear=function(){this.graphics.clear()},e.prototype.draw=function(t){this.clear();var e=egret.getTimer()-this.startTime-this.delay;if(e>=this.duration)return void this.stop();if(0>=e)var i=0;else i=360*e/this.duration;this.drawBack(),this.drawAngle(i)},e.prototype.drawBack=function(){this.graphics.beginFill(16764108,0),this.isRect?this.graphics.drawRect(0,0,this.rect.width,this.rect.height):this.graphics.drawEllipse(0,0,this.rect.width,this.rect.height),this.graphics.endFill()},e.prototype.drawAngle=function(t){!this.isAnti&&(t=360-t),this.drawSector(t,this.isAnti)},e.prototype.drawSector=function(t,e){void 0===e&&(e=!1);var i=1;e||(i=-1),this.graphics.beginFill(this.color,this.alphaC),this.graphics.lineStyle(0,this.color,0),this.graphics.moveTo(this.basePos.x,this.basePos.y),t=Math.abs(t)>360?360:t;var s=Math.ceil(Math.abs(t)/45),h=t/s;h=h*Math.PI/180;var a=this.startFrom;a=a*Math.PI/180,this.graphics.lineTo(this.basePos.x+this.a*Math.cos(a),this.basePos.y+this.b*Math.sin(a));for(var o=0;s>o;++o){a+=i*h;var n=a-i*h/2,r=this.a/Math.cos(h/2)*Math.cos(n),l=this.b/Math.cos(h/2)*Math.sin(n),c=this.a*Math.cos(a),d=this.b*Math.sin(a);this.graphics.curveTo(this.basePos.x+r,this.basePos.y+l,this.basePos.x+c,this.basePos.y+d)}this.graphics.endFill()},e.COOLDOWN_END="eventEnd",e.COOLDOWN_START="eventStart",e}(egret.Sprite);t.CooldownEffect=h,__reflect(h.prototype,"TSEffect.CooldownEffect")}(TSEffect||(TSEffect={}));var DataController=function(){function t(){this.dataList=[],this.init()}return t.prototype.init=function(){this.saveData=SaveData.getInstance(),this.config=Config.getInstance().card_tip},t.getInstance=function(){return null===this.instance&&(this.instance=new t),this.instance},t.prototype.getCanCollectionCard=function(){for(var t=[],e=this.saveData.getStageOpen(),i=1;e>i;i++)this.config[i].No===i&&this.config[i].stage<=e&&t.push(this.config[i]);return t},t.prototype.getCollectionedCards=function(t){for(var e={cards:[],index:0},i=1;i<this.config.length;i++)this.saveData.cardSave[i]>=3&&(t===i&&(e.index=e.cards.length),e.cards.push(i));return e},t.prototype.getCollectionedCardsNumber=function(){for(var t=0,e=0;e<this.saveData.cardSave.length;e++)this.saveData.cardSave[e]>=3&&t++;return t},t.prototype.cardShowHint=function(t){this.saveData.saveCardHintRead(t)},t.prototype.newCardGod=function(t){var e=this.saveData.getCardStatus(t);return 3>e?(this.saveData.saveCardGot(t),!0):!1},t.prototype.getCardId=function(t,e){for(var i=0;i<this.config.length;i++);},t.instance=null,t}();__reflect(DataController.prototype,"DataController");var GameAnalyticsController=function(){function t(){this.init()}return t.prototype.init=function(){"qqplay"===platform.name&&(GameAnalytics("setEnabledInfoLog",!0),platform.print("初始化统计"),GameAnalytics("initialize","02a2d376f1268780cdeb969e3385bae2","9b426779362d3259747c55f90ce0a40500524bcb"))},t.getInstance=function(){return null===this.instance&&(this.instance=new t),this.instance},t.prototype.stageStartAnalytics=function(t){"qqplay"===platform.name&&(platform.print("关卡开始统计"),GameAnalytics("addProgressionEvent","Start","stage",t))},t.prototype.stageGameOverAnalytics=function(t){"qqplay"===platform.name&&(platform.print("关卡结束统计"),GameAnalytics("addProgressionEvent","Fail","stage",t))},t.prototype.stageClearAnalytics=function(t){"qqplay"===platform.name&&(platform.print("关卡胜利统计"),GameAnalytics("addProgressionEvent","Complete","stage",t))},t.prototype.stageVedioPlayAnalytics=function(t,e){"qqplay"===platform.name&&(platform.print("视频播放统计"),GameAnalytics("addDesignEvent","StageHint:"+t+":"+e,1))},t.prototype.cardGotAnalytics=function(t){"qqplay"===platform.name&&(platform.print("卡片获取统计"),t.forEach(function(t){GameAnalytics("addProgressionEvent","Complete","card",t)}))},t.prototype.cardVedioPlayAnalytics=function(t){"qqplay"===platform.name&&(platform.print("卡片视频统计"),GameAnalytics("addDesignEvent","StageHint:"+t,1))},t.prototype.rankEnterAnalytics=function(){"qqplay"===platform.name&&(platform.print("排行进入统计"),GameAnalytics("addDesignEvent","RankEnter",1))},t.instance=null,t}();__reflect(GameAnalyticsController.prototype,"GameAnalyticsController");var GuideController=function(){function t(){this.init()}return t.prototype.init=function(){this._guideStep=0,this._guidePassed=!SaveData.getInstance().isNewPlayer},t.getInstance=function(){return null===this.instance&&(this.instance=new t),this.instance},t.prototype.resetStep=function(){this._guideStep=0},t.prototype.nextStep=function(){this._guideStep++},t.prototype.passGuide=function(){this._guidePassed=!0,SaveData.getInstance().passGuide()},Object.defineProperty(t.prototype,"guideStep",{get:function(){return this._guideStep},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"guidePassed",{get:function(){return this._guidePassed},enumerable:!0,configurable:!0}),t.instance=null,t}();__reflect(GuideController.prototype,"GuideController");var HintController=function(){function t(){this.dataList=[],this.init()}return t.prototype.init=function(){},t.getInstance=function(){return null===this.instance&&(this.instance=new t),this.instance},t.prototype.getStageHintStatus=function(){},t.prototype.setStageHintStatus=function(t){SaveData.getInstance().saveStageHintRead(t)},t.prototype.setCardHintStatus=function(t){SaveData.getInstance().saveCardHintRead(t)},t.instance=null,t}();__reflect(HintController.prototype,"HintController");var ItemController=function(){function t(){this.itemList=[],this.init()}return t.prototype.init=function(){},t.getInstance=function(){return null===this.instance&&(this.instance=new t),this.instance},t.prototype.hasItem=function(t){for(var e=!1,i=0;i<this.itemList.length;i++)if(this.itemList[i]===t){e=!0;break}return e},t.prototype.addItem=function(t,e){return void 0===e&&(e=!0),5===this.itemList.length?(UIManager.getInstance().showItemFullTip(),!1):this.hasItem(t)?!1:(this.itemList.push(t),e&&UIManager.getInstance().openItemGetPop(ItemEnum.getResUrlById(t)),ItemCtrlView.getInstance().updateItems(!1),!0)},t.prototype.useItem=function(t){return this.hasItem(t)?(this.itemList.splice(this.getIndexOf(t),1),ItemCtrlView.getInstance().updateItems(!1),!0):!1},t.prototype.getItem=function(t){return this.itemList[t]},t.prototype.resetList=function(){ItemCtrlView.getInstance().cancelItemCurrentDrag(),this.itemList=[],ItemCtrlView.getInstance().updateItems()},t.prototype.getItemList=function(){return this.itemList},t.prototype.getIndexOf=function(t){for(var e=-1,i=0;i<this.itemList.length;i++)if(this.itemList[i]===t){e=i;break}return e},t.instance=null,t}();__reflect(ItemController.prototype,"ItemController");var SettingController=function(){function t(){this.init()}return t.prototype.init=function(){},t.getInstance=function(){return null===this.instance&&(this.instance=new t),this.instance},Object.defineProperty(t.prototype,"SoundPlaying",{get:function(){if(void 0===this._soundPlaying){var t=SaveData.getInstance().getSoundStatus();null===t||void 0===t||""===t||"1"===t?this.SoundPlaying=!0:this._soundPlaying="1"===t?!0:!1}return this._soundPlaying},set:function(t){this._soundPlaying=t,t?(SaveData.getInstance().saveSoundStatus("1"),SoundManager.getInstance().playBGM(),SoundManager.getInstance().playSound(SoundEnum.SELECTSOUND_MP3)):(SaveData.getInstance().saveSoundStatus("0"),SoundManager.getInstance().stopBGM())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Lang",{get:function(){if(void 0===this._lang){var t=SaveData.getInstance().getLang();null===t||void 0===t||""===t?this.Lang="zh_CN":this._lang=t}return this._lang},set:function(t){SaveData.getInstance().setLang(t),this._lang=t},enumerable:!0,configurable:!0}),t.instance=null,t}();__reflect(SettingController.prototype,"SettingController");var StageController=function(){function t(){this.newOpenList=[],this.newClearList=[],this.init()}return t.prototype.init=function(){this.currentSelected=SaveData.getInstance().getLastPlay(),this.dispather=new StageDispather},t.prototype.checkNewStage=function(){},t.getInstance=function(){return null===this.instance&&(this.instance=new t),this.instance},t.prototype.nextStage=function(){},t.prototype.clearStage=function(t,e){return void 0===e&&(e=[]),__awaiter(this,void 0,void 0,function(){var i,s;return __generator(this,function(h){return ItemController.getInstance().resetList(),i=e.filter(function(t){return DataController.getInstance().newCardGod(t)}),SaveData.getInstance().saveStagePass(t)&&(this.newClearList.push(t),1===t&&SaveData.getInstance().isNewPlayer?this.newOpenList=[2,3,4,5,6]:(s=SaveData.getInstance().getStageOpen(),this.newOpenList.push(s),this.loadNextStage(s+1))),GameAnalyticsController.getInstance().stageClearAnalytics(t),GameAnalyticsController.getInstance().cardGotAnalytics(i),platform.uploadRank("",DataController.getInstance().getCollectionedCardsNumber()),UIManager.getInstance().openClearPop(t,i),[2]})})},t.prototype.gameOverStage=function(t,e){void 0===e&&(e=[]),ItemController.getInstance().resetList();var i=e.filter(function(t){return DataController.getInstance().newCardGod(t)});platform.existRank&&platform.uploadRank("",DataController.getInstance().getCollectionedCardsNumber()),GameAnalyticsController.getInstance().stageGameOverAnalytics(t),GameAnalyticsController.getInstance().cardGotAnalytics(i),UIManager.getInstance().openGameOverPop(t,i)},t.prototype.resetStage=function(){ItemController.getInstance().resetList()},t.prototype.getNewOpenList=function(){return this.newOpenList},t.prototype.removeClearFromList=function(t){this.newClearList.splice(t,1)},t.prototype.getNewClearList=function(){return this.newClearList},t.prototype.isStageOpen=function(t){return SaveData.getInstance().getStageOpen()>=t?!0:!1},t.prototype.isStageClear=function(t){return SaveData.getInstance().getStageStatus(t).pass},t.prototype.isStageNew=function(t){return-1!==this.newOpenList.indexOf(t)?!0:!1},t.prototype.getCurrentSelectedName=function(){},t.prototype.getCurrentSelected=function(){return this.currentSelected},t.prototype.getDispather=function(){return this.dispather},t.prototype.startStage=function(t){GameAnalyticsController.getInstance().stageStartAnalytics(t),UIManager.getInstance().toGameScene()},t.prototype.setSelect=function(e){if(this.isStageOpen(e))if(this.currentSelected===e)this.clearNewOpenList(Math.floor((e-1)/6)+1),this.startStage(e);else{this.currentSelected=e;var i=new StageEvent(StageEvent.STAGE_SELECED,e);t.getInstance().getDispather().dispatchEvent(i),SaveData.getInstance().saveLastPlay(e)}},t.prototype.clearNewOpenList=function(t){for(var e=0;e<this.newOpenList.length&&this.newOpenList[e]<=6*t;)this.newOpenList.shift()},t.prototype.setNewClearList=function(){},t.prototype.loadStage=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return"web"!==platform.name&&"oppo"!==platform.name&&"mi"!==platform.name?[3,2]:(console.log("load res from local"),[4,RES.loadConfig("resource/stage"+t+".res.json","resource/")]);case 1:return e.sent(),[3,4];case 2:return 30>=t?(console.log("load res from https://cdn.joypac.cn/kaihi3_h5/resource/"),[4,RES.loadConfig("stage"+t+".res.json","https://cdn.joypac.cn/kaihi3_h5/resource/")]):[3,4];case 3:e.sent(),e.label=4;case 4:return[4,RES.loadGroup("stage"+t+"_mp3",0)];case 5:return e.sent(),[4,RES.loadGroup("stage"+t+"_png",0)];case 6:return e.sent(),[4,RES.loadGroup("stage"+t+"_json",0)];case 7:return e.sent(),[2]}})})},t.prototype.loadNextStage=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return 30>=t?(platform.print("load new stage"+t),[4,RES.loadConfig("stage"+t+".res.json","https://cdn.joypac.cn/kaihi3_h5/resource/")]):[3,5];case 1:return e.sent(),[4,RES.loadGroup("stage"+t+"_mp3",0)];case 2:return e.sent(),[4,RES.loadGroup("stage"+t+"_png",0)];case 3:return e.sent(),[4,RES.loadGroup("stage"+t+"_json",0)];case 4:e.sent(),e.label=5;case 5:return[2]}})})},t.instance=null,t}();__reflect(StageController.prototype,"StageController");var HintTypeEnum=function(){function t(){}return t.COLLECTION_HINT_ITEM=0,t.STAGE_HINT_ITEM_1=1,t.STAGE_HINT_ITEM_2=2,t.STAGE_HINT_ITEM_3=3,t}();__reflect(HintTypeEnum.prototype,"HintTypeEnum");var ItemEnum=function(){function t(){}return t.getResUrlById=function(t){return this.ITEM_URL[t]},t.ITEM_COVER=0,t.ITEM_MASK=1,t.ITEM_FURIKO=2,t.ITEM_ICE=3,t.ITEM_CAKE=4,t.ITEM_FLOWER_ONE=5,t.ITEM_FLOWER_TWO=6,t.ITEM_FLOWER_THREE=7,t.ITEM_FLOWER_RING=8,t.ITEM_BERRY=9,t.ITEM_UMBRELLA=10,t.ITEM_KANI=11,t.ITEM_TAKO=12,t.ITEM_UKIWA=13,t.ITEM_MIZUGUMO=14,t.ITEM_ICESHOES=15,t.ITEM_BOTTLE=16,t.ITEM_LADDER=17,t.ITEM_BROTHER=18,t.ITEM_TIRE=19,t.ITEM_DAMETIRE=20,t.ITEM_SCREWDRIVER=21,t.ITEM_HOOD=22,t.ITEM_STICK=23,t.ITEM_APPLE=24,t.ITEM_RED_BALL=25,t.ITEM_BLUE_BALL=26,t.ITEM_ROBOT_BALL=27,t.ITEM_RED_ICE=28,t.ITEM_YELLOW_ICE=29,t.ITEM_BLUE_DRINK=30,t.ITEM_FAN=31,t.ITEM_SHELL=32,t.ITEM_STAR=33,t.ITEM_COLORFUL_UMBRELLA=34,t.ITEM_SUNSHINE_UMBRELLA=35,t.ITEM_BLUE_BOOK=36,t.ITEM_RED_BOOK=37,t.ITEM_GREY_BOOK=38,t.ITEM_HAIR_GROW_WATER=39,t.ITEM_CLIPPER=40,t.ITEM_SCISSORS=41,t.ITEM_SEED=42,t.ITEM_BOX=43,t.ITEM_FULL_BOX=44,t.ITEM_ICE_BOX=45,t.ITEM_MUSHROOM=46,t.ITEM_SWEET_POTATO=47,t.ITEM_FIRED_SWEET_POTATO=48,t.ITEM_FLASHLIGHT=49,t.ITEM_PEPER=50,t.ITEM_KELP=51,t.ITEM_FISH=52,t.ITEM_WEEDER=53,t.ITEM_CUP=54,t.ITEM_BREAD=55,t.ITEM_WATER_BUCKET=56,t.ITEM_EMPTY_BUCKET=57,t.ITEM_KEY=58,t.ITEM_SPADE=59,t.ITEM_CAT_TURE=60,t.ITEM_BERRY_BOTTLE=61,t.ITEM_GARLIC=62,t.ITEM_DRUMSTICKS=63,t.ITEM_FISH_FILLET=64,t.ITEM_DURIAN=65,t.ITEM_TOMATO=66,t.ITEM_ON_SALE=67,t.ITEM_BEAF=68,t.ITEM_POTATO=69,t.ITEM_WHITE_EGGS=70,t.ITEM_CARROT=71,t.ITEM_FRIES=72,t.ITEM_TRY_TASTE=73,t.ITEM_YELLOW_EGGS=74,t.ITEM_HUNDRED_YUAN=75,t.ITEM_HUNDRED_ONE_YUAN=76,t.ITEM_TRY_TASTE_STICK=77,t.ITEM_BANANA=78,t.ITEM_JUNGLE_BELL=79,t.ITEM_LITTLE_MING=80,t.ITEM_GOLD_REAVER=81,t.ITEM_REAVER=82,t.ITEM_BANANA_SKIN=83,t.ITEM_RED_BALL_2=84,t.ITEM_RED_BALL_3=85,t.ITEM_APPLE_2=86,t.ITEM_APPLE_3=87,t.ITEM_SEED_1=88,t.ITEM_SEED_2=89,t.ITEM_SEED_3=90,t.ITEM_SEED_4=91,t.ITEM_WATER_BUCKET_1=92,t.ITEM_WATER_BUCKET_2=93,t.ITEM_EMPTY_BUCKET_1=94,t.ITEM_WHITE_EGGS_1=95,t.ITEM_WHITE_EGGS_2=96,t.ITEM_WHITE_EGGS_3=97,t.ITEM_URL=["item_cover","item_mask","item_furiko","item_ice","item_cake","item_flower","item_flower","item_flower","item_flower_ring","item_berry","item_umbrella","item_kani","item_tako","item_ukiwa","item_mizugumo","item_iceshoes","item_bottle","item_ladder","item_brother","item_tire","item_dametire","item_screwdriver","item_hood","item_stick","item_apple","item_red_ball","item_blue_ball","item_robot_ball","item_red_ice","item_yellow_ice","item_blue_drink","item_fan","item_shell","item_star","item_colorful_umbrella","item_sunshine_umbrella","item_blue_book","item_red_book","item_grey_book","item_hair_grow_water","item_clipper","item_scissors","item_seed","item_box","item_full_box","item_ice_box","item_mushroom","item_sweet_potato","item_fired_sweet_potato","item_flashlight","item_peper","item_kelp","item_fish","item_weeder","item_cup","item_bread","item_water_bucket","item_empty_bucket","item_key","item_spade","item_cat_ture","item_berry_bottle","item_garlic","item_drumsticks","item_fish_fillet","item_durian","item_tomato","item_on_sale","item_beaf","item_potato","item_white_eggs","item_carrot","item_fries","item_try_taste","item_yellow_eggs","item_hundred_yuan","item_hundred_one_yuan","item_try_taste_stick","item_banana","item_jungle_bell","item_little_ming","item_gold_reaver","item_reaver","item_banana_skin","item_red_ball","item_red_ball","item_apple","item_apple","item_seed","item_seed","item_seed","item_seed","item_water_bucket","item_water_bucket","item_empty_bucket","item_white_eggs","item_white_eggs","item_white_eggs"],t
}();__reflect(ItemEnum.prototype,"ItemEnum");var LanguageEnum=function(){function t(){}return t.GROUP_HINT="hintLang",t.GROUP_CARD="cardLang",t.GROUP_STAGE="stageLang",t.PAGE_SELECT="page_select",t.HINT_TITLE="hint_title",t.STAGE_NO="stage_no",t}();__reflect(LanguageEnum.prototype,"LanguageEnum");var SoundEnum=function(){function t(){}return t.MAIN1SOUND_1_MP3="124_Main1Sound_1_mp3",t.ITEMSOUND_MP3="112_ItemSound_mp3",t.CLICKSOUND_MP3="52_ClickSound_mp3",t.SELECTSOUND_MP3="98_SelectSound_mp3",t.BURST2SOUND_MP3="111_Burst2Sound_mp3",t.GONGSTARTSOUND_MP3="80_GongStartSound_mp3",t.GONGENDSOUND_MP3="81_GongEndSound_1_mp3",t.KICKSOUND_MP3="78_KickSound_mp3",t.KANSEISOUND_1="41_KanseiSound_1_mp3",t.HITSOUND_MP3="40_HitSound_mp3",t.AURA2SOUND_MP3="67_Aura2Sound_mp3",t.AURASOUND_MP3="68_AuraSound_mp3",t.SUBURISOUND_MP3="23_SuburiSound_mp3",t.SHINE2SOUND_MP3="88_Shine2Sound_mp3",t.BOKESOUND_MP3="25_BokeSound_mp3",t.WATER5SOUND_MP3="12_Water5Sound_mp3",t.WATER4SOUND_MP3="15_Water4Sound_mp3",t.VALVESOUND_MP3="17_ValveSound_mp3",t.WATER7SOUND_MP3="21_Water7Sound_mp3",t.WATER6SOUND_MP3="27_Water6Sound_mp3",t.PUYONSOUND_MP3="35_PuyonSound_mp3",t.ASERISOUND_MP3="123_AseriSound_mp3",t.REIZOUKOOPENSOUND_MP3="33_ReizoukoOpenSound_mp3",t.REIZOUKOCLOSESOUND_MP3="34_ReizoukoCloseSound_mp3",t.UPSOUND_MP3="38_UpSound_mp3",t.EATSOUND_MP3="43_EatSound_mp3",t.KUWAGATASOUND_MP3="74_KuwagataSound_mp3",t.WATER8SOUND_MP3="14_Water8Sound_mp3",t.BUSH2SOUND_MP3="113_Bush2Sound_mp3",t.BUSHSOUND_MP3="114_BushSound_mp3",t.AUTODOORSOUND_MP3="125_AutoDoorSound_mp3",t.WINDSOUND_1_MP3="10_WindSound_1_mp3",t.SHINESOUND_MP3="8_ShineSound_mp3",t.UMBRELLASOUND_MP3="3_UmbrellaSound_mp3",t.ZOMBIMOVESOUND_MP3="5_ZombiMoveSound_mp3",t.ZOMBIATTACKSOUND_MP3="20_ZombiAttackSound_mp3",t.ZOMBICLEARSOUND_MP3="64_ZombiClearSound_mp3",t.ZOMBIGAMEOVERSOUND_MP3="65_ZombiGameOverSound_mp3",t.ZOMBIDIGGINGSOUND_MP3="70_ZombiDiggingSound_mp3",t.ZOMBIDEADSOUND_MP3="127_ZombiDeadSound_mp3",t.ZOMBIMARAKASUSOUND_MP3="54_ZombiMarakasuSound_mp3",t.ZOMBIMOVEFASTSOUND_MP3="6_ZombiMoveFastSound_mp3",t.NAMISOUND_1_MP3="57_NamiSound_1_mp3",t.WATER2SOUND_MP3="61_Water2Sound_mp3",t.DOOROPENSOUND_MP3="91_DoorOpenSound_mp3",t.GLASSBREAK2SOUND_MP3="82_GlassBreak2Sound_mp3",t.FREEZESOUND_MP3="96_FreezeSound_mp3",t.SUBERISOUND_MP3="53_SuberiSound_mp3",t.WATERSOUND_MP3="26_WaterSound_mp3",t.DONSOUND_MP3="120_DonSound_mp3",t.KISHIMISOUND_MP3="69_KishimiSound_mp3",t.CATSOUND_MP3="106_CatSound_mp3",t.BURSTSOUND_MP3="119_BurstSound_mp3",t.METAL4SOUND_MP3="72_Metal4Sound_mp3",t.DRINKSOUND_MP3="90_DrinkSound_mp3",t.OPEN2SOUND_MP3="44_Open2Sound_mp3",t.JUMPSOUND_MP3="4_JumpSound_mp3",t.UMASTEPSOUND_MP3="55_UmaStepSound_mp3",t.UMAVOICESOUND_MP3="56_UmaVoiceSound_mp3",t.TOSSHINSOUND_MP3="63_TosshinSound_mp3",t.METALSOUND_MP3="62_MetalSound_mp3",t.METAL6SOUND_MP3="73_Metal6Sound_mp3",t.CARSTARTSOUND_MP3="86_CarStartSound_1_mp3",t.CARPASSSOUND_1_MP3="87_CarPassSound_1_mp3",t.FUSUMAOPENSOUND_MP3="83_FusumaOpenSound_mp3",t.CHAIRSOUND_MP3="105_ChairSound_mp3",t.KONSOUND_MP3="9_KonSound_mp3",t.BUCHISOUND_MP3="30_BuchiSound_mp3",t.CRASH2SOUND_MP3="77_Crash2Sound_mp3",t.WARESOUND_MP3="115_WareSound_mp3",t.BOWLINGGUTTERSOUND_MP3="116_BowlingGutterSound_mp3",t.BOWLINGTHROWSOUND_MP3="117_BowlingThrowSound_mp3",t.DON2SOUND_MP3="118_Don2Sound_mp3",t.CORRECTSOUND_MP3="101_CorrectSound_mp3",t.SHINE3SOUND_MP3="93_Shine3Sound_mp3",t.KUSASOUND_MP3="11_KusaSound_mp3",t.METAL2SOUND_MP3="37_Metal2Sound_mp3",t.DRYERSOUND_MP3="103_DryerSound_mp3",t.HATODOKEISOUND_MP3="16_HatodokeiSound_mp3",t.FUSUMACLOSESOUND_MP3="84_FusumaCloseSound_mp3",t.KACHISOUND_MP3="49_KachiSound_mp3",t.BIRISOUND_MP3="42_BiriSound_mp3",t.OPENSOUND_MP3="45_OpenSound_mp3",t.HIT2SOUND_MP3="79_Hit2Sound_mp3",t.RUNECHOSOUND_MP3="32_RunEchoSound_mp3",t.WATER3SOUND_MP3="13_Water3Sound_mp3",t.UFOSOUND_1_MP3="18_UfoSound_1_mp3",t.KUSAKARIKISOUND_MP3="58_KusakarikiSound_mp3",t.COWSOUND_MP3="76_CowSound_mp3",t.DOGSOUND_MP3="92_DogSound_mp3",t.SCHOOLCHIMESOUND_1_MP3="31_SchoolChimeSound_1_mp3",t.TODANAOPENSOUND_MP3="99_TodanaOpenSound_mp3",t.SLIDEDOORSOUND_MP3="104_SlideDoorSound_mp3",t.KOROGARISOUND_MP3="48_KorogariSound_mp3",t.KOROGARI2SOUND_MP3="46_Korogari2Sound_mp3",t.HORRORSOUND_MP3="94_HorrorSound_mp3",t.KUSAISOUND_MP3="24_KusaiSound_mp3",t.COIN6SOUND_MP3="60_Coin6Sound_mp3",t.INCORRECTSOUND_MP3="75_IncorrectSound_mp3",t.REGISOUND_MP3="97_RegiSound_mp3",t.REGI2SOUND_MP3="102_Regi2Sound_mp3",t.TAMAGOCRASHSOUND_MP3="22_TamagoCrashSound_mp3",t.KARASUSOUND_MP3="71_KarasuSound_mp3",t.BELL3SOUND_MP3="121_Bell3Sound_mp3",t.BELL2SOUND_MP3="122_Bell2Sound_mp3",t}();__reflect(SoundEnum.prototype,"SoundEnum");var StageEnum=function(){function t(){}return t.Stage1="弹出回避",t.Stage2="KO回避",t}();__reflect(StageEnum.prototype,"StageEnum");var StageDispather=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(egret.EventDispatcher);__reflect(StageDispather.prototype,"StageDispather");var StageEvent=function(t){function e(e,i,s,h,a){var o=t.call(this,e,s,h,a)||this;return o.stage=i,o}return __extends(e,t),e.prototype.getStage=function(){return this.stage},e.STAGE_CLEAR="stage_clear",e.STAGE_OPEN="stage_open",e.STAGE_SELECED="stage_seleced",e}(egret.Event);__reflect(StageEvent.prototype,"StageEvent");var AdManager=function(){function t(){this._bannerShow=!1,this._vedioLoaded=!1,this.init()}return t.prototype.init=function(){if(null!==t.instance)throw new Error("single instance error");this._banner=null,this._vedio=null,this._interstitialAd=null,this._interstitialAdTimes=0},t.getInstance=function(){return null===this.instance&&(this.instance=new t),this.instance},t.prototype.fetchVedio=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return null!==this._vedio?[3,2]:(t=this,[4,platform.fetchVedio()]);case 1:t._vedio=e.sent(),e.label=2;case 2:return[2]}})})},t.prototype.vedioPlay=function(t,e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(i){return platform.vedioPlay(this._vedio,t,function(t){var i=t.finish;console.log(i),e(i)}),[2]})})},t.prototype.fetchInterstitial=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return null!==this._interstitialAd?[3,2]:(t=this,[4,platform.fetchInterstitial()]);case 1:t._interstitialAd=e.sent(),e.label=2;case 2:return[2]}})})},t.prototype.showInterstitial=function(){platform.hasInterstitialSDK()&&(this._interstitialAdTimes++,console.log(this._interstitialAdTimes),5===this._interstitialAdTimes&&(platform.showInterstitial(this._interstitialAd),this._interstitialAdTimes=0))},t.prototype.fetchBanner=function(t){return void 0===t&&(t=!0),__awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(i){switch(i.label){case 0:return null!==this._banner?[3,2]:(e=this,[4,platform.fetchBanner()]);case 1:e._banner=i.sent(),i.label=2;case 2:return null!==this._banner&&t&&this.showBanner(),[2]}})})},t.prototype.showBanner=function(){null===this._banner||this._bannerShow||(this._bannerShow=!0,platform.showBanner(this._banner))},t.prototype.hideBanner=function(){null!==this._banner&&this._bannerShow&&(platform.print("隐藏广告"),this._bannerShow=!1,platform.hideBanner(this._banner),"oppo"!==platform.name&&(this._banner=null,this.fetchBanner(!1)))},Object.defineProperty(t.prototype,"bannerOK",{get:function(){return null===this._banner?!1:!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"banner",{get:function(){return this._banner},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"vedio",{get:function(){return this._vedio},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bannerShow",{get:function(){return this._bannerShow},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"interstitialAd",{get:function(){return this._interstitialAd},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"vedioOK",{get:function(){return this._vedioLoaded||platform.reloadVedio(this._vedio),this._vedioLoaded},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"vedioLoaded",{set:function(t){this._vedioLoaded=t},enumerable:!0,configurable:!0}),t.instance=null,t}();__reflect(AdManager.prototype,"AdManager");var I18nManager=function(){function t(){this.init()}return t.prototype.init=function(){if(null!==t.instance)throw new Error("single instance error");this.lang=Config.getInstance().i18n},t.getInstance=function(){return null===this.instance&&(this.instance=new t),this.instance},t.prototype.getLanguageInGroupByName=function(t,e){return this.lang[SettingController.getInstance().Lang][t][e]},t.prototype.getLanguageByGroup=function(t){return this.lang[SettingController.getInstance().Lang][t]},t.prototype.getLanguageByName=function(t){return this.lang[SettingController.getInstance().Lang][t]},Object.defineProperty(t.prototype,"language",{get:function(){return this.lang[SettingController.getInstance().Lang]},enumerable:!0,configurable:!0}),t.instance=null,t}();__reflect(I18nManager.prototype,"I18nManager");var SoundManager=function(){function t(){this.bgmPlaying=!1,this.init()}return t.prototype.init=function(){if(null!==t.instance)throw new Error("single instance error")},t.getInstance=function(){return null===this.instance&&(this.instance=new t),this.instance},t.prototype.playBGM=function(){SettingController.getInstance().SoundPlaying&&!this.bgmPlaying&&(this.bgm=RES.getRes(SoundEnum.MAIN1SOUND_1_MP3),this.bgmChannel=this.bgm.play(0,0),this.bgmPlaying=!0)},t.prototype.playSound=function(t,e){if(void 0===e&&(e=1),SettingController.getInstance().SoundPlaying){var i=RES.getRes(t);this.soundChannel=i.play(0,e)}},t.prototype.onPlayOver=function(){},t.prototype.stopBGM=function(){this.bgmPlaying&&(this.bgmChannel.stop(),this.bgmPlaying=!1),void 0!==this.soundChannel&&this.soundChannel.stop()},t.instance=null,t}();__reflect(SoundManager.prototype,"SoundManager");var UIManager=function(){function t(){this.gameLayer=new egret.DisplayObjectContainer,this.loadingLayer=new egret.DisplayObjectContainer,this.uiLayer=new egret.DisplayObjectContainer,this.popLayer=new egret.DisplayObjectContainer,this.tipLayer=new egret.DisplayObjectContainer,this.gameScene=null,this.titleScene=null,this.dataScene=null,this.rankScene=null,this.isPopUp=!1,this.currentScene=null}return t.prototype.init=function(t){this.egretStage=t,this.loading=new LoadingUI,this.initLayer(this.gameLayer),this.initLayer(this.uiLayer),this.egretStage.addChild(this.popLayer),this.egretStage.addChild(this.tipLayer),this.egretStage.addChild(this.loadingLayer),this.egretStage.scaleMode===egret.StageScaleMode.FIXED_WIDTH},t.prototype.setSheet=function(){this.popSheet=RES.getRes("pops_sheet")},t.getInstance=function(){return null===this.instance&&(this.instance=new t),this.instance},t.prototype.initLayer=function(t){t.x=(Util.curWidth()-Util.displayWidth())/2,t.y=(Util.curHeight()-Util.displayHeight())/2,this.egretStage.addChild(t)},t.prototype.getGameLayer=function(){return this.gameLayer},t.prototype.getUILayer=function(){return this.uiLayer},t.prototype.getLoadingLayer=function(){return this.loadingLayer},t.prototype.getPopLayer=function(){return this.popLayer},t.prototype.getTipLayer=function(){return this.tipLayer},t.prototype.setCurrentPop=function(t){this.currentPop=t},t.prototype.getCurrentPop=function(){return this.currentPop},t.prototype.getCurrentStage=function(){return this.currentStage},t.prototype.toRankScene=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return this.showLoading(),[4,RES.loadGroup("data_scene")];case 1:return t.sent(),[4,RES.loadGroup("game_scene")];case 2:return t.sent(),null!==this.currentScene&&(this.currentScene.parent===this.gameLayer&&this.gameLayer.removeChild(this.currentScene),this.currentScene!==this.rankScene&&this.uiLayer.removeChildren(),this.currentScene=null),null===this.rankScene&&(this.rankScene=new RankScene(this.egretStage)),this.currentScene=this.rankScene,this.gameLayer.addChild(this.currentScene),this.hideLoading(),[2]}})})},t.prototype.toTitleScene=function(){this.showLoading(),null!==this.currentScene&&(this.gameLayer.removeChildren(),this.currentScene!==this.titleScene&&this.uiLayer.removeChildren()),null===this.titleScene&&(this.titleScene=new TitleScene(this.egretStage)),this.currentScene=this.titleScene,this.gameLayer.addChild(this.currentScene),this.hideLoading()},t.prototype.toGameScene=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return this.showLoading(),[4,RES.loadGroup("game_scene")];case 1:return e.sent(),[4,RES.loadGroup("tip")];case 2:return e.sent(),null!==this.currentScene&&this.currentScene!==this.gameScene&&(this.gameLayer.removeChildren(),this.uiLayer.removeChildren()),t=this,[4,new GameScene(this.egretStage)];case 3:return t.gameScene=e.sent(),this.currentScene=this.gameScene,this.currentScene.setGameStage(),this.gameLayer.addChild(this.currentScene),[2]}})})},t.prototype.toDataScene=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return this.showLoading(),[4,RES.loadGroup("data_scene")];case 1:return t.sent(),[4,RES.loadGroup("game_scene")];case 2:return t.sent(),null!==this.currentScene&&(this.gameLayer.removeChildren(),this.currentScene!==this.dataScene&&this.uiLayer.removeChildren(),this.currentScene=null),null===this.dataScene&&(this.dataScene=new DataScene(this.egretStage)),this.currentScene=null,this.currentScene=this.dataScene,this.gameLayer.addChild(this.currentScene),this.hideLoading(),[2]}})})},t.prototype.showLoading=function(){this.loadingLayer.addChild(this.loading),this.loading.onShow()},t.prototype.hideLoading=function(){this.loading.parent===this.loadingLayer&&(this.loading.onHide(),this.loadingLayer.removeChild(this.loading))},t.prototype.openHowToPlayPop=function(){var t=new HowToPlayPop;this.popLayer.addChild(t),this.isPopUp=!0,this.currentPop=t},t.prototype.closeHowToPlayPop=function(){this.popLayer.removeChild(this.currentPop),this.isPopUp=!1,this.currentPop=null},t.prototype.openItemGetPop=function(t){null==this.itemGetPop&&(this.itemGetPop=new ItemGetPop,this.itemGetPop.setIcon(t),PopEffect.addPopUp(this.itemGetPop,!0,0,0,2),this.isPopUp=!0,this.currentPop=this.itemGetPop)},t.prototype.closeItemGetPop=function(){null!=this.itemGetPop&&(PopEffect.removePopUp(this.itemGetPop,1),this.itemGetPop=null,this.isPopUp=!1,this.currentPop=null)},t.prototype.openMenuPop=function(){null==this.menuPop&&(this.menuPop=new MenuPop(this.popSheet),this.popLayer.addChild(this.menuPop),this.isPopUp=!0,this.currentPop=this.menuPop)},t.prototype.closeMenuPop=function(){null!=this.menuPop&&(this.popLayer.removeChild(this.menuPop),this.menuPop=null,this.currentPop=null,this.isPopUp=!1)},t.prototype.openClearPop=function(e,i){this.closeAllPop(),null==this.clearPop&&(this.clearPop=new ClearPop(e,this.popSheet),this.clearPop.setCollections(i),t.getInstance().getPopLayer().addChild(this.clearPop),this.currentPop=this.clearPop,this.isPopUp=!0,AdManager.getInstance().showBanner())},t.prototype.closeClearPop=function(){null!=this.clearPop&&(t.getInstance().getPopLayer().removeChild(this.clearPop),this.clearPop=null,this.currentPop=null,this.isPopUp=!1)},t.prototype.openGameOverPop=function(e,i){this.closeAllPop(),null==this.gameOverPop&&(this.gameOverPop=new GameOverPop(e,this.popSheet),this.gameOverPop.setCollections(i),t.getInstance().getPopLayer().addChild(this.gameOverPop),this.currentPop=this.gameOverPop,this.isPopUp=!0,AdManager.getInstance().showBanner())},t.prototype.closeGameOverPop=function(){null!=this.gameOverPop&&(t.getInstance().getPopLayer().removeChild(this.gameOverPop),this.gameOverPop=null,this.currentPop=null,this.isPopUp=!1)},t.prototype.openCardPop=function(t,e){void 0===e&&(e=0),null==this.cardPop&&(this.cardPop=new CardPop(t,e),this.popLayer.addChild(this.cardPop))},t.prototype.closeCardPop=function(){null!=this.cardPop&&(this.popLayer.removeChild(this.cardPop),this.cardPop=null)},t.prototype.openCollectionHintPop=function(t,e){null==this.collectionHintPop&&(this.collectionHintPop=new CollectionHintPop(t,e),this.popLayer.addChild(this.collectionHintPop))},t.prototype.closeCollectionHintPop=function(){null!=this.collectionHintPop&&(this.popLayer.removeChild(this.collectionHintPop),this.collectionHintPop=null)},t.prototype.openHintPop=function(t,e){void 0===e&&(e=!1),null==this.hintPop&&(this.hintPop=new HintPop(t),this.popLayer.addChild(this.hintPop))},t.prototype.closeHintPop=function(){null!=this.hintPop&&(this.popLayer.removeChild(this.hintPop),this.hintPop=null)},t.prototype.openNoVedioPop=function(){null==this.noVedioPop&&(this.noVedioPop=new NoVedioPop,this.popLayer.addChild(this.noVedioPop))},t.prototype.closeNoVedioPop=function(){null!=this.noVedioPop&&(this.popLayer.removeChild(this.noVedioPop),this.noVedioPop=null)},t.prototype.openStageTitlePop=function(){null==this.stageTitlePop&&(this.stageTitlePop=new StageTitlePop(this.popSheet),t.getInstance().getPopLayer().addChild(this.stageTitlePop),this.currentPop=this.stageTitlePop,this.isPopUp=!0)},t.prototype.closeStageTitlePop=function(){null!=this.stageTitlePop&&(t.getInstance().getPopLayer().removeChild(this.stageTitlePop),this.currentPop=null,this.stageTitlePop=null,this.isPopUp=!1)},t.prototype.closeAllPop=function(){this.closeItemGetPop(),this.closeMenuPop(),this.closeClearPop(),this.closeGameOverPop(),this.closeMenuPop(),this.closeHintPop()},t.prototype.showItemFullTip=function(){void 0===this.itemFullTip&&(this.itemFullTip=new TSBitmap("itemfull_png"),this.itemFullTip.alpha=0,this.itemFullTip.x=Util.curWidth()/2,this.itemFullTip.y=Util.curHeight()/2,this.itemFullTip.anchorOffsetX=this.itemFullTip.width/2,this.itemFullTip.anchorOffsetY=this.itemFullTip.height/2,this.tipLayer.addChild(this.itemFullTip)),this.itemFullTip.alpha>0||(this.itemFullTip.alpha=1,egret.Tween.get(this.itemFullTip).wait(1500).to({alpha:0},500).call(function(){}))},t.instance=null,t}();__reflect(UIManager.prototype,"UIManager");var Config=function(){function t(){this.init()}return t.prototype.init=function(){if(null!==t.instance)throw new Error("single instance error")},t.getInstance=function(){return null===this.instance&&(this.instance=new t),this.instance},Object.defineProperty(t.prototype,"i18n",{get:function(){return void 0===this._i18n&&(this._i18n=RES.getRes("i18n_json")),this._i18n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"select_json",{get:function(){return void 0===this._select_json&&(this._select_json=RES.getRes("select_json")),this._select_json},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"card_tip",{get:function(){return void 0===this._card_tip&&(this._card_tip=RES.getRes("card_tip_json")),this._card_tip},enumerable:!0,configurable:!0}),t.instance=null,t}();__reflect(Config.prototype,"Config");var SaveData=function(){function t(){this._isNewPlayer=!0,this.init()}return t.prototype.init=function(){if(null!==t.instance)throw new Error("single instance error");this.cardConfig=Config.getInstance().card_tip;var e=egret.localStorage.getItem("userSave");if(null===e||void 0===e||""===e){this.cardSave=[null];for(var i=0;143>i;i++)this.cardSave.push(0);this.stageSave=[null,0],this.saveData={stageSave:this.stageSave,cardSave:this.cardSave,guide:"0"},this.saveUserData()}else this.saveData=JSON.parse(e),this.stageSave=this.saveData.stageSave,this.cardSave=this.saveData.cardSave,this._isNewPlayer="0"===this.saveData.guide?!0:!1},t.getInstance=function(){return null===this.instance&&(this.instance=new t),this.instance},t.prototype.saveUserData=function(){this.saveData={stageSave:this.stageSave,cardSave:this.cardSave,guide:this._isNewPlayer?"0":"1"},egret.localStorage.setItem("userSave",JSON.stringify(this.saveData))},t.prototype.getStageOpen=function(){return this.stageSave.length-1},t.prototype.getDataSceneOpen=function(){return this.cardSave.length-1===0?!1:!0},t.prototype.saveStagePass=function(t){if(this.stageSave[t]<4){this.stageSave[t]+=4,1===t?(this.stageSave.push(0),this.stageSave.push(0),this.stageSave.push(0),this.stageSave.push(0),this.stageSave.push(0)):this.stageSave.length<31&&this.stageSave.push(0);for(var e=this.getStageOpen(),i=this.cardSave.length;i<this.cardConfig.length&&!(this.cardConfig[i].stage>e);i++)this.cardConfig[i].stage===e?this.cardSave.push(0):this.cardSave.push(0);return this.saveUserData(),!0}return!1},t.prototype.passGuide=function(){this._isNewPlayer=!1,this.saveUserData()},t.prototype.saveStageHintRead=function(t){this.stageSave[t]+=1,this.saveUserData()},t.prototype.getStageStatus=function(t){var e={pass:!1,hint:0},i=this.stageSave[t]-4;return e.pass=i>=0?!0:!1,e.hint=i>=0?i:this.stageSave[t],e},t.prototype.getStageSave=function(){return this.stageSave},t.prototype.saveCardHintRead=function(t){0===this.cardSave[t]&&(this.cardSave[t]=1,this.saveUserData())},t.prototype.saveCardGot=function(t){this.cardSave[t]=3,this.saveUserData()},t.prototype.getCardStatus=function(t){return this.cardSave.length<t,this.cardSave[t]},t.prototype.saveSoundStatus=function(t){egret.localStorage.setItem("soundPlaying",t)},t.prototype.getSoundStatus=function(){return egret.localStorage.getItem("soundPlaying")},t.prototype.getLang=function(){return egret.localStorage.getItem("lang")},t.prototype.setLang=function(t){egret.localStorage.setItem("lang",t)},t.prototype.getLastPlay=function(){var t=egret.localStorage.getItem("lastPlay");return null===t||void 0===t||""===t?1:parseInt(t)},t.prototype.saveLastPlay=function(t){egret.localStorage.setItem("lastPlay",t)},Object.defineProperty(t.prototype,"isNewPlayer",{get:function(){return this._isNewPlayer},enumerable:!0,configurable:!0}),t.instance=null,t}();__reflect(SaveData.prototype,"SaveData");var CardPop=function(t){function e(e,i){void 0===i&&(i=0);var s=t.call(this)||this;return s.bg_list=["","ptbg","goldbg","diamondbg"],s.head_list=["fun","fail","success"],s.cards=e,s.index=i,s.detail=Config.getInstance().card_tip[s.cards[s.index]],s.getRes(),s}return __extends(e,t),e.prototype.getRes=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return t=this,[4,RES.getRes("card_pop_sheet")];case 1:return t.sheet=e.sent(),this.initView(),[2]}})})},e.prototype.initView=function(){this.darkSprite=new egret.Sprite,this.darkSprite.graphics.clear(),this.darkSprite.graphics.beginFill(0,.3),this.darkSprite.graphics.drawRect(0,0,Util.curWidth(),Util.curHeight()),this.darkSprite.graphics.endFill(),this.darkSprite.width=Util.curWidth(),this.darkSprite.height=Util.curHeight(),this.addChild(this.darkSprite),this.darkSprite.touchEnabled=!0;var t=new TSBitmap("mask",this.sheet,!0);t.x=320,t.y=498,this.addChild(t),this.card=new egret.Sprite,this.card.x=320,this.card.y=491.7,this.addChild(this.card),this.cardBg=new egret.Bitmap,this.cardBg.texture=this.sheet.getTexture(this.bg_list[this.detail.star]),this.cardBg.anchorOffsetX=this.cardBg.width/2,this.cardBg.anchorOffsetY=this.cardBg.height/2,this.card.addChild(this.cardBg),this.head=new egret.Bitmap,this.head.y=-169.5,this.card.addChild(this.head),this.head_title=new egret.Bitmap,this.head_title.x=-132.85,this.head_title.y=-187.5,this.card.addChild(this.head_title),this.stage_text=new egret.TextField,this.card.addChild(this.stage_text),this.card_name=new egret.TextField,this.card.addChild(this.card_name);RES.getRes("data_scene");this.cardBmp=new egret.Bitmap,this.cardBmp.scaleX=247/144,this.cardBmp.scaleY=246/143,this.cardBmp.y=24,this.card.addChild(this.cardBmp),this.share=new TSBitmap("share",RES.getRes("pops_sheet"),!0),this.share.x=320,this.share.y=758.9,this.share.touchEnabled=!0,this.share.visible=platform.hasShareSDK(),this.addChild(this.share),this.leftArrow=new TSBitmap("arrow_png"),this.leftArrow.x=40,this.leftArrow.y=491,this.leftArrow.touchEnabled=!0,this.addChild(this.leftArrow),this.rightArrow=new TSBitmap("arrow_png"),this.rightArrow.scaleX=-1,this.rightArrow.x=600,this.rightArrow.y=491,this.rightArrow.touchEnabled=!0,this.addChild(this.rightArrow),this.touchChildren=!0,this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.viewTouched,this),this.share.addEventListener(egret.TouchEvent.TOUCH_TAP,this.shareTouched,this),this.leftArrow.addEventListener(egret.TouchEvent.TOUCH_TAP,this.leftArrowTouched,this),this.rightArrow.addEventListener(egret.TouchEvent.TOUCH_TAP,this.rightArrowTouched,this),1===this.cards.length?(this.leftArrow.visible=!1,this.rightArrow.visible=!1):(this.leftArrow.visible=!0,this.rightArrow.visible=!0),this.updateView()},e.prototype.updateView=function(){this.cardBg.texture=this.sheet.getTexture(this.bg_list[this.detail.star]),this.head.texture=this.sheet.getTexture(this.head_list[this.detail.type]+"head"),this.head.anchorOffsetX=this.head.width/2,this.head.anchorOffsetY=this.head.height/2,this.head_title.texture=this.sheet.getTexture(this.head_list[this.detail.type]),this.stage_text.x=-125.6,this.stage_text.y=-178.35,this.stage_text.text="No."+this.detail.No,this.stage_text.width=251.2,this.stage_text.textAlign=egret.HorizontalAlign.CENTER,this.card_name.x=-136.8,this.card_name.y=-127,this.card_name.text=I18nManager.getInstance().getLanguageByGroup(LanguageEnum.GROUP_CARD)[this.detail.No].name,this.card_name.width=275.2,this.card_name.textColor=0,this.card_name.textAlign=egret.HorizontalAlign.CENTER,this.cardBmp.texture=RES.getRes("card_sheet").getTexture(this.detail.No+"_"+this.detail.stage+"_"+this.detail.result),this.cardBmp.anchorOffsetX=this.cardBmp.width/2,this.cardBmp.anchorOffsetY=this.cardBmp.height/2;var t=new egret.TextField;t.x=-72.1,t.y=149.6,t.text=I18nManager.getInstance().getLanguageByName("hard_level"),t.textColor=0,this.card.addChild(t),this.stars=new egret.Sprite;for(var e,i=0;i<this.detail.star;i++)e=new TSBitmap("star",this.sheet),e.x=17.4,e.y=-11,this.stars.addChild(e);this.stars.x=40.55,this.stars.y=162.5,this.card.addChild(this.stars),this.index<=0&&(this.leftArrow.visible=!1),this.index>=this.cards.length-1&&(this.rightArrow.visible=!1)},Object.defineProperty(e.prototype,"id",{set:function(t){this._id=t,this.detail=Config.getInstance().card_tip[t]},enumerable:!0,configurable:!0}),e.prototype.viewTouched=function(t){t.target!==this.leftArrow&&t.target!==this.rightArrow&&UIManager.getInstance().closeCardPop()},e.prototype.shareTouched=function(){platform.share("嘿!我集到了这个卡片,不如我们一起来神回避吧~","")},e.prototype.leftArrowTouched=function(t){this.index-1<0||(this.index--,this.rightArrow.visible=!0,this.detail=Config.getInstance().card_tip[this.cards[this.index]],this.updateView())},e.prototype.rightArrowTouched=function(t){this.index+1>=this.cards.length||(this.index++,this.leftArrow.visible=!0,this.detail=Config.getInstance().card_tip[this.cards[this.index]],this.updateView())},e.prototype.getWidth=function(){return this.width},e.prototype.getHeight=function(){return this.height},e.prototype.play_loop=function(){},e}(egret.Sprite);__reflect(CardPop.prototype,"CardPop",["PopBase"]);var ClearPop=function(t){function e(e,i){var s=t.call(this)||this;return s.cardGot=[],s.stageId=e,s.initView(i),s}return __extends(e,t),e.prototype.initView=function(t){this.bg=new TSBitmap("bg",t),this.bg.x=-100,this.bg.y=-100,this.bg.alpha=.8,this.bg.touchEnabled=!0,this.addChild(this.bg),this.retry=new TSBitmap("retry",t,!0),this.retry.x=173.75,this.retry.y=Util.curHeight()-50-200,this.retry.touchEnabled=!0,this.addChild(this.retry),this.other=new TSBitmap("other",t,!0),this.other.x=466.25,this.other.y=Util.curHeight()-50-200,this.other.touchEnabled=!0,this.addChild(this.other),this.share=new TSBitmap("share",t,!0),this.share.x=320,this.share.y=776,this.share.touchEnabled=!0,this.share.visible=platform.hasShareSDK(),this.addChild(this.share),this.advertisement=new egret.Sprite,this.advertisement.touchEnabled=!0,this.advertisement.x=18,this.advertisement.y=310.35,this.light=new TSBitmap("light",t),this.light.anchorOffsetX=this.light.width/2,this.light.anchorOffsetY=this.light.height/2,this.light.x=318,this.light.y=332.6,this.addChild(this.light);var e=new egret.MovieClipDataFactory(RES.getRes("clear_boy_json"),RES.getRes("clear_boy_png"));this.boy=new egret.MovieClip(e.generateMovieClipData("boy")),this.boy.x=318,this.boy.y=303.15,this.addChild(this.boy),this.ad_bg=new TSBitmap("ad",t),this.advertisement.addChild(this.ad_bg),this.word=new TSBitmap("clear_word",t,!0),this.word.x=318,this.word.y=160.75,this.addChild(this.word),this.collections=new egret.Sprite,this.collections.y=560.35,this.addChild(this.collections),this.retry.addEventListener(egret.TouchEvent.TOUCH_TAP,this.retryTouched,this),this.share.addEventListener(egret.TouchEvent.TOUCH_TAP,this.shareTouched,this),this.other.addEventListener(egret.TouchEvent.TOUCH_TAP,this.otherTouched,this),this.advertisement.addEventListener(egret.TouchEvent.TOUCH_TAP,this.advertisementTouched,this),this.x=Util.x_fix()},e.prototype.retryTouched=function(){1===this.stageId&&SaveData.getInstance().isNewPlayer&&GuideController.getInstance().passGuide(),this.destroy(),AdManager.getInstance().showInterstitial(),UIManager.getInstance().closeClearPop(),UIManager.getInstance().currentScene.onClear(),UIManager.getInstance().toGameScene()},e.prototype.shareTouched=function(){platform.share("一起回避生活中的尴尬事吧","")},e.prototype.otherTouched=function(){1===this.stageId&&SaveData.getInstance().isNewPlayer&&GuideController.getInstance().passGuide(),this.destroy(),AdManager.getInstance().showInterstitial(),UIManager.getInstance().closeClearPop(),UIManager.getInstance().showLoading(),UIManager.getInstance().currentScene.onClear(),UIManager.getInstance().toTitleScene()},e.prototype.cardViewTouched=function(t){UIManager.getInstance().openCardPop(this.cardGot)},e.prototype.advertisementTouched=function(){this.destroy()},e.prototype.playEffect=function(){this.light.rotation++},e.prototype.destroy=function(){this.newSign&&this.collections.contains(this.newSign)&&egret.Tween.removeTweens(this.newSign)},e.prototype.setCollections=function(t){if(void 0===t&&(t=[]),t.length>0){this.cardGot=t;var e=void 0,i=RES.getRes("data_scene");Config.getInstance().card_tip;e=new CardView(i,t[0]),e.x=320,e.touchEnabled=!0,this.collections.addChild(e);var s=new TSBitmap("circle",RES.getRes("pops_sheet"),!0);s.x=261.75,s.y=63.4,this.collections.addChild(s);var h=new egret.TextField;h.text=""+t.length,h.x=s.x-h.width/2,h.y=s.y-h.height/2,h.textColor=0,this.collections.addChild(h),this.newSign=new TSBitmap("new",RES.getRes("pops_sheet"),!0),this.newSign.x=391,this.newSign.y=-56.5,this.collections.addChild(this.newSign),egret.Tween.get(this.newSign,{loop:!0}).to({y:-76.5},800).to({y:-56.5},800),e.addEventListener(egret.TouchEvent.TOUCH_TAP,this.cardViewTouched,this)}},e.prototype.getWidth=function(){return this.width},e.prototype.getHeight=function(){return this.height},e.prototype.play_loop=function(){this.light.rotation++,Util.loopPlay(this.boy)},e}(egret.Sprite);__reflect(ClearPop.prototype,"ClearPop",["PopBase"]);var CollectionHintPop=function(t){function e(e,i){var s=t.call(this)||this;return s.cardId=e.No,s.getRes(),s}return __extends(e,t),e.prototype.getRes=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return t=this,[4,RES.getRes("tip_sheet")];case 1:return t.sheet=e.sent(),this.initView(),[2]}})})},e.prototype.initView=function(){this.darkSprite=new egret.Sprite,this.darkSprite.graphics.clear(),this.darkSprite.graphics.beginFill(0,.3),this.darkSprite.graphics.drawRect(0,0,Util.curWidth(),Util.curHeight()),this.darkSprite.graphics.endFill(),this.darkSprite.width=Util.curWidth(),this.darkSprite.height=Util.curHeight(),this.addChild(this.darkSprite),this.darkSprite.touchEnabled=!0,egret.Tween.get(this.darkSprite).to({alpha:1},150),this.darkSprite.visible=!0,this.bg_view=new TSBitmap("bg0",this.sheet),this.bg_view.x=Util.curWidth()/2-this.bg_view.width/2,this.bg_view.y=Util.curHeight()/2-this.bg_view.height/2,this.addChild(this.bg_view),this.hint=new HintItem(HintTypeEnum.COLLECTION_HINT_ITEM,this.cardId,this.sheet),this.hint.x=this.bg_view.x+this.bg_view.width/2,this.hint.y=this.bg_view.y+this.bg_view.height/2,this.hint.touchEnabled=!0,this.hint.addEventListener(egret.TouchEvent.TOUCH_TAP,this.hintTouched,this),this.addChild(this.hint),this.close_btn=new TSBitmap("close_btn",this.sheet),this.close_btn.x=this.bg_view.x+this.bg_view.width/2-this.close_btn.width/2+252.6,this.close_btn.y=this.bg_view.y+this.bg_view.height/2-this.close_btn.height/2-156.25,this.addChild(this.close_btn),this.close_btn.touchEnabled=!0,this.close_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.closeTouched,this),this.updateView()
},e.prototype.hintTouched=function(t){var e=t.target;e.isShow||(AdManager.getInstance().vedioOK?this.seeVedio():UIManager.getInstance().openNoVedioPop())},e.prototype.closeTouched=function(t){this.destroy(),UIManager.getInstance().closeCollectionHintPop()},e.prototype.destroy=function(){},e.prototype.seeVedio=function(){AdManager.getInstance().vedioPlay(function(){SoundManager.getInstance().stopBGM()}.bind(this),function(t){SoundManager.getInstance().playBGM(),t&&(HintController.getInstance().setCardHintStatus(this.cardId),this.updateView())}.bind(this))},e.prototype.updateView=function(){var t=SaveData.getInstance().getCardStatus(this.cardId);t>0?this.hint.updateHintShow(!0):this.hint.updateHintShow(!1)},e.prototype.getWidth=function(){return this.width},e.prototype.getHeight=function(){return this.height},e.prototype.play_loop=function(){},e}(egret.Sprite);__reflect(CollectionHintPop.prototype,"CollectionHintPop",["PopBase"]);var GameOverPop=function(t){function e(e,i){var s=t.call(this)||this;return s.cardGot=[],s.stageId=e,s.initView(i),s}return __extends(e,t),e.prototype.initView=function(t){this.bg=new TSBitmap("bg",t),this.bg.x=-120,this.bg.y=-100,this.bg.alpha=.8,this.bg.touchEnabled=!0,this.addChild(this.bg),this.retry=new TSBitmap("retry",t,!0),this.retry.x=173.75,this.retry.y=Util.curHeight()-50-200,this.retry.touchEnabled=!0,this.addChild(this.retry),this.other=new TSBitmap("other",t,!0),this.other.x=466.25,this.other.y=Util.curHeight()-50-200,this.other.touchEnabled=!0,this.addChild(this.other),this.help_btn=new TSBitmap("help",t,!0),this.help_btn.x=320,this.help_btn.y=756,this.help_btn.touchEnabled=!0,this.help_btn.visible=platform.hasVedioSDK(),this.addChild(this.help_btn),this.hintPop=new HintPop(this.stageId),this.hintPop.anchorOffsetX=this.hintPop.width/2,this.hintPop.anchorOffsetY=this.hintPop.height/2,this.hintPop.x=320,this.hintPop.y=521.35,this.advertisement=new egret.Sprite,this.advertisement.touchEnabled=!0,this.advertisement.y=310.35,this.ad_bg=new TSBitmap("ad",t),this.advertisement.addChild(this.ad_bg),this.advertisement.x=(Util.curWidth()-this.advertisement.width)/2,this.onknee=new TSBitmap("loser",t),this.onknee.anchorOffsetX=this.onknee.width/2,this.onknee.anchorOffsetY=this.onknee.height/2,this.onknee.x=318,this.onknee.y=252.6-197-100+100,this.onknee.alpha=.2,this.addChild(this.onknee),this.word=new TSBitmap("over_word",t),this.word.anchorOffsetX=this.word.width/2,this.word.anchorOffsetY=this.word.height/2,this.word.x=318,this.word.y=160.75,this.addChild(this.word),this.collections=new egret.Sprite,this.collections.y=560.35,this.addChild(this.collections),this.retry.addEventListener(egret.TouchEvent.TOUCH_TAP,this.retryTouched,this),this.other.addEventListener(egret.TouchEvent.TOUCH_TAP,this.otherTouched,this),this.help_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.helpTouched,this),this.advertisement.addEventListener(egret.TouchEvent.TOUCH_TAP,this.advertisementTouched,this),this.x=Util.x_fix()},e.prototype.helpTouched=function(){UIManager.getInstance().openHintPop(this.stageId,!0)},e.prototype.retryTouched=function(){this.destroy(),AdManager.getInstance().showInterstitial(),UIManager.getInstance().closeGameOverPop(),UIManager.getInstance().currentScene.onGameOver(),UIManager.getInstance().toGameScene()},e.prototype.otherTouched=function(){this.destroy(),AdManager.getInstance().showInterstitial(),UIManager.getInstance().closeGameOverPop(),UIManager.getInstance().currentScene.onGameOver(),UIManager.getInstance().toTitleScene()},e.prototype.advertisementTouched=function(){},e.prototype.cardViewTouched=function(t){UIManager.getInstance().openCardPop(this.cardGot)},e.prototype.destroy=function(){this.newSign&&this.collections.contains(this.newSign)&&egret.Tween.removeTweens(this.newSign)},e.prototype.setCollections=function(t){if(void 0===t&&(t=[]),t.length>0){this.cardGot=t;var e=void 0,i=RES.getRes("data_scene");e=new CardView(i,t[0]),e.x=320,e.touchEnabled=!0,this.collections.addChild(e);var s=new TSBitmap("circle",RES.getRes("pops_sheet"),!0);s.x=261.75,s.y=63.4,this.collections.addChild(s);var h=new egret.TextField;h.text=""+t.length,h.x=s.x-h.width/2,h.y=s.y-h.height/2,h.textColor=0,this.collections.addChild(h),this.newSign=new TSBitmap("new",RES.getRes("pops_sheet"),!0),this.newSign.x=391,this.newSign.y=-56.5,this.collections.addChild(this.newSign),egret.Tween.get(this.newSign,{loop:!0}).to({y:-76.5},800).to({y:-56.5},800),e.addEventListener(egret.TouchEvent.TOUCH_TAP,this.cardViewTouched,this)}},e.prototype.getWidth=function(){return this.width},e.prototype.getHeight=function(){return this.height},e.prototype.play_loop=function(){this.onknee.alpha<1&&(this.onknee.alpha+=.2)},e}(egret.Sprite);__reflect(GameOverPop.prototype,"GameOverPop",["PopBase"]);var HintItem=function(t){function e(e,i,s){var h=t.call(this)||this;return h.hintShow=!0,h.type=e,h.id=i,h.sheet=s,h.initView(),h}return __extends(e,t),e.prototype.initView=function(){var t;this.hintText=new egret.TextField;var e=new egret.TextField;if(this.type===HintTypeEnum.COLLECTION_HINT_ITEM){var i=Config.getInstance().card_tip[this.id];t=new TSBitmap("text_bg0",this.sheet,!0),this.hintText.x=-215,this.hintText.width=434.7,e.text=I18nManager.getInstance().getLanguageByName(LanguageEnum.STAGE_NO).replace("$d",i.stage),this.hintText.text=I18nManager.getInstance().getLanguageInGroupByName(LanguageEnum.GROUP_CARD,this.id).tip}else t=new TSBitmap("text_bg",this.sheet,!0),this.hintText.x=-235.6,this.hintText.width=476.75,e.text=I18nManager.getInstance().getLanguageByName(LanguageEnum.HINT_TITLE).replace("$d",this.type>0?this.type:""),this.hintText.text=I18nManager.getInstance().getLanguageInGroupByName(LanguageEnum.GROUP_HINT,"stage"+this.id)[this.type-1];t.anchorOffsetX=t.width/2,t.anchorOffsetY=t.height/2,this.addChild(t),e.textAlign=egret.HorizontalAlign.CENTER,e.x=-102.65,e.y=-59.25,e.width=205.35,e.height=30.85,e.size=24,e.textColor=14574690,this.addChild(e),this.hintText.y=-29.65,this.hintText.height=95.15,this.hintText.size=26,this.hintText.textColor=14574690,this.addChild(this.hintText),this.vedioButton=new TSBitmap("btn"+this.type,this.sheet,!0),this.vedioButton.anchorOffsetX=this.vedioButton.width/2,this.vedioButton.anchorOffsetY=this.vedioButton.height/2,this.vedioButton.visible=!this.hintShow,this.addChild(this.vedioButton),this.touchEnabled=!0},Object.defineProperty(e.prototype,"hintType",{get:function(){return this.type},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isShow",{get:function(){return this.hintShow},enumerable:!0,configurable:!0}),e.prototype.updateHintShow=function(t){this.hintShow=t,this.vedioButton.visible=!t},Object.defineProperty(e.prototype,"hintId",{get:function(){return this.id},enumerable:!0,configurable:!0}),e}(egret.Sprite);__reflect(HintItem.prototype,"HintItem");var HintPop=function(t){function e(e){var i=t.call(this)||this;return i.stageId=e,i.getRes(),i}return __extends(e,t),e.prototype.getRes=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return t=this,[4,RES.getRes("tip_sheet")];case 1:return t.sheet=e.sent(),this.initView(),[2]}})})},e.prototype.initView=function(){this.darkSprite=new egret.Sprite,this.darkSprite.graphics.clear(),this.darkSprite.graphics.beginFill(0,.3),this.darkSprite.graphics.drawRect(0,0,Util.curWidth(),Util.curHeight()),this.darkSprite.graphics.endFill(),this.darkSprite.width=Util.curWidth(),this.darkSprite.height=Util.curHeight(),this.addChild(this.darkSprite),this.darkSprite.touchEnabled=!0,egret.Tween.get(this.darkSprite).to({alpha:1},150),this.darkSprite.visible=!0,this.bg_view=new TSBitmap("bg",this.sheet),this.bg_view.x=Util.curWidth()/2-this.bg_view.width/2,this.bg_view.y=Util.curHeight()/2-this.bg_view.height/2,this.addChild(this.bg_view);var t=[-152.75,1.25,155.65],e=I18nManager.getInstance().getLanguageInGroupByName(LanguageEnum.GROUP_HINT,"stage"+this.stageId);this.hintList=[];for(var i,s=1;s<=e.length;s++)i=new HintItem(s,this.stageId,this.sheet),i.x=this.bg_view.x+this.bg_view.width/2,i.y=this.bg_view.y+this.bg_view.height/2+t[s-1],i.touchEnabled=!0,i.addEventListener(egret.TouchEvent.TOUCH_TAP,this.hintTouched,this),this.hintList.push(i),this.addChild(i);this.close_btn=new TSBitmap("close_btn",this.sheet),this.close_btn.x=this.bg_view.x+this.bg_view.width/2-this.close_btn.width/2+252.6,this.close_btn.y=this.bg_view.y+this.bg_view.height/2-this.close_btn.height/2-285.5,this.addChild(this.close_btn),this.close_btn.touchEnabled=!0,this.close_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.closeTouched,this),this.updateView()},e.prototype.hintTouched=function(t){var e=t.target;e.isShow||(AdManager.getInstance().vedioOK?this.seeVedio(t.hintId):UIManager.getInstance().openNoVedioPop())},e.prototype.closeTouched=function(t){this.destroy(),UIManager.getInstance().closeHintPop()},e.prototype.destroy=function(){},e.prototype.seeVedio=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return AdManager.getInstance().vedioPlay(function(){SoundManager.getInstance().stopBGM()}.bind(this),function(t){SoundManager.getInstance().playBGM(),t&&(HintController.getInstance().setStageHintStatus(this.stageId),this.updateView())}.bind(this)),[2]})})},e.prototype.updateView=function(){for(var t=SaveData.getInstance().getStageStatus(this.stageId),e=0;e<this.hintList.length;e++)this.hintList[e].hintType<=t.hint?(this.hintList[e].visible=!0,this.hintList[e].updateHintShow(!0)):this.hintList[e].hintType===t.hint+1?(this.hintList[e].visible=!0,this.hintList[e].updateHintShow(!1)):this.hintList[e].visible=!1},e.prototype.getWidth=function(){return this.width},e.prototype.getHeight=function(){return this.height},e.prototype.play_loop=function(){},e}(egret.Sprite);__reflect(HintPop.prototype,"HintPop",["PopBase"]);var HowToPlayPop=function(t){function e(){var e=t.call(this)||this;return e.getRes(),e}return __extends(e,t),e.prototype.getRes=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return t=this,[4,RES.getRes("how_to_play")];case 1:return t.sheet=e.sent(),this.initView(),[2]}})})},e.prototype.initView=function(){var t=new TSBitmap("bg",this.sheet,!0);t.x=85.3,t.y=98.9,this.addChild(t);var e=new TSBitmap("title",this.sheet,!0);e.x=320,e.y=231.4,this.addChild(e),this.closeBtn=new TSBitmap("closebtn",this.sheet,!0),this.closeBtn.x=513.55,this.closeBtn.y=206.35,this.addChild(this.closeBtn),this.okBtn=new TSBitmap("okbtn",this.sheet,!0),this.okBtn.x=209.9,this.okBtn.y=753.4,this.addChild(this.okBtn),this.retryBtn=new TSBitmap("retryBtn",this.sheet,!0),this.retryBtn.x=427.05,this.retryBtn.y=753.4,this.addChild(this.retryBtn),this.itemctrl=new TSBitmap("itemctrl",this.sheet,!0),this.itemctrl.x=1.85,this.itemctrl.y=804.45,this.addChild(this.itemctrl),this.boy=new TSBitmap("boy1",this.sheet,!0),this.boy.x=134,this.boy.y=391,this.addChild(this.boy)},e.prototype.getWidth=function(){return this.width},e.prototype.getHeight=function(){return this.height},e.prototype.play_loop=function(){},e}(egret.Sprite);__reflect(HowToPlayPop.prototype,"HowToPlayPop",["PopBase"]);var ItemGetPop=function(t){function e(){var e=t.call(this)||this;return e.initView(),e}return __extends(e,t),e.prototype.setIcon=function(t){SoundManager.getInstance().playSound(SoundEnum.ITEMSOUND_MP3),this.item_icon=new egret.Bitmap,this.item_icon.texture=RES.getRes(t),this.item_icon.x=this.bg_view.width/2-this.item_icon.width/2,this.item_icon.y=this.bg_view.height/2-this.item_icon.height/2,this.addChild(this.item_icon)},e.prototype.initView=function(){this.bg_view=new egret.Bitmap,this.bg_view.texture=RES.getRes("itemget_png"),this.addChild(this.bg_view),this.ok_btn=new egret.Bitmap,this.ok_btn.texture=RES.getRes("okbtn_png"),this.ok_btn.x=this.bg_view.width/2-this.ok_btn.width/2,this.ok_btn.y=this.bg_view.width/2-this.ok_btn.height/2+180,this.ok_btn.touchEnabled=!0,this.addChild(this.ok_btn),this.x=Util.curWidth()/2-this.bg_view.width/2,this.y=Util.curHeight()/2-this.bg_view.height/2,GuideController.getInstance().guidePassed||(this.handTouch=new TSBitmap("touch_png"),this.handTouch.anchorOffsetX=this.handTouch.width/2,this.handTouch.anchorOffsetY=this.handTouch.height/2,this.handTouch.visible=!0,this.handTouch.x=this.ok_btn.x+this.ok_btn.width/2,this.handTouch.y=this.ok_btn.y+this.ok_btn.height/2,this.addChild(this.handTouch),this.guideHand=new TSBitmap("hand_png"),this.guideHand.anchorOffsetX=this.guideHand.width/2,this.guideHand.anchorOffsetY=this.guideHand.height/2,this.guideHand.visible=!0,this.guideHand.x=this.ok_btn.x+this.ok_btn.width/2,this.guideHand.y=this.ok_btn.y+this.ok_btn.height,this.addChild(this.guideHand),egret.Tween.get(this.handTouch,{loop:!0}).to({scaleX:1.5,scaleY:1.5},1e3)),this.ok_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.closePop,this)},e.prototype.closePop=function(){GuideController.getInstance().guidePassed||(this.guideHand.visible=!1,this.handTouch.visible=!1,egret.Tween.removeTweens(this.handTouch)),SoundManager.getInstance().playSound(SoundEnum.CLICKSOUND_MP3),UIManager.getInstance().closeItemGetPop()},e.prototype.getWidth=function(){return this.width},e.prototype.getHeight=function(){return this.height},e.prototype.play_loop=function(){},e}(egret.Sprite);__reflect(ItemGetPop.prototype,"ItemGetPop",["PopBase"]);var MenuPop=function(t){function e(e){var i=t.call(this)||this;return i.initView(e),i}return __extends(e,t),e.prototype.initView=function(t){this.darkSprite=new egret.Sprite,this.darkSprite.graphics.clear(),this.darkSprite.graphics.beginFill(0,.3),this.darkSprite.graphics.drawRect(0,0,Util.curWidth(),Util.curHeight()),this.darkSprite.graphics.endFill(),this.darkSprite.width=Util.curWidth(),this.darkSprite.height=Util.curHeight(),this.addChild(this.darkSprite),this.darkSprite.touchEnabled=!0,egret.Tween.get(this.darkSprite).to({alpha:1},150),this.darkSprite.visible=!0,platform.hasShareSDK()?this.bg_view=new TSBitmap("whitebord",t):(this.bg_view=new egret.Bitmap,this.bg_view.y=-50,this.bg_view.texture=RES.getRes("board_png")),this.addChild(this.bg_view),this.help=new TSBitmap("help",t),this.help.x=this.bg_view.width/2-this.help.width/2,this.help.y=this.bg_view.height/2-this.help.height/2-138.2,this.help.touchEnabled=!0,this.help.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onHelpTouched,this),this.help.visible=platform.hasVedioSDK(),this.addChild(this.help),this.retry=new TSBitmap("retry",t),this.retry.x=this.bg_view.width/2-this.retry.width/2,this.retry.touchEnabled=!0,this.retry.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onRetryTouched,this),this.addChild(this.retry),this.other=new TSBitmap("other",t),this.other.x=this.bg_view.width/2-this.other.width/2,this.other.touchEnabled=!0,this.other.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onOtherTouched,this),this.addChild(this.other),platform.hasVedioSDK()?(this.retry.y=this.bg_view.height/2-this.retry.height/2-46.3,this.other.y=this.bg_view.height/2-this.other.height/2+39.75):(this.retry.y=this.bg_view.height/2-this.retry.height/2-26.3,this.other.y=this.bg_view.height/2-this.other.height/2+59.75),this.share=new TSBitmap("share",t),this.share.x=this.bg_view.width/2-this.share.width/2,this.share.y=this.bg_view.height/2-this.share.height/2+179.5,this.share.touchEnabled=!0,this.share.visible=platform.hasShareSDK(),this.share.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onShareTouched,this),this.addChild(this.share),this.close=new TSBitmap("close",t),this.close.x=this.bg_view.width/2-this.close.width/2+203,this.close.y=this.bg_view.height/2-this.close.height/2-230.9,this.close.touchEnabled=!0,this.close.addEventListener(egret.TouchEvent.TOUCH_TAP,this.closePop,this),this.addChild(this.close),this.x=Util.curWidth()/2-this.bg_view.width/2,this.y=Util.curHeight()/2-this.bg_view.height/2,this.darkSprite.x=-(Util.curWidth()/2-this.bg_view.width/2),this.darkSprite.y=-(Util.curHeight()/2-this.bg_view.height/2)},e.prototype.onShareTouched=function(){platform.share("一起来回避生活中的尴尬事吧","")},e.prototype.onOtherTouched=function(){this.destroy(),AdManager.getInstance().showBanner(),AdManager.getInstance().showInterstitial(),UIManager.getInstance().currentScene.onReset(),UIManager.getInstance().closeMenuPop(),UIManager.getInstance().toTitleScene()},e.prototype.onHelpTouched=function(){this.destroy(),UIManager.getInstance().openHintPop(StageController.getInstance().getCurrentSelected())},e.prototype.onRetryTouched=function(){this.destroy(),AdManager.getInstance().showInterstitial(),UIManager.getInstance().currentScene.onReset(),UIManager.getInstance().closeMenuPop(),UIManager.getInstance().toGameScene()},e.prototype.closePop=function(){this.destroy(),UIManager.getInstance().closeMenuPop()},e.prototype.destroy=function(){},e.prototype.getWidth=function(){return this.width},e.prototype.getHeight=function(){return this.height},e.prototype.play_loop=function(){},e}(egret.Sprite);__reflect(MenuPop.prototype,"MenuPop",["PopBase"]);var NoVedioPop=function(t){function e(){var e=t.call(this)||this;return e.initView(),e}return __extends(e,t),e.prototype.initView=function(){this.darkSprite=new egret.Sprite,this.darkSprite.graphics.clear(),this.darkSprite.graphics.beginFill(0,.3),this.darkSprite.graphics.drawRect(0,0,Util.curWidth(),Util.curHeight()),this.darkSprite.graphics.endFill(),this.darkSprite.width=Util.curWidth(),this.darkSprite.height=Util.curHeight(),this.addChild(this.darkSprite),this.darkSprite.touchEnabled=!0,this.noVedioPop=new egret.Sprite;var t=new egret.Bitmap;t.texture=RES.getRes("board_png"),this.noVedioPop.addChild(t);var e=new egret.TextField;e.x=40,e.y=30,e.size=30,e.width=t.width-80,e.textColor=0,e.text="没有可以播放的视频:",this.noVedioPop.addChild(e);var i=new egret.TextField;i.x=40,i.y=100,i.size=25,i.width=t.width-80,i.textColor=2236962,i.text="以上这些情况下，看不到视频。\n 请稍后再试",this.noVedioPop.addChild(i),this.ok_btn=new egret.Bitmap,this.ok_btn.texture=RES.getRes("okbtn_png"),this.ok_btn.x=t.width/2-this.ok_btn.width/2,this.ok_btn.y=t.height/2-this.ok_btn.height/2+120,this.ok_btn.touchEnabled=!0,this.noVedioPop.addChild(this.ok_btn),this.addChild(this.noVedioPop),this.touchEnabled=!0,this.ok_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouch,this),this.x=Util.curWidth()/2-this.noVedioPop.width/2,this.y=Util.curHeight()/2-this.noVedioPop.height/2,this.darkSprite.x=-(Util.curWidth()/2-this.noVedioPop.width/2),this.darkSprite.y=-(Util.curHeight()/2-this.noVedioPop.height/2)},e.prototype.onTouch=function(t){UIManager.getInstance().closeNoVedioPop()},e.prototype.destroy=function(){},e.prototype.getWidth=function(){return this.width},e.prototype.getHeight=function(){return this.height},e.prototype.play_loop=function(){},e}(egret.Sprite);__reflect(NoVedioPop.prototype,"NoVedioPop",["PopBase"]);var StageTitlePop=function(t){function e(e){var i=t.call(this)||this;return i.initView(e),i}return __extends(e,t),e.prototype.initView=function(t){},e.prototype.getWidth=function(){return this.width},e.prototype.getHeight=function(){return this.height},e.prototype.play_loop=function(){},e}(egret.Sprite);__reflect(StageTitlePop.prototype,"StageTitlePop",["PopBase"]);var DataScene=function(t){function e(e){var i=t.call(this)||this;return i.PAGE_NUM=12,i.CARD_PER_PAGE=12,i.initData(),i.initView(e),i}return __extends(e,t),e.prototype.initData=function(){this.config=Config.getInstance().card_tip},e.prototype.initView=function(t){this.egretStage=t,this.sheet=RES.getRes("data_scene");var e=RES.getRes("head_ui");this.currentPage=1;var i=new TSBitmap("bg",this.sheet);i.x=-100,i.height=this.egretStage.height,i.y=-Util.y_fix(),this.addChild(i),this.data_head=new DataHead(e),this.cardView=new egret.Sprite,this.addChild(this.cardView);var s,h;this.pages=[null],this.cards=[];for(var a=1;a<=this.PAGE_NUM;a++){s=new egret.Sprite,s.x=320,s.y=500;for(var o=1;o<=this.CARD_PER_PAGE&&12*(a-1)+o!==this.config.length;o++)h=new CardView(this.sheet,12*(a-1)+o),h.x=(o-1)%4*150-224.95,h.y=220*Math.floor((o-1)/4)-223.6,s.addChild(h),h.touchEnabled=!0,h.touchChildren=!1,this.cards.push(h),h.addEventListener(egret.TouchEvent.TOUCH_TAP,this.cardTouched,this);this.pages.push(s)}this.cardView.addChild(this.pages[this.currentPage]);var n=new TSBitmap("page",e);n.anchorOffsetX=n.width/2,n.anchorOffsetY=n.height/2,n.x=320,n.y=951.15,this.addChild(n),this.pageText=new egret.TextField,this.pageText.text=I18nManager.getInstance().getLanguageByName(LanguageEnum.PAGE_SELECT).replace("$d",this.currentPage),this.pageText.anchorOffsetX=this.pageText.width/2,this.pageText.anchorOffsetY=this.pageText.height/2,this.pageText.x=320,this.pageText.y=951.15,this.pageText.textColor=0,this.addChild(this.pageText),this.left=new TSBitmap("left",e),this.left.anchorOffsetX=this.left.width/2,this.left.anchorOffsetY=this.left.height/2,this.left.x=66.4,this.left.y=950.5,this.left.touchEnabled=!0,this.left.visible=!1,this.left.addEventListener(egret.TouchEvent.TOUCH_TAP,this.leftPage,this),this.addChild(this.left),this.right=new TSBitmap("left",e),this.right.scaleX=-1,this.right.anchorOffsetX=this.right.width/2,this.right.anchorOffsetY=this.right.height/2,this.right.x=572.6,this.right.y=950.5,this.right.touchEnabled=!0,this.right.addEventListener(egret.TouchEvent.TOUCH_TAP,this.rightPage,this),this.addChild(this.right),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAdd,this),this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onSwipeBegin,this)},e.prototype.onAdd=function(t){UIManager.getInstance().getUILayer().addChild(this.data_head),this.updateView()},e.prototype.updateView=function(){for(var t=0;t<this.cards.length;t++)this.cards[t].updateView()},e.prototype.cardTouched=function(t){var e=t.target;3===e.cardStatus?this.showDetail(e.cardNumber):platform.hasVedioSDK()&&this.showHint(e.cardDetail,e.cardStatus)},e.prototype.showHint=function(t,e){UIManager.getInstance().openCollectionHintPop(t,e)},e.prototype.showDetail=function(t){var e=DataController.getInstance().getCollectionedCards(t);UIManager.getInstance().openCardPop(e.cards,e.index)},e.prototype.updatePageText=function(){this.pageText.text=I18nManager.getInstance().getLanguageByName(LanguageEnum.PAGE_SELECT).replace("$d",this.currentPage)},e.prototype.onSwipeBegin=function(t){this.touchX=t.stageX,this.addEventListener(egret.TouchEvent.TOUCH_END,this.onSwipeEnd,this)},e.prototype.onSwipeEnd=function(t){this.touchX-t.stageX>50?this.rightPage():this.touchX-t.stageX<-50&&this.leftPage()},e.prototype.rightPage=function(){this.currentPage!==this.PAGE_NUM&&(1===this.currentPage&&(this.left.visible=!0),this.showRightPageEffect(),this.currentPage+=1,this.updatePageText(),this.currentPage===this.PAGE_NUM&&(this.right.visible=!1))},e.prototype.leftPage=function(){1!==this.currentPage&&(this.currentPage===this.PAGE_NUM&&(this.right.visible=!0),this.showLeftPageEffect(),this.currentPage-=1,this.updatePageText(),1===this.currentPage&&(this.left.visible=!1))},e.prototype.showLeftPageEffect=function(){this.currentPage>this.PAGE_NUM||this.currentPage<0||(this.cardView.contains(this.pages[this.currentPage])&&this.cardView.removeChild(this.pages[this.currentPage]),egret.Tween.get(this.pages[this.currentPage],{loop:!1}).to({x:1280},100).call(function(){}));var t=this.currentPage-1;t>this.PAGE_NUM||0>t||(this.cardView.contains(this.pages[t])||this.cardView.addChild(this.pages[t]),egret.Tween.get(this.pages[t],{loop:!1}).to({x:320},100).call(function(){}))},e.prototype.showRightPageEffect=function(){this.currentPage>this.PAGE_NUM||this.currentPage<0||(this.cardView.contains(this.pages[this.currentPage])&&this.cardView.removeChild(this.pages[this.currentPage]),egret.Tween.get(this.pages[this.currentPage],{loop:!1}).to({x:-640},100).call(function(){}));var t=this.currentPage+1;t>this.PAGE_NUM||0>t||(this.cardView.contains(this.pages[t])||this.cardView.addChild(this.pages[t]),egret.Tween.get(this.pages[t],{loop:!1}).to({x:320},100).call(function(){}))},e.prototype.start_loop=function(){},e.prototype.stop_loop=function(){},e}(egret.DisplayObjectContainer);__reflect(DataScene.prototype,"DataScene",["IFSceen"]);var GameScene=function(t){function e(e){var i=t.call(this)||this;return i.currentStage=null,i.initView(e),i}return __extends(e,t),e.prototype.initView=function(t){this.egretStage=t;var e=RES.getRes("head_ui");this.game_head=new GameHead(e),this.itemCtrl=ItemCtrlView.getInstance(t),this.itemCtrl.scene=this,this.addEventListener(egret.Event.ADDED_TO_STAGE,this.start_loop,this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.stop_loop,this),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAdd,this)},e.prototype.onAdd=function(t){UIManager.getInstance().getUILayer().addChild(this.game_head),UIManager.getInstance().getUILayer().addChild(this.itemCtrl),this.game_head.updateView()},e.prototype.setGameStage=function(){var t=StageController.getInstance().getCurrentSelected(),e=new window["Stage"+t];e.name="stage"+t,this.currentStage=e,Util.scaleMode()===egret.StageScaleMode.FIXED_HEIGHT&&(e.scaleX=Util.curWidth()/Util.displayWidth(),e.x=(Util.displayWidth()-Util.curWidth())/2,e.y=(Util.displayHeight()-Util.curHeight())/2),this.addChild(e),this.game_head.updateView(),this.game_head.touchEnabled=!0,this.game_head.touchChildren=!0,this.itemCtrl.touchEnabled=!0,this.itemCtrl.touchChildren=!0,AdManager.getInstance().hideBanner()},e.prototype.onGameOver=function(){ItemController.getInstance().resetList(),this.removeChild(this.currentStage),this.currentStage._remove(),this.currentStage=null,this.game_head.touchEnabled=!1,this.itemCtrl.touchEnabled=!1},e.prototype.onClear=function(){ItemController.getInstance().resetList(),this.removeChild(this.currentStage),this.currentStage._remove(),this.currentStage=null,this.game_head.touchEnabled=!1,this.itemCtrl.touchEnabled=!1,this.itemCtrl.updateItems()},e.prototype.onReset=function(){ItemController.getInstance().resetList(),this.removeChild(this.currentStage),this.currentStage._remove(),this.currentStage=null,this.game_head.touchEnabled=!1,this.itemCtrl.touchEnabled=!1,this.itemCtrl.updateItems()},e.prototype.start_loop=function(t){this.timer=new egret.Timer(1e3/30,0),this.timer.addEventListener(egret.TimerEvent.TIMER,this.play_loop,this),this.timer.start()},e.prototype.stop_loop=function(t){this.egretStage.hasEventListener(egret.Event.ENTER_FRAME)===!0&&(this.timer.removeEventListener(egret.TimerEvent.TIMER,this.play_loop,this),this.timer.stop())},e.prototype.play_loop=function(t){UIManager.getInstance().isPopUp?UIManager.getInstance().getCurrentPop().play_loop():null!==this.currentStage&&this.currentStage.play_loop()},e.prototype.getCurrentStage=function(){return this.currentStage},e}(egret.DisplayObjectContainer);__reflect(GameScene.prototype,"GameScene",["IFSceen"]);var DebugPlatform=function(){function t(){}return t.prototype.initAnalytics=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,{gameKey:"02a2d376f1268780cdeb969e3385bae2",secretKey:"9b426779362d3259747c55f90ce0a40500524bcb"}]})})},t.prototype.setLifeCycleCallBack=function(t,e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(i){return egret.lifecycle.onPause=function(){t()},egret.lifecycle.onResume=function(){e()},[2]})})},t.prototype.setLoadingProgress=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t.prototype.loadingComplete=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t.prototype.print=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return console.log(t),[2]})})},t.prototype.existRank=function(){return!1},t.prototype.getRank=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,new Promise(function(t,e){console.log("获取"),t([{nick:"哈N她!)|A(1",score:5,selfFlag:1,url:"http://thirdqq.qlogo.cn/g?b=sdk&k=F7aCnicxWzpicK89d0gkh7cw&s=100&t=1516260478"},{nick:"哈N她!)A(2",score:5,selfFlag:1,url:"http://thirdqq.qlogo.cn/g?b=sdk&k=F7aCnicxWzpicK89d0gkh7cw&s=100&t=1516260478"},{nick:"哈N她!)|A(3",score:5,selfFlag:1,url:"http://thirdqq.qlogo.cn/g?b=sdk&k=F7aCnicxWzpicK89d0gkh7cw&s=100&t=1516260478"},{nick:"哈N她!)|A(4",score:5,selfFlag:1,url:"http://thirdqq.qlogo.cn/g?b=sdk&k=F7aCnicxWzpicK89d0gkh7cw&s=100&t=1516260478"},{nick:"哈N她!)|A(5",score:5,selfFlag:1,url:"http://thirdqq.qlogo.cn/g?b=sdk&k=F7aCnicxWzpicK89d0gkh7cw&s=100&t=1516260478"},{nick:"哈N她!)|A(6",score:5,selfFlag:1,url:"http://thirdqq.qlogo.cn/g?b=sdk&k=F7aCnicxWzpicK89d0gkh7cw&s=100&t=1516260478"},{nick:"哈N她!)|A(7",score:5,selfFlag:1,url:"http://thirdqq.qlogo.cn/g?b=sdk&k=F7aCnicxWzpicK89d0gkh7cw&s=100&t=1516260478"},{nick:"哈N她!)|A(8",score:5,selfFlag:1,url:"http://thirdqq.qlogo.cn/g?b=sdk&k=F7aCnicxWzpicK89d0gkh7cw&s=100&t=1516260478"},{nick:"哈N她!)|A(9",score:5,selfFlag:1,url:"http://thirdqq.qlogo.cn/g?b=sdk&k=F7aCnicxWzpicK89d0gkh7cw&s=100&t=1516260478"},{nick:"哈N她!)|A(10",score:5,selfFlag:1,url:"http://thirdqq.qlogo.cn/g?b=sdk&k=F7aCnicxWzpicK89d0gkh7cw&s=100&t=1516260478"},{nick:"哈N她!)|A(11",score:5,selfFlag:1,url:"http://thirdqq.qlogo.cn/g?b=sdk&k=F7aCnicxWzpicK89d0gkh7cw&s=100&t=1516260478"},{nick:"哈N她!)|A(12",score:5,selfFlag:1,url:"http://thirdqq.qlogo.cn/g?b=sdk&k=F7aCnicxWzpicK89d0gkh7cw&s=100&t=1516260478"},{nick:"哈N她!)|A(13",score:5,selfFlag:1,url:"http://thirdqq.qlogo.cn/g?b=sdk&k=F7aCnicxWzpicK89d0gkh7cw&s=100&t=1516260478"},{nick:"哈N她!)|A(14",score:5,selfFlag:1,url:"http://thirdqq.qlogo.cn/g?b=sdk&k=F7aCnicxWzpicK89d0gkh7cw&s=100&t=1516260478"}])})]})})},t.prototype.share=function(t,e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return console.log(t),[2]})})},t.prototype.uploadRank=function(t,e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,e]})})},t.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,{nickName:"username"}]})})},t.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t.prototype.fetchBanner=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,null]})})},t.prototype.showBanner=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t.prototype.hideBanner=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t.prototype.fetchInterstitial=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,null]})})},t.prototype.showInterstitial=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t.prototype.fetchVedio=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,null]})})},t.prototype.reloadVedio=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t.prototype.vedioPlay=function(t,e,i){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return i(!0),[2]})})},t.prototype.getSaveData=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,{key:"key"}]})})},t.prototype.setSaveData=function(t,e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t.prototype.rankView=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return UIManager.getInstance().toRankScene(),[2]})})},t.prototype.loadNextStage=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return[2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},t.prototype.loadFont=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]
})})},t.prototype.hasBannerSDK=function(){return!1},t.prototype.hasInterstitialSDK=function(){return!1},t.prototype.hasVedioSDK=function(){return!0},t.prototype.hasShareSDK=function(){return!1},t}();__reflect(DebugPlatform.prototype,"DebugPlatform",["Platform"]),window.platform||(window.platform=new DebugPlatform,window.platform.name="mi");var RankScene=function(t){function e(e){var i=t.call(this)||this;return i.page_num=1,i.RANK_ITEM_PER_PAGE=5,i.sortedData=[],i.initView(e),i}return __extends(e,t),e.prototype.initView=function(t){return __awaiter(this,void 0,void 0,function(){var e,i,s,h;return __generator(this,function(a){switch(a.label){case 0:return this.egretStage=t,this.sheet=RES.getRes("data_scene"),e=RES.getRes("head_ui"),this.currentPage=1,i=new TSBitmap("bg",this.sheet),i.x=-100,i.height=this.egretStage.height,i.y=-Util.y_fix(),this.addChild(i),this.rank_head=new RankHead(e),this.rankView=new egret.Sprite,this.addChild(this.rankView),s=new TSBitmap("page",e),s.anchorOffsetX=s.width/2,s.anchorOffsetY=s.height/2,s.x=320,s.y=951.15,this.addChild(s),this.pageText=new egret.TextField,this.pageText.text=I18nManager.getInstance().getLanguageByName(LanguageEnum.PAGE_SELECT).replace("$d",this.currentPage),this.pageText.anchorOffsetX=this.pageText.width/2,this.pageText.anchorOffsetY=this.pageText.height/2,this.pageText.x=320,this.pageText.y=951.15,this.pageText.textColor=0,this.addChild(this.pageText),this.left=new TSBitmap("left",e),this.left.anchorOffsetX=this.left.width/2,this.left.anchorOffsetY=this.left.height/2,this.left.x=66.4,this.left.y=950.5,this.left.touchEnabled=!0,this.left.visible=!1,this.left.addEventListener(egret.TouchEvent.TOUCH_TAP,this.leftPage,this),this.addChild(this.left),this.right=new TSBitmap("left",e),this.right.scaleX=-1,this.right.anchorOffsetX=this.right.width/2,this.right.anchorOffsetY=this.right.height/2,this.right.x=572.6,this.right.y=950.5,this.right.touchEnabled=!0,this.right.visible=!1,this.right.addEventListener(egret.TouchEvent.TOUCH_TAP,this.rightPage,this),this.addChild(this.right),h=this,[4,platform.getRank()];case 1:return h.ranks=a.sent(),this.page_num=Math.ceil(this.ranks.length/this.RANK_ITEM_PER_PAGE),this.page_num>0&&(this.page_num>1&&(this.right.visible=!0),this.currentPage=1),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAdd,this),this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onSwipeBegin,this),this.updateView(),GameAnalyticsController.getInstance().rankEnterAnalytics(),[2]}})})},e.prototype.onAdd=function(t){UIManager.getInstance().getUILayer().addChild(this.rank_head)},e.prototype.updateView=function(){this.rankView.removeChildren();for(var t,e=0;e<this.RANK_ITEM_PER_PAGE&&5*(this.currentPage-1)+e!==this.ranks.length;e++)t=new RankItem,t.y=150*e+150,t.setPlayerData(5*(this.currentPage-1)+e+1,this.ranks[5*(this.currentPage-1)+e]),this.rankView.addChild(t)},e.prototype.updatePageText=function(){this.pageText.text=I18nManager.getInstance().getLanguageByName(LanguageEnum.PAGE_SELECT).replace("$d",this.currentPage)},e.prototype.onSwipeBegin=function(t){this.touchX=t.stageX,this.addEventListener(egret.TouchEvent.TOUCH_END,this.onSwipeEnd,this)},e.prototype.onSwipeEnd=function(t){this.touchX-t.stageX>50?this.rightPage():this.touchX-t.stageX<-50&&this.leftPage()},e.prototype.rightPage=function(){this.currentPage!==this.page_num&&(1===this.currentPage&&(this.left.visible=!0),this.currentPage+=1,this.updateView(),this.updatePageText(),this.currentPage===this.page_num&&(this.right.visible=!1))},e.prototype.leftPage=function(){1!==this.currentPage&&(this.currentPage===this.page_num&&(this.right.visible=!0),this.currentPage-=1,this.updateView(),this.updatePageText(),1===this.currentPage&&(this.left.visible=!1))},e.prototype.showLeftPageEffect=function(){this.currentPage>this.page_num||this.currentPage<0||(this.rankView.contains(this.pages[this.currentPage])&&this.rankView.removeChild(this.pages[this.currentPage]),egret.Tween.get(this.pages[this.currentPage],{loop:!1}).to({x:1280},100).call(function(){}));var t=this.currentPage-1;t>this.page_num||0>t||(this.rankView.contains(this.pages[t])||this.rankView.addChild(this.pages[t]),egret.Tween.get(this.pages[t],{loop:!1}).to({x:320},100).call(function(){}))},e.prototype.showRightPageEffect=function(){this.currentPage>this.page_num||this.currentPage<0||(this.rankView.contains(this.pages[this.currentPage])&&this.rankView.removeChild(this.pages[this.currentPage]),egret.Tween.get(this.pages[this.currentPage],{loop:!1}).to({x:-640},100).call(function(){}));var t=this.currentPage+1;t>this.page_num||0>t||(this.rankView.contains(this.pages[t])||this.rankView.addChild(this.pages[t]),egret.Tween.get(this.pages[t],{loop:!1}).to({x:320},100).call(function(){}))},e.prototype.start_loop=function(){},e.prototype.stop_loop=function(){},e}(egret.DisplayObjectContainer);__reflect(RankScene.prototype,"RankScene",["IFSceen"]);var TitleScene=function(t){function e(e){var i=t.call(this)||this;return i.GAME_STARTED=!1,i.egretStage=e,i.initView(),i}return __extends(e,t),e.prototype.loadRes=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return[4,RES.loadGroup("pops")];case 1:return t.sent(),UIManager.getInstance().setSheet(),[2]}})})},e.prototype.initView=function(){return __awaiter(this,void 0,void 0,function(){var t,e,i,s,h,a,o,n,r,l,c;return __generator(this,function(d){return this.init_sheet=RES.getRes("title_init"),this.selectedStage=StageController.getInstance().getCurrentSelected(),this.currentPage=Math.floor((this.selectedStage-1)/6)+1,this.selectSprite1=new egret.Sprite,this.selectSprite2=new egret.Sprite,t=new TSBitmap("select1",this.init_sheet),e=new TSBitmap("select1",this.init_sheet),t.x=e.x=Util.displayWidth()/2-t.width/2,t.y=e.y=0,this.selectSprite1.addChild(t),this.selectSprite2.addChild(e),i=new TSBitmap("select2",this.init_sheet),s=new TSBitmap("select2",this.init_sheet),i.x=s.x=Util.displayWidth()/2-t.width/2,i.y=s.y=780,this.selectSprite1.addChild(i),this.selectSprite2.addChild(s),h=new TSBitmap("select3",this.init_sheet),a=new TSBitmap("select3",this.init_sheet),h.x=a.x=Util.displayWidth()/2-t.width/2,h.y=a.y=1560,this.selectSprite1.addChild(h),this.selectSprite2.addChild(a),o=new TSBitmap("select4",this.init_sheet),n=new TSBitmap("select4",this.init_sheet),o.x=n.x=Util.displayWidth()/2-t.width/2,o.y=n.y=2340,this.selectSprite1.addChild(o),this.selectSprite2.addChild(n),r=new TSBitmap("select5",this.init_sheet),l=new TSBitmap("select5",this.init_sheet),r.x=l.x=Util.displayWidth()/2-t.width/2,r.y=l.y=3120,this.selectSprite1.addChild(r),this.selectSprite2.addChild(l),this.selectSprite2.y=this.selectSprite1.height,this.addChild(this.selectSprite1),this.addChild(this.selectSprite2),c=new egret.Bitmap(RES.getRes("loading_bg_png")),c.x=-100,c.height=this.egretStage.height,c.y=-Util.y_fix(),this.addChild(c),c.alpha=.8,this.title=new TSBitmap("title",this.init_sheet),this.title.anchorOffsetX=this.title.width/2,this.title.anchorOffsetY=this.title.height/2,this.title.x=320,this.title.y=493.1,this.addChild(this.title),this.start_btn=new TSBitmap("start",this.init_sheet),this.start_btn.touchEnabled=!0,this.start_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.startGame,this),this.breathEffect=TSEffect.breathEffect(this.start_btn,-1),this.start_btn.x=320,this.start_btn.y=777.6,this.addChild(this.start_btn),Util.gameStage().addEventListener(egret.MovieClipEvent.ENTER_FRAME,this.play_loop,this),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAdd,this),[2]})})},e.prototype.startGame=function(t){return void 0===t&&(t=null),__awaiter(this,void 0,void 0,function(){var e,i;return __generator(this,function(s){switch(s.label){case 0:return[4,this.loadRes()];case 1:for(s.sent(),null!==t&&SoundManager.getInstance().playSound(SoundEnum.SELECTSOUND_MP3),this.head_sheet=RES.getRes("head_ui"),this.start_sheet=RES.getRes("title_start"),this.title_head=new TitleHead(this.head_sheet),this.title_head.visible=!1,this.GAME_STARTED===!1&&(this.GAME_STARTED=!0,UIManager.getInstance().getUILayer().addChild(this.title_head),this.title_head.updateView()),AdManager.getInstance().showBanner(),this.breathEffect.destroy(),this.title.visible=!1,this.start_btn.visible=!1,this.removeChild(this.title),this.removeChild(this.start_btn),this.title_head.visible=!0,this.selectView=new egret.Sprite,e=1;5>=e;e++)this["selectPanel"+e]=new SelectPanel(this.start_sheet,e),this.currentPage>e?this["selectPanel"+e].x=-640:this.currentPage===e?this["selectPanel"+e].x=320:this["selectPanel"+e].x=1280,this["selectPanel"+e].y=520;return this.selectView.addChild(this["selectPanel"+this.currentPage]),this.addChild(this.selectView),i=new TSBitmap("page",this.head_sheet),i.anchorOffsetX=i.width/2,i.anchorOffsetY=i.height/2,i.x=320,i.y=951.15,this.addChild(i),this.pageText=new egret.TextField,this.pageText.text=I18nManager.getInstance().getLanguageByName(LanguageEnum.PAGE_SELECT).replace("$d",this.currentPage),this.pageText.anchorOffsetX=this.pageText.width/2,this.pageText.anchorOffsetY=this.pageText.height/2,this.pageText.x=320,this.pageText.y=951.15,this.pageText.textColor=0,this.addChild(this.pageText),this.left=new TSBitmap("left",this.head_sheet),this.left.anchorOffsetX=this.left.width/2,this.left.anchorOffsetY=this.left.height/2,this.left.x=66.4,this.left.y=950.5,this.left.touchEnabled=!0,this.left.addEventListener(egret.TouchEvent.TOUCH_TAP,this.leftPage,this),this.addChild(this.left),this.right=new TSBitmap("left",this.head_sheet),this.right.scaleX=-1,this.right.anchorOffsetX=this.right.width/2,this.right.anchorOffsetY=this.right.height/2,this.right.x=572.6,this.right.y=950.5,this.right.touchEnabled=!0,this.right.addEventListener(egret.TouchEvent.TOUCH_TAP,this.rightPage,this),this.addChild(this.right),1===this.currentPage?this.left.visible=!1:5===this.currentPage&&(this.right.visible=!1),this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onSwipeBegin,this),this.setLastPlaySelected(),StageController.getInstance().getDispather().addEventListener(StageEvent.STAGE_SELECED,this.selectStage,this),[2]}})})},e.prototype.onAdd=function(t){this.GAME_STARTED&&(UIManager.getInstance().getUILayer().addChild(this.title_head),this.title_head.updateView(),this.updatePageView())},e.prototype.setLastPlaySelected=function(){this.selectedStageView=this["selectPanel"+this.currentPage].getStageList()[(this.selectedStage-1)%6],this.selectedStageView.setSelected(!0)},e.prototype.onSwipeBegin=function(t){this.touchX=t.stageX,this.addEventListener(egret.TouchEvent.TOUCH_END,this.onSwipeEnd,this)},e.prototype.onSwipeEnd=function(t){this.touchX-t.stageX>50?this.rightPage():this.touchX-t.stageX<-50&&this.leftPage()},e.prototype.selectStage=function(t){void 0!==this.selectedStageView&&this.selectedStageView.setSelected(!1),this.selectedStage=t.getStage(),this.selectedStageView=this["selectPanel"+this.currentPage].getStageList()[(this.selectedStage-1)%6],this.selectedStageView.setSelected(!0)},e.prototype.updatePageText=function(){this.pageText.text=I18nManager.getInstance().getLanguageByName(LanguageEnum.PAGE_SELECT).replace("$d",this.currentPage)},e.prototype.updatePageView=function(){this["selectPanel"+this.currentPage].updateView()},e.prototype.rightPage=function(){5!==this.currentPage&&(1===this.currentPage&&(this.left.visible=!0),this.showRightPageEffect(),StageController.getInstance().clearNewOpenList(this.currentPage),this.currentPage+=1,this.updatePageText(),5===this.currentPage&&(this.right.visible=!1),this.updatePageView())},e.prototype.leftPage=function(){1!==this.currentPage&&(5===this.currentPage&&(this.right.visible=!0),this.showLeftPageEffect(),StageController.getInstance().clearNewOpenList(this.currentPage),this.currentPage-=1,this.updatePageText(),1===this.currentPage&&(this.left.visible=!1),this.updatePageView())},e.prototype.showLeftPageEffect=function(){var t=this;this.currentPage>5||this.currentPage<0||(this.selectView.contains(this["selectPanel"+this.currentPage])&&this.selectView.removeChild(this["selectPanel"+this.currentPage]),egret.Tween.get(this["selectPanel"+this.currentPage],{loop:!1}).to({x:1280},100));var e=this.currentPage-1;e>5||0>e||(this.selectView.contains(this["selectPanel"+e])||this.selectView.addChild(this["selectPanel"+e]),egret.Tween.get(this["selectPanel"+e],{loop:!1}).to({x:320},100).call(function(){for(var e,i,s=StageController.getInstance().getNewClearList().length-1;s>=0;s--)i=StageController.getInstance().getNewClearList()[s],i/6+1===t.currentPage&&(e=t["selectPanel"+t.currentPage].getStageList()[(i-1)%6],e.updateStatus(),StageController.getInstance().getNewClearList().splice(i,1))}))},e.prototype.showRightPageEffect=function(){var t=this;this.currentPage>5||this.currentPage<0||(this.selectView.contains(this["selectPanel"+this.currentPage])&&this.selectView.removeChild(this["selectPanel"+this.currentPage]),egret.Tween.get(this["selectPanel"+this.currentPage],{loop:!1}).to({x:-640},100));var e=this.currentPage+1;e>5||0>e||(this.selectView.contains(this["selectPanel"+e])||this.selectView.addChild(this["selectPanel"+e]),egret.Tween.get(this["selectPanel"+e],{loop:!1}).to({x:320},100).call(function(){for(var e,i,s=StageController.getInstance().getNewClearList().length-1;s>=0;s--)i=StageController.getInstance().getNewClearList()[s],i/6+1===t.currentPage&&(e=t["selectPanel"+t.currentPage].getStageList()[(i-1)%6],e.updateStatus(),StageController.getInstance().getNewClearList().splice(i,1))}))},e.prototype.play_loop=function(t){this.GAME_STARTED?(this.selectSprite1.y-=1,this.selectSprite2.y-=1,this.selectSprite1.y===-this.selectSprite1.height&&(this.selectSprite1.y=this.selectSprite1.height),this.selectSprite2.y===-this.selectSprite1.height&&(this.selectSprite2.y=this.selectSprite1.height)):(this.selectSprite1.y-=5,this.selectSprite2.y-=5,this.selectSprite1.y===-this.selectSprite1.height&&(this.selectSprite1.y=this.selectSprite1.height),this.selectSprite2.y===-this.selectSprite1.height&&(this.selectSprite2.y=this.selectSprite1.height))},e}(egret.DisplayObjectContainer);__reflect(TitleScene.prototype,"TitleScene",["IFSceen"]);var CardView=function(t){function e(e,i){var s=t.call(this)||this;return s.detail=Config.getInstance().card_tip[i],s.initView(e),s}return __extends(e,t),e.prototype.initView=function(t){this.status=SaveData.getInstance().getCardStatus(this.detail.No),this.noText=new egret.TextField,this.noText.text="No. "+this.detail.No,this.noText.x=-65.7,this.noText.y=-91,this.noText.width=118.7,this.noText.height=26,this.noText.textColor=0,this.noText.size=22,this.addChild(this.noText),this.card_bf=new TSBitmap("card_bf"+this.detail.star,t,!0),this.card_bg=new TSBitmap("card_bg"+this.detail.star,t,!0),parseInt(this.status)/2>=1?(this.card=new TSBitmap(this.detail.No+"_"+this.detail.stage+"_"+this.detail.result,RES.getRes("card_sheet"),!0),this.card.touchEnabled=!0,this.addChild(this.card),this.addChild(this.card_bf)):this.addChild(this.card_bg),this.stars=new egret.Sprite;for(var e,i=0;i<this.detail.star;i++)e=new TSBitmap("star",t),e.x=32.15-e.width*i,e.y=66.9,this.stars.addChild(e);this.addChild(this.stars)},e.prototype.updateView=function(){this.status=SaveData.getInstance().getCardStatus(this.detail.No),parseInt(this.status)/2>=1&&(this.contains(this.card_bg)&&this.removeChild(this.card_bg),this.card=new TSBitmap(this.detail.No+"_"+this.detail.stage+"_"+this.detail.result,RES.getRes("card_sheet"),!0),this.card.touchEnabled=!1,this.addChild(this.card),this.addChild(this.card_bf))},Object.defineProperty(e.prototype,"cardDetail",{get:function(){return this.detail},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cardNumber",{get:function(){return this.detail.No},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cardStatus",{get:function(){return this.status},enumerable:!0,configurable:!0}),e}(egret.Sprite);__reflect(CardView.prototype,"CardView");var DataHead=function(t){function e(e){var i=t.call(this)||this;return i.init(e),i}return __extends(e,t),e.prototype.init=function(t){var e=new TSBitmap("head",t);e.x=-120,e.y=-160,this.addChild(e),this.title=new TSBitmap("title",RES.getRes("data_scene")),this.title.x=143.5,this.title.y=15.5,this.addChild(this.title),this.back_btn=new TSBitmap("back_btn",t,!0),this.back_btn.x=80,this.back_btn.y=40,this.back_btn.touchEnabled=!0,this.addChild(this.back_btn),this.back_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.backTouched,this),UIManager.getInstance().getUILayer().addChild(this)},e.prototype.backTouched=function(){UIManager.getInstance().toTitleScene()},e}(egret.Sprite);__reflect(DataHead.prototype,"DataHead");var GameHead=function(t){function e(e){var i=t.call(this)||this;return i.init(e),i}return __extends(e,t),e.prototype.init=function(t){var e=new TSBitmap("head",t);e.x=-120,e.y=-160,this.addChild(e),this.stageId=new egret.TextField,this.stageId.textColor=0,this.addChild(this.stageId),this.stageName=new egret.TextField,this.stageName.textColor=0,this.stageName.y=40,this.addChild(this.stageName),this.menu_pop=new TSBitmap("menu",t,!0),this.menu_pop.x=580-("wxgame"===platform.name?150:0),this.menu_pop.y=40,this.menu_pop.touchEnabled=!0,this.addChild(this.menu_pop),this.menu_pop.addEventListener(egret.TouchEvent.TOUCH_TAP,this.showMenu,this),this.voice=new egret.Sprite,this.voice.x=450-("wxgame"===platform.name?150:0),this.voice.y=40,this.addChild(this.voice),this.voice.touchEnabled=!0,this.voice.addEventListener(egret.TouchEvent.TOUCH_TAP,this.changeVoice,this);var i=new TSBitmap("on",t,!0);i.name="on",this.voice.addChild(i);var s=new TSBitmap("off",t,!0);s.name="off",this.voice.addChild(s),UIManager.getInstance().getUILayer().addChild(this),this.updateView(),this.showVoice()},e.prototype.updateView=function(){this.stageId.text="第"+StageController.getInstance().getCurrentSelected()+"关",this.stageName.text=I18nManager.getInstance().getLanguageInGroupByName("stageLang","stage"+StageController.getInstance().getCurrentSelected()),this.showVoice()},e.prototype.showMenu=function(){UIManager.getInstance().openMenuPop()},e.prototype.showVoice=function(){SettingController.getInstance().SoundPlaying?(this.voice.getChildByName("off").visible=!1,this.voice.getChildByName("on").visible=!0):(this.voice.getChildByName("on").visible=!1,this.voice.getChildByName("off").visible=!0)},e.prototype.changeVoice=function(){SettingController.getInstance().SoundPlaying?SettingController.getInstance().SoundPlaying=!1:SettingController.getInstance().SoundPlaying=!0,this.showVoice()},e}(egret.Sprite);__reflect(GameHead.prototype,"GameHead");var Item=function(t){function e(e){void 0===e&&(e="");var i=t.call(this)||this;i.item_name=e,i.png=new egret.Bitmap;var s=RES.getRes(e);return i.png.texture=s,i}return __extends(e,t),e.prototype.getName=function(){return this.item_name},e}(egret.Bitmap);__reflect(Item.prototype,"Item");var ItemCtrlView=function(t){function e(e){var i=t.call(this)||this;return i.drag=new egret.Bitmap,i.egretStage=e,i.init(),i}return __extends(e,t),e.getInstance=function(t){return void 0===t&&(t=null),null===this.instance?this.instance=new e(t):null!=t&&null===this.instance.egretStage&&(this.instance.egretStage=t),this.instance},e.prototype.init=function(){this.container=new egret.Sprite,this.addChild(this.container),this.addChild(this.drag),this.drag.visible=!1;var t=new TSBitmap("items_png");t.touchEnabled=!0,this.container.addChild(t),this.container.x=-100,this.container.y=Util.displayHeight(),this.dragHand=new TSBitmap("hand_png"),this.dragHand.visible=!1,this.addChild(this.dragHand),UIManager.getInstance().getGameLayer().addChild(this)},e.prototype.createBitmapByName=function(t){var e=new egret.Bitmap,i=RES.getRes(t);return e.texture=i,e},e.prototype.updateItems=function(t){void 0===t&&(t=!0);for(var e=ItemController.getInstance().getItemList(),i=0;5>i;i++)i<e.length?((void 0===this["item"+i]||null===this["item"+i])&&(this["item"+i]=new egret.Bitmap),this["item"+i].texture=RES.getRes(ItemEnum.getResUrlById(e[i])),this["item"+i].name=ItemEnum.getResUrlById(e[i]),this["item"+i].id=e[i],this["item"+i].width=101,this["item"+i].height=101,this["item"+i].x=127*i+117,this["item"+i].y=18,this["item"+i].visible=!0,this["item"+i].touchEnabled=!0,this["item"+i].addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onItemTouchBegin,this),this.container.addChild(this["item"+i])):void 0!==this["item"+i]&&null!==this["item"+i]&&this["item"+i].parent===this.container&&(this.container.removeChild(this["item"+i]),this["item"+i]=null);e.length>=1?egret.Tween.get(this.container,{loop:!1}).to({y:Util.displayHeight()-120},1e3):0===e.length&&egret.Tween.get(this.container,{loop:!1}).to({y:Util.displayHeight()},1e3)},e.prototype.onFireOpend=function(){},e.prototype.addItem=function(t){this.container.addChild(t)},e.prototype.useItem=function(t){this["item"+t]=null,this.container.removeChild(this["item"+t])},e.prototype.getItem=function(t){return this["item"+t]},e.prototype.cancelItemCurrentDrag=function(){-1!==this.dragId&&(this.drag.visible=!1,this.dragId=-1)},e.prototype.cancelItem=function(t){var e=ItemController.getInstance().getIndexOf(t);this["item"+e]&&(this["item"+e].visible=!0)},e.prototype.onItemTouchBegin=function(t){t.target.visible=!1,this.drag.texture=RES.getRes(t.target.name),this.drag.width=this.drag.height=100*Util.factor(),this.dragId=t.target.id,this.drag.x=t.stageX-50*Util.factor()-Util.x_fix(),this.drag.y=t.stageY-50*Util.factor()-Util.y_fix(),this.drag.visible=!0,this.egretStage.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.onItemTouchMove,this),this.egretStage.addEventListener(egret.TouchEvent.TOUCH_END,this.onItemTouchEnd,this),GuideController.getInstance().guidePassed||this.hideDragGuide()},e.prototype.onItemTouchMove=function(t){this.drag.x=t.stageX-50*Util.factor()-Util.x_fix(),this.drag.y=t.stageY-50*Util.factor()-Util.y_fix()},e.prototype.onItemTouchEnd=function(t){this.egretStage.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.onItemTouchMove,this),this.egretStage.removeEventListener(egret.TouchEvent.TOUCH_END,this.onItemTouchEnd,this),UIManager.getInstance().currentScene.getCurrentStage().useItem(this.dragId,t.stageX,t.stageY)?ItemController.getInstance().useItem(this.dragId):this.cancelItem(this.dragId),this.drag.visible=!1,this.dragId=-1},e.prototype.showDragGuide=function(t,e){if(1===GuideController.getInstance().guideStep){var i=this.localToGlobal(this.container.x+this.item0.x-Util.x_fix(),this.container.y+this.item0.y-Util.y_fix());this.dragHand.x=i.x,this.dragHand.y=i.y,this.dragHand.visible=!0,egret.Tween.get(this.dragHand,{loop:!0}).to({x:t-Util.x_fix(),y:e-Util.y_fix()},2e3)}},e.prototype.hideDragGuide=function(){this.dragHand.visible=!1,egret.Tween.removeTweens(this.dragHand)},e.prototype.finishDragGuide=function(){GuideController.getInstance().nextStep()},Object.defineProperty(e.prototype,"currentDragId",{get:function(){return void 0===this.dragId&&(this.dragId=-1),this.dragId},enumerable:!0,configurable:!0}),e.instance=null,e}(egret.Sprite);__reflect(ItemCtrlView.prototype,"ItemCtrlView");var RankHead=function(t){function e(e){var i=t.call(this)||this;return i.init(e),i}return __extends(e,t),e.prototype.init=function(t){var e=new TSBitmap("head",t);e.x=-120,e.y=-160,this.addChild(e),this.title=new TSBitmap("rank_title_png",RES.getRes("title_scene")),this.title.x=143.5,this.title.y=15.5,this.addChild(this.title),this.back_btn=new TSBitmap("back_btn",t,!0),this.back_btn.x=80,this.back_btn.y=40,this.back_btn.touchEnabled=!0,this.addChild(this.back_btn),this.back_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.backTouched,this),UIManager.getInstance().getUILayer().addChild(this)},e.prototype.backTouched=function(){UIManager.getInstance().toTitleScene()},e}(egret.Sprite);__reflect(RankHead.prototype,"RankHead");var RankItem=function(t){function e(){var e=t.call(this)||this;return e.initView(),e}return __extends(e,t),e.prototype.initView=function(){this.rank_index_text=new egret.TextField,this.rank_index_text.x=45,this.rank_index_text.y=30,this.rank_index_text.text="",this.rank_index_text.fontFamily="KaiTi",this.rank_index_text.textColor=3551278,this.addChild(this.rank_index_text),this.player_head=new egret.Bitmap,this.player_head.y=-20,this.addChild(this.player_head),this.head_crown=new egret.Bitmap,this.head_crown.y=-10,this.player_name_text=new egret.TextField,this.player_name_text.x=260,this.player_name_text.y=30,this.player_name_text.text="",this.player_name_text.textColor=3551278,this.addChild(this.player_name_text),this.total_card_text=new egret.TextField,this.total_card_text.x=410,this.total_card_text.y=30,this.total_card_text.text="0",this.total_card_text.textColor=16284771,this.addChild(this.total_card_text)},e.prototype.updateView=function(){this.rank_index_text.text="No."+this.rank_index,this.player_head.x=55+this.rank_index_text.width,this.player_name_text.text=this.player_name.length>4?this.player_name.slice(0,4)+"...":this.player_name,this.total_card_text.text="图鉴 "+this.total_card+"张";var t=this,e=new egret.ImageLoader;e.crossOrigin="anonymous",e.load(this.head_url),e.once(egret.Event.COMPLETE,function(e){if(e.currentTarget.data){egret.log("加载头像成功: "+e.currentTarget.data);var i=new egret.Texture;i.bitmapData=e.currentTarget.data,t.player_head.texture=i}},this)},e.prototype.setPlayerData=function(t,e){this.rank_index=t,this.rank_index<4&&(this.head_crown.texture=RES.getRes("crown_sheet").getTexture("crown"+this.rank_index),this.head_crown.x=this.player_head.x+this.player_head.width-this.head_crown.width,this.addChild(this.head_crown)),this.player_name=e.nick,this.total_card=e.score,this.head_url=e.url,this.updateView()},e}(egret.Sprite);__reflect(RankItem.prototype,"RankItem");var SelectPanel=function(t){function e(e,i){var s=t.call(this)||this;return s.stageList=[],s.initView(e,i),s}return __extends(e,t),e.prototype.initView=function(t,e){var i,s=Config.getInstance().select_json;if(6>e)for(var h=1+6*(e-1);6*e>=h;h++)i=new SelectStageView(t,h,s),i.x=s["act"+h].x,i.y=s["act"+h].y,this.addChild(i),this.stageList.push(i)},e.prototype.updateView=function(){for(var t=0;6>t;t++)this.stageList[t].updateStatus()},e.prototype.getStageList=function(){return this.stageList},e}(egret.DisplayObjectContainer);__reflect(SelectPanel.prototype,"SelectPanel");var SelectStageView=function(t){function e(e,i,s){var h=t.call(this)||this;return h.id=i,h.init(e,i,s),h}return __extends(e,t),e.prototype.init=function(t,e,i){var s=new TSBitmap("act"+e,t);s.x=i["act"+e].view.x,s.y=i["act"+e].view.y,this.addChild(s);var h=new TSBitmap("idbg",t);h.anchorOffsetX=0,h.anchorOffsetY=0,h.x=i["act"+e].idbg.x-h.width/2,h.y=i["act"+e].idbg.y-h.height/2,this.addChild(h);var a=new egret.TextField;a.textColor=0,a.text=e.toString(),a.anchorOffsetX=a.width/2,a.anchorOffsetY=a.height/2,a.x=h.x+h.width/2,a.y=h.y+h.height/2,this.addChild(a),this.titleText=new egret.TextField,this.textBG=new egret.Shape,this.titleText.textColor=16777215,this.stageName=I18nManager.getInstance().getLanguageInGroupByName("stageLang","stage"+e),"right"===i["act"+e].title?(this.titleText.text=this.stageName,this.titleText.x=h.x+h.width,this.titleText.y=h.y+this.titleText.height/2-10,this.textBG.graphics.beginFill(0),this.textBG.graphics.drawRect(this.titleText.x,this.titleText.y,this.titleText.width,this.titleText.height),this.textBG.graphics.endFill(),this.addChild(this.textBG),this.addChild(this.titleText)):(this.titleText.text=i["act"+e].name,this.titleText.x=h.x-this.titleText.width,this.titleText.y=h.y+this.titleText.height/2-10,this.textBG.graphics.beginFill(0),this.textBG.graphics.drawRect(this.titleText.x,this.titleText.y,this.titleText.width,this.titleText.height),this.textBG.graphics.endFill(),this.addChild(this.textBG),this.addChild(this.titleText)),this.acts=new TSBitmap("act"+e+"s",t),this.acts.x=i["act"+e].view.x,this.acts.y=i["act"+e].view.y,this.addChild(this.acts),this.newTag=new TSBitmap("new",RES.getRes("pops_sheet"),!0),this.newTag.x=i["act"+e].clear.x,this.newTag.y=i["act"+e].clear.y,this.newTag.visible=!1,this.addChild(this.newTag),this.clear=new TSBitmap("finish",t),this.clear.anchorOffsetX=this.clear.width/2,this.clear.anchorOffsetY=this.clear.height/2,this.clear.x=i["act"+e].clear.x,this.clear.y=i["act"+e].clear.y,this.addChild(this.clear),this.updateStatus(),this.touchEnabled=!0,this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSelected,this)},e.prototype.onSelected=function(){SoundManager.getInstance().playSound(SoundEnum.SELECTSOUND_MP3),StageController.getInstance().setSelect(this.id)},e.prototype.updateStatus=function(){if(StageController.getInstance().isStageOpen(this.id))this.filters=[];else{var t=[.3,.6,0,0,0,.3,.6,0,0,0,.3,.6,0,0,0,0,0,0,1,0],e=new egret.ColorMatrixFilter(t);this.filters=[e]}StageController.getInstance().isStageClear(this.id)?this.clear.visible=!0:this.clear.visible=!1,StageController.getInstance().isStageNew(this.id)?this.setNewTagShow(!0):this.setNewTagShow(!1),StageController.getInstance().getCurrentSelected()===this.id?this.setSelected(!0):this.setSelected(!1)},e.prototype.setNewTagShow=function(t){t?egret.Tween.get(this.newTag,{loop:!0}).to({y:this.newTag.y+10},800).to({y:this.newTag.y-10},800):this.newTag.visible===!0&&egret.Tween.removeTweens(this.newTag),this.newTag.visible=t},e.prototype.setSelected=function(t){this.acts.visible=t,this.titleText.visible=t,this.textBG.visible=t},e.prototype.getStageName=function(){return this.stageName},e}(egret.Sprite);__reflect(SelectStageView.prototype,"SelectStageView");var TitleHead=function(t){function e(e){var i=t.call(this)||this;return i.init(e),i}return __extends(e,t),e.prototype.init=function(t){var e=new TSBitmap("head",t);e.x=-120,e.y=-160,this.addChild(e),this.ours=new TSBitmap("ours",t),this.ours.anchorOffsetX=this.ours.width/2,this.ours.anchorOffsetY=this.ours.height/2,this.ours.x=122.7,this.ours.y=48,this.ours.visible=!1,this.addChild(this.ours),this.data_entrance=new TSBitmap("data_scene",t,!0),this.data_entrance.x=450-("wxgame"===platform.name?150:0),this.data_entrance.y=40,this.data_entrance.touchEnabled=!0,this.addChild(this.data_entrance),this.data_entrance.addEventListener(egret.TouchEvent.TOUCH_TAP,this.dataShow,this),this.voice=new egret.Sprite,this.voice.x=580-("wxgame"===platform.name?150:0),this.voice.y=40,this.addChild(this.voice),this.voice.touchEnabled=!0,this.voice.addEventListener(egret.TouchEvent.TOUCH_TAP,this.changeVoice,this),this.rank_btn=new TSBitmap("rank",t,!0),this.rank_btn.x=320-("wxgame"===platform.name?150:0),this.rank_btn.y=40,this.addChild(this.rank_btn),this.rank_btn.touchEnabled=!0,this.rank_btn.visible=platform.existRank(),this.rank_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.rankShow,this);var i=new TSBitmap("on",t,!0);i.name="on",this.voice.addChild(i);var s=new TSBitmap("off",t,!0);s.name="off",this.voice.addChild(s),this.showVoice();var h=new TSBitmap("dialog",t);h.x=434.65,h.y=101.9,h.visible=!1,this.addChild(h)},e.prototype.updateView=function(){this.showVoice()},e.prototype.showVoice=function(){SettingController.getInstance().SoundPlaying?(this.voice.getChildByName("off").visible=!1,this.voice.getChildByName("on").visible=!0):(this.voice.getChildByName("on").visible=!1,this.voice.getChildByName("off").visible=!0)},e.prototype.changeVoice=function(){SettingController.getInstance().SoundPlaying?SettingController.getInstance().SoundPlaying=!1:SettingController.getInstance().SoundPlaying=!0,this.showVoice()},e.prototype.dataShow=function(){UIManager.getInstance().toDataScene()},e.prototype.rankShow=function(){platform.rankView()},e}(egret.Sprite);__reflect(TitleHead.prototype,"TitleHead");var Stage1=function(t){function e(){var e=t.call(this)||this;return e.STAGE_ID=1,e.FLAG_TOUCH_GUIDE=!1,e.FLAG_DRAG_GUIDE=!1,e.FLAG_COVER_GOT=!1,e.FLAG_START_POURING=!1,e.FLAG_FIRE_OPENED=!1,e.FLAG_POP_JUMP=!1,e.FLAG_POP_BOOM=!1,e.FLAG_COVER_USED=!1,e.FLAG_OPEN_COVER=!1,e.FLAG_POP_SOUND=!0,e.FLAG_TASTE_POP=!1,e.FLAG_COVER_CAN_USE=!0,e.FLAG_CLEAR=!1,e.FLAG_GAME_OVER=!1,e.COUNTER_OPEN_COVER=0,e.fire_open_time=0,e._init(),e
}return __extends(e,t),e.prototype._init=function(){return __awaiter(this,void 0,void 0,function(){var t,e,i,s,h,a,o,n,r,l,c,d,_,g,p,u,y,E;return __generator(this,function(T){switch(T.label){case 0:return UIManager.getInstance().showLoading(),[4,this._loadRes()];case 1:return T.sent(),UIManager.getInstance().hideLoading(),t=new TSBitmap("bg_png"),t.x=-120,t.y=-100,this.addChild(t),e=RES.getRes("boy_action_json"),i=RES.getRes("boy_action_png"),this.boyMcFactory=new egret.MovieClipDataFactory(e,i),this.boy=new egret.MovieClip(this.boyMcFactory.generateMovieClipData("start")),this.boy.x=306,this.boy.y=643,this.addChild(this.boy),this.boy.play(1),this.stand=new TSBitmap("stand_png"),this.stand.x=-120,this.stand.y=707,this.addChild(this.stand),this.rarm=new TSBitmap("rarm_png"),this.rarm.anchorOffsetX=this.rarm.width/2,this.rarm.anchorOffsetY=this.rarm.height/2,this.rarm.x=307,this.rarm.y=643,this.rarm.visible=!1,this.addChild(this.rarm),this.larm=new TSBitmap("larm_png"),this.larm.anchorOffsetX=this.larm.width/2,this.larm.anchorOffsetY=this.larm.height/2,this.larm.x=305,this.larm.y=646,this.larm.visible=!1,this.addChild(this.larm),s=new TSBitmap("stove_png"),s.anchorOffsetX=s.width/2,s.anchorOffsetY=s.height/2,s.x=300,s.y=780,this.addChild(s),h=RES.getRes("fire_action_json"),a=RES.getRes("fire_action_png"),o=new egret.MovieClipDataFactory(h,a),this.fire_action=new egret.MovieClip(o.generateMovieClipData("fire")),this.fire_action.x=315,this.fire_action.y=776.25,this.fire_action.alpha=0,this.addChild(this.fire_action),this.fire_action.gotoAndStop(1),this.pot=new TSBitmap("pot_png"),this.pot.anchorOffsetX=s.width/2,this.pot.anchorOffsetY=s.height/2,this.pot.x=334,this.pot.y=727,this.pot.touchEnabled=!0,this.addChild(this.pot),n=RES.getRes("pop_clear_json"),r=RES.getRes("pop_clear_png"),l=new egret.MovieClipDataFactory(n,r),this.pop_clear_action=new egret.MovieClip(l.generateMovieClipData("pop_in_pot")),this.pop_clear_action.x=310,this.pop_clear_action.y=this.pot.y+this.pop_clear_action.height/2,this.pop_clear_action.visible=!1,this.pop_clear_action.gotoAndStop(1),this.addChild(this.pop_clear_action),this.cover=new TSBitmap("cover_png"),this.cover.anchorOffsetX=this.cover.width/2,this.cover.anchorOffsetY=this.cover.height/2,this.cover.x=153,this.cover.y=797,this.cover.touchEnabled=!0,this.cover.addEventListener(egret.TouchEvent.TOUCH_TAP,this.getCover,this),this.addChild(this.cover),c=RES.getRes("cover_on_json"),d=RES.getRes("cover_on_png"),_=new egret.MovieClipDataFactory(c,d),this.cover_on=new egret.MovieClip(_.generateMovieClipData("cover_on")),this.cover_on.x=315,this.cover_on.y=this.pot.y+10,this.cover_on.visible=!1,this.cover_on.gotoAndStop(1),this.addChild(this.cover_on),g=RES.getRes("pop_boom_json"),p=RES.getRes("pop_boom_png"),this.popMcFactory=new egret.MovieClipDataFactory(g,p),this.pop_jump_action=new egret.MovieClip(this.popMcFactory.generateMovieClipData("jump")),this.pop_jump_action.x=315.7,this.pop_jump_action.y=741.9,this.pop_jump_action.visible=!1,this.pop_jump_action.gotoAndStop(1),this.addChild(this.pop_jump_action),this.pop_boom_action=new egret.MovieClip(this.popMcFactory.generateMovieClipData("boom")),this.pop_boom_action.x=315,this.pop_boom_action.y=744,this.pop_boom_action.visible=!1,this.pop_boom_action.gotoAndStop(this.pop_boom_action.totalFrames),this.addChild(this.pop_boom_action),this.pop_drop_action=new egret.MovieClip(this.popMcFactory.generateMovieClipData("drop")),this.pop_drop_action.x=306,this.pop_drop_action.y=761,this.pop_drop_action.visible=!1,this.pop_drop_action.gotoAndStop(1),this.addChild(this.pop_drop_action),u=RES.getRes("pop_enter_json"),y=RES.getRes("pop_enter_png"),E=new egret.MovieClipDataFactory(u,y),this.enter_action1=new egret.MovieClip(E.generateMovieClipData("pour1")),this.enter_action2=new egret.MovieClip(E.generateMovieClipData("pour2")),this.enter_action1.x=308,this.enter_action1.y=641,this.addChild(this.enter_action1),this.enter_action1.gotoAndPlay(1),this.enter_action2.x=308,this.enter_action2.y=641,this.addChild(this.enter_action2),this.enter_action2.gotoAndPlay(1),this.bag=new TSBitmap("bag_png"),this.bag.anchorOffsetX=this.bag.width/2,this.bag.anchorOffsetY=this.bag.height/2,this.bag.x=449,this.bag.y=736,this.bag.visible=!1,this.addChild(this.bag),GuideController.getInstance().guidePassed||(this.title_guide_word=new egret.Bitmap,this.title_guide_word.texture=RES.getRes("guide_0_png"),this.title_guide_word.anchorOffsetX=this.title_guide_word.width/2,this.title_guide_word.anchorOffsetY=this.title_guide_word.height/2,this.title_guide_word.x=320,this.title_guide_word.y=300,this.title_guide_word.visible=!0,this.addChild(this.title_guide_word),this.guide_word=new egret.Bitmap,this.guide_word.texture=RES.getRes("guide_1_png"),this.guide_word.anchorOffsetX=this.guide_word.width/2,this.guide_word.anchorOffsetY=this.guide_word.height/2,this.guide_word.x=320,this.guide_word.y=300,this.guide_word.visible=!1,this.addChild(this.guide_word),this.handTouch=new TSBitmap("touch_png"),this.handTouch.anchorOffsetX=this.handTouch.width/2,this.handTouch.anchorOffsetY=this.handTouch.height/2,this.handTouch.visible=!1,this.handTouch.x=this.cover.x,this.handTouch.y=this.cover.y,this.addChild(this.handTouch),this.guideHand=new TSBitmap("hand_png"),this.guideHand.anchorOffsetX=this.guideHand.width/2,this.guideHand.anchorOffsetY=this.guideHand.height/2,this.guideHand.visible=!1,this.guideHand.x=this.cover.x,this.guideHand.y=this.cover.y+this.cover.height,this.addChild(this.guideHand)),GuideController.getInstance().guidePassed||(GuideController.getInstance().resetStep(),ItemCtrlView.getInstance().hideDragGuide()),this._start(),[2]}})})},e.prototype.onFireOpend=function(){GuideController.getInstance().guidePassed===!1&&0===GuideController.getInstance().guideStep&&(this.FLAG_TOUCH_GUIDE=!0,this.title_guide_word.visible=!1,this.guideHand.visible=!0,this.handTouch.visible=!0,this.guide_word.visible=!0,egret.Tween.get(this.handTouch,{loop:!0}).to({scaleX:1.5,scaleY:1.5},1e3)),this.fire_open_time=0,this.rarm.visible=!1,this.boy.movieClipData=this.boyMcFactory.generateMovieClipData("stand"),this.boy.gotoAndStop(1)},e.prototype.popJumpStart=function(){this.pop_jump_action.visible=!0,this.pop_clear_action.visible=!1,this.boy.movieClipData=this.boyMcFactory.generateMovieClipData("fuon"),this.boy.gotoAndStop(1),this.pop_jump_action.gotoAndStop(1)},e.prototype.open_cover=function(){this.cover_on.visible=!1,this.boy.movieClipData=this.boyMcFactory.generateMovieClipData("open"),this.boy.gotoAndStop(1),this.setChildIndex(this.stand,this.getChildIndex(this.boy)),this.larm.visible=!0},e.prototype.taste_pop=function(){this.boy.movieClipData=this.boyMcFactory.generateMovieClipData("clear"),this.setChildIndex(this.boy,this.getChildIndex(this.stand)),this.boy.gotoAndStop(1)},e.prototype.GameOver=function(){},e.prototype._loadRes=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,StageController.getInstance().loadStage(1)];case 1:return e.sent(),[3,3];case 2:return t=e.sent(),console.error(t),[3,3];case 3:return[2]}})})},e.prototype.getCover=function(){ItemController.getInstance().addItem(ItemEnum.ITEM_COVER)&&(this.cover.visible=!1,this.cover.touchEnabled=!1,this.FLAG_COVER_GOT=!0,GuideController.getInstance().guidePassed===!1&&(this.FLAG_TOUCH_GUIDE=!1,this.guideHand.visible=!1,this.handTouch.visible=!1,this.guide_word.visible=!1,GuideController.getInstance().nextStep()))},e.prototype._start=function(){this.FLAG_START_POURING=!0},e.prototype.play_loop=function(){this.FLAG_GAME_OVER||this.FLAG_CLEAR||this.FLAG_TOUCH_GUIDE||this.FLAG_DRAG_GUIDE||(this.FLAG_START_POURING&&this.FLAG_FIRE_OPENED===!1&&this.enter_action1.currentFrame===this.enter_action1.totalFrames&&(this.enter_action1.stop(),this.enter_action2.stop(),this.enter_action1.visible=!1,this.enter_action2.visible=!1,this.removeChild(this.enter_action1),this.removeChild(this.enter_action2),this.bag.visible=!0,this.rarm.visible=!0,this.fire_action.visible=!0,this.pop_clear_action.visible=!0,egret.Tween.get(this.fire_action,{loop:!1}).to({alpha:1},2e3).call(this.onFireOpend,this,[]),this.FLAG_FIRE_OPENED=!0),this.FLAG_FIRE_OPENED&&this.FLAG_POP_JUMP===!1&&this.FLAG_OPEN_COVER===!1&&(Util.loopPlay(this.fire_action),this.boy.nextFrame(),this.FLAG_COVER_USED?(this.pop_clear_action.currentFrame===this.pop_clear_action.totalFrames&&(this.FLAG_OPEN_COVER=!0,this.open_cover()),this.FLAG_POP_SOUND=!this.FLAG_POP_SOUND,this.FLAG_POP_SOUND&&SoundManager.getInstance().playSound(SoundEnum.BURST2SOUND_MP3),this.pop_clear_action.nextFrame(),Util.loopPlay(this.cover_on),this.larm.visible=!1):GuideController.getInstance().guidePassed?120===this.fire_open_time?(this.FLAG_POP_JUMP=!0,this.FLAG_COVER_CAN_USE=!1,this.popJumpStart()):this.fire_open_time++:this.FLAG_COVER_GOT&&(60===this.fire_open_time?(-1===ItemCtrlView.getInstance().currentDragId&&this.showDragGuide(),this.title_guide_word.visible=!1,this.guide_word.texture=RES.getRes("guide_2_png"),this.guide_word.anchorOffsetX=this.guide_word.width/2,this.guide_word.anchorOffsetY=this.guide_word.height/2,this.guide_word.visible=!0,this.FLAG_DRAG_GUIDE=!0):this.fire_open_time++)),this.FLAG_POP_JUMP&&!this.FLAG_POP_BOOM&&(this.pop_jump_action.nextFrame(),this.pop_jump_action.currentFrame===this.pop_jump_action.totalFrames?(this.FLAG_POP_BOOM=!0,this.pop_boom_action.visible=!0,this.pop_drop_action.visible=!0,this.pop_boom_action.gotoAndStop(1),this.pop_drop_action.gotoAndStop(1),this.boy.movieClipData=this.boyMcFactory.generateMovieClipData("bad"),this.boy.gotoAndStop(1)):(1===this.pop_jump_action.currentFrame||7===this.pop_jump_action.currentFrame||10===this.pop_jump_action.currentFrame)&&SoundManager.getInstance().playSound(SoundEnum.BURST2SOUND_MP3)),this.FLAG_POP_BOOM&&(this.pop_drop_action.totalFrames===this.pop_drop_action.currentFrame&&(StageController.getInstance().gameOverStage(this.STAGE_ID,[1]),this.FLAG_GAME_OVER=!0),this.boy.nextFrame(),this.FLAG_POP_SOUND=!this.FLAG_POP_SOUND,this.FLAG_POP_SOUND&&SoundManager.getInstance().playSound(SoundEnum.BURST2SOUND_MP3),Util.loopPlay(this.pop_boom_action),this.pop_drop_action.nextFrame()),this.FLAG_OPEN_COVER&&this.FLAG_TASTE_POP===!1&&(this.boy.currentFrame===this.boy.totalFrames&&(this.FLAG_TASTE_POP=!0,this.cover.visible=!0,this.taste_pop()),this.boy.nextFrame(),this.pop_clear_action.nextFrame()),this.FLAG_TASTE_POP&&(this.boy.totalFrames===this.boy.currentFrame&&(StageController.getInstance().clearStage(this.STAGE_ID,[2]),this.FLAG_CLEAR=!0),Util.loopPlay(this.boy)))},e.prototype._remove=function(){egret.Tween.removeAllTweens()},e.prototype.showDragGuide=function(){ItemCtrlView.getInstance().showDragGuide(this.localToGlobal(this.pot.x).x,this.localToGlobal(this.pot.x,this.pot.y).y)},e.prototype.registItem=function(t){t===ItemEnum.ITEM_COVER&&(this.FLAG_COVER_GOT=!0)},e.prototype.useItem=function(t,e,i){return t===ItemEnum.ITEM_COVER&&this.FLAG_COVER_CAN_USE===!0?this.pot.hitTestPoint(e,i)?(this.FLAG_COVER_USED=!0,this.cover_on.visible=!0,this.pop_clear_action.visible=!0,GuideController.getInstance().guidePassed||(this.FLAG_DRAG_GUIDE=!1,this.guide_word.visible=!1,ItemCtrlView.getInstance().finishDragGuide()),!0):(this.showDragGuide(),!1):!1},e.prototype.getDisplayArea=function(){return new egret.Rectangle},e.prototype.ctrl_right=function(){},e.prototype.ctrl_left=function(){},e.prototype.ctrl_up=function(){},e.prototype.ctrl_down=function(){},e.prototype.ctrl_ok=function(){},e.prototype.ctrl_cancel=function(){},e}(egret.DisplayObjectContainer);__reflect(Stage1.prototype,"Stage1",["IFKaihiStage"]);var Stage10=function(t){function e(){var e=t.call(this)||this;return e.STAGE_ID=10,e.FLAG_IS_INITED=!1,e.FLAG_BOTTLE_GOT=!1,e.FLAG_BOY_WITH_SHOE=!1,e.FLAG_ICE_REPAIRED=!1,e.FLAG_GO_TOUCHED=!1,e.FLAG_FAIL_ROTATION=!1,e.FLAG_FAIL_CRASH=!1,e.FLAG_CLEAR=!1,e.FLAG_GAME_OVER=!1,e.HELP_ROTATION=0,e.HELP_DROP_IN_WATER=0,e.HELP_POUR_WATER=0,e.HELP_REPAIR_ICE=0,e.COUNTER_CLEAR=0,e.COUNTER_GAMEOVER=0,e.FALL_DOWN_X=180.5,e.CRASH_X=312.6,e.CLEAR_X=400,e.HOUSE_DOOR_CLOSED=1,e.HOUSE_DOOR_OPEN_BOTTLE_IN=2,e.HOUSE_DOOR_OPEN_BOTTLE_OUT=3,e.cards=[],e._init(),e}return __extends(e,t),e.prototype._init=function(){return __awaiter(this,void 0,void 0,function(){var t,e;return __generator(this,function(i){switch(i.label){case 0:return UIManager.getInstance().showLoading(),[4,this._loadRes()];case 1:return i.sent(),this.sheet=RES.getRes("stage10_texture"),t=new TSBitmap("bg",this.sheet),t.x=-120,t.y=-100,this.addChild(t),this.mcFactory=new egret.MovieClipDataFactory(RES.getRes("stage10_action_json"),RES.getRes("stage10_action_png")),this.house=new egret.MovieClip(this.mcFactory.generateMovieClipData("house")),this.house.x=507.5,this.house.y=409.45,this.house.gotoAndStop(this.HOUSE_DOOR_CLOSED),this.house.touchEnabled=!0,this.addChild(this.house),this.shoe=new TSBitmap("shoe",this.sheet,!0),this.shoe.x=250.45,this.shoe.y=575.2,this.shoe.touchEnabled=!0,this.addChild(this.shoe),this.liebing=new egret.MovieClip(this.mcFactory.generateMovieClipData("liebing")),this.liebing.x=320,this.liebing.y=784.35,this.liebing.gotoAndStop(1),this.addChild(this.liebing),this.green=new egret.MovieClip(this.mcFactory.generateMovieClipData("green_stand")),this.green.x=495.65,this.green.y=633.8,this.green.gotoAndStop(1),this.addChild(this.green),this.red=new egret.MovieClip(this.mcFactory.generateMovieClipData("red_stand")),this.red.x=575.45,this.red.y=650.75,this.red.gotoAndStop(1),this.addChild(this.red),this.boy=new egret.MovieClip(this.mcFactory.generateMovieClipData("sh_stand")),this.boy.x=68,this.boy.y=650.6,this.addChild(this.boy),this.touchEnabled=!0,this.boy.gotoAndStop(1),this.goButton=new TSBitmap("go",this.sheet,!0),this.goButton.x=320,this.goButton.y=870,this.goButton.touchEnabled=!0,this.addChild(this.goButton),this.together=new TSBitmap("together",this.sheet,!0),this.together.x=444.5,this.together.y=668.8,this.together.visible=!1,this.addChild(this.together),e=new egret.MovieClipDataFactory(RES.getRes("stage10_crash_json"),RES.getRes("stage10_crash_png")),this.crash=new egret.MovieClip(e.generateMovieClipData("drop")),this.crash.x=320.7,this.crash.y=800.75,this.crash.visible=!1,this.addChild(this.crash),this.iceArea=new egret.Shape,this.iceArea.graphics.beginFill(0),this.iceArea.graphics.drawRect(227.7,645.6,180,152),this.iceArea.graphics.endFill(),this.iceArea.alpha=0,this.iceArea.touchEnabled=!0,this.addChild(this.iceArea),this.togetherMask=new egret.Shape,this.togetherMask.graphics.beginFill(0),this.togetherMask.graphics.drawRect(213.1,465.55,420.55,361.05),this.togetherMask.graphics.endFill(),this.togetherMask.alpha=0,this.addChild(this.togetherMask),this.goButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.goTouched,this),this.addAllEventListener(),this.FLAG_IS_INITED=!0,UIManager.getInstance().hideLoading(),[2]}})})},e.prototype.addAllEventListener=function(){this.boy.touchEnabled=!0,this.shoe.touchEnabled=!0,this.iceArea.touchEnabled=!0,this.house.touchEnabled=!0,this.house.addEventListener(egret.TouchEvent.TOUCH_TAP,this.houseTouched,this),this.shoe.addEventListener(egret.TouchEvent.TOUCH_TAP,this.shoeTouched,this)},e.prototype.removeAllEventListener=function(){this.house.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.houseTouched,this),this.shoe.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.shoeTouched,this),this.boy.touchEnabled=!1,this.shoe.touchEnabled=!1,this.iceArea.touchEnabled=!1,this.house.touchEnabled=!1},e.prototype.houseTouched=function(){this.house.currentFrame===this.HOUSE_DOOR_CLOSED?(SoundManager.getInstance().playSound(SoundEnum.DOOROPENSOUND_MP3),this.FLAG_BOTTLE_GOT?this.house.gotoAndStop(this.HOUSE_DOOR_OPEN_BOTTLE_OUT):this.house.gotoAndStop(this.HOUSE_DOOR_OPEN_BOTTLE_IN)):this.house.currentFrame===this.HOUSE_DOOR_OPEN_BOTTLE_IN?this.registItem(ItemEnum.ITEM_BOTTLE):this.house.currentFrame===this.HOUSE_DOOR_OPEN_BOTTLE_OUT&&(SoundManager.getInstance().playSound(SoundEnum.DOOROPENSOUND_MP3),this.house.gotoAndStop(this.HOUSE_DOOR_CLOSED))},e.prototype.shoeTouched=function(){this.registItem(ItemEnum.ITEM_ICESHOES)},e.prototype.goTouched=function(){this.removeAllEventListener(),this.goButton.touchEnabled=!1,this.goButton.visible=!1,this.goButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.goTouched,this),this.FLAG_GO_TOUCHED=!0,this.FLAG_BOY_WITH_SHOE||(this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_walk"))},e.prototype._loadRes=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,StageController.getInstance().loadStage(10)];case 1:return e.sent(),[3,3];case 2:return t=e.sent(),console.error(t),[3,3];case 3:return[2]}})})},e.prototype._start=function(){},e.prototype.play_loop=function(){var t=this;if(this.FLAG_IS_INITED){if(1===this.HELP_POUR_WATER?this.boy.currentFrame===this.boy.totalFrames&&(SoundManager.getInstance().playSound(SoundEnum.FREEZESOUND_MP3),this.HELP_POUR_WATER=2):2===this.HELP_POUR_WATER&&this.COUNTER_GAMEOVER++,this.FLAG_GAME_OVER)return this.COUNTER_GAMEOVER++,15===this.COUNTER_GAMEOVER&&SoundManager.getInstance().playSound(SoundEnum.BOKESOUND_MP3),void(this.COUNTER_GAMEOVER>=45&&StageController.getInstance().gameOverStage(this.STAGE_ID,this.cards));60===this.COUNTER_GAMEOVER&&StageController.getInstance().gameOverStage(this.STAGE_ID,this.cards),60===this.COUNTER_CLEAR&&(Util.singletonPush(this.cards,43),StageController.getInstance().clearStage(this.STAGE_ID,this.cards)),1===this.HELP_REPAIR_ICE&&this.repairIce.currentFrame===this.repairIce.totalFrames&&(SoundManager.getInstance().playSound(SoundEnum.FREEZESOUND_MP3),this.repairIce.visible=!1,this.liebing.visible=!1,this.HELP_REPAIR_ICE=2),this.FLAG_GO_TOUCHED?this.FLAG_FAIL_ROTATION?(0===this.HELP_ROTATION&&(egret.Tween.get(this.boy).to({x:219.15},500,egret.Ease.quadOut),egret.Tween.get(this.boy).to({y:712.95},500,egret.Ease.quadIn).call(function(){SoundManager.getInstance().playSound(SoundEnum.KICKSOUND_MP3),t.boy.play(-1),t.HELP_ROTATION=2}),this.HELP_ROTATION=1),2===this.HELP_ROTATION&&(0===this.COUNTER_GAMEOVER&&SoundManager.getInstance().playSound(SoundEnum.BOKESOUND_MP3),this.COUNTER_GAMEOVER++)):this.FLAG_FAIL_CRASH?1===this.HELP_DROP_IN_WATER?(this.liebing.visible=!1,this.crash.visible=!0,this.crash.currentFrame==this.crash.totalFrames?this.FLAG_GAME_OVER=!0:this.crash.currentFrame>10?this.together.visible=!1:10===this.crash.currentFrame?SoundManager.getInstance().playSound(SoundEnum.WATERSOUND_MP3):this.crash.currentFrame>=5&&(this.together.y+=24,this.together.mask=this.togetherMask),5===this.crash.currentFrame&&SoundManager.getInstance().playSound(SoundEnum.DONSOUND_MP3),this.crash.nextFrame()):(this.liebing.currentFrame===this.liebing.totalFrames&&(this.together.visible=!0,this.boy.visible=!1,this.green.visible=!1,this.red.visible=!1,this.together.y++,this.HELP_DROP_IN_WATER=1,1!=this.HELP_DROP_IN_WATER&&SoundManager.getInstance().playSound(SoundEnum.DONSOUND_MP3)),this.liebing.nextFrame()):this.FLAG_CLEAR?(this.COUNTER_CLEAR++,this.COUNTER_CLEAR>=30&&(this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_clear"),this.red.movieClipData=this.mcFactory.generateMovieClipData("red_clear"),this.green.movieClipData=this.mcFactory.generateMovieClipData("green_clear"))):this.FLAG_BOY_WITH_SHOE?(this.boy.x+=10,this.FLAG_ICE_REPAIRED?this.boy.x>=this.CLEAR_X&&(this.FLAG_CLEAR=!0):this.boy.x>=this.CRASH_X&&(Util.singletonPush(this.cards,41),SoundManager.getInstance().playSound(SoundEnum.GLASSBREAK2SOUND_MP3),this.FLAG_FAIL_CRASH=!0)):(Util.loopPlay(this.boy),this.boy.x+=5,this.boy.x>=this.FALL_DOWN_X&&(SoundManager.getInstance().playSound(SoundEnum.SUBERISOUND_MP3),this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_rotation"),this.boy.gotoAndStop(1),this.boy.x=194.2,this.boy.y=647.95,this.FLAG_FAIL_ROTATION=!0,Util.singletonPush(this.cards,40))):(Util.loopPlay(this.green),Util.loopPlay(this.red))}},e.prototype._remove=function(){egret.Tween.removeAllTweens()},e.prototype.registItem=function(t){ItemController.getInstance().addItem(t)&&(t===ItemEnum.ITEM_ICESHOES&&(this.shoe.visible=!1),t===ItemEnum.ITEM_BOTTLE&&(this.FLAG_BOTTLE_GOT=!0,this.house.gotoAndStop(this.HOUSE_DOOR_OPEN_BOTTLE_OUT)))},e.prototype.useItem=function(t,e,i){switch(t){case ItemEnum.ITEM_BOTTLE:return this.boy.hitTestPoint(e,i)?(Util.singletonPush(this.cards,42),this.FLAG_BOY_WITH_SHOE?(SoundManager.getInstance().playSound(SoundEnum.WATER8SOUND_MP3),this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_water2"),this.boy.play(),this.HELP_POUR_WATER=1):(SoundManager.getInstance().playSound(SoundEnum.WATER8SOUND_MP3),this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_water1"),this.boy.play(),this.HELP_POUR_WATER=1),!0):this.iceArea.hitTestPoint(e,i)?(SoundManager.getInstance().playSound(SoundEnum.WATER8SOUND_MP3),this.repairIce=new egret.MovieClip(this.mcFactory.generateMovieClipData("ice_water")),this.repairIce.x=320.35,this.repairIce.y=683.8,this.addChildAt(this.repairIce,this.getChildIndex(this.boy)),this.repairIce.play(),this.FLAG_ICE_REPAIRED=!0,this.HELP_REPAIR_ICE=1,!0):!1;case ItemEnum.ITEM_ICESHOES:return this.boy.hitTestPoint(e,i)?(this.FLAG_BOY_WITH_SHOE=!0,this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_stand2"),!0):!1}return!1},e.prototype.getDisplayArea=function(){return new egret.Rectangle},e.prototype.ctrl_right=function(){},e.prototype.ctrl_left=function(){},e.prototype.ctrl_up=function(){},e.prototype.ctrl_down=function(){},e.prototype.ctrl_ok=function(){},e.prototype.ctrl_cancel=function(){},e}(egret.DisplayObjectContainer);__reflect(Stage10.prototype,"Stage10",["IFKaihiStage"]);var Stage11=function(t){function e(){var e=t.call(this)||this;return e.stageID=11,e.FLAG_BOLOON_FLY=!1,e.FLAG_BOY_CLIMBING=!1,e.FLAG_CAT_APPEAR=!1,e.FLAG_GOT_THE_BOLOON=!1,e.FLAG_GAME_CLEAR=!1,e.FLAG_GAMEOVER=!1,e.FLAG_BOLOON_BURST=!1,e.FLAG_CAT_RUN=!1,e.BROTHER_IN_TREE=!1,e.HELP_ROTATION_CHANGE=1,e.MVHELP_LADDER_BAD=0,e.COUNTER_CLIMBING=0,e.COUNTER_ROTATION_TIMES=0,e.COUNTER_OVER=0,e.cards=[],e._init(),e}return __extends(e,t),e.prototype._init=function(){return __awaiter(this,void 0,void 0,function(){var t,e,i,s;return __generator(this,function(h){switch(h.label){case 0:return UIManager.getInstance().showLoading(),[4,this._loadRes()];case 1:return h.sent(),this.mcFactory=new egret.MovieClipDataFactory(RES.getRes("stage11_action_json"),RES.getRes("stage11_action_png")),this.sheet=RES.getRes("stage11_texture"),t=new TSBitmap("bg",this.sheet),t.x=-120,t.y=-100,this.addChild(t),e=new TSBitmap("garden",this.sheet,!0),e.x=320,e.y=1005,this.addChild(e),i=new TSBitmap("tree",this.sheet),i.x=-156.6,i.y=33.8,this.addChild(i),this.ladder=new TSBitmap("ladder",this.sheet,!0),this.ladder.x=456.2,this.ladder.y=630.1,this.ladder.scaleX=this.ladder.scaleY=.78,this.ladder.rotation=8.8,this.ladder.touchEnabled=!0,this.addChild(this.ladder),s=new TSBitmap("house",this.sheet),s.x=402,s.y=144.6,this.addChild(s),this.branch=new TSBitmap("branch",this.sheet,!0),this.branch.x=299.5,this.branch.y=405,this.branch.touchEnabled=!0,this.addChild(this.branch),this.boloon=new egret.MovieClip(this.mcFactory.generateMovieClipData("baloon_mc")),this.boloon.x=323.25,this.boloon.y=357.1,this.boloon.play(-1),this.boloon.touchEnabled=!0,this.addChild(this.boloon),this.cat=new egret.MovieClip(this.mcFactory.generateMovieClipData("neko_tail")),this.cat.x=99.1,this.cat.y=384.7,this.cat.play(-1),this.cat.touchEnabled=!0,this.addChild(this.cat),this.brother=new TSBitmap("ototo",this.sheet,!0),this.brother.x=545.15,this.brother.y=750,this.brother.touchEnabled=!0,this.addChild(this.brother),this.boy=new egret.MovieClip(this.mcFactory.generateMovieClipData("sh_jump")),this.boy.x=332.85,this.boy.y=698.95,this.boy.play(),this.boy.touchEnabled=!0,this.addChild(this.boy),this.leaves=new TSBitmap("nekoleaf",this.sheet,!0),this.leaves.x=61.5,this.leaves.y=332,this.addChild(this.leaves),this.treeArea=new egret.Shape,this.treeArea.graphics.beginFill(255),this.treeArea.graphics.drawRect(72.35,611.3-160,130,320),this.treeArea.graphics.endFill(),this.treeArea.touchEnabled=!0,this.treeArea.alpha=0,this.addChild(this.treeArea),this.catArea=new egret.Shape,this.catArea.graphics.beginFill(255),this.catArea.x=this.cat.x,this.catArea.y=this.cat.y,this.catArea.graphics.drawRect(-53,-60,106,120),this.catArea.graphics.endFill(),this.catArea.touchEnabled=!0,this.catArea.alpha=0,this.addChild(this.catArea),this.addAllEventListener(),this.boy_jump(),UIManager.getInstance().hideLoading(),[2]}})})},e.prototype.addAllEventListener=function(){this.boloon.addEventListener(egret.TouchEvent.TOUCH_TAP,this.boloonTouche,this),this.boy.addEventListener(egret.TouchEvent.TOUCH_TAP,this.boyTouched,this),this.treeArea.addEventListener(egret.TouchEvent.TOUCH_TAP,this.treeTouched,this),this.ladder.addEventListener(egret.TouchEvent.TOUCH_TAP,this.ladderTouched,this),this.catArea.addEventListener(egret.TouchEvent.TOUCH_TAP,this.catTouched,this),this.brother.addEventListener(egret.TouchEvent.TOUCH_TAP,this.ototoTouched,this)},e.prototype.removeAllEventListener=function(){this.boloon.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.boloonTouche,this),this.boy.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.boyTouched,this),this.treeArea.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.treeTouched,this),this.ladder.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.ladderTouched,this),this.catArea.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.catTouched,this),this.brother.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.ototoTouched,this)},e.prototype.boyTouched=function(){this.boy_jump()},e.prototype.boloonTouche=function(){var t=this;this.boloon.touchEnabled=!1,SoundManager.getInstance().playSound(SoundEnum.PUYONSOUND_MP3),this.boloon.movieClipData=this.mcFactory.generateMovieClipData("baloon_fly_mc"),this.boloon.play(-1),egret.Tween.get(this.boloon).to({y:-100},1e3).call(function(){t.boy.movieClipData=t.mcFactory.generateMovieClipData("sh_bad1"),t.boy.play(-1),t.FLAG_GAMEOVER=!0}).wait(500).call(function(){Util.singletonPush(t.cards,44),StageController.getInstance().gameOverStage(t.stageID,t.cards)})},e.prototype.catTouched=function(){var t=this;this.FLAG_CAT_APPEAR?(this.removeAllEventListener(),this.cat.x=150.8,this.cat.gotoAndStop(1),this.FLAG_CAT_RUN=!0,Util.singletonPush(this.cards,45)):(SoundManager.getInstance().playSound(SoundEnum.BUSHSOUND_MP3),egret.Tween.get(this.cat).to({x:74.1,y:349.7},500).call(function(){t.cat.movieClipData=t.mcFactory.generateMovieClipData("neko_run"),t.cat.gotoAndStop(1),t.cat.x=t.catArea.x=130.8,t.cat.y=t.catArea.y=312.3,SoundManager.getInstance().playSound(SoundEnum.CATSOUND_MP3),t.FLAG_CAT_APPEAR=!0}),egret.Tween.get(this.leaves).to({x:56.5},100).to({x:66.5},200).to({x:56.5},200).to({x:66.5},200).to({x:61.5},100))},e.prototype.treeTouched=function(){this.removeAllEventListener(),this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_climb"),this.boy.x=192.5,this.boy.y=704.3,this.boy.play(-1),this.FLAG_BOY_CLIMBING=!0,Util.singletonPush(this.cards,49)},e.prototype.ladderTouched=function(){this.registItem(ItemEnum.ITEM_LADDER)},e.prototype.ototoTouched=function(){this.registItem(ItemEnum.ITEM_BROTHER)},e.prototype._loadRes=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,StageController.getInstance().loadStage(11)];case 1:return e.sent(),[3,3];case 2:return t=e.sent(),console.error(t),[3,3];case 3:return[2]}})})},e.prototype.boy_jump=function(){var t=this;this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_jump"),egret.Tween.get(this.boy).to({y:655.45},500).call(function(){t.boy.play()},this).to({y:699.45},100).to({y:655.45},500).call(function(){t.boy.play()},this).to({y:699.45},100).call(function(){t.boy.movieClipData=t.mcFactory.generateMovieClipData("sh_stand")})},e.prototype.branch_rotation=function(t){this.branch.rotation>=.5?this.HELP_ROTATION_CHANGE=-.1:this.branch.rotation<0&&(this.HELP_ROTATION_CHANGE=.1,this.COUNTER_ROTATION_TIMES++),this.branch.rotation+=this.HELP_ROTATION_CHANGE,t.rotation+=this.HELP_ROTATION_CHANGE},e.prototype._start=function(){},e.prototype.play_loop=function(){this.FLAG_GAMEOVER?(1===this.COUNTER_OVER&&SoundManager.getInstance().playSound(SoundEnum.BOKESOUND_MP3),30===this.COUNTER_OVER&&(console.log("1111111"),StageController.getInstance().gameOverStage(this.stageID,this.cards)),this.COUNTER_OVER++):this.FLAG_GAME_CLEAR?(30===this.COUNTER_OVER&&StageController.getInstance().clearStage(this.stageID,this.cards),this.COUNTER_OVER++):(this.BROTHER_IN_TREE&&(this.branch_rotation(this.brother),this.COUNTER_ROTATION_TIMES>2&&(this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_bad1"),this.boy.play(-1),this.boloon_fly(),this.BROTHER_IN_TREE=!1)),2===this.MVHELP_LADDER_BAD&&(this.branch_rotation(this.boy),this.COUNTER_ROTATION_TIMES>2&&(this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_bad3"),this.boy.play(-1),this.MVHELP_LADDER_BAD=3,this.boloon_fly())),1===this.MVHELP_LADDER_BAD&&this.boy.currentFrame===this.boy.totalFrames&&(this.MVHELP_LADDER_BAD=2,SoundManager.getInstance().playSound(SoundEnum.KISHIMISOUND_MP3)),this.FLAG_BOLOON_BURST&&(this.boloon.y+=5,this.boy.hitTestPoint(this.boloon.localToGlobal().x,this.boloon.localToGlobal().y)&&(this.boloon.visible=!1,this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_bad2"),this.FLAG_GAMEOVER=!0)),this.FLAG_CAT_RUN&&(40===this.cat.currentFrame&&(this.boloon.movieClipData=this.mcFactory.generateMovieClipData("baloon_burst"),SoundManager.getInstance().playSound(SoundEnum.BURSTSOUND_MP3),this.FLAG_BOLOON_BURST=!0),this.cat.nextFrame()),this.FLAG_GOT_THE_BOLOON&&(55===this.boy.currentFrame&&(this.boloon.visible=!1),this.boy.totalFrames===this.boy.currentFrame&&(this.boy.movieClipData=this.mcFactory.generateMovieClipData("clear"),this.boy.x+=10.9,this.boy.y+=-34.1,this.boy.play(),this.FLAG_GAME_CLEAR=!0)),this.FLAG_BOY_CLIMBING&&(this.COUNTER_CLIMBING>=60&&(this.COUNTER_CLIMBING=0,this.FLAG_BOY_CLIMBING=!1,this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_stand"),this.boy.x=332.85,this.boy.y=698.95,this.addAllEventListener()),this.COUNTER_CLIMBING>30?this.boy.y--:30===this.COUNTER_CLIMBING?this.boy.y=698.95:this.boy.y--,this.COUNTER_CLIMBING++))},e.prototype._remove=function(){egret.Tween.removeAllTweens()},e.prototype.registItem=function(t){ItemController.getInstance().addItem(t)&&(t===ItemEnum.ITEM_LADDER&&(this.ladder.visible=!1),t===ItemEnum.ITEM_BROTHER&&(this.brother.visible=!1))},e.prototype.useItem=function(t,e,i){switch(t){case ItemEnum.ITEM_LADDER:return this.treeArea.hitTestPoint(e,i)?(this.removeAllEventListener(),this.ladder.touchEnabled=!1,this.ladder.scaleX=this.ladder.scaleY=1,this.ladder.texture=this.sheet.getTexture("ladderbytree"),this.ladder.rotation=0,this.ladder.visible=!0,this.ladder.x=194.85,this.ladder.y=661.2,this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_ladder"),this.boy.x=194.85,this.boy.y=661.2,this.boy.play(),this.MVHELP_LADDER_BAD=1,Util.singletonPush(this.cards,46),!0):!1;case ItemEnum.ITEM_BROTHER:return this.boy.hitTestPoint(e,i)?(this.removeAllEventListener(),this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_jump2"),this.boy.x=306.95,this.boy.y=673.5,this.boy.play(),this.FLAG_GOT_THE_BOLOON=!0,Util.singletonPush(this.cards,48),!0):this.branch.hitTestPoint(e,i)?(this.brother.texture=this.sheet.getTexture("ototointree"),this.brother.x=175.5+this.brother.width/2,this.brother.y=298.75+this.brother.height/2,this.brother.visible=!0,this.brother.touchEnabled=!1,SoundManager.getInstance().playSound(SoundEnum.KISHIMISOUND_MP3),this.BROTHER_IN_TREE=!0,Util.singletonPush(this.cards,47),!0):!1}return!1},e.prototype.boloon_fly=function(){var t=this;this.boloon.movieClipData=this.mcFactory.generateMovieClipData("baloon_fly_mc"),this.boloon.play(-1),egret.Tween.get(this.boloon).to({y:-100},2500).wait(500).call(function(){t.FLAG_GAMEOVER=!0,StageController.getInstance().gameOverStage(t.stageID,t.cards)
})},e.prototype.getDisplayArea=function(){return new egret.Rectangle},e.prototype.ctrl_right=function(){},e.prototype.ctrl_left=function(){},e.prototype.ctrl_up=function(){},e.prototype.ctrl_down=function(){},e.prototype.ctrl_ok=function(){},e.prototype.ctrl_cancel=function(){},e}(egret.DisplayObjectContainer);__reflect(Stage11.prototype,"Stage11",["IFKaihiStage"]);var Stage12=function(t){function e(){var e=t.call(this)||this;return e.stageID=12,e.FLAG_INITED=!1,e.FLAG_WAITING_FOR_BILL=!1,e.FLAG_BOSS_TO_GET_FOOD=!1,e.FLAG_BOY_GOT_FOOD=!1,e.FLAG_GOT_FOOD_TYPE=0,e.FLAG_ELECTRONE_TO_RIGHT=!0,e.FLAG_GREEN_EATING=!0,e.FLAG_RED_EATING=!0,e.FLAG_SH_EATING=!1,e.FLAG_END_GAMEOVER=!1,e.FLAG_END_CLEAR=!1,e.COUNTER_END=0,e.cards=[],e.FOOD_1_FRAME=0,e.FOOD_2_FRAME=0,e.FOOD_3_FRAME=0,e.FOOD_4_FRAME=0,e._init(),e}return __extends(e,t),e.prototype._init=function(){return __awaiter(this,void 0,void 0,function(){var t,e,i,s,h,a,o,n;return __generator(this,function(r){switch(r.label){case 0:return UIManager.getInstance().showLoading(),[4,this._loadRes()];case 1:return r.sent(),this.mcFactory=new egret.MovieClipDataFactory(RES.getRes("stage12_action_json"),RES.getRes("stage12_action_png")),this.sheet=RES.getRes("stage12_texture"),t=new TSBitmap("bg",this.sheet),t.x=-120,t.y=-100,this.addChild(t),this.moyu=new TSBitmap("moyu",this.sheet,!0),this.hanzi=new TSBitmap("hanzi",this.sheet,!0),this.fish=new TSBitmap("fish",this.sheet,!0),this.tea=new TSBitmap("tea",this.sheet,!0),this.moyu.x=48.15,this.hanzi.x=149.35,this.fish.x=250.55,this.tea.x=351.75,this.hanzi.y=this.moyu.y=this.fish.y=this.tea.y=222.45,this.hanzi.touchEnabled=this.moyu.touchEnabled=this.fish.touchEnabled=this.tea.touchEnabled=!0,this.addChild(this.moyu),this.addChild(this.hanzi),this.addChild(this.fish),this.addChild(this.tea),this.arrow=new TSBitmap("arrow",this.sheet,!0),this.arrow.y=328.35,this.arrow.visible=!1,this.addChild(this.arrow),e=new TSBitmap("stomach",this.sheet),e.x=484.25,e.y=176,this.addChild(e),i=new TSBitmap("prgsbg",this.sheet),i.x=482.25,i.y=229,this.addChild(i),this.prgsShape=new egret.Shape,this.prgsShape.x=508.25,this.prgsShape.y=320,this.prgsShape.graphics.beginFill(3394815),this.prgsShape.graphics.drawRect(-21.1,-85,42,170),this.prgsShape.graphics.endFill(),this.addChild(this.prgsShape),s=new egret.Shape,s.graphics.beginFill(0),s.graphics.drawRect(487.15,235,42,170),s.graphics.endFill(),s.alpha=0,this.addChild(s),this.prgsShape.mask=s,h=new TSBitmap("prgs",this.sheet),h.x=482.25,h.y=229,this.addChild(h),a=new TSBitmap("plants",this.sheet),a.x=-4,a.y=554,this.addChild(a),this.green=new egret.MovieClip(this.mcFactory.generateMovieClipData("green_eat")),this.addChild(this.green),this.green.gotoAndStop(1),this.red=new egret.MovieClip(this.mcFactory.generateMovieClipData("red_eat")),this.addChild(this.red),this.red.gotoAndStop(1),o=new TSBitmap("plants",this.sheet),o.x=186,o.y=554,this.addChild(o),this.boy=new egret.MovieClip(this.mcFactory.generateMovieClipData("sh_stand")),this.addChild(this.boy),this.boy.gotoAndStop(1),n=new TSBitmap("desk",this.sheet,!0),n.x=320,n.y=848.65,this.addChild(n),this.electron=new TSBitmap("ele",this.sheet,!0),this.electron.x=320,this.electron.y=685.4,this.addChild(this.electron),this.food1=new egret.MovieClip(this.mcFactory.generateMovieClipData("food")),this.food1.x=203,this.food1.y=this.electron.y,this.addChild(this.food1),this.food2=new egret.MovieClip(this.mcFactory.generateMovieClipData("food")),this.food2.x=83.2,this.food2.y=this.electron.y,this.addChild(this.food2),this.food3=new egret.MovieClip(this.mcFactory.generateMovieClipData("food")),this.food3.x=-36.6,this.food3.y=this.electron.y,this.addChild(this.food3),this.food4=new egret.MovieClip(this.mcFactory.generateMovieClipData("food")),this.food4.x=-156.4,this.food4.y=this.electron.y,this.addChild(this.food4),this.green_part=new egret.MovieClip(this.mcFactory.generateMovieClipData("green_part")),this.green.x=this.green_part.x=126.8,this.green.y=this.green_part.y=563.25,this.green_part.visible=!1,this.green_part.gotoAndStop(1),this.red_part=new egret.MovieClip(this.mcFactory.generateMovieClipData("red_part")),this.red.x=this.red_part.x=309.65,this.red.y=this.red_part.y=559.25,this.red_part.visible=!1,this.red_part.gotoAndStop(1),this.boy_part=new egret.MovieClip(this.mcFactory.generateMovieClipData("sh_part")),this.boy.x=this.boy_part.x=506.8,this.boy.y=this.boy_part.y=563.25,this.boy_part.visible=!1,this.boy_part.gotoAndStop(1),this.addChild(this.boy_part),this.addChild(this.red_part),this.addChild(this.green_part),this.rebar=new egret.MovieClip(this.mcFactory.generateMovieClipData("rebar")),this.rebar.x=321.75,this.rebar.y=887.15,this.rebar.gotoAndStop(5),this.rebar.touchEnabled=!0,this.addChild(this.rebar),this.board=new TSBitmap("board",this.sheet,!0),this.board.x=321.75,this.board.y=887.15,this.board.touchEnabled=!0,this.addChild(this.board),this.boss=new egret.MovieClip(this.mcFactory.generateMovieClipData("vator_run")),this.boss.x=321.85,this.boss.y=901.9,this.boss.gotoAndStop(1),this.addChild(this.boss),this.bossBack=new egret.MovieClip(this.mcFactory.generateMovieClipData("vator_back")),this.bossBack.x=509.5,this.bossBack.y=1231.5,this.bossBack.visible=!1,this.addChild(this.bossBack),this.addAllEventListener(),this.board.addEventListener(egret.TouchEvent.TOUCH_TAP,this.boardTouched,this),this.rebar.addEventListener(egret.TouchEvent.TOUCH_TAP,this.rebarTouched,this),UIManager.getInstance().hideLoading(),this.FLAG_INITED=!0,[2]}})})},e.prototype.addAllEventListener=function(){this.moyu.addEventListener(egret.TouchEvent.TOUCH_TAP,this.moyuTouched,this),this.hanzi.addEventListener(egret.TouchEvent.TOUCH_TAP,this.hanziTouched,this),this.fish.addEventListener(egret.TouchEvent.TOUCH_TAP,this.fishTouched,this),this.tea.addEventListener(egret.TouchEvent.TOUCH_TAP,this.teaTouched,this)},e.prototype.removeAllEventListener=function(){this.moyu.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.moyuTouched,this),this.hanzi.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.hanziTouched,this),this.fish.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.fishTouched,this),this.tea.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.teaTouched,this)},e.prototype.boardTouched=function(t){var e=this;this.FLAG_BOSS_TO_GET_FOOD&&(SoundManager.getInstance().playSound(SoundEnum.OPEN2SOUND_MP3),egret.Tween.get(this.board).to({rotation:15},300).to({y:987.15,alpha:0},500).call(function(){e.board.visible=!1}))},e.prototype.rebarTouched=function(t){this.rebar.touchEnabled=!1,SoundManager.getInstance().playSound(SoundEnum.METAL4SOUND_MP3),this.removeAllEventListener(),this.rebar.play(),this.green_part.visible=!1,this.green.movieClipData=this.mcFactory.generateMovieClipData("green_drink"),this.green.play(-1),this.green_part.visible=!1,this.FLAG_SH_EATING=!0,this.FLAG_ELECTRONE_TO_RIGHT=!1},e.prototype.moyuTouched=function(t){this.removeAllEventListener(),this.FLAG_GOT_FOOD_TYPE=1,this.bossGetFood(t.target),Util.singletonPush(this.cards,51)},e.prototype.hanziTouched=function(t){this.removeAllEventListener(),this.FLAG_GOT_FOOD_TYPE=2,this.bossGetFood(t.target),Util.singletonPush(this.cards,52)},e.prototype.fishTouched=function(t){this.removeAllEventListener(),this.FLAG_GOT_FOOD_TYPE=3,this.bossGetFood(t.target),Util.singletonPush(this.cards,53)},e.prototype.teaTouched=function(t){this.removeAllEventListener(),this.FLAG_GOT_FOOD_TYPE=0,this.bossGetFood(t.target),Util.singletonPush(this.cards,55)},e.prototype.bossGetFood=function(t){this.FLAG_WAITING_FOR_BILL=!0,this.rebar.touchEnabled=!0,this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_wait"),this.FLAG_BOSS_TO_GET_FOOD=!0,this.arrow.x=t.x,this.arrow.visible=!0,this.boss.gotoAndPlay(2)},e.prototype.ele2Left=function(){egret.Tween.get(this.electron,{loop:!0}).to({x:245},1e3).to({x:320}),egret.Tween.get(this.food1,{loop:!0}).to({x:245},1e3).to({x:320}),egret.Tween.get(this.food1,{loop:!0}).to({x:245},1e3).to({x:320}),egret.Tween.get(this.food1,{loop:!0}).to({x:245},1e3).to({x:320}),egret.Tween.get(this.food1,{loop:!0}).to({x:245},1e3).to({x:320})},e.prototype.ele2Right=function(){var t=this;egret.Tween.get(this.electron,{loop:!0}).to({x:395},1e3).to({x:320}),egret.Tween.get(this.food1).to({x:223},250).call(function(){egret.Tween.get(t.food1,{loop:!0}).to({x:223},3e3).to({x:-156.4})},this.food1),egret.Tween.get(this.food2).to({x:223},500).call(function(){egret.Tween.get(t.food2,{loop:!0}).to({x:223},3e3).to({x:-156.4})},this.food2),egret.Tween.get(this.food3).to({x:223},750).call(function(){egret.Tween.get(t.food3,{loop:!0}).to({x:223},3e3).to({x:-156.4})},this.food3),egret.Tween.get(this.food4).to({x:223},1e3).call(function(){egret.Tween.get(t.food4,{loop:!0}).to({x:223},3e3).to({x:-156.4})},this.food4)},e.prototype._loadRes=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,StageController.getInstance().loadStage(this.stageID)];case 1:return e.sent(),[3,3];case 2:return t=e.sent(),console.error(t),[3,3];case 3:return[2]}})})},e.prototype._start=function(){},e.prototype.play_loop=function(){var t=this;if(this.FLAG_INITED){if(this.FLAG_END_GAMEOVER||this.FLAG_END_CLEAR)return this.COUNTER_END++,void(this.COUNTER_END>60&&(this.FLAG_END_GAMEOVER&&StageController.getInstance().gameOverStage(this.stageID,this.cards),this.FLAG_END_CLEAR&&StageController.getInstance().clearStage(this.stageID,this.cards)));this.FLAG_ELECTRONE_TO_RIGHT?(this.electron.x++,0===this.FOOD_1_FRAME?(this.food1.x+=5,this.food1.x>203&&(this.FOOD_1_FRAME=1)):this.FOOD_1_FRAME>=1&&this.FOOD_1_FRAME<20?(this.food1.x=-4+this.red.x,this.food1.y=75.35+this.red.y,this.FOOD_1_FRAME++):20===this.FOOD_1_FRAME&&(this.food1.x=-36.6,this.food1.y=this.electron.y,this.FOOD_1_FRAME=0),0===this.FOOD_2_FRAME?(this.food2.x+=5,this.food2.x>83.2&&(this.FOOD_2_FRAME=1)):this.FOOD_2_FRAME>=1&&this.FOOD_2_FRAME<20?(this.food2.x=-4.15+this.green.x,this.food2.y=75.35+this.green.y,this.FOOD_2_FRAME++):20===this.FOOD_2_FRAME&&(this.food2.x=-156.4,this.food2.y=this.electron.y,this.FOOD_2_FRAME=0),0===this.FOOD_3_FRAME?(this.food3.x+=5,this.food3.x>203&&(this.FOOD_3_FRAME=1)):this.FOOD_3_FRAME>=1&&this.FOOD_3_FRAME<20?(this.food3.x=-4+this.red.x,this.food3.y=75.35+this.red.y,this.FOOD_3_FRAME++):20===this.FOOD_3_FRAME&&(this.food3.x=-36.6,this.food3.y=this.electron.y,this.FOOD_3_FRAME=0),0===this.FOOD_4_FRAME?(this.food4.x+=5,this.food4.x>83.2&&(this.FOOD_4_FRAME=1)):this.FOOD_4_FRAME>=1&&this.FOOD_4_FRAME<20?(this.food4.x=-4.15+this.green.x,this.food4.y=75.35+this.green.y,this.FOOD_4_FRAME++):20===this.FOOD_4_FRAME&&(this.food4.x=-156.4,this.food4.y=this.electron.y,this.FOOD_4_FRAME=0),this.electron.x>=395&&(this.electron.x=320)):(this.electron.x--,0===this.FOOD_1_FRAME?(this.food1.x-=5,this.food1.x<509.85&&(this.FOOD_1_FRAME=1)):this.FOOD_1_FRAME>=1&&this.FOOD_1_FRAME<20?(this.food1.x=-4+this.boy.x,this.food1.y=75.35+this.boy.y,this.FOOD_1_FRAME++):20===this.FOOD_1_FRAME&&(this.food1.x=800,this.food1.y=this.electron.y,this.FOOD_1_FRAME=0),this.food2.x-=5,this.food3.x-=5,this.food4.x-=5,this.electron.x<=245&&(this.electron.x=320));var e=0;this.FLAG_GREEN_EATING&&(e=this.green.currentFrame,e<this.green_part.totalFrames&&this.green_part.nextFrame(),e===this.green_part.totalFrames+1&&(this.green_part.visible=!1),this.green.currentFrame===this.green.totalFrames?(this.green_part.visible=!0,this.green.gotoAndStop(1),this.green_part.gotoAndStop(1)):this.green.nextFrame()),this.FLAG_RED_EATING&&(e=this.red.currentFrame,e<this.red_part.totalFrames&&this.red_part.nextFrame(),e===this.red_part.totalFrames+1&&(this.red_part.visible=!1),this.red.currentFrame===this.red.totalFrames?(this.red_part.visible=!0,this.red.gotoAndStop(1),this.red_part.gotoAndStop(1)):this.red.nextFrame()),this.FLAG_SH_EATING&&(e=this.boy.currentFrame,e<this.boy_part.totalFrames&&this.boy_part.nextFrame(),e===this.boy_part.totalFrames+1&&(this.boy_part.visible=!1),this.boy.currentFrame===this.boy.totalFrames?(this.boy_part.visible=!0,this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_eat"),this.boy.gotoAndStop(1),this.boy_part.gotoAndStop(1)):this.boy.nextFrame()),this.FLAG_SH_EATING===!1&&this.FLAG_WAITING_FOR_BILL===!1?(this.prgsShape.y++,this.prgsShape.y>490&&(this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_blue"),this.boy.play(),this.FLAG_END_GAMEOVER=!0,Util.singletonPush(this.cards,50))):this.FLAG_SH_EATING===!0&&(this.prgsShape.y--,this.prgsShape.y<=320&&(this.boy_part.visible=!1,this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_full"),this.boy.play(-1),this.FLAG_END_CLEAR=!0,Util.singletonPush(this.cards,54))),this.FLAG_BOSS_TO_GET_FOOD&&(15===this.boss.currentFrame&&(this.arrow.visible=!1,egret.Tween.get(this.boss).to({x:-this.boss.width},500).wait(3e3).call(function(){t.FLAG_ELECTRONE_TO_RIGHT&&(t.bossBack.visible=!0,egret.Tween.get(t.bossBack).to({y:919},300).call(function(){t.bossBack.play()}))}),this.FLAG_BOY_GOT_FOOD=!0),this.FLAG_BOY_GOT_FOOD?this.bossBack.currentFrame===this.bossBack.totalFrames&&(this.boss.x=321.85,this.boss.y=901.9,this.boss.gotoAndStop(1),this.bossBack.gotoAndStop(1),this.bossBack.x=509.5,this.bossBack.y=1231.5,this.bossBack.visible=!1,0===this.FLAG_GOT_FOOD_TYPE?(SoundManager.getInstance().playSound(SoundEnum.DRINKSOUND_MP3),this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_drink"),this.boy.play(),this.FLAG_BOY_GOT_FOOD=!1):(SoundManager.getInstance().playSound(SoundEnum.SHINESOUND_MP3),this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_sosi"+this.FLAG_GOT_FOOD_TYPE),this.boy.play(),this.FLAG_BOY_GOT_FOOD=!1)):(10===this.boy.currentFrame&&SoundManager.getInstance().playSound(SoundEnum.EATSOUND_MP3),this.boy.currentFrame===this.boy.totalFrames&&(0!=this.FLAG_GOT_FOOD_TYPE?StageController.getInstance().gameOverStage(this.stageID,this.cards):(this.FLAG_ELECTRONE_TO_RIGHT&&this.addAllEventListener(),this.FLAG_WAITING_FOR_BILL=!1,this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_stand"),this.boy.gotoAndStop(1),this.rebar.touchEnabled=!1,this.FLAG_BOSS_TO_GET_FOOD=!1))))}},e.prototype._remove=function(){egret.Tween.removeAllTweens()},e.prototype.registItem=function(t){},e.prototype.useItem=function(t,e,i){return!0},e.prototype.getDisplayArea=function(){return new egret.Rectangle},e.prototype.ctrl_right=function(){},e.prototype.ctrl_left=function(){},e.prototype.ctrl_up=function(){},e.prototype.ctrl_down=function(){},e.prototype.ctrl_ok=function(){},e.prototype.ctrl_cancel=function(){},e}(egret.DisplayObjectContainer);__reflect(Stage12.prototype,"Stage12",["IFKaihiStage"]);var Stage13=function(t){function e(){var e=t.call(this)||this;return e.stageID=13,e.FLAG_SHEEP_COUNT=0,e.FLAG_DARK_SHEEP_RUNNING=!1,e.TOUJOU_CHARA_SHEEP=0,e.TOUJOU_CHARA_KENTA=1,e.TOUJOU_CHARA_DARKSHEEP=2,e.TOUJOU_CHARA_YAGI=3,e.FLAG_END_CLEAR=!1,e.FLAG_END_GAMEOVER=!1,e.FLAG_GAME_IS_OVER=!1,e.COUNTER_END=0,e.SHEEP_BACK=-1,e.LEFT_SHEEP_BACK=!1,e.sheepSelector=0,e.cards=[],e.toujouArray=[e.TOUJOU_CHARA_SHEEP,e.TOUJOU_CHARA_SHEEP,e.TOUJOU_CHARA_KENTA,e.TOUJOU_CHARA_SHEEP,e.TOUJOU_CHARA_SHEEP,e.TOUJOU_CHARA_DARKSHEEP,e.TOUJOU_CHARA_YAGI,e.TOUJOU_CHARA_SHEEP,e.TOUJOU_CHARA_SHEEP,e.TOUJOU_CHARA_KENTA,e.TOUJOU_CHARA_SHEEP,e.TOUJOU_CHARA_SHEEP,e.TOUJOU_CHARA_SHEEP,e.TOUJOU_CHARA_SHEEP,e.TOUJOU_CHARA_YAGI,e.TOUJOU_CHARA_YAGI,e.TOUJOU_CHARA_SHEEP,e.TOUJOU_CHARA_SHEEP,e.TOUJOU_CHARA_SHEEP,e.TOUJOU_CHARA_DARKSHEEP],e.FLAG_START_EFFECT_PLAYING=!1,e._init(),e}return __extends(e,t),e.prototype._init=function(){return __awaiter(this,void 0,void 0,function(){var t,e,i,s,h,a,o,n,r,l,c;return __generator(this,function(d){switch(d.label){case 0:return UIManager.getInstance().showLoading(),[4,this._loadRes()];case 1:return d.sent(),this.mcFactory=new egret.MovieClipDataFactory(RES.getRes("stage13_action_json"),RES.getRes("stage13_action_png")),this.sheet=RES.getRes("stage13_texture"),t=new TSBitmap("bg",this.sheet),t.x=-120,t.y=-100,this.addChild(t),this.container=new egret.Sprite,this.addChild(this.container),e=new TSBitmap("room",this.sheet),e.x=-120,e.y=182,this.container.addChild(e),i=new TSBitmap("window",this.sheet),i.x=91,i.y=345,this.container.addChild(i),this.clock=new TSBitmap("clock1",this.sheet,!0),this.clock.x=380,this.clock.y=308,this.container.addChild(this.clock),this.horse=new TSBitmap("horse",this.sheet,!0),this.horse.x=232.5,this.horse.y=415,this.horse.visible=!1,this.container.addChild(this.horse),s=new TSBitmap("bed",this.sheet),s.x=320.35-198,s.y=836.3,this.container.addChild(s),this.boyInBed=new egret.MovieClip(this.mcFactory.generateMovieClipData("sleep1")),this.boyInBed.x=-15.95+320.35,this.boyInBed.y=812.25,this.container.addChild(this.boyInBed),this.dreamContainer=new egret.Sprite,this.container.addChild(this.dreamContainer),this.circle=new TSBitmap("circle",this.sheet,!0),this.circle.x=374,this.circle.y=773,this.circle.visible=!1,this.container.addChild(this.circle),this.circle2=new TSBitmap("circle2",this.sheet,!0),this.circle2.x=339,this.circle2.y=732,this.circle2.visible=!1,this.container.addChild(this.circle2),h=new TSBitmap("sky",this.sheet),h.x=-120,h.y=-100,this.dreamContainer.addChild(h),a=new TSBitmap("lgrass",this.sheet),a.x=56,a.y=462,this.dreamContainer.addChild(a),o=new TSBitmap("rgrass",this.sheet),o.x=447,o.y=468,this.dreamContainer.addChild(o),n=new TSBitmap("ground",this.sheet),n.x=-120,n.y=483,this.dreamContainer.addChild(n),this.boy=new egret.MovieClip(this.mcFactory.generateMovieClipData("boystand")),this.boy.x=153.75,this.boy.y=438.2,this.dreamContainer.addChild(this.boy),this.sheepCnt_text=new egret.TextField,this.sheepCnt_text.x=210.6,this.sheepCnt_text.y=184.55,this.sheepCnt_text.width=212.9,this.sheepCnt_text.height=71,this.sheepCnt_text.text=this.FLAG_SHEEP_COUNT.toString(),this.sheepCnt_text.textAlign="center",this.sheepCnt_text.size=66,this.sheepCnt_text.textColor=3381572,this.dreamContainer.addChild(this.sheepCnt_text),this.sheep=new egret.MovieClip(this.mcFactory.generateMovieClipData("sheep")),this.goat=new egret.MovieClip(this.mcFactory.generateMovieClipData("goat")),this.bsheep=new egret.MovieClip(this.mcFactory.generateMovieClipData("bsheep")),this.kenta=new egret.MovieClip(this.mcFactory.generateMovieClipData("horse")),this.lsheep=new egret.MovieClip(this.mcFactory.generateMovieClipData("lsheep")),this.sheep.x=this.goat.x=this.bsheep.x=this.kenta.x=645.6,this.sheep.y=this.goat.y=this.bsheep.y=481.8,this.lsheep.x=-14.85,this.lsheep.y=484.8,this.kenta.y=400,this.goat.visible=!1,this.bsheep.visible=!1,this.kenta.visible=!1,this.lsheep.visible=!1,this.dreamContainer.addChild(this.sheep),this.dreamContainer.addChild(this.goat),this.dreamContainer.addChild(this.bsheep),this.dreamContainer.addChild(this.kenta),this.dreamContainer.addChild(this.lsheep),r=new TSBitmap("ltree",this.sheet),r.anchorOffsetY=r.height/2,r.x=-120,r.y=442,this.dreamContainer.addChild(r),l=new TSBitmap("rtree",this.sheet),l.anchorOffsetX=l.width,l.anchorOffsetY=l.height/2,l.x=760,l.y=447.65,this.dreamContainer.addChild(l),c=new TSBitmap("wood",this.sheet,!0),c.x=320,c.y=479.55,this.dreamContainer.addChild(c),this.dreamContainer.alpha=0,this.sheep.addEventListener(egret.TouchEvent.TOUCH_TAP,this.sheepTouched,this),this.kenta.addEventListener(egret.TouchEvent.TOUCH_TAP,this.kentaTouched,this),this.bsheep.addEventListener(egret.TouchEvent.TOUCH_TAP,this.bsheepTouched,this),this.goat.addEventListener(egret.TouchEvent.TOUCH_TAP,this.goatTouched,this),this.lsheep.addEventListener(egret.TouchEvent.TOUCH_TAP,this.lsheepTouched,this),UIManager.getInstance().hideLoading(),this.startEffect(),[2]}})})},e.prototype.sheepTouched=function(t){egret.Tween.removeTweens(this.sheep),this.sheep.scaleX=-1,this.SHEEP_BACK=this.TOUJOU_CHARA_SHEEP},e.prototype.kentaTouched=function(t){egret.Tween.removeTweens(this.kenta),this.kenta.scaleX=-1,this.SHEEP_BACK=this.TOUJOU_CHARA_KENTA},e.prototype.bsheepTouched=function(t){this.bsheep.scaleX=-1,this.FLAG_DARK_SHEEP_RUNNING=!1,this.SHEEP_BACK=this.TOUJOU_CHARA_DARKSHEEP,egret.Tween.removeTweens(this.bsheep),this.bsheep.gotoAndStop(1)},e.prototype.goatTouched=function(t){egret.Tween.removeTweens(this.goat),this.goat.scaleX=-1,this.SHEEP_BACK=this.TOUJOU_CHARA_YAGI},e.prototype.lsheepTouched=function(t){egret.Tween.removeTweens(this.lsheep),this.lsheep.scaleX=-1,this.LEFT_SHEEP_BACK=!0},e.prototype.startEffect=function(){egret.Tween.get(this.container).to({y:100},800),this.boyInBed.play(),this.FLAG_START_EFFECT_PLAYING=!0},e.prototype._loadRes=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,StageController.getInstance().loadStage(this.stageID)];case 1:return e.sent(),[3,3];case 2:return t=e.sent(),console.error(t),[3,3];case 3:return[2]}})})},e.prototype._start=function(){},e.prototype.play_loop=function(){var t=this;if(this.FLAG_END_GAMEOVER||this.FLAG_END_CLEAR){if(this.FLAG_GAME_IS_OVER)return;return this.FLAG_END_GAMEOVER&&(this.boyInBed.movieClipData=this.mcFactory.generateMovieClipData("sleep3"),this.boyInBed.play()),this.horse.visible=!0,egret.Tween.get(this.dreamContainer).to({alpha:0},1e3).call(function(){t.circle.visible=t.circle2.visible=!1,egret.Tween.get(t.horse).to({alpha:0},500)}).wait(4e3).call(function(){t.FLAG_END_CLEAR&&StageController.getInstance().clearStage(t.stageID,t.cards),t.FLAG_END_GAMEOVER&&StageController.getInstance().gameOverStage(t.stageID,t.cards)}),void(this.FLAG_GAME_IS_OVER=!0)}this.SHEEP_BACK===this.TOUJOU_CHARA_SHEEP?(this.sheep.x+=5,this.sheep.x>645.6&&(this.SHEEP_BACK=-1,this.sheepSelector++,this.sheep.stop(),this.startCount())):this.SHEEP_BACK===this.TOUJOU_CHARA_YAGI?(this.goat.x+=5,this.goat.x>645.6&&(this.SHEEP_BACK=-1,this.sheepSelector++,this.goat.stop(),this.startCount())):this.SHEEP_BACK===this.TOUJOU_CHARA_DARKSHEEP?(this.bsheep.x+=5,this.bsheep.x>645.6&&(this.SHEEP_BACK=-1,this.sheepSelector++,this.bsheep.gotoAndStop(1),this.startCount())):this.SHEEP_BACK===this.TOUJOU_CHARA_KENTA&&(this.kenta.x+=5,this.kenta.x>645.6&&(this.SHEEP_BACK=-1,this.sheepSelector++,this.kenta.stop(),this.startCount())),this.LEFT_SHEEP_BACK&&(this.lsheep.x-=5,this.lsheep.x<-50&&(this.LEFT_SHEEP_BACK=!1,this.lsheep.stop())),this.FLAG_START_EFFECT_PLAYING&&this.boyInBed.totalFrames===this.boyInBed.currentFrame&&(this.FLAG_START_EFFECT_PLAYING=!1,egret.Tween.get(this.dreamContainer).wait(100).call(function(){t.circle.visible=!0}).wait(100).call(function(){t.circle2.visible=!0,t.boy.play(-1)}).to({alpha:1},500).call(function(){t.startCount()})),this.FLAG_DARK_SHEEP_RUNNING&&(2===this.bsheep.currentFrame&&SoundManager.getInstance().playSound(SoundEnum.TOSSHINSOUND_MP3),this.bsheep.currentFrame===this.bsheep.totalFrames?(this.FLAG_DARK_SHEEP_RUNNING=!1,SoundManager.getInstance().playSound(SoundEnum.KICKSOUND_MP3),Util.singletonPush(this.cards,58),this.FLAG_END_GAMEOVER=!0):this.bsheep.nextFrame())},e.prototype.startCount=function(){var t=this;switch(this.nextSheep()){case this.TOUJOU_CHARA_SHEEP:SoundManager.getInstance().playSound(SoundEnum.BUSHSOUND_MP3),this.sheep.touchEnabled=!0,this.sheep.play(-1),this.sheep.scaleX=1,this.sheep.visible=!0,this.goat.visible=this.bsheep.visible=this.kenta.visible=!1,egret.Tween.get(this.sheep).to({x:630.6},330).wait(700).to({x:400.6},1100).call(function(){SoundManager.getInstance().playSound(SoundEnum.JUMPSOUND_MP3),t.sheep.touchEnabled=!1}).to({y:331.8,x:300},250).to({y:481.8,x:200},250).wait(100).to({y:511.8,x:400.6-400},500,egret.Ease.quadIn).call(function(){t.sheep.visible=!1,t.sheepSelector++}).wait(300).to({x:645.6,y:481.8}).call(function(){t.sheep.stop(),t.FLAG_SHEEP_COUNT++,t.sheepCnt_text.text=t.FLAG_SHEEP_COUNT.toString(),10===t.FLAG_SHEEP_COUNT?(t.FLAG_END_CLEAR=!0,Util.singletonPush(t.cards,59)):t.startCount()});break;case this.TOUJOU_CHARA_KENTA:SoundManager.getInstance().playSound(SoundEnum.BUSHSOUND_MP3),this.kenta.scaleX=1,this.kenta.touchEnabled=!0,this.kenta.visible=!0,this.kenta.play(-1),this.goat.visible=this.bsheep.visible=this.sheep.visible=!1,egret.Tween.get(this.kenta).to({x:620.6},330).wait(700).call(function(){SoundManager.getInstance().playSound(SoundEnum.UMASTEPSOUND_MP3)}).to({x:400.6},1100).call(function(){SoundManager.getInstance().playSound(SoundEnum.UMAVOICESOUND_MP3),t.kenta.movieClipData=t.mcFactory.generateMovieClipData("horse_jump"),t.kenta.play(-1)}).to({y:250,x:300},250).to({y:400,x:200},250).wait(100).call(function(){Util.singletonPush(t.cards,56),t.FLAG_END_GAMEOVER=!0});break;case this.TOUJOU_CHARA_DARKSHEEP:SoundManager.getInstance().playSound(SoundEnum.BUSHSOUND_MP3),this.bsheep.scaleX=1,this.bsheep.touchEnabled=!0,this.bsheep.visible=!0,this.goat.visible=this.sheep.visible=this.kenta.visible=!1,egret.Tween.get(this.bsheep).to({x:620.6},330).wait(700).call(function(){t.bsheep.movieClipData=t.mcFactory.generateMovieClipData("bsheep"),t.bsheep.gotoAndStop(1),t.FLAG_DARK_SHEEP_RUNNING=!0});break;case this.TOUJOU_CHARA_YAGI:SoundManager.getInstance().playSound(SoundEnum.BUSHSOUND_MP3),this.goat.scaleX=1,this.goat.touchEnabled=!0,this.goat.visible=!0,this.goat.play(-1),this.sheep.visible=this.bsheep.visible=this.kenta.visible=!1,egret.Tween.get(this.goat).to({x:620.6},330).wait(700).to({x:400.6},1100).to({y:331.8,x:300},250).to({y:481.8,x:200},250).wait(100).to({y:511.8,x:400.6-400},500,egret.Ease.quadIn).wait(300).to({x:645.6,y:481.8}).call(function(){var e=new TSBitmap("boy4s",t.sheet,!0);e.x=t.boy.x+2.65,e.y=t.boy.y-114.35,t.dreamContainer.addChild(e),t.FLAG_SHEEP_COUNT++,t.sheepCnt_text.text=t.FLAG_SHEEP_COUNT+"?",t.goat.visible=!1}).wait(2e3).call(function(){Util.singletonPush(t.cards,57),t.FLAG_END_GAMEOVER=!0})}this.FLAG_SHEEP_COUNT>=5&&(this.lsheep.visible=!0,this.lsheep.scaleX=1,this.lsheep.touchEnabled=!0,this.lsheep.x=-14.85,this.lsheep.y=484.8,this.lsheep.play(-1),egret.Tween.get(this.lsheep).wait(500).call(function(){SoundManager.getInstance().playSound(SoundEnum.BUSHSOUND_MP3)}).to({x:45.15,y:496.8},200).wait(700).to({x:225.15},1100).to({y:322.8,x:325.15},250).to({y:472.8,x:425.15},250).wait(100).to({y:551.8,x:925.15},500,egret.Ease.quadIn).call(function(){t.FLAG_SHEEP_COUNT--}))},e.prototype.nextSheep=function(){return this.sheepSelector>=this.toujouArray.length&&(this.sheepSelector=0),this.toujouArray[this.sheepSelector]},e.prototype._remove=function(){egret.Tween.removeTweens(this.dreamContainer),egret.Tween.removeTweens(this.sheep),egret.Tween.removeTweens(this.goat)},e.prototype.registItem=function(t){},e.prototype.useItem=function(t,e,i){return!0},e.prototype.getDisplayArea=function(){return new egret.Rectangle},e.prototype.ctrl_right=function(){},e.prototype.ctrl_left=function(){},e.prototype.ctrl_up=function(){},e.prototype.ctrl_down=function(){},e.prototype.ctrl_ok=function(){},e.prototype.ctrl_cancel=function(){},e}(egret.DisplayObjectContainer);__reflect(Stage13.prototype,"Stage13",["IFKaihiStage"]);var Stage14=function(t){function e(){var e=t.call(this)||this;return e.stageID=14,e.FLAG_ENGINE_OK=!0,e.FLAG_TIRE_OK=!0,e.FLAG_STARTED=!1,e.FLAG_USE_TIRE=1,e.FLAG_ENGINE_FRONT=!1,e.FLAG_TAIR_LOSS=!1,e.COUNTER_STARTED=0,e._init(),e}return __extends(e,t),e.prototype._init=function(){return __awaiter(this,void 0,void 0,function(){var t,e,i,s,h,a;return __generator(this,function(o){switch(o.label){case 0:return UIManager.getInstance().showLoading(),[4,this._loadRes()];case 1:return o.sent(),this.mcFactory=new egret.MovieClipDataFactory(RES.getRes("stage14_action_json"),RES.getRes("stage14_action_png")),this.sheet=RES.getRes("stage14_texture"),t=new TSBitmap("bg",this.sheet),t.x=-120,t.y=-100,this.addChild(t),e=new TSBitmap("road",this.sheet),e.x=-119,e.y=692,this.addChild(e),i=new TSBitmap("title",this.sheet),i.x=-120,i.y=117,this.addChild(i),this.newTair=new TSBitmap("tair",this.sheet),this.newTair.anchorOffsetX=this.newTair.width/2,this.newTair.anchorOffsetY=this.newTair.height/2,this.newTair.x=84.6,this.newTair.y=186.95,this.newTair.touchEnabled=!0,this.addChild(this.newTair),s=new TSBitmap("left",this.sheet),s.x=-119,s.y=410,this.addChild(s),h=new TSBitmap("right",this.sheet),h.x=472,h.y=410,this.addChild(h),this.tool=new TSBitmap("tool",this.sheet,!0),this.tool.x=589.2,this.tool.y=638.1,this.tool.touchEnabled=!0,this.addChild(this.tool),a=new TSBitmap("start",this.sheet),a.x=-119,a.y=855,this.addChild(a),this.blueCar=new egret.MovieClip(this.mcFactory.generateMovieClipData("blue")),this.blueCar.scaleX=this.blueCar.scaleY=.62,this.blueCar.x=116.1,this.blueCar.y=686.85,this.blueCar.play(-1),this.addChild(this.blueCar),this.greenCar=new egret.MovieClip(this.mcFactory.generateMovieClipData("green")),this.greenCar.scaleX=this.greenCar.scaleY=.41,this.greenCar.x=563.45-109.15,this.greenCar.y=669.55,this.greenCar.play(-1),this.addChild(this.greenCar),this.redCarSprite=new egret.Sprite,this.addChild(this.redCarSprite),this.redCar=new TSBitmap("red",this.sheet,!0),this.redCar.x=320,this.redCar.y=688.9,this.redCarSprite.addChild(this.redCar),this.tair=new TSBitmap("tair1",this.sheet,!0),this.tair.x=103.7+this.redCar.x,this.tair.y=77.75+this.redCar.y,this.redCarSprite.addChild(this.tair),this.engine=new TSBitmap("engine",this.sheet,!0),this.engine.x=+this.redCar.x,this.engine.y=+this.redCar.y+36,this.redCarSprite.addChild(this.engine),this.lines=new egret.MovieClip(this.mcFactory.generateMovieClipData("car2")),this.lines.x=+this.redCar.x,this.lines.y=+this.redCar.y+36,this.lines.gotoAndStop(1),this.lines.touchEnabled=!0,this.redCarSprite.addChild(this.lines),this.head=new TSBitmap("head",this.sheet,!0),this.head.x=this.redCar.x,this.head.y=this.redCar.y+36,this.head.touchEnabled=!0,this.redCarSprite.addChild(this.head),this.redCarStart=new egret.MovieClip(this.mcFactory.generateMovieClipData("start")),this.redCarStart.x=320,this.redCarStart.y=688.9,this.redCarStart.visible=!1,this.redCarStart.gotoAndStop(1),this.addChild(this.redCarStart),this.startBtn=new TSBitmap("startbtn",this.sheet,!0),this.startBtn.x=320.5,this.startBtn.y=852,this.startBtn.touchEnabled=!0,this.addChild(this.startBtn),this.engineArea=new egret.Shape,this.engineArea.graphics.beginFill(0),this.engineArea.graphics.drawRect(262.65,643.3,117.3,158.1),this.engineArea.graphics.endFill(),this.engineArea.alpha=0,this.engineArea.touchEnabled=!0,this.addChild(this.engineArea),this.tireArea=new egret.Shape,this.tireArea.graphics.beginFill(0),this.tireArea.graphics.drawRect(389.5,686,81.4,110.8),this.tireArea.graphics.endFill(),this.tireArea.alpha=0,this.tireArea.touchEnabled=!0,this.addChild(this.tireArea),UIManager.getInstance().hideLoading(),this.addAllEventListener(),[2]}})})},e.prototype.addAllEventListener=function(){this.engineArea.addEventListener(egret.TouchEvent.TOUCH_TAP,this.engineTouched,this),this.tool.addEventListener(egret.TouchEvent.TOUCH_TAP,this.toolTouched,this),this.newTair.addEventListener(egret.TouchEvent.TOUCH_TAP,this.newTairTouched,this),this.startBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.startBtnTouched,this),this.tireArea.addEventListener(egret.TouchEvent.TOUCH_TAP,this.tairTouched,this)},e.prototype.removeAllEventListener=function(){this.engineArea.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.engineTouched,this),this.tool.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.toolTouched,this),this.newTair.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.newTairTouched,this),this.startBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.startBtnTouched,this),this.tireArea.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.tairTouched,this)},e.prototype.engineTouched=function(t){if(!this.FLAG_ENGINE_OK){var e=1===this.lines.currentFrame?2:1;this.FLAG_ENGINE_FRONT=2===e?!0:!1,this.lines.gotoAndStop(e)}},e.prototype.toolTouched=function(t){this.registItem(ItemEnum.ITEM_SCREWDRIVER)},e.prototype.tairTouched=function(t){1===this.FLAG_USE_TIRE?this.registItem(ItemEnum.ITEM_DAMETIRE):2===this.FLAG_USE_TIRE&&this.registItem(ItemEnum.ITEM_TIRE),this.FLAG_TIRE_OK=!1,this.startBtn.visible=!1,this.tair.visible=!1
},e.prototype.newTairTouched=function(t){this.registItem(ItemEnum.ITEM_TIRE)},e.prototype.startBtnTouched=function(t){this.removeAllEventListener(),1===this.FLAG_USE_TIRE?(this.tair.visible=!1,this.startBtn.visible=!1,this.tairMc=new egret.MovieClip(this.mcFactory.generateMovieClipData("tair3")),this.tairMc.x=426.85,this.tairMc.y=760.95,this.tairMc.gotoAndPlay(1),this.redCarSprite.addChild(this.tairMc),this.FLAG_STARTED=!0):(this.startBtn.visible=!1,this.redCarSprite.visible=!1,this.redCarStart.visible=!0,this.redCarStart.play(-1),this.blueCar.play(-1),this.greenCar.play(-1),this.FLAG_STARTED=!0)},e.prototype.setTire=function(){this.tair.texture=this.sheet.getTexture("tair"+this.FLAG_USE_TIRE)},e.prototype._loadRes=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,StageController.getInstance().loadStage(this.stageID)];case 1:return e.sent(),[3,3];case 2:return t=e.sent(),console.error(t),[3,3];case 3:return[2]}})})},e.prototype._start=function(){},e.prototype.play_loop=function(){var t=this;this.FLAG_STARTED&&1===this.FLAG_USE_TIRE?(this.tairMc.currentFrame===this.tairMc.totalFrames&&(this.redCarSprite.visible=!1,this.redCarStart.visible=!0,this.redCarStart.movieClipData=this.mcFactory.generateMovieClipData("loss1"),this.redCarStart.x=301,this.redCarStart.y=702.6,this.redCarStart.nextFrame(),this.FLAG_TAIR_LOSS=!0),this.redCarStart.currentFrame===this.redCarStart.totalFrames&&this.FLAG_TAIR_LOSS&&StageController.getInstance().gameOverStage(this.stageID,[60])):this.FLAG_STARTED&&2===this.FLAG_USE_TIRE&&(this.COUNTER_STARTED++,30===this.COUNTER_STARTED&&egret.Tween.get(this.greenCar).to({x:933.45,y:794.55,scaleX:1.28,scaleY:1.28},500),60===this.COUNTER_STARTED&&egret.Tween.get(this.blueCar).to({x:-288.45,y:772.2,scaleX:1.33,scaleY:1.33},500),90===this.COUNTER_STARTED?this.FLAG_ENGINE_FRONT?(this.redCarStart.movieClipData=this.mcFactory.generateMovieClipData("front"),egret.Tween.get(this.redCarStart).to({y:733.9,scaleX:2.82,scaleY:2.82},1100).call(function(){StageController.getInstance().clearStage(t.stageID,[62])})):(this.redCarStart.movieClipData=this.mcFactory.generateMovieClipData("back"),egret.Tween.get(this.redCarStart).to({scaleX:.8,scaleY:.8},800).to({scaleX:.1,scaleY:.1},800).to({scaleX:0,scaleY:0},600),egret.Tween.get(this.redCarStart).to({y:678.9},800).to({y:674.9},200).to({y:688.9},600).to({y:695.9},600).call(function(){StageController.getInstance().gameOverStage(t.stageID,[61])})):this.COUNTER_STARTED>90&&this.redCarStart.nextFrame())},e.prototype._remove=function(){egret.Tween.removeAllTweens()},e.prototype.registItem=function(t){ItemController.getInstance().addItem(t)&&(this.startBtn.visible=this.FLAG_ENGINE_OK&&this.FLAG_TIRE_OK,t===ItemEnum.ITEM_DAMETIRE,t===ItemEnum.ITEM_TIRE&&(this.newTair.visible=!1),t===ItemEnum.ITEM_SCREWDRIVER&&(this.tool.visible=!1),t===ItemEnum.ITEM_HOOD&&(this.head.visible=!1))},e.prototype.useItem=function(t,e,i){return t===ItemEnum.ITEM_SCREWDRIVER&&this.engineArea.hitTestPoint(e,i)?(this.registItem(ItemEnum.ITEM_HOOD),this.head.visible=!1,this.FLAG_ENGINE_OK=!1,this.startBtn.visible=this.FLAG_ENGINE_OK&&this.FLAG_TIRE_OK,!0):t===ItemEnum.ITEM_TIRE&&this.tireArea.hitTestPoint(e,i)?this.FLAG_TIRE_OK?(this.registItem(ItemEnum.ITEM_DAMETIRE),this.FLAG_USE_TIRE=2,this.setTire(),!0):(this.tair.visible=!0,this.FLAG_USE_TIRE=2,this.setTire(),this.FLAG_TIRE_OK=!0,this.startBtn.visible=this.FLAG_ENGINE_OK&&this.FLAG_TIRE_OK,!0):t===ItemEnum.ITEM_DAMETIRE&&this.tireArea.hitTestPoint(e,i)?this.FLAG_TIRE_OK?(this.registItem(ItemEnum.ITEM_TIRE),this.FLAG_USE_TIRE=1,this.setTire(),!0):(this.tair.visible=!0,this.FLAG_USE_TIRE=1,this.setTire(),this.FLAG_TIRE_OK=!0,this.startBtn.visible=this.FLAG_ENGINE_OK&&this.FLAG_TIRE_OK,!0):t===ItemEnum.ITEM_HOOD&&this.engineArea.hitTestPoint(e,i)?(this.head.visible=!0,this.FLAG_ENGINE_OK=!0,this.startBtn.visible=this.FLAG_ENGINE_OK&&this.FLAG_TIRE_OK,this.registItem(ItemEnum.ITEM_SCREWDRIVER),!0):!1},e.prototype.getDisplayArea=function(){return new egret.Rectangle},e.prototype.ctrl_right=function(){},e.prototype.ctrl_left=function(){},e.prototype.ctrl_up=function(){},e.prototype.ctrl_down=function(){},e.prototype.ctrl_ok=function(){},e.prototype.ctrl_cancel=function(){},e}(egret.DisplayObjectContainer);__reflect(Stage14.prototype,"Stage14",["IFKaihiStage"]);var Stage15=function(t){function e(){var e=t.call(this)||this;return e.stageID=15,e.FLAG_WINDOW_OPENED=0,e.FLAG_BANANA_USED=!1,e.FLAG_USE_BEETLE=1,e.FLAG_GOLD_ON_HEAD=!1,e.FLAG_GAMEOVER=!1,e.COUNTER_GAMEOVER=0,e.cards=[],e._init(),e}return __extends(e,t),e.prototype._init=function(){return __awaiter(this,void 0,void 0,function(){var t,e,i,s,h,a,o,n,r,l,c;return __generator(this,function(d){switch(d.label){case 0:return UIManager.getInstance().showLoading(),[4,this._loadRes()];case 1:return d.sent(),this.mcFactory=new egret.MovieClipDataFactory(RES.getRes("stage15_action_json"),RES.getRes("stage15_action_png")),this.sheet=RES.getRes("stage15_texture"),t=new TSBitmap("bg",this.sheet),t.x=-120,t.y=-100,this.addChild(t),e=new TSBitmap("tree",this.sheet),e.x=361,e.y=174,this.addChild(e),i=new TSBitmap("wall",this.sheet),i.x=-120,i.y=-100,this.addChild(i),s=new TSBitmap("ground",this.sheet),s.x=-120,s.y=622,this.addChild(s),h=new TSBitmap("grid",this.sheet),h.x=-120,h.y=481,this.addChild(h),a=new TSBitmap("plant",this.sheet),a.x=541,a.y=444,this.addChild(a),o=new TSBitmap("window",this.sheet),o.x=640,o.y=238,this.addChild(o),this.window=new TSBitmap("window",this.sheet,!0),this.window.x=571.05,this.window.y=389.7,this.addChild(this.window),this.boy=new egret.MovieClip(this.mcFactory.generateMovieClipData("boystand")),this.boy.x=186.95,this.boy.y=707.15,this.addChild(this.boy),n=new TSBitmap("chair",this.sheet),n.x=268,n.y=677,this.addChild(n),r=new TSBitmap("desk",this.sheet),r.x=222,r.y=711,this.addChild(r),this.chair2=new TSBitmap("chair",this.sheet,!0),this.chair2.x=640.6,this.chair2.y=761.15,this.addChild(this.chair2),this.banana=new TSBitmap("banana",this.sheet),this.banana.x=580.2,this.banana.y=724.9,this.banana.visible=!1,this.banana.touchEnabled=!0,this.addChild(this.banana),l=new TSBitmap("desk",this.sheet),l.x=548,l.y=711,this.addChild(l),c=new TSBitmap("land",this.sheet),c.x=257,c.y=705,this.addChild(c),this.beetle1=new egret.MovieClip(this.mcFactory.generateMovieClipData("beetle1")),this.beetle1.x=295.5,this.beetle1.y=718.7,this.beetle1.play(-1),this.addChild(this.beetle1),this.beetle2=new egret.MovieClip(this.mcFactory.generateMovieClipData("beetle2")),this.beetle2.x=336.4,this.beetle2.y=714.1,this.beetle2.play(-1),this.addChild(this.beetle2),this.beetle3=new egret.MovieClip(this.mcFactory.generateMovieClipData("beetle3")),this.beetle3.x=294.4,this.beetle3.y=714.6,this.beetle3.gotoAndStop(1),this.beetle3.visible=!1,this.addChild(this.beetle3),this.red=new egret.MovieClip(this.mcFactory.generateMovieClipData("redstand")),this.red.x=470.3,this.red.y=708.75,this.red.play(-1),this.addChild(this.red),this.desk1Area=new egret.Shape,this.desk1Area.graphics.beginFill(0),this.desk1Area.graphics.drawRect(294.4-40,674.6,80,80),this.desk1Area.graphics.endFill(),this.desk1Area.touchEnabled=!0,this.desk1Area.alpha=0,this.addChild(this.desk1Area),this.boyHeadArea=new egret.Shape,this.boyHeadArea.graphics.beginFill(0),this.boyHeadArea.graphics.drawRect(150.5,564,80,80),this.boyHeadArea.graphics.endFill(),this.boyHeadArea.touchEnabled=!0,this.boyHeadArea.alpha=0,this.addChild(this.boyHeadArea),this.desk2Area=new egret.Shape,this.desk2Area.graphics.beginFill(0),this.desk2Area.graphics.drawRect(540.05,673,198.2,99.7),this.desk2Area.graphics.endFill(),this.desk2Area.touchEnabled=!0,this.desk2Area.alpha=0,this.addChild(this.desk2Area),this.treeArea=new egret.Shape,this.treeArea.graphics.beginFill(0),this.treeArea.graphics.drawRect(350.1,389.2-135.9,277.4,271.8),this.treeArea.graphics.endFill(),this.treeArea.touchEnabled=!0,this.treeArea.alpha=0,this.addChild(this.treeArea),this.beetle=new TSBitmap("beetle",this.sheet),this.beetle.rotation=114,this.beetle.x=517.1+this.beetle.width/2,this.beetle.y=438.2,this.beetle.touchEnabled=!0,this.beetle.visible=!1,this.addChild(this.beetle),this.goldBeetle=new TSBitmap("goldbeetle",this.sheet),this.goldBeetle.scaleX=-1,this.goldBeetle.x=588.75+this.goldBeetle.width/2,this.goldBeetle.y=379.55-this.goldBeetle.height/2,this.goldBeetle.touchEnabled=!0,this.goldBeetle.visible=!1,this.addChild(this.goldBeetle),this.startBtn=new TSBitmap("startbtn",this.sheet,!0),this.startBtn.x=320,this.startBtn.y=872.55,this.startBtn.touchEnabled=!0,this.addChild(this.startBtn),this.addAllEventListener(),UIManager.getInstance().hideLoading(),[2]}})})},e.prototype.addAllEventListener=function(){this.banana.addEventListener(egret.TouchEvent.TOUCH_TAP,this.bananaTouched,this),this.desk1Area.addEventListener(egret.TouchEvent.TOUCH_TAP,this.desk1AreaTouched,this),this.desk2Area.addEventListener(egret.TouchEvent.TOUCH_TAP,this.desk2AreaTouched,this),this.treeArea.addEventListener(egret.TouchEvent.TOUCH_TAP,this.treeAreaTouched,this),this.goldBeetle.addEventListener(egret.TouchEvent.TOUCH_TAP,this.goldBeetleTouched,this),this.beetle.addEventListener(egret.TouchEvent.TOUCH_TAP,this.beetleTouched,this),this.boyHeadArea.addEventListener(egret.TouchEvent.TOUCH_TAP,this.boyHeadAreaTouched,this),this.startBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.startBtnTouched,this)},e.prototype.startBtnTouched=function(t){var e=this;this.startBtn.visible=!1;var i=new egret.MovieClip(this.mcFactory.generateMovieClipData("bling"));i.x=309.15,i.y=707.9,this.addChild(i),i.play(-1),1===this.FLAG_USE_BEETLE?(egret.Tween.get(this.beetle1).to({x:300.5},100).call(function(){SoundManager.getInstance().playSound(SoundEnum.KICKSOUND_MP3)}).to({x:290.5},100).to({x:300.5},100).call(function(){SoundManager.getInstance().playSound(SoundEnum.KICKSOUND_MP3)}).to({x:290.5},100).to({x:300.5},100).call(function(){SoundManager.getInstance().playSound(SoundEnum.KICKSOUND_MP3)}).to({x:290.5},100).to({x:300.5},100).call(function(){SoundManager.getInstance().playSound(SoundEnum.KICKSOUND_MP3)}).to({x:290.5},100).to({x:300.5},100).call(function(){SoundManager.getInstance().playSound(SoundEnum.KICKSOUND_MP3)}).to({x:290.5},100).to({x:190.55,y:883.05,rotation:180},100).call(function(){Util.singletonPush(e.cards,63),StageController.getInstance().gameOverStage(e.stageID,e.cards)}),egret.Tween.get(this.beetle2).to({x:331.4},100).to({x:341.4},100).to({x:331.4},100).to({x:341.4},100).to({x:331.4},100).to({x:341.4},100).to({x:331.4},100).to({x:341.4},100).to({x:331.4},100).to({x:341.4},100)):2===this.FLAG_USE_BEETLE&&(egret.Tween.get(this.beetle3).to({x:299.4},100).call(function(){SoundManager.getInstance().playSound(SoundEnum.KICKSOUND_MP3)}).to({x:289.4},100).to({x:299.4},100).call(function(){SoundManager.getInstance().playSound(SoundEnum.KICKSOUND_MP3)}).to({x:289.4},100).to({x:299.4},100).call(function(){SoundManager.getInstance().playSound(SoundEnum.KICKSOUND_MP3)}).to({x:289.4},100).to({x:299.4},100).call(function(){SoundManager.getInstance().playSound(SoundEnum.KICKSOUND_MP3)}).to({x:289.4},100).to({x:299.4},100).call(function(){SoundManager.getInstance().playSound(SoundEnum.KICKSOUND_MP3)}).to({x:289.4},100),egret.Tween.get(this.beetle2).to({x:331.4},100).to({x:341.4},100).to({x:331.4},100).to({x:341.4},100).to({x:331.4},100).to({x:341.4},100).to({x:331.4},100).to({x:341.4},100).to({x:331.4},100).to({x:341.4},100).to({x:399.5,y:883.05,rotation:180},100).call(function(){Util.singletonPush(e.cards,67),StageController.getInstance().clearStage(e.stageID,e.cards)}))},e.prototype.boyHeadAreaTouched=function(t){this.FLAG_GOLD_ON_HEAD&&(this.registItem(ItemEnum.ITEM_GOLD_REAVER),this.FLAG_GOLD_ON_HEAD=!1)},e.prototype.beetleTouched=function(t){this.registItem(ItemEnum.ITEM_REAVER)},e.prototype.goldBeetleTouched=function(t){this.registItem(ItemEnum.ITEM_GOLD_REAVER)},e.prototype.bananaTouched=function(t){this.registItem(ItemEnum.ITEM_BANANA_SKIN)},e.prototype.treeAreaTouched=function(t){0===this.FLAG_WINDOW_OPENED&&(SoundManager.getInstance().playSound(SoundEnum.FUSUMAOPENSOUND_MP3),this.FLAG_WINDOW_OPENED=1)},e.prototype.desk1AreaTouched=function(t){1===this.FLAG_USE_BEETLE?this.registItem(ItemEnum.ITEM_REAVER):2===this.FLAG_USE_BEETLE&&this.registItem(ItemEnum.ITEM_GOLD_REAVER),this.startBtn.visible=!1,this.FLAG_USE_BEETLE=0},e.prototype.desk2AreaTouched=function(t){SoundManager.getInstance().playSound(SoundEnum.CHAIRSOUND_MP3),this.banana.visible=!0,egret.Tween.get(this.chair2).to({y:721.15},500),egret.Tween.get(this.banana).to({y:802.8},300),this.desk2Area.touchEnabled=!1},e.prototype._loadRes=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,StageController.getInstance().loadStage(this.stageID)];case 1:return e.sent(),[3,3];case 2:return t=e.sent(),console.error(t),[3,3];case 3:return[2]}})})},e.prototype._start=function(){},e.prototype.play_loop=function(){this.FLAG_GAMEOVER&&(this.COUNTER_GAMEOVER++,30===this.COUNTER_GAMEOVER&&StageController.getInstance().gameOverStage(this.stageID,this.cards)),1===this.FLAG_WINDOW_OPENED&&(this.window.x<640+this.window.width?this.window.x+=10:this.FLAG_WINDOW_OPENED=2)},e.prototype._remove=function(){egret.Tween.removeAllTweens()},e.prototype.registItem=function(t){ItemController.getInstance().addItem(t)&&(t===ItemEnum.ITEM_BANANA_SKIN&&(this.banana.visible=!1),t===ItemEnum.ITEM_REAVER&&(this.beetle1.visible=!1,this.beetle.visible=!1),t===ItemEnum.ITEM_GOLD_REAVER&&(this.beetle3.visible=!1,this.goldBeetle.visible=!1))},e.prototype.useItem=function(t,e,i){var s=this;if(t===ItemEnum.ITEM_BANANA_SKIN){if(this.treeArea.hitTestPoint(e,i))return 2===this.FLAG_WINDOW_OPENED?(this.banana.x=576.3-this.banana.width/2,this.banana.y=427.5-this.banana.height/2,this.banana.visible=!0,this.goldBeetle.visible=!0,this.FLAG_BANANA_USED=!0,!0):!1;if(this.boy.hitTestPoint(e,i))return this.startBtn.visible=!1,this.banana.x=138.85,this.banana.y=791.9,this.banana.visible=!0,this.banana.rotation=50,egret.Tween.get(this.banana).to({x:163.85},120).to({x:183.85},180).to({x:203.85},300),egret.Tween.get(this.banana).to({y:792},150).to({y:783.3},150).to({y:835.3},300),egret.Tween.get(this.banana).to({rotation:-30},80).to({rotation:-20},150).to({rotation:-10},320).to({rotation:0},50),this.boy.movieClipData=this.mcFactory.generateMovieClipData("boyrotation"),this.boy.x=186.95-62.4,this.boy.y=783.3,this.boy.play(-1),Util.singletonPush(this.cards,65),this.FLAG_GAMEOVER=!0,!0}if(t===ItemEnum.ITEM_GOLD_REAVER){if(this.treeArea.hitTestPoint(e,i))return this.goldBeetle.visible=!0,!0;if(this.boyHeadArea.hitTestPoint(e,i))return this.beetle3.x=190.5,this.beetle3.y=564,this.beetle3.visible=!0,this.FLAG_GOLD_ON_HEAD=!0,Util.singletonPush(this.cards,68),!0;if(this.desk1Area.hitTestPoint(e,i))return this.beetle3.x=294.4,this.beetle3.y=714.6,this.beetle3.visible=!0,1===this.FLAG_USE_BEETLE&&this.registItem(ItemEnum.ITEM_REAVER),this.FLAG_USE_BEETLE=2,this.startBtn.visible=!0,!0}if(t===ItemEnum.ITEM_REAVER){if(this.treeArea.hitTestPoint(e,i)){if(this.FLAG_BANANA_USED)this.beetle.visible=!0;else{SoundManager.getInstance().playSound(SoundEnum.BOKESOUND_MP3);var h=new egret.MovieClip(this.mcFactory.generateMovieClipData("fly"));h.x=429,h.y=478.75,h.play(-1),this.addChild(h),egret.Tween.get(h).to({alpha:.2},1500,egret.Ease.quadIn).call(function(){h.visible=!1}),egret.Tween.get(h).to({y:386.75},1500,egret.Ease.cubicOut),egret.Tween.get(h).to({x:368.65},1500,egret.Ease.cubicIn).call(function(){s.boy.movieClipData=s.mcFactory.generateMovieClipData("boyfly"),s.boy.x=422.5,s.boy.y=533.75,s.boy.play()}).wait(500).call(function(){Util.singletonPush(s.cards,64),StageController.getInstance().gameOverStage(s.stageID,s.cards)})}return!0}if(this.boyHeadArea.hitTestPoint(e,i))return SoundManager.getInstance().playSound(SoundEnum.KUWAGATASOUND_MP3),this.boy.movieClipData=this.mcFactory.generateMovieClipData("boynose"),this.boy.play(-1),this.FLAG_GAMEOVER=!0,Util.singletonPush(this.cards,66),!0;if(this.desk1Area.hitTestPoint(e,i))return 2===this.FLAG_USE_BEETLE&&this.registItem(ItemEnum.ITEM_REAVER),this.FLAG_USE_BEETLE=1,this.beetle1.visible=!0,this.startBtn.visible=!0,!0}return!1},e.prototype.getDisplayArea=function(){return new egret.Rectangle},e.prototype.ctrl_right=function(){},e.prototype.ctrl_left=function(){},e.prototype.ctrl_up=function(){},e.prototype.ctrl_down=function(){},e.prototype.ctrl_ok=function(){},e.prototype.ctrl_cancel=function(){},e}(egret.DisplayObjectContainer);__reflect(Stage15.prototype,"Stage15",["IFKaihiStage"]);var Stage16=function(t){function e(){var e=t.call(this)||this;return e.stageID=16,e.FLAG_INITED=!1,e.FLAG_END_GAMEOVER=!1,e.FLAG_END_CLEAR=!1,e.FLAG_STICK_GOT=!1,e.COUNTER_END=0,e.FLAG_ZOMBI_ACTION_END=0,e.FLAG_ZOMBI_HAKA=!1,e.HEROES_TURN=!1,e.cards=[],e.boyX=2,e.boyY=6,e.boyFace=-1,e.zombiX=[0,7],e.zombiY=[7,0],e.zombiFace=[0,0],e.zombiList=[],e.handX=[1,6],e.handY=[7,5],e.handStick=[0,0],e.handList=[],e.kengX=[3,6],e.kengY=[6,4],e.kengList=[],e.gridWidth=81,e.stoneX=[1,2,3,4,5,5,2,4,1,4,1,4,5,6,7],e.stoneY=[1,1,1,1,1,2,3,3,4,4,5,7,7,7,7],e._init(),e}return __extends(e,t),e.prototype._init=function(){return __awaiter(this,void 0,void 0,function(){var t,e,i,s,h,a;return __generator(this,function(o){switch(o.label){case 0:return UIManager.getInstance().showLoading(),[4,this._loadRes()];case 1:for(o.sent(),this.mcFactory=new egret.MovieClipDataFactory(RES.getRes("stage16_action_json"),RES.getRes("stage16_action_png")),this.sheet=RES.getRes("stage16_texture"),t=new TSBitmap("bg",this.sheet),t.x=-120,t.y=-100,this.addChild(t),e=new TSBitmap("cemetery",this.sheet),e.x=-120,e.y=248,this.addChild(e),i=new TSBitmap("grid",this.sheet),i.x=-5,i.y=266.5,this.addChild(i),s=new TSBitmap("wall",this.sheet),s.x=-120,s.y=163,this.addChild(s),this.container=new egret.Sprite,this.addChild(this.container),this.keng1=new TSBitmap("keng",this.sheet,!0),this.keng1.x=this.kengX[0]*this.gridWidth+38,this.keng1.y=this.kengY[0]*this.gridWidth+304.35,this.container.addChild(this.keng1),this.keng2=new TSBitmap("keng",this.sheet,!0),this.keng2.x=this.kengX[1]*this.gridWidth+38,this.keng2.y=this.kengY[1]*this.gridWidth+304.35,this.container.addChild(this.keng2),this.kengList=[this.keng1,this.keng2],this.zombi1=new egret.MovieClip(this.mcFactory.generateMovieClipData("zombi_up")),this.zombi1.x=36+this.zombiX[0]*this.gridWidth,this.zombi1.y=300+this.zombiY[0]*this.gridWidth-33,this.zombi1.play(-1),this.container.addChild(this.zombi1),this.zombi2=new egret.MovieClip(this.mcFactory.generateMovieClipData("zombi_up")),this.zombi2.x=36+this.zombiX[1]*this.gridWidth,this.zombi2.y=300+this.zombiY[1]*this.gridWidth-33,this.zombi2.play(-1),this.container.addChild(this.zombi2),this.zombiList=[this.zombi1,this.zombi2],this.hand1=new egret.MovieClip(this.mcFactory.generateMovieClipData("hand")),this.hand1.x=this.handX[0]*this.gridWidth+38,this.hand1.y=this.handY[0]*this.gridWidth+304.35,this.hand1.gotoAndStop(1),this.container.addChild(this.hand1),this.hand2=new egret.MovieClip(this.mcFactory.generateMovieClipData("hand")),this.hand2.x=this.handX[1]*this.gridWidth+38,this.hand2.y=this.handY[1]*this.gridWidth+304.35,this.hand2.gotoAndStop(1),this.container.addChild(this.hand2),this.handList=[this.hand1,this.hand2],this.stick=new egret.MovieClip(this.mcFactory.generateMovieClipData("stick")),this.stick.x=38,this.stick.y=3*this.gridWidth+304.35,this.stick.gotoAndStop(1),this.container.addChild(this.stick),this.stoneList=[],a=0;a<this.stoneX.length;a++)h=this.newStone(this.stoneX[a],this.stoneY[a]),this.container.addChild(h);return this.leftArea=new egret.Shape,this.leftArea.graphics.beginFill(6697881),this.leftArea.graphics.drawRect(0,0,this.gridWidth,this.gridWidth),this.leftArea.graphics.endFill(),this.leftArea.touchEnabled=!0,this.container.addChild(this.leftArea),this.upArea=new egret.Shape,this.upArea.graphics.beginFill(6697881),this.upArea.graphics.drawRect(0,0,this.gridWidth,this.gridWidth),this.upArea.graphics.endFill(),this.upArea.touchEnabled=!0,this.container.addChild(this.upArea),this.rightArea=new egret.Shape,this.rightArea.graphics.beginFill(6697881),this.rightArea.graphics.drawRect(0,0,this.gridWidth,this.gridWidth),this.rightArea.graphics.endFill(),this.rightArea.touchEnabled=!0,this.container.addChild(this.rightArea),this.downArea=new egret.Shape,this.downArea.graphics.beginFill(6697881),this.downArea.graphics.drawRect(0,0,this.gridWidth,this.gridWidth),this.downArea.graphics.endFill(),this.downArea.touchEnabled=!0,this.container.addChild(this.downArea),this.boy=new egret.MovieClip(this.mcFactory.generateMovieClipData("sh_stop")),this.boy.x=this.boyX*this.gridWidth+36,this.boy.y=this.boyY*this.gridWidth+305,this.container.addChild(this.boy),this.leftArea.x=this.boy.x-3*this.gridWidth/2,this.leftArea.y=this.boy.y-this.gridWidth/2,this.rightArea.x=this.boy.x+this.gridWidth/2,this.rightArea.y=this.boy.y-this.gridWidth/2,this.upArea.x=this.boy.x-this.gridWidth/2,this.upArea.y=this.boy.y-this.gridWidth-this.gridWidth/2,this.downArea.x=this.boy.x-this.gridWidth/2,this.downArea.y=this.boy.y+this.gridWidth-this.gridWidth/2,this.areaAlpha=1,this.alphaChange=.1,this.FLAG_INITED=!0,this.HEROES_TURN=!0,this.setChildrenIndex(),this.addAllEventListener(),UIManager.getInstance().hideLoading(),[2]}})})},e.prototype.newStone=function(t,e,i){void 0===i&&(i=!1);var s=new TSBitmap("stone",this.sheet,!0);return s.x=40+t*this.gridWidth,s.y=306+e*this.gridWidth,i&&(this.stoneX.push(t),this.stoneY.push(e)),this.stoneList.push(s),s},e.prototype.addAllEventListener=function(){this.leftArea.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onLeftTouched,this),this.rightArea.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onRightTouched,this),this.upArea.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onUpTouched,this),this.downArea.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onDownTouched,this)},e.prototype.removeAllEventListener=function(){this.leftArea.visible=!1,this.rightArea.visible=!1,this.upArea.visible=!1,this.downArea.visible=!1,this.leftArea.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onLeftTouched,this),this.rightArea.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onRightTouched,this),this.upArea.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onUpTouched,this),this.downArea.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onDownTouched,this)},e.prototype.onLeftTouched=function(t){var e=this;this.boyX--,this.removeAllEventListener(),3!==this.boyFace&&(this.boyFace=3,this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_left"),this.boy.y=this.boyY*this.gridWidth+300-33,this.boy.play(-1)),egret.Tween.get(this.boy).to({x:this.boyX*this.gridWidth+36},1e3).call(function(){e.update(3)})},e.prototype.onRightTouched=function(t){var e=this;this.boyX++,this.removeAllEventListener(),1!==this.boyFace&&(this.boyFace=1,this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_right"),this.boy.y=this.boyY*this.gridWidth+300-33,this.boy.play(-1)),egret.Tween.get(this.boy).to({x:this.boyX*this.gridWidth+36},1e3).call(function(){e.update(1)})},e.prototype.onUpTouched=function(t){var e=this;this.removeAllEventListener(),this.boyY--,0!==this.boyFace&&(this.boyFace=0,this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_up"),this.boy.play(-1)),egret.Tween.get(this.boy).to({y:this.boyY*this.gridWidth+300-33},1e3).call(function(){e.update(0)})},e.prototype.onDownTouched=function(t){var e=this;this.removeAllEventListener(),this.boyY++,2!==this.boyFace&&(this.boyFace=2,this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_down"),this.boy.play(-1)),egret.Tween.get(this.boy).to({y:this.boyY*this.gridWidth+300-33},1e3).call(function(){e.update(2)})},e.prototype.isHero=function(t,e,i){return t===this.boyX&&e===this.boyY?!0:!1},e.prototype.isZombiDiaoKeng=function(){for(var t=0;t<this.zombiList.length;t++)this.isDiaoKeng(this.zombiX[t],this.zombiY[t],!0)&&(this.zombiList[t].movieClipData=this.mcFactory.generateMovieClipData("zombi_haka"),this.zombiList[t].play(),this.diedZombie=this.zombiList[t],this.zombiList[t].y+=33,this.zombiList.splice(t,1),this.zombiX.splice(t,1),this.zombiY.splice(t,1),this.FLAG_ZOMBI_HAKA=!0,SoundManager.getInstance().playSound(SoundEnum.ZOMBIDEADSOUND_MP3))},e.prototype.isDiaoKeng=function(t,e,i){for(var s=0;s<this.kengX.length;s++)if(t===this.kengX[s]&&e===this.kengY[s])return this.container.removeChild(this.kengList[s]),i&&(this.newBuildStone=this.newStone(this.kengX[s],this.kengY[s],!0),this.container.addChild(this.newBuildStone),this.newBuildStone.visible=!1),this.kengList.splice(s,1),this.kengX.splice(s,1),this.kengY.splice(s,1),!0;return!1},e.prototype.update=function(t){return __awaiter(this,void 0,void 0,function(){var e,i,s,h;return __generator(this,function(a){switch(a.label){case 0:return SoundManager.getInstance().playSound(SoundEnum.ZOMBIMOVESOUND_MP3),this.isStick(this.boyX,this.boyY)&&this.registItem(ItemEnum.ITEM_STICK),this.handNearBy()?[2]:[3,1];case 1:return this.isDiaoKeng(this.boyX,this.boyY,!1)?(SoundManager.getInstance().playSound(SoundEnum.ZOMBIDIGGINGSOUND_MP3),this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_sh_haka"),this.boy.y+=33,this.boy.play(),this.FLAG_END_GAMEOVER=!0,[3,7]):[3,2];case 2:if(null===this.isZombi(this.boyX,this.boyY))return[3,3];switch(SoundManager.getInstance().playSound(SoundEnum.ZOMBIATTACKSOUND_MP3),e=this.isZombi(this.boyX,this.boyY),this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_bad"),this.boy.y+=33,this.boy.play(),t){case 0:e.movieClipData=this.mcFactory.generateMovieClipData("zombi_attack_down"),e.play();break;case 1:e.movieClipData=this.mcFactory.generateMovieClipData("zombi_attack_left"),e.play();break;case 2:e.movieClipData=this.mcFactory.generateMovieClipData("zombi_attack_up"),e.play();break;case 3:e.movieClipData=this.mcFactory.generateMovieClipData("zombi_attack_left"),e.scaleX=-1,e.play()}return this.FLAG_END_GAMEOVER=!0,[3,7];case 3:i=void 0,s=0,a.label=4;case 4:return s<this.zombiX.length?[4,this.zombiAction(this.zombiX[s],this.zombiY[s],this.zombiFace[s])]:[3,7];case 5:i=a.sent(),i.move===!0?(h=void 0,0===i.direction?(this.zombiY[s]-=1,h=300+this.zombiY[s]*this.gridWidth-33):1===i.direction?(this.zombiX[s]+=1,h=36+this.zombiX[s]*this.gridWidth):2===i.direction?(this.zombiY[s]+=1,h=300+this.zombiY[s]*this.gridWidth-33):3===i.direction&&(this.zombiX[s]-=1,h=36+this.zombiX[s]*this.gridWidth),this.zombiMove(this.zombiList[s],h,i.direction,this.isHero(this.zombiX[s],this.zombiY[s],i.direction))):(this.zombiFace[s]=i.direction,this.zombiChangeFace(this.zombiList[s],i.direction)),a.label=6;case 6:return s++,[3,4];case 7:return this.setChildrenIndex(),[2]}})})},e.prototype.setChildrenIndex=function(){for(var t=0,e=0;8>e;e++){var i=void 0;for(i=0;i<this.kengList.length;i++)this.kengY[i]===e&&(this.container.setChildIndex(this.kengList[i],t),t++);for(i=0;i<this.zombiY.length;i++)this.zombiY[i]===e&&(this.container.setChildIndex(this.zombiList[i],t),t++);for(i=0;i<this.stoneY.length;i++)this.stoneY[i]===e&&(this.container.setChildIndex(this.stoneList[i],t),t++);for(i=0;i<this.handY.length;i++)this.handY[i]===e&&(this.container.setChildIndex(this.handList[i],t),t++);3===e&&(this.container.setChildIndex(this.stick,t),t++),this.boyY===e&&(this.container.setChildIndex(this.boy,t),t++)}this.container.setChildIndex(this.upArea,this.container.getChildIndex(this.boy)),this.container.setChildIndex(this.downArea,this.container.numChildren),this.container.setChildIndex(this.leftArea,this.container.getChildIndex(this.boy)),this.container.setChildIndex(this.rightArea,this.container.getChildIndex(this.boy))},e.prototype.heroDie=function(){this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_bad"),this.boy.play(),this.boy.y+=33,this.FLAG_END_GAMEOVER=!0},e.prototype.zombiMove=function(t,e,i,s){var h=this;if(s)switch(i){case 0:t.movieClipData=this.mcFactory.generateMovieClipData("zombi_attack_up"),t.play(),this.heroDie();break;case 2:t.movieClipData=this.mcFactory.generateMovieClipData("zombi_attack_down"),t.play(),this.heroDie();break;case 1:t.movieClipData=this.mcFactory.generateMovieClipData("zombi_attack_left"),t.scaleX=-1,t.play(),this.heroDie();break;case 3:t.movieClipData=this.mcFactory.generateMovieClipData("zombi_attack_left"),t.play(),this.heroDie()}else switch(i){case 0:case 2:egret.Tween.get(t).to({y:e},1e3).call(function(){h.FLAG_ZOMBI_ACTION_END++});break;case 1:case 3:egret.Tween.get(t).to({x:e},1e3).call(function(){h.FLAG_ZOMBI_ACTION_END++})}},e.prototype.zombiChangeFace=function(t,e){switch(e){case 0:t.movieClipData=this.mcFactory.generateMovieClipData("zombi_up"),t.play(-1);break;case 1:t.movieClipData=this.mcFactory.generateMovieClipData("zombi_right"),t.play(-1);break;case 2:t.movieClipData=this.mcFactory.generateMovieClipData("zombi_down"),t.play(-1);break;case 3:t.movieClipData=this.mcFactory.generateMovieClipData("zombi_left"),t.play(-1);break;default:console.log("error zombi direction")}this.FLAG_ZOMBI_ACTION_END++},e.prototype.directionXY=function(t){switch(t){case 0:return{x:0,y:-1};case 1:return{x:1,y:0};case 2:return{x:0,y:1};case 3:return{x:-1,y:0}}return{x:0,y:0}},e.prototype.canMove=function(t,e,i){void 0===i&&(i=-1);var s,h=t,a=e;return-1!==i&&(s=this.directionXY(i),h=t+s.x,a=e+s.y),!this.isStone(h,a)&&!this.isHand(h,a)&&null===this.isZombi(h,a)&&h>=0&&7>=h&&a>=0&&7>=a?!0:!1},e.prototype.getDirectionCanMove=function(t,e,i){void 0===i&&(i=[]);for(var s=[0,1,2,3],h=[],a=0;a<i.length;a++)h.push(i[a]);for(var o=0;o<s.length;o++)-1===h.indexOf(s[o])&&h.push(s[o]);for(var o=0;o<h.length;o++)if(this.canMove(t,e,h[o]))return h[o];return-1},e.prototype.zombiAction=function(t,e,i){var s={move:!1,direction:-1},h=t-this.boyX>0?!0:!1,a=e-this.boyY>0?!0:!1;return Math.abs(t-this.boyX)-Math.abs(e-this.boyY)>=0?h?this.canMove(t-1,e)?(3===i&&(s.move=!0),s.direction=3):3!==i&&this.canMove(t,e,i)?(s.move=!0,s.direction=i):(s.move=!1,s.direction=this.getDirectionCanMove(t,e,[h===!0?3:1,a===!0?0:2])):h||(this.canMove(t+1,e)?(1===i&&(s.move=!0),s.direction=1):1!==i&&this.canMove(t,e,i)?(s.move=!0,s.direction=i):(s.move=!1,s.direction=this.getDirectionCanMove(t,e,[h===!0?3:1,a===!0?0:2]))):a?this.canMove(t,e-1)?(0===i&&(s.move=!0),s.direction=0):0!==i&&this.canMove(t,e,i)?(s.move=!0,s.direction=i):(s.move=!1,s.direction=this.getDirectionCanMove(t,e,[h===!0?3:1,a===!0?0:2])):a||(this.canMove(t,e+1)?(2===i&&(s.move=!0),s.direction=2):2!==i&&this.canMove(t,e,i)?(s.move=!0,s.direction=i):(s.move=!1,s.direction=this.getDirectionCanMove(t,e,[h===!0?3:1,a===!0?0:2]))),-1===s.direction&&console.log("error direction"),s},e.prototype.handNearBy=function(){for(var t=0;t<this.handX.length;t++)if(1!==this.handStick[t]){if(Util.singletonPush(this.cards,69),this.boyX-this.handX[t]===0&&this.boyY-this.handY[t]===1)return this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_hand_down"),this.boy.y=this.boy.y+40,this.boy.play(-1),this.handList[t].visible=!1,this.FLAG_END_GAMEOVER=!0,!0;if(this.boyX-this.handX[t]===0&&this.boyY-this.handY[t]===-1)return this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_hand_up"),this.boy.y=this.boy.y+40,this.boy.play(-1),this.handList[t].visible=!1,this.FLAG_END_GAMEOVER=!0,!0;if(this.boyX-this.handX[t]===1&&this.boyY-this.handY[t]===0)return this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_hand_right"),this.boy.play(-1),this.handList[t].visible=!1,this.FLAG_END_GAMEOVER=!0,!0;if(this.boyX-this.handX[t]===-1&&this.boyY-this.handY[t]===0)return this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_hand_left"),this.boy.play(-1),this.handList[t].visible=!1,this.FLAG_END_GAMEOVER=!0,!0}return!1},e.prototype.isStick=function(t,e){return this.FLAG_STICK_GOT||0!==t||3!==e?!1:!0},e.prototype.isHand=function(t,e){for(var i=0;i<this.handX.length;i++)if(this.handX[i]===t&&this.handY[i]===e)return!0;
return!1},e.prototype.isZombi=function(t,e){for(var i=0;i<this.zombiX.length;i++)if(this.zombiX[i]===t&&this.zombiY[i]===e)return this.zombiList[i];return null},e.prototype.isStone=function(t,e){for(var i=0;i<this.stoneX.length;i++)if(this.stoneX[i]===t&&this.stoneY[i]===e)return!0;return!1},e.prototype.setMoveArea=function(){this.leftArea.visible=!0,this.rightArea.visible=!0,this.upArea.visible=!0,this.downArea.visible=!0,this.addAllEventListener(),this.boyX-1<0&&(this.leftArea.visible=!1),this.boyX+1>7&&(this.rightArea.visible=!1),this.boyY-1<0&&(this.upArea.visible=!1),this.boyY+1>7&&(this.downArea.visible=!1);for(var t=0;t<this.stoneX.length;t++)this.stoneY[t]>=this.boyY-1&&this.stoneY[t]<=this.boyY+1&&this.stoneX[t]>=this.boyX-1&&this.stoneX[t]<=this.boyX+1&&Math.abs(this.stoneX[t]-this.boyX)+Math.abs(this.stoneY[t]-this.boyY)===1&&(1===Math.abs(this.stoneX[t]-this.boyX)?this.stoneX[t]>this.boyX?this.rightArea.visible=!1:this.leftArea.visible=!1:1===Math.abs(this.stoneY[t]-this.boyY)&&(this.stoneY[t]>this.boyY?this.downArea.visible=!1:this.upArea.visible=!1));for(var t=0;t<this.handList.length;t++)this.handX[t]>=this.boyX-1&&this.handX[t]<=this.boyX+1&&this.handY[t]>=this.boyY-1&&this.handY[t]<=this.boyY+1&&Math.abs(this.handX[t]-this.boyX)+Math.abs(this.handY[t]-this.boyY)===1&&(1===Math.abs(this.handX[t]-this.boyX)?this.handX[t]>this.boyX?this.rightArea.visible=!1:this.leftArea.visible=!1:1===Math.abs(this.handY[t]-this.boyY)&&(this.handY[t]>this.boyY?this.downArea.visible=!1:this.upArea.visible=!1));this.leftArea.x=this.boy.x-3*this.gridWidth/2,this.leftArea.y=this.boy.y,this.rightArea.x=this.boy.x+this.gridWidth/2,this.rightArea.y=this.boy.y,this.upArea.x=this.boy.x-this.gridWidth/2,this.upArea.y=this.boy.y-this.gridWidth,this.downArea.x=this.boy.x-this.gridWidth/2,this.downArea.y=this.boy.y+this.gridWidth},e.prototype._loadRes=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,StageController.getInstance().loadStage(this.stageID)];case 1:return e.sent(),[3,3];case 2:return t=e.sent(),console.error(t),[3,3];case 3:return[2]}})})},e.prototype._start=function(){},e.prototype.play_loop=function(){return this.FLAG_END_GAMEOVER||this.FLAG_END_CLEAR?(this.FLAG_END_GAMEOVER&&(20===this.COUNTER_END&&SoundManager.getInstance().playSound(SoundEnum.ZOMBIGAMEOVERSOUND_MP3),60===this.COUNTER_END&&StageController.getInstance().gameOverStage(this.stageID,this.cards),this.COUNTER_END++),void(this.FLAG_END_CLEAR&&(this.COUNTER_END++,20===this.COUNTER_END&&SoundManager.getInstance().playSound(SoundEnum.ZOMBICLEARSOUND_MP3),60===this.COUNTER_END&&StageController.getInstance().clearStage(this.stageID,this.cards)))):void(this.FLAG_INITED&&(this.FLAG_ZOMBI_HAKA&&this.diedZombie.currentFrame===this.diedZombie.totalFrames&&(this.container.removeChild(this.diedZombie),this.newBuildStone.visible=!0,this.FLAG_ZOMBI_HAKA=!1),this.FLAG_ZOMBI_ACTION_END>=this.zombiX.length&&(this.isZombiDiaoKeng(),0===this.zombiX.length?(this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_clear"),this.boy.play(),this.boy.y=this.boy.y+33,this.FLAG_END_CLEAR=!0):(this.setMoveArea(),this.FLAG_ZOMBI_ACTION_END=0,SoundManager.getInstance().playSound(SoundEnum.ZOMBIMOVESOUND_MP3),this.HEROES_TURN=!0)),this.areaAlpha+=this.alphaChange,this.areaAlpha>=.8?this.alphaChange=-.05:this.areaAlpha<=.4&&(this.alphaChange=.05),this.leftArea.alpha=this.rightArea.alpha=this.upArea.alpha=this.downArea.alpha=this.areaAlpha))},e.prototype._remove=function(){egret.Tween.removeAllTweens()},e.prototype.registItem=function(t){ItemController.getInstance().addItem(ItemEnum.ITEM_STICK)&&(this.stick.visible=!1,this.FLAG_STICK_GOT=!0)},e.prototype.useItem=function(t,e,i){if(t===ItemEnum.ITEM_STICK){if(this.hand1.hitTestPoint(e,i))return this.handStick[0]=1,SoundManager.getInstance().playSound(SoundEnum.ZOMBIMARAKASUSOUND_MP3),this.hand1.movieClipData=this.mcFactory.generateMovieClipData("hand_stick"),this.hand1.play(-1),Util.singletonPush(this.cards,70),!0;if(this.hand2.hitTestPoint(e,i))return this.handStick[1]=1,this.hand2.movieClipData=this.mcFactory.generateMovieClipData("hand_stick"),this.hand2.play(-1),Util.singletonPush(this.cards,70),!0}return!1},e.prototype.getDisplayArea=function(){return new egret.Rectangle},e.prototype.ctrl_right=function(){},e.prototype.ctrl_left=function(){},e.prototype.ctrl_up=function(){},e.prototype.ctrl_down=function(){},e.prototype.ctrl_ok=function(){},e.prototype.ctrl_cancel=function(){},e}(egret.DisplayObjectContainer);__reflect(Stage16.prototype,"Stage16",["IFKaihiStage"]);var Stage17=function(t){function e(){var e=t.call(this)||this;return e.stageID=17,e.FLAG_GOT_APPLE_NUM=0,e.FLAG_EAT_APPLE_NUM=0,e.FLAG_SHOT_TIMES=0,e.FLAG_START_SHOT=!1,e.FLAG_IS_EATING=!1,e.FLAG_CLEAR_STAGE=!1,e.FLAG_ANIMATE_PLAYING=!1,e.FLAG_APPLE1_ID=ItemEnum.ITEM_APPLE,e.FLAG_APPLE2_ID=ItemEnum.ITEM_APPLE_2,e.FLAG_APPLE3_ID=ItemEnum.ITEM_APPLE_3,e.cards=[],e._init(),e}return __extends(e,t),e.prototype._init=function(){return __awaiter(this,void 0,void 0,function(){var t,e,i,s,h;return __generator(this,function(a){switch(a.label){case 0:return UIManager.getInstance().showLoading(),[4,this._loadRes()];case 1:return a.sent(),this.mcFactory=new egret.MovieClipDataFactory(RES.getRes("stage17_action_json"),RES.getRes("stage17_action_png")),this.sheet=RES.getRes("stage17_texture"),t=new TSBitmap("bg",this.sheet),t.x=-120,t.y=-100,this.addChild(t),e=new TSBitmap("ground",this.sheet),e.x=-120,e.y=611,this.addChild(e),i=new TSBitmap("tree",this.sheet),i.x=-120,i.y=-30,this.addChild(i),s=new TSBitmap("wood",this.sheet),s.x=315,s.y=474,this.addChild(s),h=new TSBitmap("wood",this.sheet),h.x=442,h.y=474,this.addChild(h),this.boy=new egret.MovieClip(this.mcFactory.generateMovieClipData("sh_stand")),this.boy.x=203,this.boy.y=604.5,this.boy.gotoAndStop(1),this.addChild(this.boy),this.bow=new egret.MovieClip(this.mcFactory.generateMovieClipData("bow0")),this.bow.x=558.05,this.bow.y=759.95,this.bow.gotoAndStop(1),this.addChild(this.bow),this.stock1=new TSBitmap("arrow1",this.sheet,!0),this.stock1.x=525.7,this.stock1.y=827.5,this.addChild(this.stock1),this.stock2=new TSBitmap("arrow1",this.sheet,!0),this.stock2.x=477.7,this.stock2.y=833.6,this.addChild(this.stock2),this.shottingStock=new TSBitmap("arrow2",this.sheet,!0),this.shottingStock.x=542.9,this.shottingStock.y=660.8,this.shottingStock.visible=!1,this.addChild(this.shottingStock),this.headArea=new egret.Shape,this.headArea.graphics.beginFill(0,0),this.headArea.graphics.drawRect(172.1,422.9,80,80),this.headArea.graphics.endFill(),this.headArea.touchEnabled=!0,this.addChild(this.headArea),this.wood1Area=new egret.Shape,this.wood1Area.graphics.beginFill(0,0),this.wood1Area.graphics.drawRect(298.65,425.9,80,80),this.wood1Area.graphics.endFill(),this.wood1Area.touchEnabled=!0,this.addChild(this.wood1Area),this.wood2Area=new egret.Shape,this.wood2Area.graphics.beginFill(0,0),this.wood2Area.graphics.drawRect(425.65,425.9,80,80),this.wood2Area.graphics.endFill(),this.wood2Area.touchEnabled=!0,this.addChild(this.wood2Area),this.eatArea=new egret.Shape,this.eatArea.graphics.beginFill(0,0),this.eatArea.graphics.drawRect(156.3,551.05-40,80,80),this.eatArea.graphics.endFill(),this.addChild(this.eatArea),this.apple1=new egret.MovieClip(this.mcFactory.generateMovieClipData("apple")),this.apple1.x=465.65,this.apple1.y=465.9,this.addChild(this.apple1),this.apple2=new egret.MovieClip(this.mcFactory.generateMovieClipData("apple")),this.apple2.x=338.65,this.apple2.y=465.9,this.addChild(this.apple2),this.apple3=new egret.MovieClip(this.mcFactory.generateMovieClipData("apple")),this.apple3.x=212.1,this.apple3.y=462.9,this.addChild(this.apple3),this.apple1.touchEnabled=this.apple2.touchEnabled=this.apple3.touchEnabled=!0,this.startBtn=new TSBitmap("start",this.sheet,!0),this.startBtn.x=320,this.startBtn.y=870,this.startBtn.touchEnabled=!0,this.addChild(this.startBtn),this.rope=new egret.MovieClip(this.mcFactory.generateMovieClipData("rope")),this.rope.x=176.5,this.rope.y=596,this.rope.gotoAndStop(1),this.addChild(this.rope),this.addAllEventListener(),UIManager.getInstance().hideLoading(),[2]}})})},e.prototype.addAllEventListener=function(){this.startBtn.visible=!0,this.apple1.addEventListener(egret.TouchEvent.TOUCH_TAP,this.apple1Touched,this),this.apple2.addEventListener(egret.TouchEvent.TOUCH_TAP,this.apple2Touched,this),this.apple3.addEventListener(egret.TouchEvent.TOUCH_TAP,this.apple3Touched,this),this.startBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.startTouched,this),this.FLAG_ANIMATE_PLAYING=!1},e.prototype.removeAllEventListener=function(){this.startBtn.visible=!1,this.apple1.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.apple1Touched,this),this.apple2.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.apple2Touched,this),this.apple3.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.apple3Touched,this),this.startBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.startTouched,this),this.FLAG_ANIMATE_PLAYING=!0},e.prototype.apple1Touched=function(t){this.registItem(ItemEnum.ITEM_APPLE),this.FLAG_APPLE1_ID=-1},e.prototype.apple2Touched=function(t){this.registItem(ItemEnum.ITEM_APPLE_2),this.FLAG_APPLE2_ID=-1},e.prototype.apple3Touched=function(t){this.registItem(ItemEnum.ITEM_APPLE_3),this.FLAG_APPLE3_ID=-1},e.prototype.startTouched=function(t){this.FLAG_START_SHOT=!0,this.FLAG_SHOT_TIMES=1,this.startBtn.visible=!1,this.bow.gotoAndPlay(1)},e.prototype._loadRes=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,StageController.getInstance().loadStage(this.stageID)];case 1:return e.sent(),[3,3];case 2:return t=e.sent(),console.error(t),[3,3];case 3:return[2]}})})},e.prototype._start=function(){},e.prototype.play_loop=function(){var t=this;this.FLAG_CLEAR_STAGE||(this.FLAG_START_SHOT?(7===this.bow.currentFrame&&(SoundManager.getInstance().playSound(SoundEnum.SUBURISOUND_MP3),1===this.FLAG_SHOT_TIMES?(this.shottingStock.visible=!0,this.shottingStock.x=542.9,this.shottingStock.y=660.8,-1===this.FLAG_APPLE1_ID?egret.Tween.get(this.shottingStock).to({x:524.7,y:522.15,scaleX:.54,scaleY:.54},200).call(function(){SoundManager.getInstance().playSound(SoundEnum.KONSOUND_MP3),t.shottingStock.visible=!1;var e=new egret.MovieClip(t.mcFactory.generateMovieClipData("arrow"));e.x=498.4,e.y=510.8,e.scaleX=e.scaleY=.8,e.rotation=-34.4806,t.addChild(e),e.play(-1)}):egret.Tween.get(this.shottingStock).to({x:524.7,y:660.8-186.8+25.75,scaleX:.54,scaleY:.54},200).call(function(){SoundManager.getInstance().playSound(SoundEnum.CRASH2SOUND_MP3),t.shottingStock.visible=!1,t.apple1.movieClipData=t.mcFactory.generateMovieClipData("appleboom"),t.apple1.gotoAndPlay(1)})):2===this.FLAG_SHOT_TIMES?(SoundManager.getInstance().playSound(SoundEnum.SUBURISOUND_MP3),this.shottingStock.visible=!0,-1===this.FLAG_APPLE2_ID?(this.shottingStock.x=531.7,this.shottingStock.y=660.8,egret.Tween.get(this.shottingStock).to({x:531.7-189.05,y:660.8-163.7,scaleX:.54,scaleY:.54},200).call(function(){SoundManager.getInstance().playSound(SoundEnum.KONSOUND_MP3),t.shottingStock.visible=!1;var e=new egret.MovieClip(t.mcFactory.generateMovieClipData("arrow"));e.x=370.4,e.y=510.8,e.scaleX=e.scaleY=.8,e.rotation=-34.4806,t.addChild(e),e.play(-1)})):egret.Tween.get(this.shottingStock).to({x:542.9-189.05,y:660.8-189.3,scaleX:.54,scaleY:.54},200).call(function(){SoundManager.getInstance().playSound(SoundEnum.CRASH2SOUND_MP3),t.shottingStock.visible=!1,t.apple2.movieClipData=t.mcFactory.generateMovieClipData("appleboom"),t.apple2.gotoAndPlay(1)})):3===this.FLAG_SHOT_TIMES&&(SoundManager.getInstance().playSound(SoundEnum.SUBURISOUND_MP3),this.shottingStock.visible=!0,-1===this.FLAG_APPLE3_ID?(this.shottingStock.x=531.7,this.shottingStock.y=660.8,egret.Tween.get(this.shottingStock).to({x:531.7-308.85,y:490.4,scaleX:.65,scaleY:.65},200).call(function(){SoundManager.getInstance().playSound(SoundEnum.KONSOUND_MP3),t.cards.push(72),t.shottingStock.visible=!1;var e=new egret.MovieClip(t.mcFactory.generateMovieClipData("arrow"));e.x=255.3,e.y=483.25,e.rotation=-68.8454,t.addChild(e),e.play(-1)})):egret.Tween.get(this.shottingStock).to({x:531.7-314.55,y:660.8-193.6,scaleX:.65,scaleY:.65},200).call(function(){SoundManager.getInstance().playSound(SoundEnum.CRASH2SOUND_MP3),t.cards.push(71),t.shottingStock.visible=!1,t.apple3.movieClipData=t.mcFactory.generateMovieClipData("appleboom"),t.apple3.gotoAndPlay(1)}))),this.bow.currentFrame===this.bow.totalFrames&&(this.shottingStock.visible=!1,1===this.FLAG_SHOT_TIMES?(this.bow.movieClipData=this.mcFactory.generateMovieClipData("bow1"),this.FLAG_SHOT_TIMES=2,this.bow.gotoAndPlay(1),this.stock1.visible=!1):2===this.FLAG_SHOT_TIMES?(this.bow.movieClipData=this.mcFactory.generateMovieClipData("bow2"),this.FLAG_SHOT_TIMES=3,this.bow.gotoAndPlay(1),this.stock2.visible=!1):3===this.FLAG_SHOT_TIMES&&(this.FLAG_START_SHOT=!1,StageController.getInstance().gameOverStage(this.stageID,this.cards)))):this.FLAG_IS_EATING&&this.boy.currentFrame===this.boy.totalFrames&&(0===this.FLAG_EAT_APPLE_NUM?(this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_stand1"),this.boy.gotoAndStop(1),this.FLAG_EAT_APPLE_NUM=1,this.rope.gotoAndStop(this.FLAG_EAT_APPLE_NUM),this.addAllEventListener()):1===this.FLAG_EAT_APPLE_NUM?(this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_stand2"),this.boy.gotoAndStop(1),this.FLAG_EAT_APPLE_NUM=2,this.rope.gotoAndStop(this.FLAG_EAT_APPLE_NUM),this.addAllEventListener()):2===this.FLAG_EAT_APPLE_NUM&&(this.rope.visible=!1,this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_escape"),this.boy.gotoAndPlay(1),this.FLAG_EAT_APPLE_NUM=3),this.FLAG_IS_EATING=!1),3===this.FLAG_EAT_APPLE_NUM&&(1===this.boy.currentFrame&&SoundManager.getInstance().playSound(SoundEnum.BUCHISOUND_MP3),this.boy.currentFrame===this.boy.totalFrames&&(StageController.getInstance().clearStage(this.stageID,[73]),this.FLAG_CLEAR_STAGE=!0)))},e.prototype._remove=function(){egret.Tween.removeAllTweens()},e.prototype.registItem=function(t){if(ItemController.getInstance().addItem(t))switch(t){case ItemEnum.ITEM_APPLE:this.apple1.visible=!1;break;case ItemEnum.ITEM_APPLE_2:this.apple2.visible=!1;break;case ItemEnum.ITEM_APPLE_3:this.apple3.visible=!1}},e.prototype.useItem=function(t,e,i){if(!this.boy.isPlaying&&!this.FLAG_START_SHOT){if(this.eatArea.hitTestPoint(e,i))switch(t){case ItemEnum.ITEM_APPLE:case ItemEnum.ITEM_APPLE_2:case ItemEnum.ITEM_APPLE_3:if(0===this.FLAG_EAT_APPLE_NUM)this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_eat"),this.boy.gotoAndPlay(1);else if(1===this.FLAG_EAT_APPLE_NUM)this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_eat1"),this.boy.gotoAndPlay(1);else{if(2!==this.FLAG_EAT_APPLE_NUM)return!1;this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_eat2"),this.boy.gotoAndPlay(1)}return SoundManager.getInstance().playSound(SoundEnum.EATSOUND_MP3),this.removeAllEventListener(),this.FLAG_IS_EATING=!0,!0}else{if(this.headArea.hitTestPoint(e,i))return this.FLAG_APPLE3_ID===ItemEnum.ITEM_APPLE||this.FLAG_APPLE3_ID===ItemEnum.ITEM_APPLE_2||this.FLAG_APPLE3_ID===ItemEnum.ITEM_APPLE_3?!1:(this.apple3.visible=!0,this.FLAG_APPLE3_ID=t,!0);if(this.wood1Area.hitTestPoint(e,i))return this.FLAG_APPLE2_ID===ItemEnum.ITEM_APPLE||this.FLAG_APPLE2_ID===ItemEnum.ITEM_APPLE_2||this.FLAG_APPLE2_ID===ItemEnum.ITEM_APPLE_3?!1:(this.apple2.visible=!0,this.FLAG_APPLE2_ID=t,!0);if(this.wood2Area.hitTestPoint(e,i))return this.FLAG_APPLE1_ID===ItemEnum.ITEM_APPLE||this.FLAG_APPLE1_ID===ItemEnum.ITEM_APPLE_2||this.FLAG_APPLE1_ID===ItemEnum.ITEM_APPLE_3?!1:(this.apple1.visible=!0,this.FLAG_APPLE1_ID=t,!0)}return!1}},e.prototype.getDisplayArea=function(){return new egret.Rectangle},e.prototype.ctrl_right=function(){},e.prototype.ctrl_left=function(){},e.prototype.ctrl_up=function(){},e.prototype.ctrl_down=function(){},e.prototype.ctrl_ok=function(){},e.prototype.ctrl_cancel=function(){},e}(egret.DisplayObjectContainer);__reflect(Stage17.prototype,"Stage17",["IFKaihiStage"]);var Stage18=function(t){function e(){var e=t.call(this)||this;return e.stageId=18,e.FLAG_END_GAMEOVER=!1,e.FLAG_END_CLEAR=!1,e.COUNTER_END=0,e.FLAG_RED_THROW=!1,e.FLAG_SH_THROW1=!1,e.FLAG_SH_THROW2=!1,e.FLAG_SH_BLUE_BAD=!1,e.FLAG_RED_THROW_NUM=0,e.FLAG_SHOW_RED_BALL=!1,e.FLAG_RED_BOY_REST=!1,e.FLAG_PIN_ACTION=!1,e.FLAG_ROBOT_WALK=!1,e.FLAG_BOY_SCORE=!1,e.FLAG_LEFT_PIN=!1,e.FLAG_NOT_ANY_BALL=!1,e.FLAG_SHOW_NEXT_BALL=!1,e.cards=[],e._init(),e}return __extends(e,t),e.prototype._init=function(){return __awaiter(this,void 0,void 0,function(){var t,e,i,s,h,a,o,n,r,l,c,d;return __generator(this,function(_){switch(_.label){case 0:return UIManager.getInstance().showLoading(),[4,this._loadRes()];case 1:return _.sent(),this.mcFactory=new egret.MovieClipDataFactory(RES.getRes("stage18_action_json"),RES.getRes("stage18_action_png")),this.sheet=RES.getRes("stage18_texture"),this.container=new egret.Sprite,this.container.x=0,this.container.y=0,this.addChild(this.container),t=new TSBitmap("bg",this.sheet),t.x=-120,t.y=-100,this.container.addChild(t),e=new TSBitmap("wall",this.sheet),e.x=-120,e.y=-100,this.container.addChild(e),i=new TSBitmap("ad",this.sheet),i.x=-120,i.y=92,this.container.addChild(i),s=new TSBitmap("ground",this.sheet),s.x=-120,s.y=230,this.container.addChild(s),h=new TSBitmap("road",this.sheet),h.x=21,h.y=197,this.container.addChild(h),a=new TSBitmap("road",this.sheet),a.x=670,a.y=197,this.container.addChild(a),o=new TSBitmap("chairs",this.sheet),o.x=-86,o.y=703,this.container.addChild(o),n=new TSBitmap("chair",this.sheet),n.x=1153,n.y=699,this.container.addChild(n),r=new TSBitmap("score",this.sheet,!0),r.x=313.65,r.y=150.5,this.container.addChild(r),l=new TSBitmap("score",this.sheet,!0),l.x=963.4,l.y=150.5,this.container.addChild(l),this.board1_1=new TSBitmap("g",this.sheet,!0),this.board1_1.x=r.x+-40,this.board1_1.y=r.y+.35,this.container.addChild(this.board1_1),this.board1_2=new TSBitmap("g",this.sheet,!0),this.board1_2.x=r.x+0,this.board1_2.y=r.y+.35,this.container.addChild(this.board1_2),this.board1_3=new TSBitmap("g",this.sheet,!0),this.board1_3.x=r.x+40,this.board1_3.y=r.y+.35,this.board1_3.visible=!1,this.container.addChild(this.board1_3),this.board2_1=new TSBitmap("good",this.sheet,!0),this.board2_1.x=l.x+-40,this.board2_1.y=l.y+.35,this.board2_1.visible=!1,this.container.addChild(this.board2_1),this.board2_2=new TSBitmap("good",this.sheet,!0),this.board2_2.x=l.x+0,this.board2_2.y=l.y+.35,this.board2_2.visible=!1,this.container.addChild(this.board2_2),this.board2_3=new TSBitmap("good",this.sheet,!0),this.board2_3.x=l.x+40,this.board2_3.y=l.y+.35,this.board2_3.visible=!1,this.container.addChild(this.board2_3),this.machine=new TSBitmap("mashine",this.sheet,!0),this.machine.x=1111.05,this.machine.y=905.8,this.container.addChild(this.machine),c=new TSBitmap("mashinehead",this.sheet),c.x=1186.05,c.y=816.8,this.container.addChild(c),d=new TSBitmap("green",this.sheet),d.x=1193,d.y=868,this.container.addChild(d),this.redBall1=new egret.MovieClip(this.mcFactory.generateMovieClipData("redball_machine")),this.redBall1.x=1139.75,this.redBall1.y=852.75,this.redBall1.gotoAndStop(1),this.redBall2=new egret.MovieClip(this.mcFactory.generateMovieClipData("redball_machine")),this.redBall2.x=1092.2,this.redBall2.y=852.55,this.redBall2.gotoAndStop(4),this.redBall3=new egret.MovieClip(this.mcFactory.generateMovieClipData("redball_machine")),this.redBall3.x=1040.1499999999999,this.redBall3.y=852.1,this.redBall3.gotoAndStop(7),this.redBall1.touchEnabled=this.redBall2.touchEnabled=this.redBall3.touchEnabled=!0,this.blueBall=new egret.MovieClip(this.mcFactory.generateMovieClipData("blueball_machine")),this.blueBall.x=1221,this.blueBall.y=852.1,this.blueBall.visible=!0,this.blueBall.gotoAndStop(2),this.robotBall=new egret.MovieClip(this.mcFactory.generateMovieClipData("robotball_machine")),this.robotBall.x=1221,this.robotBall.y=871.9,this.robotBall.gotoAndStop(2),this.robotBall.visible=!1,this.nextBall=this.blueBall,this.machineAllList=[this.blueBall,this.redBall1,this.redBall2,this.redBall3,this.robotBall],this.container.addChild(this.redBall3),this.container.addChild(this.redBall2),this.container.addChild(this.redBall1),this.container.addChild(this.blueBall),this.container.addChild(this.robotBall),this.machineMask=new egret.Shape,this.machineMask.x=1111.05,this.machineMask.y=905.8,this.machineMask.graphics.beginFill(0),this.machineMask.graphics.drawRect(-151.6,-114.2,232.6,180.55),this.machineMask.graphics.endFill(),this.container.addChild(this.machineMask),this.nextBall.mask=this.machineMask,this.leftPin=new egret.MovieClip(this.mcFactory.generateMovieClipData("strike")),this.leftPin.x=314.15,this.leftPin.y=267.95,this.leftPin.gotoAndStop(1),this.container.addChild(this.leftPin),this.rightPin=new egret.MovieClip(this.mcFactory.generateMovieClipData("strike")),this.rightPin.x=963.85,this.rightPin.y=267.45,this.rightPin.gotoAndStop(1),this.container.addChild(this.rightPin),this.rightPinMask=new egret.Shape,this.rightPinMask.graphics.beginFill(0,1),this.rightPinMask.graphics.drawRect(876.75,205.85,174.75,114.85),this.rightPinMask.graphics.endFill(),this.rightPin.mask=this.rightPinMask,this.container.addChild(this.rightPinMask),this.redBallThrow=new egret.MovieClip(this.mcFactory.generateMovieClipData("redball")),this.redBallThrow.x=965.3,this.redBallThrow.y=702.1,this.redBallThrow.gotoAndStop(1),this.redBallThrow.visible=!1,this.container.addChild(this.redBallThrow),this.red=new egret.MovieClip(this.mcFactory.generateMovieClipData("red_stand")),this.red.x=964.55,this.red.y=682.2,this.red.gotoAndStop(1),this.container.addChild(this.red),this.boy=new egret.MovieClip(this.mcFactory.generateMovieClipData("sh_stand")),this.boy.x=310.55,this.boy.y=679.85,this.boy.gotoAndStop(1),this.container.addChild(this.boy),this.leftArrow=new TSBitmap("arrow_png"),this.leftArrow.x=40,this.leftArrow.y=510,this.leftArrow.touchEnabled=!0,this.leftArrow.visible=!1,this.addChild(this.leftArrow),this.rightArrow=new TSBitmap("arrow_png"),this.rightArrow.scaleX=-1,this.rightArrow.x=600,this.rightArrow.y=510,this.rightArrow.touchEnabled=!0,this.addChild(this.rightArrow),this.leftArrow.addEventListener(egret.TouchEvent.TOUCH_TAP,this.leftArrowTouched,this),this.rightArrow.addEventListener(egret.TouchEvent.TOUCH_TAP,this.rightArrowTouched,this),this.redBall1.addEventListener(egret.TouchEvent.TOUCH_TAP,this.ball1Touched,this),this.redBall2.addEventListener(egret.TouchEvent.TOUCH_TAP,this.ball2Touched,this),this.redBall3.addEventListener(egret.TouchEvent.TOUCH_TAP,this.ball3Touched,this),this.blueBall.addEventListener(egret.TouchEvent.TOUCH_TAP,this.blueTouched,this),this.robotBall.addEventListener(egret.TouchEvent.TOUCH_TAP,this.robotTouched,this),UIManager.getInstance().hideLoading(),[2]}})})},e.prototype.robotTouched=function(t){this.registItem(ItemEnum.ITEM_ROBOT_BALL)},e.prototype.blueTouched=function(t){this.registItem(ItemEnum.ITEM_BLUE_BALL)},e.prototype.ball1Touched=function(t){this.registItem(ItemEnum.ITEM_RED_BALL)},e.prototype.ball2Touched=function(t){this.registItem(ItemEnum.ITEM_RED_BALL_2)},e.prototype.ball3Touched=function(t){this.registItem(ItemEnum.ITEM_RED_BALL_3)},e.prototype.rightArrowTouched=function(t){this.rightArrow.visible=!1,this.leftArrow.visible=!0,egret.Tween.get(this.container).to({x:-640},500)},e.prototype.leftArrowTouched=function(t){this.leftArrow.visible=!1,this.rightArrow.visible=!0,egret.Tween.get(this.container).to({x:0},500)},e.prototype._loadRes=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,StageController.getInstance().loadStage(this.stageId)];case 1:return e.sent(),[3,3];case 2:return t=e.sent(),console.error(t),[3,3];case 3:return[2]}})})},e.prototype._start=function(){},e.prototype.play_loop=function(){var t=this;if(this.FLAG_END_CLEAR||this.FLAG_END_GAMEOVER)return this.COUNTER_END++,void(this.COUNTER_END>90&&(this.FLAG_END_CLEAR?StageController.getInstance().clearStage(this.stageId,this.cards):this.FLAG_END_GAMEOVER&&StageController.getInstance().gameOverStage(this.stageId,this.cards)));if(this.FLAG_RED_BOY_REST?this.FLAG_SHOW_NEXT_BALL&&!this.FLAG_NOT_ANY_BALL&&(this.nextBall.x--,this.nextBall.x<=1170&&(this.FLAG_SHOW_NEXT_BALL=!1,this.nextBall.touchEnabled=!0,0!=this.machineAllList.length&&(this.nextBall=this.machineAllList.shift(),0===this.machineAllList.length&&(this.FLAG_NOT_ANY_BALL=!0)))):3===this.FLAG_RED_THROW_NUM&&(this.red.movieClipData=this.mcFactory.generateMovieClipData("red_rest"),this.red.x=1181.6,this.red.y=734.1,this.red.gotoAndStop(1),Util.singletonPush(this.cards,77),this.FLAG_RED_BOY_REST=!0,this.FLAG_SHOW_NEXT_BALL=!0,this.red.touchEnabled=!1,this.container.setChildIndex(this.red,this.container.getChildIndex(this.machine))),this.FLAG_RED_THROW&&(this.FLAG_SHOW_RED_BALL||(38===this.red.currentFrame?(this.redBallThrow.visible=!0,this.redBallThrow.x=965.3,this.redBallThrow.y=702.1,this.red.gotoAndPlay(39),SoundManager.getInstance().playSound(SoundEnum.BOWLINGTHROWSOUND_MP3),egret.Tween.get(this.redBallThrow).to({y:252},540).call(function(){SoundManager.getInstance().playSound(SoundEnum.WARESOUND_MP3),t.FLAG_SHOW_RED_BALL=!0,t.redBallThrow.y=702.1,t.redBallThrow.gotoAndStop(1),t.redBallThrow.visible=!1})):this.red.nextFrame()),this.FLAG_SHOW_RED_BALL&&(this.rightPin.nextFrame(),this.rightPin.currentFrame===this.rightPin.totalFrames&&(this.rightPin.movieClipData=this.mcFactory.generateMovieClipData("pin_back"),this.rightPin.y=267.45,this.rightPin.gotoAndStop(1),this.FLAG_PIN_ACTION=!0,this.FLAG_SHOW_RED_BALL=!1)),this.FLAG_PIN_ACTION&&(this.rightPin.nextFrame(),this.rightPin.currentFrame===this.rightPin.totalFrames&&(this.rightPin.movieClipData=this.mcFactory.generateMovieClipData("strike"),this.rightPin.y=155.95,this.rightPin.gotoAndStop(1),egret.Tween.get(this.rightPin).to({y:267.45},500),this.FLAG_RED_THROW_NUM++,this["board2_"+this.FLAG_RED_THROW_NUM].visible=!0,this.FLAG_PIN_ACTION=!1,this.FLAG_RED_THROW=!1)),this.red.currentFrame===this.red.totalFrames&&(this.red.movieClipData=this.mcFactory.generateMovieClipData("red_stand"))),this.FLAG_SH_BLUE_BAD&&(this.FLAG_END_GAMEOVER=!0),this.FLAG_SH_THROW1){if(47===this.boy.currentFrame)switch(this.redBallThrow.x=319.3,this.redBallThrow.y=702.1,this.redBallThrow.gotoAndPlay(1),this.redBallThrow.visible=!0,this.FLAG_SH_THROW1=!1,this.boy.gotoAndPlay(48),Util.singletonPush(this.cards,74),Math.floor(3*Math.random())){case 0:egret.Tween.get(this.redBallThrow).to({y:252,x:229.3,scaleX:.6,scaleY:.6},4e3).call(function(){SoundManager.getInstance().playSound(SoundEnum.BOWLINGGUTTERSOUND_MP3)}).to({x:249.3,y:242,scaleX:.45,scaleY:.45},1400).call(function(){t.redBallThrow.gotoAndStop(1),t.redBallThrow.visible=!1,t.board1_3.visible=!0,t.boy.movieClipData=t.mcFactory.generateMovieClipData("sh_bad"),t.boy.play(),t.FLAG_END_GAMEOVER=!0});break;case 1:egret.Tween.get(this.redBallThrow).to({y:252,x:409.3,scaleX:.6,scaleY:.6},3600).call(function(){SoundManager.getInstance().playSound(SoundEnum.BOWLINGGUTTERSOUND_MP3)}).to({x:389.3,y:242,scaleX:.45,scaleY:.45},1700).call(function(){t.redBallThrow.gotoAndStop(1),t.redBallThrow.visible=!1,t.board1_3.visible=!0,t.boy.movieClipData=t.mcFactory.generateMovieClipData("sh_bad"),t.boy.play(),t.FLAG_END_GAMEOVER=!0});break;case 2:egret.Tween.get(this.redBallThrow).to({y:252,x:229.3,scaleX:.6,scaleY:.6},3900).call(function(){SoundManager.getInstance().playSound(SoundEnum.BOWLINGGUTTERSOUND_MP3)}).to({x:249.3,y:242,scaleX:.45,scaleY:.45},1600).call(function(){t.redBallThrow.gotoAndStop(1),t.redBallThrow.visible=!1,t.board1_3.visible=!0,t.boy.movieClipData=t.mcFactory.generateMovieClipData("sh_bad"),t.boy.play(),t.FLAG_END_GAMEOVER=!0})}this.boy.nextFrame()}this.FLAG_SH_THROW2&&(this.FLAG_ROBOT_WALK===!1&&(47===this.boy.currentFrame?(this.robotBall2.x=319.3,this.robotBall2.y=702.1,this.robotBall2.visible=!0,this.robotBall2.gotoAndPlay(1),this.FLAG_ROBOT_WALK=!0,this.boy.gotoAndPlay(48)):this.boy.nextFrame()),this.FLAG_ROBOT_WALK&&this.robotBall2.currentFrame===this.robotBall2.totalFrames&&(this.FLAG_ROBOT_WALK=!1,this.FLAG_LEFT_PIN=!0),this.FLAG_LEFT_PIN&&(this.robotBall2.visible=!1,this.leftPin.movieClipData=this.mcFactory.generateMovieClipData("strick_sh"),this.leftPin.play(),this.FLAG_BOY_SCORE=!0,this.FLAG_LEFT_PIN=!1),this.FLAG_BOY_SCORE&&this.leftPin.currentFrame===this.leftPin.totalFrames&&(this.board1_3.visible=!0,this.board1_3.texture=this.sheet.getTexture("good"),SoundManager.getInstance().playSound(SoundEnum.CORRECTSOUND_MP3),this.FLAG_SH_THROW2=!1,this.FLAG_END_CLEAR=!0,Util.singletonPush(this.cards,76)))},e.prototype._remove=function(){egret.Tween.removeAllTweens()},e.prototype.registItem=function(t){ItemController.getInstance().addItem(t)&&(t===ItemEnum.ITEM_RED_BALL&&(this.FLAG_RED_BOY_REST?(this.FLAG_SHOW_NEXT_BALL=!0,this.nextBall=this.redBall2,this.nextBall.mask=this.machineMask,this.nextBall.visible=!0,this.redBall1.visible=!1):(this.redBall1.x=1221,this.redBall1.y=852.1,this.redBall1.visible=!1)),t===ItemEnum.ITEM_RED_BALL_2&&(this.FLAG_RED_BOY_REST?(this.FLAG_SHOW_NEXT_BALL=!0,this.nextBall=this.redBall3,this.nextBall.mask=this.machineMask,this.nextBall.visible=!0,this.redBall2.visible=!1):(this.redBall2.x=1221,this.redBall2.y=852.1,this.redBall2.visible=!1)),t===ItemEnum.ITEM_RED_BALL_3&&(this.FLAG_RED_BOY_REST?(this.FLAG_SHOW_NEXT_BALL=!0,this.nextBall=this.robotBall,this.nextBall.mask=this.machineMask,this.nextBall.visible=!0,this.redBall3.visible=!1):(this.redBall3.x=1221,this.redBall3.y=852.1,this.redBall3.visible=!1)),t===ItemEnum.ITEM_BLUE_BALL&&(this.FLAG_SHOW_NEXT_BALL=!0,this.nextBall=this.redBall1,this.nextBall.mask=this.machineMask,this.nextBall.visible=!0,this.blueBall.visible=!1),t===ItemEnum.ITEM_ROBOT_BALL&&(this.robotBall.visible=!1))},e.prototype.useItem=function(t,e,i){return this.FLAG_RED_THROW||this.FLAG_SH_THROW1||this.FLAG_SH_THROW2?!1:t===ItemEnum.ITEM_RED_BALL?this.red.hitTestPoint(e,i)?this.FLAG_RED_BOY_REST?!1:(this.red.movieClipData=this.mcFactory.generateMovieClipData("red_throw"),this.FLAG_RED_THROW=!0,!0):this.boy.hitTestPoint(e,i)?(this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_throw1"),this.boy.gotoAndPlay(1),this.FLAG_SH_THROW1=!0,!0):!1:t===ItemEnum.ITEM_RED_BALL_2?this.red.hitTestPoint(e,i)?(this.red.movieClipData=this.mcFactory.generateMovieClipData("red_throw"),this.FLAG_RED_THROW=!0,!0):this.boy.hitTestPoint(e,i)?(this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_throw1"),this.boy.gotoAndPlay(1),this.FLAG_SH_THROW1=!0,!0):!1:t===ItemEnum.ITEM_RED_BALL_3?this.red.hitTestPoint(e,i)?(this.red.movieClipData=this.mcFactory.generateMovieClipData("red_throw"),this.FLAG_RED_THROW=!0,!0):this.boy.hitTestPoint(e,i)?(this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_throw1"),this.FLAG_SH_THROW1=!0,!0):!1:t===ItemEnum.ITEM_BLUE_BALL?this.boy.hitTestPoint(e,i)?(Util.singletonPush(this.cards,75),this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_blue"),this.boy.gotoAndPlay(1),SoundManager.getInstance().playSound(SoundEnum.DON2SOUND_MP3),this.FLAG_SH_BLUE_BAD=!0,!0):!1:t===ItemEnum.ITEM_ROBOT_BALL&&this.boy.hitTestPoint(e,i)?(this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_throw2"),this.robotBall2=new egret.MovieClip,this.robotBall2.movieClipData=this.mcFactory.generateMovieClipData("robotwalk"),this.robotBall2.visible=!0,this.container.addChildAt(this.robotBall2,this.container.getChildIndex(this.leftPin)+1),this.FLAG_SH_THROW2=!0,!0):!1},e.prototype.getDisplayArea=function(){return new egret.Rectangle},e.prototype.ctrl_right=function(){},e.prototype.ctrl_left=function(){},e.prototype.ctrl_up=function(){},e.prototype.ctrl_down=function(){},e.prototype.ctrl_ok=function(){},e.prototype.ctrl_cancel=function(){},e
}(egret.DisplayObjectContainer);__reflect(Stage18.prototype,"Stage18",["IFKaihiStage"]);var Stage19=function(t){function e(){var e=t.call(this)||this;return e.FLAG_UMBRELLA_LAYING=!1,e.FLAG_BLUE_DRINK_GOT=!1,e.FLAG_SUNSHINE_UMBRELLA_USED=!1,e.FLAG_COLORFUL_UMBRELLA_USED=!1,e.FLAG_UMBRELLA_COLORING=!1,e.FLAG_FAN_USED=!1,e.FLAG_SHELL_USED=!1,e.FLAG_STAR_USED=!1,e.FLAG_UMBRELLA_COLORS=0,e.FLAG_GAME_OVER=!1,e.FLAG_CLEAR=!1,e.FLAG_INITED=!1,e.FLAG_SHINING=!1,e.FLAG_BOY_FIRING_TIMES=0,e.cards=[],e.COUNT_END=0,e._init(),e}return __extends(e,t),e.prototype._init=function(){return __awaiter(this,void 0,void 0,function(){var t,e,i,s,h,a,o;return __generator(this,function(n){switch(n.label){case 0:return UIManager.getInstance().showLoading(),[4,this._loadRes()];case 1:return n.sent(),this.mcFactory=new egret.MovieClipDataFactory(RES.getRes("stage19_action_json"),RES.getRes("stage19_action_png")),this.sheet=RES.getRes("stage19_texture"),t=new TSBitmap("bg",this.sheet),t.x=-120,t.y=-100,this.addChild(t),e=new TSBitmap("sea",this.sheet),e.anchorOffsetX=e.width/2,e.anchorOffsetY=e.height,e.x=320,e.y=592.25,this.addChild(e),egret.Tween.get(e,{loop:!0}).to({y:596.25},2e3).to({y:592.25},2e3),this.sun=new egret.MovieClip(this.mcFactory.generateMovieClipData("sun")),this.sun.x=320,this.sun.y=220.8,this.sun.play(-1),this.addChild(this.sun),this.sunshine=new egret.MovieClip(this.mcFactory.generateMovieClipData("shine")),this.sunshine.x=382.5,this.sunshine.y=357.8,this.sunshine.gotoAndStop(1),this.addChild(this.sunshine),i=new TSBitmap("sellor",this.sheet),i.x=33,i.y=379,this.addChild(i),this.fan=new TSBitmap("litshan",this.sheet,!0),this.fan.x=118,this.fan.y=451,this.fan.touchEnabled=!0,this.addChild(this.fan),s=new TSBitmap("gui",this.sheet),s.x=6,s.y=440,this.addChild(s),this.yellowDrink=new TSBitmap("yellow1",this.sheet,!0),this.yellowDrink.x=225.7,this.yellowDrink.y=534.8,this.yellowDrink.touchEnabled=!0,this.addChild(this.yellowDrink),this.redDrink=new TSBitmap("red1",this.sheet,!0),this.redDrink.x=195.8,this.redDrink.y=534.8,this.redDrink.touchEnabled=!0,this.addChild(this.redDrink),h=new TSBitmap("li",this.sheet),h.x=536,h.y=697.8,this.addChild(h),this.open_umbrella_front=new TSBitmap("umbrella",this.sheet,!0),this.open_umbrella_back=new TSBitmap("baisan",this.sheet,!0),this.open_umbrella_front.x=this.open_umbrella_back.x=411.6,this.open_umbrella_front.y=this.open_umbrella_back.y=474,this.open_umbrella_front.visible=this.open_umbrella_back.visible=!1,this.open_umbrella_front.touchEnabled=!0,this.addChild(this.open_umbrella_back),this.addChild(this.open_umbrella_front),this.umbrella=new TSBitmap("lisan",this.sheet,!0),this.umbrella.anchorOffsetY=this.umbrella.height,this.umbrella.x=574.7,this.umbrella.y=812.4,this.umbrella.touchEnabled=!0,this.addChild(this.umbrella),this.chair=new TSBitmap("white",this.sheet,!0),this.chair.x=447,this.chair.y=679,this.addChild(this.chair),a=new TSBitmap("shanzhi",this.sheet),a.x=400.55,a.y=534.8,this.addChild(a),this.standArea=new egret.Shape,this.standArea.graphics.beginFill(0,0),this.standArea.graphics.drawRect(380.15,507.4,60,60),this.standArea.graphics.endFill(),this.standArea.touchEnabled=!0,this.addChild(this.standArea),o=new TSBitmap("desk",this.sheet),o.x=511,o.y=678.8,this.addChild(o),this.blueDrink=new TSBitmap("drink",this.sheet,!0),this.blueDrink.x=591.05,this.blueDrink.y=683.05,this.blueDrink.touchEnabled=!0,this.addChild(this.blueDrink),this.colorful_umbrella=new TSBitmap("xiaoshan",this.sheet,!0),this.addChild(this.colorful_umbrella),this.colorful_umbrella.visible=!1,this.shell=new TSBitmap("beike",this.sheet,!0),this.shell.x=178.2,this.shell.y=842.8,this.shell.touchEnabled=!0,this.addChild(this.shell),this.boy=new egret.MovieClip(this.mcFactory.generateMovieClipData("sh_lay")),this.boy.x=441,this.boy.y=649,this.boy.gotoAndStop(1),this.addChild(this.boy),this.star=new TSBitmap("wuxing",this.sheet,!0),this.star.x=83,this.star.y=785.5,this.star.touchEnabled=!0,this.addChild(this.star),this.starOnBody=new TSBitmap("wuxingshen",this.sheet,!0),this.starOnBody.x=446.25,this.starOnBody.y=648,this.starOnBody.visible=!1,this.addChild(this.starOnBody),this.shellOnBody1=new TSBitmap("beikeshen",this.sheet,!0),this.shellOnBody1.x=455.2,this.shellOnBody1.y=620.3,this.shellOnBody1.visible=!1,this.addChild(this.shellOnBody1),this.shellOnBody2=new TSBitmap("beikeshen",this.sheet,!0),this.shellOnBody2.x=476,this.shellOnBody2.y=627,this.shellOnBody2.visible=!1,this.addChild(this.shellOnBody2),this.bodyAir=new egret.MovieClip(this.mcFactory.generateMovieClipData("sh_air")),this.bodyAir.x=456,this.bodyAir.y=587.3,this.bodyAir.visible=!1,this.addChild(this.bodyAir),this.fan.addEventListener(egret.TouchEvent.TOUCH_TAP,this.fanTouched,this),this.umbrella.addEventListener(egret.TouchEvent.TOUCH_TAP,this.umbrellaTouched,this),this.colorful_umbrella.addEventListener(egret.TouchEvent.TOUCH_TAP,this.colorfulUmbrellaTouched,this),this.star.addEventListener(egret.TouchEvent.TOUCH_TAP,this.starTouched,this),this.shell.addEventListener(egret.TouchEvent.TOUCH_TAP,this.shellTouched,this),this.redDrink.addEventListener(egret.TouchEvent.TOUCH_TAP,this.redDrinkTouched,this),this.yellowDrink.addEventListener(egret.TouchEvent.TOUCH_TAP,this.yellowDrinkTouched,this),this.blueDrink.addEventListener(egret.TouchEvent.TOUCH_TAP,this.blueDrinkTouched,this),this.open_umbrella_front.addEventListener(egret.TouchEvent.TOUCH_TAP,this.umbrellaTouched,this),UIManager.getInstance().hideLoading(),this.FLAG_INITED=!0,[2]}})})},e.prototype.colorfulUmbrellaTouched=function(t){this.registItem(ItemEnum.ITEM_COLORFUL_UMBRELLA)},e.prototype.fanTouched=function(t){this.registItem(ItemEnum.ITEM_FAN)},e.prototype.umbrellaTouched=function(t){var e=this;this.FLAG_UMBRELLA_LAYING===!1?egret.Tween.get(this.umbrella).to({rotation:-90},600).call(function(){e.FLAG_UMBRELLA_LAYING=!0}):this.registItem(ItemEnum.ITEM_SUNSHINE_UMBRELLA)},e.prototype.shellTouched=function(t){this.registItem(ItemEnum.ITEM_SHELL)},e.prototype.starTouched=function(t){this.registItem(ItemEnum.ITEM_STAR)},e.prototype.blueDrinkTouched=function(t){this.registItem(ItemEnum.ITEM_BLUE_DRINK),this.colorful_umbrella.visible=!0,this.colorful_umbrella.x=578.75,this.colorful_umbrella.y=652.35,this.colorful_umbrella.touchEnabled=!0,egret.Tween.get(this.colorful_umbrella).to({y:696.85},300).to({rotation:-18},100)},e.prototype.redDrinkTouched=function(t){this.registItem(ItemEnum.ITEM_RED_ICE)},e.prototype.yellowDrinkTouched=function(t){this.registItem(ItemEnum.ITEM_YELLOW_ICE)},e.prototype._loadRes=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,StageController.getInstance().loadStage(19)];case 1:return e.sent(),[3,3];case 2:return t=e.sent(),console.error(t),[3,3];case 3:return[2]}})})},e.prototype._start=function(){},e.prototype.play_loop=function(){if(this.FLAG_INITED){if(this.FLAG_CLEAR||this.FLAG_GAME_OVER)return console.log(this.COUNT_END),void(0===this.COUNT_END?(console.log(this.boy.currentFrame),console.log(this.boy.totalFrames),this.boy.currentFrame===this.boy.totalFrames&&this.COUNT_END++):(this.COUNT_END++,60===this.COUNT_END&&(this.FLAG_CLEAR?(Util.singletonPush(this.cards,84),StageController.getInstance().clearStage(19,this.cards)):this.FLAG_GAME_OVER&&(Util.singletonPush(this.cards,78),StageController.getInstance().gameOverStage(19,this.cards)))));if(4===this.FLAG_BOY_FIRING_TIMES)if(3===this.FLAG_UMBRELLA_COLORS)this.FLAG_CLEAR=!0,this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_clear"),this.boy.gotoAndPlay(1);else{if(this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_bad"),this.FLAG_GAME_OVER=!0,this.FLAG_STAR_USED){var t=new TSBitmap("wuxingyin",this.sheet,!0);t.x=this.starOnBody.x,t.y=this.starOnBody.y,this.addChildAt(t,this.getChildIndex(this.starOnBody)),egret.Tween.get(this.starOnBody).to({x:this.starOnBody.x+15,y:this.starOnBody.y+70},100)}if(this.FLAG_SHELL_USED){var e=new TSBitmap("beikeyin",this.sheet,!0);e.x=this.shellOnBody1.x,e.y=this.shellOnBody1.y,this.addChildAt(e,this.getChildIndex(this.shellOnBody1));var i=new TSBitmap("beikeyin",this.sheet,!0);i.x=this.shellOnBody2.x,i.y=this.shellOnBody2.y,this.addChildAt(i,this.getChildIndex(this.shellOnBody2)),egret.Tween.get(this.shellOnBody1).to({x:this.shellOnBody1.x-50,y:this.shellOnBody1.y+50},100),egret.Tween.get(this.shellOnBody2).to({x:this.shellOnBody2.x+12,y:this.shellOnBody2.y+40},100)}if(this.FLAG_FAN_USED){var s=new TSBitmap("fan",this.sheet,!0);s.x=541,s.y=703.5,this.addChild(s)}this.boy.gotoAndPlay(1)}this.FLAG_SHINING?(egret.Tween.get(this.sun).to({scaleX:.92,scaleY:.92},200).to({scaleX:1.25,scaleY:1.25,alpha:50},400).wait(1e3).to({scaleX:1,scaleY:1,alpha:1},1e3),this.sunshine.gotoAndPlay(1),this.FLAG_SHINING=!1,this.FLAG_UMBRELLA_COLORS<3&&(SoundManager.getInstance().playSound(SoundEnum.SHINE3SOUND_MP3),this.bodyAir.visible=!0,this.bodyAir.gotoAndPlay(1))):(this.sunshine.currentFrame===this.sunshine.totalFrames&&this.sunshine.gotoAndStop(1),this.bodyAir.currentFrame===this.bodyAir.totalFrames&&(this.bodyAir.visible=!1,this.bodyAir.gotoAndStop(1)),Util.loopPlay(this.boy,6*this.FLAG_BOY_FIRING_TIMES+1,6*(this.FLAG_BOY_FIRING_TIMES+1)))}},e.prototype._remove=function(){egret.Tween.removeAllTweens()},e.prototype.registItem=function(t){ItemController.getInstance().addItem(t)&&(t===ItemEnum.ITEM_FAN&&(this.fan.visible=!1,this.fan.touchEnabled=!1),t===ItemEnum.ITEM_STAR&&(this.star.visible=!1,this.star.touchEnabled=!1),t===ItemEnum.ITEM_SHELL&&(this.shell.visible=!1,this.shell.touchEnabled=!1),t===ItemEnum.ITEM_RED_ICE&&(this.redDrink.visible=!1),t===ItemEnum.ITEM_YELLOW_ICE&&(this.yellowDrink.visible=!1),t===ItemEnum.ITEM_BLUE_DRINK&&(this.blueDrink.visible=!1),t===ItemEnum.ITEM_COLORFUL_UMBRELLA&&(this.FLAG_COLORFUL_UMBRELLA_USED=!1,this.colorful_umbrella.visible=!1),t===ItemEnum.ITEM_SUNSHINE_UMBRELLA&&(this.FLAG_SUNSHINE_UMBRELLA_USED&&!this.FLAG_UMBRELLA_COLORING?(this.FLAG_SUNSHINE_UMBRELLA_USED=!1,this.open_umbrella_front.visible=!1,this.open_umbrella_back.visible=!1):this.umbrella.visible=!1))},e.prototype.useItem=function(t,e,i){var s=this;if(this.FLAG_CLEAR||this.FLAG_GAME_OVER)return!1;switch(t){case ItemEnum.ITEM_FAN:return this.boy.hitTestPoint(e,i)?(Util.singletonPush(this.cards,82),this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_fan"),this.FLAG_FAN_USED=!0,this.FLAG_BOY_FIRING_TIMES++,this.FLAG_SHINING=!0,!0):!1;case ItemEnum.ITEM_STAR:return this.boy.hitTestPoint(e,i)?(Util.singletonPush(this.cards,80),this.starOnBody.visible=!0,this.FLAG_BOY_FIRING_TIMES++,this.FLAG_SHINING=!0,this.FLAG_STAR_USED=!0,!0):!1;case ItemEnum.ITEM_SHELL:return this.boy.hitTestPoint(e,i)?(Util.singletonPush(this.cards,79),this.shellOnBody1.visible=!0,this.shellOnBody2.visible=!0,this.boy.gotoAndPlay(1),this.FLAG_BOY_FIRING_TIMES++,this.FLAG_SHINING=!0,this.FLAG_SHELL_USED=!0,!0):!1;case ItemEnum.ITEM_YELLOW_ICE:if(this.FLAG_SUNSHINE_UMBRELLA_USED&&this.open_umbrella_front.hitTestPoint(e,i)){this.FLAG_UMBRELLA_COLORING=!0,this.FLAG_UMBRELLA_COLORS++;var h=new TSBitmap("yellowdrink",this.sheet);h.x=469.7,h.y=343.5,this.addChild(h);var a=new TSBitmap("yellowdrop",this.sheet);return a.x=467.7,a.y=407.5,this.addChild(a),egret.Tween.get(a).to({y:435},400).call(function(){var t=new TSBitmap("yellowshan",s.sheet,!0);t.x=411.6,t.y=474,s.addChildAt(t,s.getChildIndex(a)),s.FLAG_BOY_FIRING_TIMES++,s.FLAG_SHINING=!0,SoundManager.getInstance().playSound(SoundEnum.WATER4SOUND_MP3)}).to({y:407.5}).wait(100).to({y:427.5},400).to({y:407.5}).wait(100).to({y:427.5},400).wait(100).call(function(){h.visible=!1,a.visible=!1}),!0}return!1;case ItemEnum.ITEM_RED_ICE:if(this.FLAG_SUNSHINE_UMBRELLA_USED&&this.open_umbrella_front.hitTestPoint(e,i)){this.FLAG_UMBRELLA_COLORING=!0,this.FLAG_UMBRELLA_COLORS++;var o=new TSBitmap("reddrink",this.sheet);o.x=408.05,o.y=345,this.addChild(o);var n=new TSBitmap("reddrop",this.sheet);return n.x=403.05,n.y=409,this.addChild(n),egret.Tween.get(n).to({y:435},300).call(function(){var t=new TSBitmap("redshan",s.sheet,!0);t.x=411.6,t.y=474,s.addChildAt(t,s.getChildIndex(n)),s.FLAG_BOY_FIRING_TIMES++,s.FLAG_SHINING=!0,SoundManager.getInstance().playSound(SoundEnum.WATER4SOUND_MP3)}).to({y:409}).wait(100).to({y:429},400).to({y:409}).wait(100).to({y:429},400).wait(100).call(function(){o.visible=!1,n.visible=!1}),!0}return!1;case ItemEnum.ITEM_BLUE_DRINK:if(this.open_umbrella_front.hitTestPoint(e,i)&&this.FLAG_SUNSHINE_UMBRELLA_USED){this.FLAG_UMBRELLA_COLORING=!0,this.FLAG_UMBRELLA_COLORS++;var r=new TSBitmap("bluedrink",this.sheet);r.x=338.6,r.y=349,this.addChild(r);var l=new TSBitmap("bluedrop",this.sheet);return l.x=333.6,l.y=415,this.addChild(l),egret.Tween.get(l).to({y:435},300).call(function(){var t=new TSBitmap("blueshan",s.sheet,!0);t.x=411.6,t.y=474,s.addChildAt(t,s.getChildIndex(l)),s.FLAG_BOY_FIRING_TIMES++,s.FLAG_SHINING=!0,SoundManager.getInstance().playSound(SoundEnum.WATER4SOUND_MP3)}).to({y:415}).wait(100).to({y:435},400).to({y:415}).wait(100).to({y:435},400).wait(100).call(function(){r.visible=!1,l.visible=!1}),!0}return!1;case ItemEnum.ITEM_COLORFUL_UMBRELLA:return this.standArea.hitTestPoint(e,i)&&!this.FLAG_SUNSHINE_UMBRELLA_USED?(Util.singletonPush(this.cards,81),this.colorful_umbrella.x=410.15,this.colorful_umbrella.y=537.4,this.colorful_umbrella.visible=!0,this.FLAG_BOY_FIRING_TIMES++,this.FLAG_SHINING=!0,this.FLAG_COLORFUL_UMBRELLA_USED=!0,!0):!1;case ItemEnum.ITEM_SUNSHINE_UMBRELLA:return this.standArea.hitTestPoint(e,i)&&!this.FLAG_COLORFUL_UMBRELLA_USED?(Util.singletonPush(this.cards,83),SoundManager.getInstance().playSound(SoundEnum.UMBRELLASOUND_MP3),this.open_umbrella_back.visible=!0,this.open_umbrella_front.visible=!0,this.FLAG_SUNSHINE_UMBRELLA_USED=!0,this.FLAG_BOY_FIRING_TIMES++,this.FLAG_SHINING=!0,!0):!1}return!1},e.prototype.getDisplayArea=function(){return new egret.Rectangle},e.prototype.ctrl_right=function(){},e.prototype.ctrl_left=function(){},e.prototype.ctrl_up=function(){},e.prototype.ctrl_down=function(){},e.prototype.ctrl_ok=function(){},e.prototype.ctrl_cancel=function(){},e}(egret.DisplayObjectContainer);__reflect(Stage19.prototype,"Stage19",["IFKaihiStage"]);var Stage2=function(t){function e(){var e=t.call(this)||this;return e.STAGE_ID=2,e.FLAG_GAME_OVER=!1,e.FLAG_CLEAR=!1,e.FLAG_WRESLER_CRY=!1,e.FLAG_BOY_TO_FUKU=!1,e.START_FIGHT=!1,e.ARENA_FINISH=!1,e.MVHELP_FUKU_STEP=0,e.MVHELP_BOY_TO_POKA_STEP=0,e.COUNTER_END=0,e.WIN_FRAME=0,e.FLAG_HIGHLIGHT_CHANGE=5,e._init(),e}return __extends(e,t),e.prototype._init=function(){return __awaiter(this,void 0,void 0,function(){var t,e,i,s,h,a,o,n,r;return __generator(this,function(l){switch(l.label){case 0:return UIManager.getInstance().showLoading(),[4,this._loadRes()];case 1:return l.sent(),UIManager.getInstance().hideLoading(),this.sheet=RES.getRes("stage2_texture"),t=new TSBitmap("bg",this.sheet),t.x=-120,t.y=-150,this.addChild(t),this.audi_back=new TSBitmap("audiance_front",this.sheet),this.audi_back.x=-440+this.audi_back.width/2,this.audi_back.y=505,this.addChild(this.audi_back),this.audi_left=new TSBitmap("audiance_left",this.sheet),this.audi_right=new TSBitmap("audiance_right",this.sheet),this.audi_up=new TSBitmap("audiance_up",this.sheet),this.audi_front=new TSBitmap("audiance_back",this.sheet),this.audi_front.x=-440+this.audi_front.width/2,this.audi_front.y=431,this.addChild(this.audi_front),e=new TSBitmap("arena",this.sheet),e.x=-120,e.y=658,this.addChild(e),i=new TSBitmap("line",this.sheet),i.x=-120,i.y=492,this.addChild(i),s=new TSBitmap("light",this.sheet),s.x=-120,s.y=0,this.addChild(s),this.high_light=new egret.Sprite,this.high_light.x=320,this.high_light.y=211,this.addChild(this.high_light),this.light_left=new TSBitmap("light_right",this.sheet),this.light_left.scaleX=-1,this.light_left.anchorOffsetX=this.light_left.width/2,this.light_left.anchorOffsetY=0,this.light_left.x=-232,this.light_left.y=-45-this.light_left.height/2,this.high_light.addChild(this.light_left),this.ligth_right=new TSBitmap("light_right",this.sheet),this.ligth_right.anchorOffsetX=this.light_left.width/2,this.ligth_right.anchorOffsetY=0,this.ligth_right.x=232,this.ligth_right.y=-44-this.ligth_right.height/2,this.high_light.addChild(this.ligth_right),this.light_mid=new TSBitmap("light_mid",this.sheet),this.light_mid.anchorOffsetX=this.light_mid.width/2,this.light_mid.anchorOffsetY=0,this.light_mid.x=0,this.light_mid.y=-38-this.light_mid.height/2,this.high_light.addChild(this.light_mid),h=RES.getRes("stage2_role_action_json"),a=RES.getRes("stage2_role_action_png"),this.roleMcFactory=new egret.MovieClipDataFactory(h,a),this.boy=new egret.MovieClip(this.roleMcFactory.generateMovieClipData("boy_stand")),this.boy.anchorOffsetX=.5,this.boy.anchorOffsetY=.5,this.boy.x=492,this.boy.y=640,this.addChild(this.boy),this.wresler=new egret.MovieClip(this.roleMcFactory.generateMovieClipData("wresler_stand")),this.wresler.x=193.35,this.wresler.y=631.75,this.addChild(this.wresler),this.fuku=new egret.MovieClip(this.roleMcFactory.generateMovieClipData("fuku_attack")),this.fuku.x=555,this.fuku.y=432,this.fuku.gotoAndStop(1),this.fuku.visible=!1,this.addChild(this.fuku),o=RES.getRes("stage2_fight_lose_json"),n=RES.getRes("stage2_fight_lose_png"),r=new egret.MovieClipDataFactory(o,n),this.fight_lose=new egret.MovieClip(r.generateMovieClipData("fight_lose")),this.fight_lose.x=319,this.fight_lose.y=630,this.fight_lose.gotoAndStop(1),this.fight_lose.visible=!1,this.addChild(this.fight_lose),this.start_btn=new TSBitmap("fight",this.sheet),this.start_btn.anchorOffsetX=this.start_btn.width/2,this.start_btn.anchorOffsetY=this.start_btn.height/2,this.start_btn.x=320,this.start_btn.y=872,this.start_btn.touchEnabled=!0,this.addChild(this.start_btn),this.touch_area_wresler=new egret.Shape,this.touch_area_wresler.graphics.beginFill(255),this.touch_area_wresler.graphics.drawRect(155,477,80,80),this.touch_area_wresler.graphics.endFill(),this.touch_area_wresler.touchEnabled=!0,this.touch_area_wresler.alpha=0,this.addChild(this.touch_area_wresler),this.touch_area_cry_wresler=new egret.Shape,this.touch_area_cry_wresler.graphics.beginFill(255),this.touch_area_cry_wresler.x=155,this.touch_area_cry_wresler.y=577,this.touch_area_cry_wresler.graphics.drawRect(0,0,80,80),this.touch_area_cry_wresler.graphics.endFill(),this.touch_area_cry_wresler.alpha=0,this.touch_area_cry_wresler.touchEnabled=!0,this.addChild(this.touch_area_cry_wresler),this.touch_area_boy=new egret.Shape,this.touch_area_boy.graphics.beginFill(255),this.touch_area_boy.x=442,this.touch_area_boy.y=480,this.touch_area_boy.graphics.drawRect(0,0,108,124),this.touch_area_boy.graphics.endFill(),this.touch_area_boy.graphics.endFill(),this.touch_area_boy.touchEnabled=!0,this.touch_area_boy.alpha=0,this.addChild(this.touch_area_boy),this.touch_area_fuku=new egret.Shape,this.touch_area_fuku.graphics.beginFill(255),this.touch_area_fuku.graphics.drawRect(510,217,80,80),this.touch_area_fuku.graphics.endFill(),this.touch_area_fuku.touchEnabled=!0,this.touch_area_fuku.alpha=0,this.addChild(this.touch_area_fuku),this.cards=[],this.addAllEventListener(),[2]}})})},e.prototype.addAllEventListener=function(){this.start_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.playFight,this),this.touch_area_wresler.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onGetMask,this),this.touch_area_fuku.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onGetMask,this)},e.prototype.playFight=function(){this.removeAllEventListener(),this.start_btn.touchEnabled=!1,this.start_btn.visible=!1,this.START_FIGHT=!0,SoundManager.getInstance().playSound(SoundEnum.GONGSTARTSOUND_MP3),this.FLAG_WRESLER_CRY===!1?(this.boy.movieClipData=this.roleMcFactory.generateMovieClipData("boy_move"),this.boy.gotoAndStop(0),this.wresler.movieClipData=this.roleMcFactory.generateMovieClipData("wresler_move"),this.wresler.gotoAndStop(0)):(this.boy.movieClipData=this.roleMcFactory.generateMovieClipData("boy_move"),this.boy.gotoAndStop(0)),this.removeAllEventListener()},e.prototype.removeAllEventListener=function(){this.touch_area_wresler.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onGetMask,this),this.touch_area_fuku.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onGetMask,this)},e.prototype.onGetMask=function(){ItemController.getInstance().addItem(ItemEnum.ITEM_MASK)&&(this.wresler.movieClipData=this.roleMcFactory.generateMovieClipData("wresler_cry"),this.wresler.x=151,this.wresler.y=687,this.FLAG_WRESLER_CRY=!0,this.FLAG_BOY_TO_FUKU=!1,this.boy.visible=!0,this.fuku.visible=!1,Util.singletonPush(this.cards,4),this.touch_area_wresler.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onGetMask,this))},e.prototype.wreslerUseMask=function(){this.wresler.movieClipData=this.roleMcFactory.generateMovieClipData("wresler_stand"),this.wresler.x=193.35,this.wresler.y=631.75,this.touch_area_wresler.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onGetMask,this),this.FLAG_WRESLER_CRY=!1},e.prototype.boyUseMask=function(){this.FLAG_BOY_TO_FUKU=!0,this.boy.visible=!1,this.fuku.visible=!0,this.touch_area_fuku.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onGetMask,this)},e.prototype._loadRes=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,StageController.getInstance().loadStage(2)];case 1:return e.sent(),[3,3];case 2:return t=e.sent(),console.error(t),[3,3];case 3:return[2]}})})},e.prototype._start=function(){},e.prototype.play_loop=function(){return this.FLAG_CLEAR?(this.light_left.rotation+=this.FLAG_HIGHLIGHT_CHANGE,this.light_mid.rotation+=this.FLAG_HIGHLIGHT_CHANGE,this.ligth_right.rotation+=this.FLAG_HIGHLIGHT_CHANGE,this.light_left.rotation>30&&(this.FLAG_HIGHLIGHT_CHANGE=-5),this.light_left.rotation<-30&&(this.FLAG_HIGHLIGHT_CHANGE=5),1===this.COUNTER_END&&SoundManager.getInstance().playSound(SoundEnum.KANSEISOUND_1),this.COUNTER_END++,void(60===this.COUNTER_END&&StageController.getInstance().clearStage(this.STAGE_ID,this.cards))):void(this.FLAG_GAME_OVER||(this.ARENA_FINISH===!0?(this.FLAG_WRESLER_CRY&&this.wresler.nextFrame(),this.FLAG_BOY_TO_FUKU?(this.fuku.currentFrame===this.fuku.totalFrames&&(SoundManager.getInstance().playSound(SoundEnum.GONGENDSOUND_MP3),this.FLAG_CLEAR=!0,Util.singletonPush(this.cards,5)),this.fuku.nextFrame()):(this.boy.currentFrame===this.boy.totalFrames&&(this.FLAG_WRESLER_CRY?(SoundManager.getInstance().playSound(SoundEnum.GONGENDSOUND_MP3),this.FLAG_CLEAR=!0,Util.singletonPush(this.cards,6),this.boy.movieClipData=this.roleMcFactory.generateMovieClipData("boy_clear")):(this.FLAG_GAME_OVER=!0,Util.singletonPush(this.cards,3),StageController.getInstance().gameOverStage(this.STAGE_ID,this.cards))),this.boy.nextFrame())):(this.FLAG_WRESLER_CRY===!0&&Util.loopPlay(this.wresler),this.START_FIGHT===!0&&(this.FLAG_BOY_TO_FUKU===!0?this.fuku.currentFrame===this.fuku.totalFrames?this.MVHELP_FUKU_STEP>=1?(this.fuku.gotoAndStop(1),1===this.MVHELP_FUKU_STEP&&(this.MVHELP_FUKU_STEP=2,egret.Tween.get(this.fuku,{loop:!1}).to({x:this.touch_area_cry_wresler.x,y:this.touch_area_cry_wresler.y},1e3).call(this.HitWresler,this,[]))):(this.fuku.movieClipData=this.roleMcFactory.generateMovieClipData("fuku_roll"),this.fuku.gotoAndStop(1),this.fuku.y-=200,this.MVHELP_FUKU_STEP=1):this.fuku.nextFrame():this.FLAG_WRESLER_CRY===!0?this.boy.x<this.wresler.x+this.wresler.width?0===this.MVHELP_BOY_TO_POKA_STEP?(this.MVHELP_BOY_TO_POKA_STEP=1,this.boy.movieClipData=this.roleMcFactory.generateMovieClipData("pokapoka"),this.boy.gotoAndStop(1)):1===this.MVHELP_BOY_TO_POKA_STEP&&(this.boy.currentFrame===this.boy.totalFrames-5&&SoundManager.getInstance().playSound(SoundEnum.GONGENDSOUND_MP3),Util.loopPlay(this.boy),this.WIN_FRAME+=1,45===this.WIN_FRAME&&(this.ARENA_FINISH=!0,this.boy.movieClipData=this.roleMcFactory.generateMovieClipData("boy_clear"),this.boy.gotoAndStop(1))):0===this.MVHELP_BOY_TO_POKA_STEP&&(Util.loopPlay(this.boy),this.boy.x-=2):(this.boy.x<this.wresler.x+this.wresler.width?(Util.loopPlay(this.boy),Util.loopPlay(this.wresler),this.boy.x-=1,this.wresler.x+=1,this.boy.x<this.wresler.x+this.wresler.width-60&&(this.boy.visible=!1,this.wresler.visible=!1,this.fight_lose.visible=!0,this.fight_lose.nextFrame())):(this.boy.x-=2,this.wresler.x+=2,Util.loopPlay(this.boy),Util.loopPlay(this.wresler)),this.fight_lose.currentFrame===this.fight_lose.totalFrames&&(this.ARENA_FINISH=!0))))))},e.prototype.HitWresler=function(){SoundManager.getInstance().playSound(SoundEnum.KICKSOUND_MP3),this.wresler.movieClipData=this.roleMcFactory.generateMovieClipData("wresler_damage"),this.wresler.gotoAndStop(1),this.ARENA_FINISH=!0,this.fuku.movieClipData=this.roleMcFactory.generateMovieClipData("fuku_clear"),this.fuku.x=304,this.fuku.y=641},e.prototype._remove=function(){egret.Tween.removeAllTweens()},e.prototype.registItem=function(t){},e.prototype.useItem=function(t,e,i){return 1===t&&this.touch_area_boy.hitTestPoint(e,i)?(this.boyUseMask(),!0):1===t&&this.touch_area_cry_wresler.hitTestPoint(e,i)?(this.wreslerUseMask(),!0):!1},e.prototype.getDisplayArea=function(){return new egret.Rectangle},e.prototype.ctrl_right=function(){},e.prototype.ctrl_left=function(){},e.prototype.ctrl_up=function(){},e.prototype.ctrl_down=function(){},e.prototype.ctrl_ok=function(){},e.prototype.ctrl_cancel=function(){},e}(egret.DisplayObjectContainer);__reflect(Stage2.prototype,"Stage2",["IFKaihiStage"]);var Stage20=function(t){function e(){var e=t.call(this)||this;return e.FLAG_READING=!1,e.FLAG_CUTTING_HAIR=!1,e.FLAG_WIND_HAIR=!1,e.FLAG_WATER_HAIR=!1,e.FLAG_HAIR_STRIGHT=!1,e.FLAG_ENDING_CLEAR=!1,e.FLAG_ENDING_GAMEOVER=!1,e.COUNTER_HAIRING=0,e.COUNTER_ENDING=0,e.COUNTER_READING=0,e.READING_BOOK=-1,e.cards=[],e._init(),e}return __extends(e,t),e.prototype._init=function(){return __awaiter(this,void 0,void 0,function(){var t,e,i,s,h,a,o,n,r,l;return __generator(this,function(c){switch(c.label){case 0:return UIManager.getInstance().showLoading(),[4,this._loadRes()];case 1:return c.sent(),this.mcFactory=new egret.MovieClipDataFactory(RES.getRes("stage20_action_json"),RES.getRes("stage20_action_png")),this.sheet=RES.getRes("stage20_texture"),t=new TSBitmap("bg",this.sheet),t.x=-120,t.y=-100,this.addChild(t),e=new egret.MovieClip(this.mcFactory.generateMovieClipData("light")),e.x=108.05,e.y=556.8,e.play(-1),this.addChild(e),i=new TSBitmap("title",this.sheet),i.x=468,i.y=529,this.addChild(i),s=new TSBitmap("room",this.sheet),s.x=-120,s.y=-100,this.addChild(s),h=new TSBitmap("che",this.sheet),h.x=475,h.y=668,this.addChild(h),a=new TSBitmap("waters",this.sheet),a.x=557,a.y=605,this.addChild(a),o=new TSBitmap("bookdesk",this.sheet),o.x=-29,o.y=698,this.addChild(o),this.scissors=new TSBitmap("jiandao",this.sheet),this.scissors.x=437.35,this.scissors.y=756.65,this.scissors.touchEnabled=!0,this.addChild(this.scissors),this.clipper=new TSBitmap("windmachine",this.sheet,!0),this.clipper.x=586.1,this.clipper.y=735.9,this.clipper.touchEnabled=!0,this.addChild(this.clipper),this.grow_water=new TSBitmap("hairwater",this.sheet,!0),this.grow_water.x=529.1,this.grow_water.y=646.5,this.grow_water.touchEnabled=!0,this.addChild(this.grow_water),this.gray_book=new TSBitmap("white",this.sheet,!0),this.gray_book.x=148.8,this.gray_book.y=733.6,this.gray_book.touchEnabled=!0,this.addChild(this.gray_book),this.red_book=new TSBitmap("red",this.sheet,!0),this.red_book.x=121.15,this.red_book.y=806.5,this.red_book.touchEnabled=!0,this.addChild(this.red_book),this.blue_book=new TSBitmap("blue",this.sheet,!0),this.blue_book.x=71.55,this.blue_book.y=733.6,this.blue_book.touchEnabled=!0,this.addChild(this.blue_book),this.boy=new egret.MovieClip(this.mcFactory.generateMovieClipData("sh")),this.boy.x=415.25,this.boy.y=697,this.addChild(this.boy),n=new TSBitmap("chair",this.sheet,!0),n.x=321.05,n.y=758.4,this.addChild(n),this.guest=new egret.MovieClip(this.mcFactory.generateMovieClipData("sit")),this.guest.x=323,this.guest.y=723.2,this.addChild(this.guest),this.hairStyle=new egret.MovieClip(this.mcFactory.generateMovieClipData("hair")),this.hairStyle.x=320.35,this.hairStyle.y=563.1,this.hairStyle.gotoAndStop(1),this.addChild(this.hairStyle),this.pop=new egret.Sprite,this.addChild(this.pop),this.style_pop=new TSBitmap("style1",this.sheet),this.style_pop.x=-114,this.style_pop.y=-127,this.pop.addChild(this.style_pop),r=new TSBitmap("pop",this.sheet),r.x=-41,r.y=-34,this.pop.addChild(r),l=new TSBitmap("pop",this.sheet),l.x=-24,l.y=-22,this.pop.addChild(l),this.pop.x=278.8,this.pop.y=531.8,this.pop.scaleX=this.pop.scaleY=0,this.drop_hair=new TSBitmap("haironground",this.sheet),this.drop_hair.x=376.15,this.drop_hair.y=761.65,this.addChild(this.drop_hair),this.pour=new TSBitmap("pour",this.sheet,!0),this.watering=new egret.MovieClip(this.mcFactory.generateMovieClipData("water")),this.dropAction(),this.showPop(),this.addAllEventListener(),UIManager.getInstance().hideLoading(),[2]}})})},e.prototype.hidePop=function(){this.pop.visible=!1,this.pop.scaleX=this.pop.scaleY=0},e.prototype.showPop=function(){this.pop.visible=!0,egret.Tween.get(this.pop).to({scaleX:1,scaleY:1},300)},e.prototype.dropAction=function(){SoundManager.getInstance().playSound(SoundEnum.KUSASOUND_MP3),egret.Tween.get(this.drop_hair).to({y:885.65},400),egret.Tween.get(this.scissors).to({y:861.65-this.scissors.height/2},200).to({x:497.35-this.scissors.width/2},300).call(function(){SoundManager.getInstance().playSound(SoundEnum.METAL2SOUND_MP3)})},e.prototype.addAllEventListener=function(){this.red_book.addEventListener(egret.TouchEvent.TOUCH_TAP,this.redBookTouched,this),this.blue_book.addEventListener(egret.TouchEvent.TOUCH_TAP,this.blueBookTouched,this),this.gray_book.addEventListener(egret.TouchEvent.TOUCH_TAP,this.greyBookTouched,this),this.scissors.addEventListener(egret.TouchEvent.TOUCH_TAP,this.scissorsTouched,this),this.clipper.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clipperTouched,this),this.grow_water.addEventListener(egret.TouchEvent.TOUCH_TAP,this.waterTouched,this)},e.prototype.waterTouched=function(){this.registItem(ItemEnum.ITEM_HAIR_GROW_WATER)},e.prototype.clipperTouched=function(){this.registItem(ItemEnum.ITEM_CLIPPER)},e.prototype.redBookTouched=function(){this.registItem(ItemEnum.ITEM_RED_BOOK)},e.prototype.blueBookTouched=function(){this.registItem(ItemEnum.ITEM_BLUE_BOOK)},e.prototype.greyBookTouched=function(t){this.registItem(ItemEnum.ITEM_GREY_BOOK)},e.prototype.scissorsTouched=function(){this.registItem(ItemEnum.ITEM_SCISSORS)},e.prototype._loadRes=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,StageController.getInstance().loadStage(20)];case 1:return e.sent(),[3,3];case 2:return t=e.sent(),console.error(t),[3,3];case 3:return[2]}})})},e.prototype._start=function(){},e.prototype.play_loop=function(){if(this.FLAG_ENDING_CLEAR&&(this.COUNTER_ENDING++,this.COUNTER_ENDING>60&&StageController.getInstance().clearStage(20,this.cards)),this.FLAG_ENDING_GAMEOVER&&(this.COUNTER_ENDING++,this.COUNTER_ENDING>60&&StageController.getInstance().gameOverStage(20,this.cards),30===this.COUNTER_ENDING&&(this.FLAG_HAIR_STRIGHT?(this.boy.movieClipData=this.mcFactory.generateMovieClipData("bad1"),this.boy.play()):(this.boy.movieClipData=this.mcFactory.generateMovieClipData("bad2"),this.boy.play()))),this.FLAG_READING&&(this.COUNTER_READING++,this.COUNTER_READING>60)){switch(this.READING_BOOK){case ItemEnum.ITEM_RED_BOOK:this.red_book.visible=!0,this.style_pop.texture=this.sheet.getTexture("style2");break;case ItemEnum.ITEM_BLUE_BOOK:this.blue_book.visible=!0,this.style_pop.texture=this.sheet.getTexture("style1");break;case ItemEnum.ITEM_GREY_BOOK:this.gray_book.visible=!0,this.style_pop.texture=this.sheet.getTexture("style3")}this.showPop(),this.guest.movieClipData=this.mcFactory.generateMovieClipData("sit"),this.guest.gotoAndStop(1),this.COUNTER_READING=0,this.FLAG_READING=!1}this.FLAG_WATER_HAIR&&(this.COUNTER_HAIRING++,this.COUNTER_HAIRING>60&&(this.watering.visible=!1,this.pour.visible=!1,this.boy.visible=!1,this.guest.movieClipData=this.mcFactory.generateMovieClipData("hair_grow"),this.guest.x=318.9,this.guest.y=735.15,this.guest.play(),this.FLAG_ENDING_GAMEOVER=!0,this.COUNTER_HAIRING=0,this.FLAG_WATER_HAIR=!1)),this.FLAG_CUTTING_HAIR&&(this.COUNTER_HAIRING++,this.COUNTER_HAIRING>60&&(this.COUNTER_HAIRING=0,this.handMc.visible=!1,this.READING_BOOK===ItemEnum.ITEM_GREY_BOOK?this.FLAG_HAIR_STRIGHT?(this.boy.gotoAndStop(4),SoundManager.getInstance().playSound(SoundEnum.SHINESOUND_MP3),this.hairStyle.gotoAndStop(4),Util.singletonPush(this.cards,87),this.FLAG_ENDING_CLEAR=!0,this.guest.movieClipData=this.mcFactory.generateMovieClipData("clear"),this.guest.play(-1)):(this.boy.gotoAndStop(3),SoundManager.getInstance().playSound(SoundEnum.SHINESOUND_MP3),this.hairStyle.gotoAndStop(2),Util.singletonPush(this.cards,86),this.FLAG_ENDING_GAMEOVER=!0,this.guest.movieClipData=this.mcFactory.generateMovieClipData("sit2")):this.FLAG_HAIR_STRIGHT?(this.hairStyle.gotoAndStop(4),SoundManager.getInstance().playSound(SoundEnum.SHINESOUND_MP3),this.boy.gotoAndStop(4),Util.singletonPush(this.cards,86),this.FLAG_ENDING_GAMEOVER=!0,this.guest.movieClipData=this.mcFactory.generateMovieClipData("sit2")):(this.boy.gotoAndStop(3),SoundManager.getInstance().playSound(SoundEnum.SHINESOUND_MP3),this.hairStyle.gotoAndStop(2),Util.singletonPush(this.cards,86),this.FLAG_ENDING_GAMEOVER=!0,this.guest.movieClipData=this.mcFactory.generateMovieClipData("sit2")),this.FLAG_CUTTING_HAIR=!1)),this.FLAG_WIND_HAIR&&(this.COUNTER_HAIRING++,this.COUNTER_HAIRING>60&&(this.hairStyle.gotoAndStop(3),this.FLAG_HAIR_STRIGHT=!0,this.clipperMc.visible=!1,this.COUNTER_HAIRING=0,this.FLAG_WIND_HAIR=!1))
},e.prototype._remove=function(){egret.Tween.removeAllTweens()},e.prototype.registItem=function(t){if(ItemController.getInstance().addItem(t))switch(t){case ItemEnum.ITEM_BLUE_BOOK:this.blue_book.visible=!1;break;case ItemEnum.ITEM_RED_BOOK:this.red_book.visible=!1;break;case ItemEnum.ITEM_GREY_BOOK:this.gray_book.visible=!1;break;case ItemEnum.ITEM_SCISSORS:this.scissors.visible=!1;break;case ItemEnum.ITEM_CLIPPER:this.clipper.visible=!1;break;case ItemEnum.ITEM_HAIR_GROW_WATER:this.grow_water.visible=!1}},e.prototype.useItem=function(t,e,i){switch(t){case ItemEnum.ITEM_HAIR_GROW_WATER:return this.hairStyle.hitTestPoint(e,i)?(Util.singletonPush(this.cards,85),this.hidePop(),this.pour.x=355.95,this.pour.y=447.5,this.addChild(this.pour),this.watering.x=355.95-30.6,this.watering.y=521.75,this.watering.play(-1),SoundManager.getInstance().playSound(SoundEnum.WATER8SOUND_MP3),this.addChild(this.watering),this.FLAG_WATER_HAIR=!0,!0):!1;case ItemEnum.ITEM_BLUE_BOOK:return this.guest.hitTestPoint(e,i)&&!this.FLAG_READING?(this.hidePop(),this.guest.movieClipData=this.mcFactory.generateMovieClipData("read"),this.guest.gotoAndStop(1),this.FLAG_READING=!0,Util.singletonPush(this.cards,88),this.READING_BOOK=ItemEnum.ITEM_BLUE_BOOK,!0):!1;case ItemEnum.ITEM_RED_BOOK:return this.guest.hitTestPoint(e,i)&&!this.FLAG_READING?(this.hidePop(),this.guest.movieClipData=this.mcFactory.generateMovieClipData("read"),this.guest.gotoAndStop(2),this.FLAG_READING=!0,Util.singletonPush(this.cards,88),this.READING_BOOK=ItemEnum.ITEM_RED_BOOK,!0):!1;case ItemEnum.ITEM_GREY_BOOK:return this.guest.hitTestPoint(e,i)&&!this.FLAG_READING?(this.hidePop(),this.guest.movieClipData=this.mcFactory.generateMovieClipData("read"),this.guest.gotoAndStop(3),this.FLAG_READING=!0,Util.singletonPush(this.cards,88),this.READING_BOOK=ItemEnum.ITEM_GREY_BOOK,!0):!1;case ItemEnum.ITEM_SCISSORS:return this.boy.hitTestPoint(e,i)?(this.boy.gotoAndStop(2),this.handMc=new egret.MovieClip(this.mcFactory.generateMovieClipData("sh_hand")),this.handMc.x=299.05,this.handMc.y=563.7,this.addChild(this.handMc),SoundManager.getInstance().playSound(SoundEnum.KUSASOUND_MP3),this.handMc.play(-1),this.FLAG_CUTTING_HAIR=!0,!0):!1;case ItemEnum.ITEM_CLIPPER:if(this.boy.hitTestPoint(e,i))return this.clipperMc=new egret.MovieClip(this.mcFactory.generateMovieClipData("wind")),this.clipperMc.x=382.55,this.clipperMc.y=628.4,this.addChild(this.clipperMc),SoundManager.getInstance().playSound(SoundEnum.DRYERSOUND_MP3),this.clipperMc.play(-1),this.FLAG_WIND_HAIR=!0,!0}return!1},e.prototype.getDisplayArea=function(){return new egret.Rectangle},e.prototype.ctrl_right=function(){},e.prototype.ctrl_left=function(){},e.prototype.ctrl_up=function(){},e.prototype.ctrl_down=function(){},e.prototype.ctrl_ok=function(){},e.prototype.ctrl_cancel=function(){},e}(egret.DisplayObjectContainer);__reflect(Stage20.prototype,"Stage20",["IFKaihiStage"]);var Stage21=function(t){function e(){var e=t.call(this)||this;return e.FLAG_END_GAMEOVER=!1,e.FLAG_END_CLEAR=!1,e.FLAG_CLOCK_SHOW=!1,e.FLAG_NINJA_SHOW=!1,e.FLAG_BOY_BOX=0,e.FLAG_LEFT_DOOR_FIRST_OPEN=!1,e.FLAG_UP_DOOR_OPEN=!1,e.FLAG_DOWN_DOOR_OPEN=!1,e.FLAG_LEFT_DOOR_OPEN=!1,e.FLAG_RIGHT_DOOR_OPEN=!1,e.FLAG_MONTH_TWO=!1,e.FLAG_BUDAI_OPENED=!1,e.FLAG_GHOST_COMMING_IN=!1,e.COUNTER_END=0,e.FLAG_BEANS_GOT=0,e.SEED_LIST=[ItemEnum.ITEM_SEED,ItemEnum.ITEM_SEED_1,ItemEnum.ITEM_SEED_2,ItemEnum.ITEM_SEED_3,ItemEnum.ITEM_SEED_4],e.FLAG_NEED_BEANS=10,e.FLAG_LEVEL_2_TOUCHED_TIMES=0,e.FLAG_LEVEL_3_TOUCHED_TIMES=0,e.FLAG_LEVEL_4_TOUCHED_TIMES=0,e.FLAG_BEANS_GROW_TIMES=0,e.FLAG_BEANS_GROWN=!1,e.cards=[],e._init(),e}return __extends(e,t),e.prototype._init=function(){return __awaiter(this,void 0,void 0,function(){var t,e,i,s,h,a,o,n,r,l,l,l;return __generator(this,function(c){switch(c.label){case 0:return UIManager.getInstance().showLoading(),[4,this._loadRes()];case 1:for(c.sent(),this.mcFactory=new egret.MovieClipDataFactory(RES.getRes("stage21_action_json"),RES.getRes("stage21_action_png")),this.sheet=RES.getRes("stage21_texture"),this.container=new egret.Sprite,this.container.x=0,this.container.y=0,this.addChild(this.container),t=new TSBitmap("bg",this.sheet),t.x=-120,t.y=-100,this.container.addChild(t),this.ghost=new egret.MovieClip(this.mcFactory.generateMovieClipData("ghost_stand")),this.ghost.x=399.95,this.ghost.y=559.35,this.ghost.gotoAndStop(1),this.container.addChild(this.ghost),e=new TSBitmap("wall",this.sheet),e.x=-120,e.y=-100,this.container.addChild(e),i=new TSBitmap("ceil",this.sheet,!0),i.x=640,i.y=43.7,this.container.addChild(i),this.dida=new TSBitmap("dida",this.sheet),this.dida.anchorOffsetX=this.dida.width/2,this.dida.anchorOffsetY=0,this.dida.x=586.05,this.dida.y=340.75,this.container.addChild(this.dida),this.clock=new TSBitmap("clock",this.sheet,!0),this.clock.x=586.05,this.clock.y=296.75,this.container.addChild(this.clock),this.clock_point=new egret.MovieClip(this.mcFactory.generateMovieClipData("clock_point")),this.clock_point.x=584.55,this.clock_point.y=312.55,this.clock_point.gotoAndStop(1),this.container.addChild(this.clock_point),this.clock_bird=new egret.MovieClip(this.mcFactory.generateMovieClipData("clock_bird")),this.clock_bird.x=585.05,this.clock_bird.y=269.75,this.clock_bird.gotoAndStop(1),this.container.addChild(this.clock_bird),this.clockArea=new egret.Shape,this.clockArea.graphics.beginFill(255),this.clockArea.graphics.drawRect(546.05,256.75,80,80),this.clockArea.graphics.endFill(),this.clockArea.touchEnabled=!0,this.clockArea.alpha=0,this.container.addChild(this.clockArea),this.bean5=new TSBitmap("bean",this.sheet,!0),this.bean5.x=586.05,this.bean5.y=296.75,this.bean5.visible=!1,this.bean5Area=new egret.Shape,this.bean5Area.graphics.beginFill(255),this.bean5Area.graphics.drawRect(546.05,256.75,80,80),this.bean5Area.graphics.endFill(),this.bean5Area.touchEnabled=!1,this.bean5Area.alpha=0,this.container.addChild(this.bean5Area),s=new TSBitmap("iceberg",this.sheet),s.x=118,s.y=492,this.container.addChild(s),this.ice=new TSBitmap("ice",this.sheet,!0),this.ice.x=168.5,this.ice.y=649.6,this.ice.touchEnabled=!0,this.container.addChild(this.ice),this.udoor=new TSBitmap("door_u1",this.sheet,!0),this.udoor.x=181.05,this.udoor.y=531.7,this.udoor.touchEnabled=!0,this.container.addChild(this.udoor),this.ddoor=new TSBitmap("door_d1",this.sheet,!0),this.ddoor.x=181.75,this.ddoor.y=617.1,this.ddoor.touchEnabled=!0,this.container.addChild(this.ddoor),this.ldoor=new TSBitmap("ldoor",this.sheet,!0),this.ldoor.x=190.5,this.ldoor.y=568.75,this.ldoor.touchEnabled=!0,this.container.addChild(this.ldoor),this.drop=new TSBitmap("drop",this.sheet),this.drop.x=817.35,this.drop.y=165.7,this.container.addChild(this.drop),h=new TSBitmap("month2",this.sheet,!0),h.x=1183.6,h.y=317.25,this.container.addChild(h),this.bean7=new TSBitmap("bean",this.sheet,!0),this.bean7.x=1222.85,this.bean7.y=281.25,this.container.addChild(this.bean7),this.bean7Area=new egret.Shape,this.bean7Area.graphics.beginFill(255),this.bean7Area.graphics.drawRect(1182.85,241.25,80,80),this.bean7Area.graphics.endFill(),this.bean7Area.touchEnabled=!0,this.bean7Area.alpha=0,this.container.addChild(this.bean7Area),this.budai=new TSBitmap("budai",this.sheet,!0),this.budai.x=1222.85,this.budai.y=281.25,this.budai.touchEnabled=!0,this.container.addChild(this.budai),this.month1=new TSBitmap("month1",this.sheet,!0),this.month1.x=1183.6,this.month1.y=332.85,this.month1.touchEnabled=!0,this.container.addChild(this.month1),a=new TSBitmap("light",this.sheet),a.x=172,a.y=99,this.container.addChild(a),this.bean2=new TSBitmap("bean",this.sheet,!0),this.bean2.x=242.85,this.bean2.y=355.25,this.container.addChild(this.bean2),this.bean2Area=new egret.Shape,this.bean2Area.graphics.beginFill(255),this.bean2Area.graphics.drawRect(202.85,315.25,80,80),this.bean2Area.graphics.endFill(),this.bean2Area.touchEnabled=!0,this.bean2Area.alpha=0,this.container.addChild(this.bean2Area),this.ninja=new TSBitmap("ninja",this.sheet,!0),this.ninja.x=985,this.ninja.y=890,this.container.addChild(this.ninja),this.bean6=new TSBitmap("bean",this.sheet,!0),this.bean6.x=976.5,this.bean6.y=825.75,this.container.addChild(this.bean6),this.bean6Area=new egret.Shape,this.bean6Area.graphics.beginFill(255),this.bean6Area.graphics.drawRect(936.5,785.75,80,80),this.bean6Area.graphics.endFill(),this.bean6Area.touchEnabled=!0,this.bean6Area.alpha=0,this.container.addChild(this.bean6Area),o=new TSBitmap("grids",this.sheet,!0),o.x=640,o.y=975,this.container.addChild(o),n=new TSBitmap("shuipen",this.sheet,!0),n.x=817.35,n.y=750,this.container.addChild(n),this.bean3=new TSBitmap("bean",this.sheet,!0),this.bean3.x=82.45,this.bean3.y=400.65,this.container.addChild(this.bean3),this.rdoor=new TSBitmap("rdoor",this.sheet,!0),this.rdoor.x=392,this.rdoor.y=567.75,this.rdoor.touchEnabled=!0,this.container.addChild(this.rdoor),this.bean3Area=new egret.Shape,this.bean3Area.graphics.beginFill(255),this.bean3Area.graphics.drawRect(66.7-40,723.65,80,80),this.bean3Area.graphics.endFill(),this.bean3Area.touchEnabled=!0,this.bean3Area.alpha=0,this.container.addChild(this.bean3Area),this.grid=new TSBitmap("grid",this.sheet,!0),this.grid.x=975.7,this.grid.y=866.8,this.grid.touchEnabled=!0,this.container.addChild(this.grid),this.bean1=new TSBitmap("bean",this.sheet,!0),this.bean1.x=495.1,this.bean1.y=809.05,this.container.addChild(this.bean1),this.bean1Area=new egret.Shape,this.bean1Area.graphics.beginFill(255),this.bean1Area.graphics.drawRect(455.1,769.05,80,80),this.bean1Area.graphics.endFill(),this.bean1Area.touchEnabled=!0,this.bean1Area.alpha=0,this.container.addChild(this.bean1Area),this.bean4=new TSBitmap("bean",this.sheet,!0),this.bean4.x=328.7,this.bean4.y=907.3,this.container.addChild(this.bean4),this.bean4Area=new egret.Shape,this.bean4Area.graphics.beginFill(255),this.bean4Area.graphics.drawRect(288.7,867.3,80,80),this.bean4Area.graphics.endFill(),this.bean4Area.touchEnabled=!0,this.bean4Area.alpha=0,this.bean4Area.touchEnabled=!1,this.container.addChild(this.bean4Area),this.boy=new egret.MovieClip(this.mcFactory.generateMovieClipData("sh_sit")),this.boy.x=178,this.boy.y=800,this.container.addChild(this.boy),this.desk=new TSBitmap("desk",this.sheet,!0),this.desk.x=336.85,this.desk.y=866.85,this.desk.touchEnabled=!0,this.container.addChild(this.desk),this.woodLevel1=new egret.Sprite,this.woodLevel1.x=997.8,this.woodLevel1.y=697.75,l=0;4>l;l++)r=new TSBitmap("wood",this.sheet),r.x=70*l,this.woodLevel1.addChild(r);for(this.container.addChild(this.woodLevel1),this.woodLevel2=new egret.Sprite,this.woodLevel2.x=1067.8,this.woodLevel2.y=627.75,this.woodLevel2.touchEnabled=!0,l=0;3>l;l++)r=new TSBitmap("wood",this.sheet),r.x=70*l,this.woodLevel2.addChild(r);for(this.container.addChild(this.woodLevel2),this.woodLevel3=new egret.Sprite,this.woodLevel3.x=1137.8,this.woodLevel3.y=557.75,this.woodLevel3.touchEnabled=!0,l=0;2>l;l++)r=new TSBitmap("wood",this.sheet),r.x=70*l,this.woodLevel3.addChild(r);return this.container.addChild(this.woodLevel3),this.woodLevel4=new egret.Sprite,this.woodLevel4.x=1207.8,this.woodLevel4.y=487.75,r=new TSBitmap("wood",this.sheet),this.woodLevel4.addChild(r),this.woodLevel4.touchEnabled=!0,this.container.addChild(this.woodLevel4),this.huapen=new TSBitmap("huapen",this.sheet),this.huapen.x=1207.8,this.huapen.y=416.6,this.container.addChild(this.huapen),this.beans=new egret.MovieClip(this.mcFactory.generateMovieClipData("beans")),this.beans.x=1207.8,this.beans.y=396.6+this.beans.height,this.container.addChild(this.beans),this.beansMask=new egret.Shape,this.beansMask.graphics.beginFill(255),this.beansMask.graphics.drawRect(1205.75+this.beans.width-39,347.75,78.85,95.55),this.beansMask.graphics.endFill(),this.beansMask.touchEnabled=!0,this.beansMask.alpha=0,this.beans.mask=this.beansMask,this.container.addChild(this.beansMask),this.beansArea=new egret.Shape,this.beansArea.graphics.beginFill(255),this.beansArea.graphics.drawRect(787.8,416.6-this.beans.height+50.4,80,80),this.beansArea.graphics.endFill(),this.beansArea.touchEnabled=!1,this.beansArea.alpha=0,this.container.addChild(this.beansArea),this.pop=new TSBitmap("pop",this.sheet),this.pop.anchorOffsetX=0,this.pop.anchorOffsetY=this.pop.height,this.pop.x=230.35,this.pop.y=740,this.pop.scaleX=this.pop.scaleY=this.pop.alpha=0,this.container.addChild(this.pop),this.count_text=new egret.TextField,this.count_text.x=230.35+7.95+10,this.count_text.y=665.9,this.count_text.height=54,this.count_text.width=82.35,this.count_text.size=50,this.count_text.textColor=0,this.count_text.textAlign="center",this.count_text.text=this.FLAG_NEED_BEANS.toString(),this.count_text.visible=!1,this.container.addChild(this.count_text),this.leftArrow=new TSBitmap("arrow_png"),this.leftArrow.x=40,this.leftArrow.y=510,this.leftArrow.touchEnabled=!0,this.leftArrow.visible=!1,this.addChild(this.leftArrow),this.rightArrow=new TSBitmap("arrow_png"),this.rightArrow.scaleX=-1,this.rightArrow.x=600,this.rightArrow.y=510,this.rightArrow.touchEnabled=!0,this.addChild(this.rightArrow),this.addAllEventListener(),UIManager.getInstance().hideLoading(),this.knockAction(),this.dropAction(),this.clockAction(),[2]}})})},e.prototype.addAllEventListener=function(){this.bean1Area.addEventListener(egret.TouchEvent.TOUCH_TAP,this.bean1AreaTouched,this),this.bean2Area.addEventListener(egret.TouchEvent.TOUCH_TAP,this.bean2AreaTouched,this),this.bean3Area.addEventListener(egret.TouchEvent.TOUCH_TAP,this.bean3AreaTouched,this),this.bean4Area.addEventListener(egret.TouchEvent.TOUCH_TAP,this.bean4AreaTouched,this),this.bean5Area.addEventListener(egret.TouchEvent.TOUCH_TAP,this.bean5AreaTouched,this),this.bean6Area.addEventListener(egret.TouchEvent.TOUCH_TAP,this.bean6AreaTouched,this),this.bean7Area.addEventListener(egret.TouchEvent.TOUCH_TAP,this.bean7AreaTouched,this),this.beansArea.addEventListener(egret.TouchEvent.TOUCH_TAP,this.beansAreaTouched,this),this.desk.addEventListener(egret.TouchEvent.TOUCH_TAP,this.deskTouched,this),this.grid.addEventListener(egret.TouchEvent.TOUCH_TAP,this.gridTouched,this),this.ldoor.addEventListener(egret.TouchEvent.TOUCH_TAP,this.leftDoorTouched,this),this.rdoor.addEventListener(egret.TouchEvent.TOUCH_TAP,this.rightDoorTouched,this),this.udoor.addEventListener(egret.TouchEvent.TOUCH_TAP,this.upDoorTouched,this),this.ddoor.addEventListener(egret.TouchEvent.TOUCH_TAP,this.downDoorTouched,this),this.ice.addEventListener(egret.TouchEvent.TOUCH_TAP,this.iceTouched,this),this.clockArea.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clockAreaTouched,this),this.woodLevel2.addEventListener(egret.TouchEvent.TOUCH_TAP,this.woodLevel2Touched,this),this.woodLevel3.addEventListener(egret.TouchEvent.TOUCH_TAP,this.woodLevel3Touched,this),this.woodLevel4.addEventListener(egret.TouchEvent.TOUCH_TAP,this.woodLevel4Touched,this),this.month1.addEventListener(egret.TouchEvent.TOUCH_TAP,this.monthTouched,this),this.budai.addEventListener(egret.TouchEvent.TOUCH_TAP,this.budaiTouched,this),this.leftArrow.addEventListener(egret.TouchEvent.TOUCH_TAP,this.leftArrowTouched,this),this.rightArrow.addEventListener(egret.TouchEvent.TOUCH_TAP,this.rightArrowTouched,this)},e.prototype.removeAllEventListener=function(){this.bean1Area.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.bean1AreaTouched,this),this.bean2Area.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.bean2AreaTouched,this),this.bean3Area.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.bean3AreaTouched,this),this.bean4Area.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.bean4AreaTouched,this),this.bean5Area.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.bean5AreaTouched,this),this.bean6Area.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.bean6AreaTouched,this),this.bean7Area.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.bean7AreaTouched,this),this.beansArea.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.beansAreaTouched,this),this.grid.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.gridTouched,this),this.ldoor.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.leftDoorTouched,this),this.rdoor.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.rightDoorTouched,this),this.udoor.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.upDoorTouched,this),this.ddoor.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.downDoorTouched,this),this.month1.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.monthTouched,this),this.budai.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.budaiTouched,this),this.ice.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.iceTouched,this),this.clockArea.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clockAreaTouched,this),this.woodLevel2.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.woodLevel2Touched,this),this.woodLevel3.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.woodLevel3Touched,this),this.woodLevel4.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.woodLevel4Touched,this),this.leftArrow.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.leftArrowTouched,this),this.rightArrow.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.rightArrowTouched,this)},e.prototype.clockAreaTouched=function(t){this.clock_point.currentFrame===this.clock_point.totalFrames?(SoundManager.getInstance().playSound(SoundEnum.HATODOKEISOUND_MP3),this.clock_bird.gotoAndPlay(1),this.FLAG_CLOCK_SHOW=!0,this.clock_point.gotoAndStop(1),this.bean5Area.touchEnabled=!0):(SoundManager.getInstance().playSound(SoundEnum.KACHISOUND_MP3),this.clock_point.nextFrame())},e.prototype.iceTouched=function(t){this.registItem(ItemEnum.ITEM_ICE_BOX)},e.prototype.monthTouched=function(t){var e=this;this.removeAllEventListener(),SoundManager.getInstance().playSound(SoundEnum.BIRISOUND_MP3),this.FLAG_MONTH_TWO=!0,egret.Tween.get(this.month1).to({x:this.month1.x+90,y:this.month1.y+100,alpha:0},660).call(function(){e.addAllEventListener()})},e.prototype.budaiTouched=function(t){!this.FLAG_BUDAI_OPENED&&this.FLAG_MONTH_TWO&&(this.budai.texture=this.sheet.getTexture("budai2"),this.budai.x=this.budai.x-23+24,this.budai.y=this.budai.y-2+21,this.FLAG_BUDAI_OPENED=!0)},e.prototype.deskTouched=function(t){var e=this;this.desk.touchEnabled=!1,egret.Tween.get(this.desk).to({x:368.75},1e3).call(function(){e.bean4Area.touchEnabled=!0})},e.prototype.gridTouched=function(t){this.FLAG_NINJA_SHOW?(this.FLAG_NINJA_SHOW=!1,egret.Tween.get(this.grid).to({y:866.8,scaleX:1,scaleY:1},200)):(this.FLAG_NINJA_SHOW=!0,egret.Tween.get(this.grid).to({y:989.8,scaleX:1.39,scaleY:1.32},200))},e.prototype.bean1AreaTouched=function(t){this.getSeed()&&(this.bean1.visible=!1,this.bean1Area.visible=!1)},e.prototype.bean2AreaTouched=function(t){this.getSeed()&&(this.bean2.visible=!1,this.bean2Area.visible=!1)},e.prototype.bean3AreaTouched=function(t){this.getSeed()&&(this.bean3.visible=!1,this.bean3Area.visible=!1)},e.prototype.bean4AreaTouched=function(t){this.getSeed()&&(this.bean4.visible=!1,this.bean4Area.visible=!1)},e.prototype.bean5AreaTouched=function(t){this.FLAG_CLOCK_SHOW&&(this.getSeed()&&(this.bean5Area.visible=!1,this.clock_bird.movieClipData=this.mcFactory.generateMovieClipData("clock_bird2")),this.clock_bird.play())},e.prototype.bean6AreaTouched=function(t){this.FLAG_NINJA_SHOW&&this.getSeed()&&(this.bean6.visible=!1,this.bean6Area.visible=!1)},e.prototype.bean7AreaTouched=function(t){this.FLAG_BUDAI_OPENED&&this.getSeed()&&(this.bean7.visible=!1,this.bean7Area.visible=!1)},e.prototype.beansAreaTouched=function(t){this.FLAG_BEANS_GOT<3&&this.getSeed()&&(this.FLAG_BEANS_GOT++,this.beans.currentFrame<this.beans.totalFrames&&this.beans.gotoAndStop(2+this.FLAG_BEANS_GOT))},e.prototype.leftDoorTouched=function(t){this.FLAG_LEFT_DOOR_OPEN?(SoundManager.getInstance().playSound(SoundEnum.FUSUMAOPENSOUND_MP3),egret.Tween.get(this.ldoor).to({x:190.5},200),this.FLAG_LEFT_DOOR_OPEN=!1):(SoundManager.getInstance().playSound(SoundEnum.FUSUMACLOSESOUND_MP3),this.FLAG_LEFT_DOOR_FIRST_OPEN===!1&&(this.FLAG_LEFT_DOOR_FIRST_OPEN=!0,this.bean3Area.touchEnabled=!0,egret.Tween.get(this.bean3).to({y:750.65},500).to({x:62.45,y:755.65,rotation:70},100).to({x:42.45,y:757.65,rotation:-80},100).to({x:32.45,y:759.65},100).to({x:32.45-10,y:761.65},100).to({x:27.45,y:762.65,rotation:130},100).to({x:24.45,y:763.65,rotation:-60},100)),egret.Tween.get(this.ldoor).to({x:340.45},200),this.FLAG_LEFT_DOOR_OPEN=!0)},e.prototype.rightDoorTouched=function(t){var e=this;this.FLAG_RIGHT_DOOR_OPEN?egret.Tween.get(this.rdoor).to({x:340.45},200):(egret.Tween.removeTweens(this.rdoor),this.FLAG_LEFT_DOOR_OPEN&&(egret.Tween.get(this.ldoor).to({x:190.5},200),this.FLAG_LEFT_DOOR_OPEN=!1),egret.Tween.get(this.rdoor).to({x:190.5},200).call(function(){1===e.FLAG_BOY_BOX?e.boy.gotoAndStop(9):0===e.FLAG_NEED_BEANS?(e.boy.gotoAndStop(8),e.pop.visible=!1,SoundManager.getInstance().playSound(SoundEnum.SHINE3SOUND_MP3)):e.FLAG_NEED_BEANS>0&&e.boy.gotoAndStop(7),e.ghost.movieClipData=e.mcFactory.generateMovieClipData("ghost_in"),e.FLAG_GHOST_COMMING_IN=!0}))},e.prototype.upDoorTouched=function(t){this.FLAG_UP_DOOR_OPEN?(this.udoor.texture=this.sheet.getTexture("door_u1"),this.udoor.x=181.05,this.FLAG_UP_DOOR_OPEN=!1):(this.udoor.texture=this.sheet.getTexture("door_u2"),this.udoor.x=236.3,this.FLAG_UP_DOOR_OPEN=!0)},e.prototype.downDoorTouched=function(t){this.FLAG_DOWN_DOOR_OPEN?(SoundManager.getInstance().playSound(SoundEnum.REIZOUKOCLOSESOUND_MP3),this.ddoor.texture=this.sheet.getTexture("door_d1"),this.ddoor.x=181.05,this.FLAG_DOWN_DOOR_OPEN=!1):(SoundManager.getInstance().playSound(SoundEnum.REIZOUKOOPENSOUND_MP3),this.ddoor.texture=this.sheet.getTexture("door_d2"),this.ddoor.x=236.3,this.FLAG_DOWN_DOOR_OPEN=!0)},e.prototype.woodLevel2Touched=function(t){var e=this;3===this.FLAG_LEVEL_2_TOUCHED_TIMES||(this.FLAG_LEVEL_2_TOUCHED_TIMES++,this.removeAllEventListener(),egret.Tween.get(this.beans).to({x:this.beans.x-70},500),egret.Tween.get(this.beansMask).to({x:this.beansMask.x-70},500),egret.Tween.get(this.huapen).to({x:this.huapen.x-70},500),egret.Tween.get(this.woodLevel2).to({x:this.woodLevel2.x-70},500),egret.Tween.get(this.woodLevel3).to({x:this.woodLevel3.x-70},500),egret.Tween.get(this.woodLevel4).to({x:this.woodLevel4.x-70},500).call(function(){e.addAllEventListener()}))},e.prototype.woodLevel3Touched=function(t){var e=this;2===this.FLAG_LEVEL_3_TOUCHED_TIMES||(this.FLAG_LEVEL_3_TOUCHED_TIMES++,this.removeAllEventListener(),egret.Tween.get(this.beans).to({x:this.beans.x-70},500),egret.Tween.get(this.beansMask).to({x:this.beansMask.x-70},500),egret.Tween.get(this.huapen).to({x:this.huapen.x-70},500),egret.Tween.get(this.woodLevel3).to({x:this.woodLevel3.x-70},500),egret.Tween.get(this.woodLevel4).to({x:this.woodLevel4.x-70},500).call(function(){e.addAllEventListener()}))},e.prototype.woodLevel4Touched=function(t){var e=this;1===this.FLAG_LEVEL_4_TOUCHED_TIMES||(this.FLAG_LEVEL_4_TOUCHED_TIMES++,this.removeAllEventListener(),egret.Tween.get(this.beans).to({x:this.beans.x-70},500),egret.Tween.get(this.beansMask).to({x:this.beansMask.x-70},500),egret.Tween.get(this.huapen).to({x:this.huapen.x-70},500),egret.Tween.get(this.woodLevel4).to({x:this.woodLevel4.x-70},500).call(function(){e.addAllEventListener()}))},e.prototype.clockAction=function(){egret.Tween.get(this.dida,{loop:!0}).to({rotation:-30},500).to({rotation:0},500).to({rotation:30},500).to({rotation:0},500)},e.prototype.knockAction=function(){egret.Tween.get(this.rdoor,{loop:!0}).wait(1e3).to({scaleX:1.05,scaleY:1.05},100).call(function(){SoundManager.getInstance().playSound(SoundEnum.KICKSOUND_MP3)}).to({scaleX:1,scaleY:1},150).to({scaleX:1.05,scaleY:1.05},100).call(function(){SoundManager.getInstance().playSound(SoundEnum.KICKSOUND_MP3)}).to({scaleX:1,scaleY:1},150).to({scaleX:1.05,scaleY:1.05},100).call(function(){SoundManager.getInstance().playSound(SoundEnum.KICKSOUND_MP3)}).to({scaleX:1,scaleY:1},150)},e.prototype.dropAction=function(){var t=this;egret.Tween.get(this.drop,{loop:!0}).to({y:416.6},600).call(function(){3===t.FLAG_LEVEL_2_TOUCHED_TIMES&&2===t.FLAG_LEVEL_3_TOUCHED_TIMES&&1===t.FLAG_LEVEL_4_TOUCHED_TIMES&&(t.drop.visible=!1,t.FLAG_BEANS_GROWN||(t.FLAG_BEANS_GROW_TIMES<5?(t.FLAG_BEANS_GROW_TIMES++,SoundManager.getInstance().playSound(SoundEnum.UPSOUND_MP3),egret.Tween.get(t.beans).to({y:t.beans.y-14},600)):(t.FLAG_BEANS_GROWN=!0,t.beans.gotoAndStop(2),t.beansArea.touchEnabled=!0)))}).to({y:741.9},400).call(function(){t.drop.visible=!0})},e.prototype.rightArrowTouched=function(t){this.rightArrow.visible=!1,this.leftArrow.visible=!0,egret.Tween.get(this.container).to({x:-640},500)},e.prototype.leftArrowTouched=function(t){this.leftArrow.visible=!1,this.rightArrow.visible=!0,egret.Tween.get(this.container).to({x:0},500)},e.prototype._loadRes=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,StageController.getInstance().loadStage(21)];case 1:return e.sent(),[3,3];case 2:return t=e.sent(),console.error(t),[3,3];case 3:return[2]}})})},e.prototype.getSeed=function(){for(var t=0;t<this.SEED_LIST.length;t++)if(-1===ItemController.getInstance().getIndexOf(this.SEED_LIST[t]))return ItemController.getInstance().addItem(this.SEED_LIST[t]);return UIManager.getInstance().showItemFullTip(),!1},e.prototype._start=function(){},e.prototype.play_loop=function(){return this.FLAG_END_CLEAR?(this.COUNTER_END++,void(60===this.COUNTER_END&&StageController.getInstance().clearStage(21,this.cards))):this.FLAG_END_GAMEOVER?(this.COUNTER_END++,void(60===this.COUNTER_END&&StageController.getInstance().gameOverStage(21,this.cards))):(this.FLAG_CLOCK_SHOW===!0&&this.clock_bird.currentFrame===this.clock_bird.totalFrames&&(this.FLAG_CLOCK_SHOW=!1,this.bean5Area.touchEnabled=!1),void(this.FLAG_GHOST_COMMING_IN&&(this.ghost.currentFrame==this.ghost.totalFrames&&(this.COUNTER_END++,30===this.COUNTER_END&&(this.FLAG_GHOST_COMMING_IN=!1,this.pop.visible=!1,this.count_text.visible=!1,0===this.FLAG_BOY_BOX?10===this.FLAG_NEED_BEANS?(this.ghost.x=398,this.ghost.y=538.5,this.ghost.movieClipData=this.mcFactory.generateMovieClipData("ghost_angry"),this.ghost.play(),this.boy.gotoAndStop(5),this.FLAG_END_GAMEOVER=!0,Util.singletonPush(this.cards,89)):0===this.FLAG_NEED_BEANS?(this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_clear"),this.boy.x=146.85,this.boy.y=674.55,this.boy.play(),this.FLAG_END_CLEAR=!0,Util.singletonPush(this.cards,92)):this.FLAG_NEED_BEANS>0&&(this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_bad"),this.boy.x=146.85,this.boy.y=674.55,this.boy.play(),this.FLAG_END_GAMEOVER=!0,Util.singletonPush(this.cards,90)):(this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_bad2"),this.boy.x=146.85,this.boy.y=674.55,this.boy.play(),this.FLAG_END_GAMEOVER=!0,Util.singletonPush(this.cards,91)))),8===this.ghost.currentFrame&&this.container.setChildIndex(this.ghost,this.getChildIndex(this.rdoor)),this.ghost.nextFrame())))},e.prototype._remove=function(){this.removeAllEventListener(),egret.Tween.removeAllTweens()},e.prototype.registItem=function(t){ItemController.getInstance().addItem(t)&&t===ItemEnum.ITEM_ICE_BOX&&(this.ice.visible=!1)},e.prototype.useItem=function(t,e,i){var s=this;return-1!==this.SEED_LIST.indexOf(t)&&0===this.FLAG_BOY_BOX&&this.boy.hitTestPoint(e,i)?(this.FLAG_NEED_BEANS--,0===this.FLAG_NEED_BEANS&&(this.boy.gotoAndStop(3),this.pop.visible=!1),9===this.FLAG_NEED_BEANS&&egret.Tween.get(this.pop).to({scaleX:1,scaleY:1,alpha:1}).call(function(){s.count_text.visible=!0}),this.FLAG_NEED_BEANS>0?this.count_text.text=this.FLAG_NEED_BEANS.toString():0===this.FLAG_NEED_BEANS&&(this.count_text.visible=!1),!0):t===ItemEnum.ITEM_ICE_BOX&&this.boy.hitTestPoint(e,i)?(this.FLAG_BOY_BOX=1,this.boy.gotoAndStop(4),0===this.FLAG_NEED_BEANS?this.registItem(ItemEnum.ITEM_FULL_BOX):this.registItem(ItemEnum.ITEM_BOX),this.pop.visible=!1,this.count_text.visible=!1,!0):t===ItemEnum.ITEM_FULL_BOX&&this.boy.hitTestPoint(e,i)?(this.FLAG_BOY_BOX=0,this.boy.gotoAndStop(8),this.registItem(ItemEnum.ITEM_ICE_BOX),this.pop.visible=!1,!0):t===ItemEnum.ITEM_BOX&&this.boy.hitTestPoint(e,i)?(this.FLAG_BOY_BOX=0,this.boy.gotoAndStop(1),this.registItem(ItemEnum.ITEM_ICE_BOX),this.pop.visible=!0,this.count_text.visible=!0,!0):!1},e.prototype.getDisplayArea=function(){return new egret.Rectangle},e.prototype.ctrl_right=function(){},e.prototype.ctrl_left=function(){},e.prototype.ctrl_up=function(){},e.prototype.ctrl_down=function(){},e.prototype.ctrl_ok=function(){},e.prototype.ctrl_cancel=function(){},e}(egret.DisplayObjectContainer);__reflect(Stage21.prototype,"Stage21",["IFKaihiStage"]);var Stage22=function(t){function e(){var e=t.call(this)||this;return e.stageid=22,e.FLAG_POTATO_SMELL_WELL=!1,e.FLAG_YAO_TREE_BAD=!1,e.FLAG_END_GAMEOVER=!1,e.FLAG_END_CLEAR=!1,e.FLAG_FACE_OUT=!1,e.FLAG_TREE_ACTION=!1,e.FLAG_TREE_EATING=!1,e.FLAG_THROW_MUSHROOM=!1,e.FLAG_TASTE_MUSHROOM=!1,e.FLAG_FIRED_MUSHROOM=!1,e.FLAG_BOY_PICK_UP=!1,e.FLAG_LIZI_PICK_UP=!1,e.FLAG_LOOK_HOLE=!1,e.COUNTER_PICKED_UP=0,e.COUNT_YAO_TIME=0,e.COUNTER_END=0,e.cards=[],e._init(),e}return __extends(e,t),e.prototype._init=function(){return __awaiter(this,void 0,void 0,function(){var t,e,i,s,h,a,o,n;return __generator(this,function(r){switch(r.label){case 0:return UIManager.getInstance().showLoading(),[4,this._loadRes()];case 1:return r.sent(),this.mcFactory=new egret.MovieClipDataFactory(RES.getRes("stage22_action_json"),RES.getRes("stage22_action_png")),this.sheet=RES.getRes("stage22_texture"),this.container=new egret.Sprite,this.container.x=0,this.container.y=0,this.addChild(this.container),t=new TSBitmap("bg",this.sheet),t.x=-760,t.y=-100,this.container.addChild(t),e=new TSBitmap("mogus",this.sheet,!0),e.x=-119.95,e.y=723.95,this.container.addChild(e),i=new TSBitmap("room",this.sheet),i.x=-588,i.y=469,this.container.addChild(i),s=new TSBitmap("desk",this.sheet),s.x=-482,s.y=665,this.container.addChild(s),h=new TSBitmap("cup",this.sheet,!0),h.x=-456.5,h.y=661,h.visible=!1,this.container.addChild(h),this.lizi=new TSBitmap("lizi",this.sheet,!0),this.lizi.x=-402.7,this.lizi.y=652.75,this.lizi.visible=!1,this.container.addChild(this.lizi),this.liziair=new TSBitmap("liziair",this.sheet,!0),this.liziair.x=this.lizi.x,this.liziair.y=this.lizi.y-38.5,this.liziair.visible=!1,this.container.addChild(this.liziair),this.mama=new egret.MovieClip(this.mcFactory.generateMovieClipData("ma_stand")),this.mama.x=-503,this.mama.y=648,this.container.addChild(this.mama),this.tree=new egret.Sprite,this.treeMain=new TSBitmap("tree",this.sheet,!0),this.tree.x=440,this.tree.y=397.5,this.container.addChild(this.tree),this.tree.addChild(this.treeMain),a=new TSBitmap("house",this.sheet),a.x=-760,a.y=80,this.container.addChild(a),o=new TSBitmap("water",this.sheet),o.x=-697,o.y=673,this.container.addChild(o),this.mogu=new TSBitmap("mogu",this.sheet,!0),this.mogu.x=-119.95,this.mogu.y=723.95,this.mogu.touchEnabled=!0,this.container.addChild(this.mogu),n=new TSBitmap("chai",this.sheet),n.x=-454.2,n.y=836,this.container.addChild(n),this.fire=new egret.MovieClip(this.mcFactory.generateMovieClipData("fire")),this.fire.x=-410.2,this.fire.y=827,this.fire.play(-1),this.container.addChild(this.fire),this.ash=new egret.MovieClip(this.mcFactory.generateMovieClipData("sh_hui")),this.ash.x=-376,this.ash.y=801.95,this.ash.touchEnabled=!0,this.ash.visible=!1,this.ash.gotoAndStop(1),this.container.addChild(this.ash),this.grass1=new TSBitmap("grass",this.sheet,!0),this.grass1.x=-595.5,this.grass1.y=871.5,this.grass1.touchEnabled=!0,this.container.addChild(this.grass1),this.grass2=new TSBitmap("grass",this.sheet,!0),this.grass2.x=-162.5,this.grass2.y=834.85,this.grass2.touchEnabled=!0,this.container.addChild(this.grass2),this.grass3=new TSBitmap("grass",this.sheet,!0),this.grass3.x=180.4,this.grass3.y=847.5,this.grass3.touchEnabled=!0,this.container.addChild(this.grass3),this.grass4=new TSBitmap("grass",this.sheet,!0),this.grass4.x=557.85,this.grass4.y=882,this.grass4.touchEnabled=!0,this.container.addChild(this.grass4),this.hongshu=new TSBitmap("potato",this.sheet,!0),this.hongshu.x=557.85,this.hongshu.y=882,this.hongshu.visible=!1,this.hongshu.touchEnabled=!0,this.container.addChild(this.hongshu),this.treelizi1=new TSBitmap("lizi1",this.sheet,!0),this.treelizi1.x=271.5,this.treelizi1.y=251.3,this.treelizi1.touchEnabled=!0,this.container.addChild(this.treelizi1),this.treelizi2=new TSBitmap("lizi1",this.sheet,!0),this.treelizi2.x=384,this.treelizi2.y=158.8,this.treelizi2.touchEnabled=!0,this.container.addChild(this.treelizi2),this.treelizi3=new TSBitmap("lizi1",this.sheet,!0),this.treelizi3.x=396.5,this.treelizi3.y=307.55,this.treelizi3.touchEnabled=!0,this.container.addChild(this.treelizi3),this.treelizi4=new TSBitmap("lizi1",this.sheet,!0),this.treelizi4.x=547.75,this.treelizi4.y=192.55,this.treelizi4.touchEnabled=!0,this.container.addChild(this.treelizi4),this.treelizi5=new TSBitmap("lizi1",this.sheet,!0),this.treelizi5.x=569,this.treelizi5.y=322.55,this.treelizi5.touchEnabled=!0,this.container.addChild(this.treelizi5),this.treeFace=new egret.MovieClip(this.mcFactory.generateMovieClipData("tree_face_out")),this.treeFace.x=30,this.treeFace.y=158.75,this.treeFace.gotoAndStop(1),this.tree.addChild(this.treeFace),this.treeHand=new egret.MovieClip(this.mcFactory.generateMovieClipData("tree_leaf")),this.treeHand.x=38.35,this.treeHand.y=212,this.treeHand.gotoAndStop(1),this.tree.addChild(this.treeHand),this.treeArea=new egret.Shape,this.treeArea.graphics.beginFill(144470),this.treeArea.graphics.drawRect(411.2,593.55-210,127.3,420.6),this.treeArea.graphics.endFill(),this.treeArea.touchEnabled=!0,this.treeArea.alpha=0,this.container.addChild(this.treeArea),this.holeArea=new egret.Shape,this.holeArea.graphics.beginFill(6636321),this.holeArea.graphics.drawRect(437.4,526.1,66.2,60),this.holeArea.graphics.endFill(),this.holeArea.touchEnabled=!0,this.holeArea.alpha=0,this.container.addChild(this.holeArea),this.boy=new egret.MovieClip(this.mcFactory.generateMovieClipData("sh_move")),this.boy.x=-14.75,this.boy.y=670.95,this.boy.play(-1),this.container.addChild(this.boy),this.addAllEventListener(),this.leftArrow=new TSBitmap("arrow_png"),this.leftArrow.x=40,this.leftArrow.y=510,this.leftArrow.touchEnabled=!0,this.leftArrow.visible=!1,this.addChild(this.leftArrow),this.rightArrow=new TSBitmap("arrow_png"),this.rightArrow.scaleX=-1,this.rightArrow.x=600,this.rightArrow.y=510,this.rightArrow.touchEnabled=!0,this.rightArrow.visible=!1,this.addChild(this.rightArrow),this.boyAction(),this.well_air1=new TSBitmap("potatoair",this.sheet,!0),this.well_air1.x=-349,this.well_air1.y=835,this.container.addChild(this.well_air1),this.well_air2=new TSBitmap("potatoair",this.sheet,!0),this.well_air2.x=-349,this.well_air2.y=835,this.container.addChild(this.well_air2),this.well_air3=new TSBitmap("potatoair",this.sheet,!0),this.well_air3.x=-349,this.well_air3.y=835,this.container.addChild(this.well_air3),this.well_air4=new TSBitmap("potatoair",this.sheet,!0),this.well_air4.x=-349,this.well_air4.y=835,this.container.addChild(this.well_air4),this.well_air1.alpha=this.well_air2.alpha=this.well_air3.alpha=this.well_air4.alpha=0,this.well_air1.visible=this.well_air2.visible=this.well_air3.visible=this.well_air4.visible=!1,this.leftArrow.addEventListener(egret.TouchEvent.TOUCH_TAP,this.leftArrowTouched,this),this.rightArrow.addEventListener(egret.TouchEvent.TOUCH_TAP,this.rightArrowTouched,this),UIManager.getInstance().hideLoading(),[2]
}})})},e.prototype.boyAction=function(){var t=this;egret.Tween.get(this.boy).to({x:179.75},1e3).call(function(){t.boy.movieClipData=t.mcFactory.generateMovieClipData("sh_stand"),t.leftArrow.visible=!0})},e.prototype.addAllEventListener=function(){this.mogu.addEventListener(egret.TouchEvent.TOUCH_TAP,this.moguTouched,this),this.treeArea.addEventListener(egret.TouchEvent.TOUCH_TAP,this.treeTouched,this),this.holeArea.addEventListener(egret.TouchEvent.TOUCH_TAP,this.holeTouched,this),this.grass1.addEventListener(egret.TouchEvent.TOUCH_TAP,this.grass1Touched,this),this.grass2.addEventListener(egret.TouchEvent.TOUCH_TAP,this.grass2Touched,this),this.grass3.addEventListener(egret.TouchEvent.TOUCH_TAP,this.grass3Touched,this),this.grass4.addEventListener(egret.TouchEvent.TOUCH_TAP,this.grass4Touched,this),this.hongshu.addEventListener(egret.TouchEvent.TOUCH_TAP,this.hongshuTouched,this),this.ash.addEventListener(egret.TouchEvent.TOUCH_TAP,this.ashTouched,this)},e.prototype.removeAllEventListener=function(){this.mogu.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.moguTouched,this),this.treeArea.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.treeTouched,this),this.holeArea.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.holeTouched,this),this.grass1.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.grass1Touched,this),this.grass2.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.grass2Touched,this),this.grass3.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.grass3Touched,this),this.grass4.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.grass4Touched,this),this.hongshu.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.hongshuTouched,this),this.ash.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.ashTouched,this)},e.prototype.ashTouched=function(t){this.ash.play()},e.prototype.moguTouched=function(t){this.FLAG_FIRED_MUSHROOM||this.registItem(ItemEnum.ITEM_MUSHROOM)},e.prototype.holeTouched=function(t){this.FLAG_FACE_OUT||(this.removeAllEventListener(),this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_knock"),this.boy.x=413.95,this.boy.y=670.45,this.boy.play(),this.FLAG_LOOK_HOLE=!0)},e.prototype.treeTouched=function(t){this.FLAG_LIZI_PICK_UP||(Util.singletonPush(this.cards,94),this.removeAllEventListener(),this.boy.movieClipData=this.mcFactory.generateMovieClipData("yao_tree"),this.boy.x=363.95,this.boy.y=677.45,this.boy.gotoAndPlay(1),this.FLAG_YAO_TREE_BAD=!0)},e.prototype.hongshuTouched=function(t){this.hongshu.visible=!1,this.FLAG_POTATO_SMELL_WELL?(this.registItem(ItemEnum.ITEM_FIRED_SWEET_POTATO),this.FLAG_POTATO_SMELL_WELL=!1):this.registItem(ItemEnum.ITEM_SWEET_POTATO)},e.prototype.grass1Touched=function(t){SoundManager.getInstance().playSound(SoundEnum.BUSH2SOUND_MP3),this.grass1.touchEnabled=!1,this.grass1.texture=this.sheet.getTexture("grasss")},e.prototype.grass2Touched=function(t){SoundManager.getInstance().playSound(SoundEnum.BUSH2SOUND_MP3),this.grass2.touchEnabled=!1,this.grass2.texture=this.sheet.getTexture("grasss")},e.prototype.grass3Touched=function(t){SoundManager.getInstance().playSound(SoundEnum.BUSH2SOUND_MP3),this.grass3.touchEnabled=!1,this.grass3.texture=this.sheet.getTexture("grasss")},e.prototype.grass4Touched=function(t){SoundManager.getInstance().playSound(SoundEnum.BUSH2SOUND_MP3),this.grass4.touchEnabled=!1,this.hongshu.visible=!0,this.grass4.texture=this.sheet.getTexture("grasss")},e.prototype.rightArrowTouched=function(t){this.FLAG_POTATO_SMELL_WELL&&(Util.singletonPush(this.cards,95),SoundManager.getInstance().playSound(SoundEnum.PUYONSOUND_MP3),this.treeFace.movieClipData=this.mcFactory.generateMovieClipData("tree_face_out"),this.treeFace.play(),this.hongshu.texture=this.sheet.getTexture("potato2"),this.hongshu.touchEnabled=!0),this.rightArrow.visible=!1,this.leftArrow.visible=!0,egret.Tween.get(this.container).to({x:0},500)},e.prototype.leftArrowTouched=function(t){void 0===t&&(t=null),this.leftArrow.visible=!1,this.rightArrow.visible=!0,egret.Tween.get(this.container).to({x:640},500)},e.prototype.boyPickUp=function(t){this.FLAG_BOY_PICK_UP=!0},e.prototype._loadRes=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,StageController.getInstance().loadStage(this.stageid)];case 1:return e.sent(),[3,3];case 2:return t=e.sent(),console.error(t),[3,3];case 3:return[2]}})})},e.prototype._start=function(){},e.prototype.play_loop=function(){var t=this;return this.FLAG_END_GAMEOVER||this.FLAG_END_CLEAR?(this.COUNTER_END++,void(this.COUNTER_END>=60&&(this.FLAG_END_CLEAR&&(Util.singletonPush(this.cards,96),StageController.getInstance().clearStage(this.stageid,this.cards)),this.FLAG_END_GAMEOVER&&StageController.getInstance().gameOverStage(this.stageid,this.cards)))):(this.FLAG_TREE_EATING&&this.treeHand.currentFrame===this.treeHand.totalFrames&&(egret.Tween.get(this.treelizi1).to({x:291.5},150).to({x:271.5},150).to({x:291.5},150).to({x:271.5},150).to({x:291.5},150).to({x:271.5},150).to({x:261.5},150).to({x:281.5},150).to({x:271.5,y:800.8},1500),egret.Tween.get(this.treelizi2).to({x:344.15},150).to({x:324.15},150).to({x:344.15},150).to({x:324.15},150).to({x:344.15},150).to({x:324.15},150).to({x:314.15},150).to({x:334.15},150).to({x:324.15,y:798.1},1500),egret.Tween.get(this.treelizi3).to({x:436},150).to({x:416},150).to({x:436},150).to({x:416},150).to({x:436},150).to({x:416},150).to({x:406},150).to({x:426},150).to({x:416,y:817.45},1500),egret.Tween.get(this.treelizi4).to({x:447.75},150).to({x:427.75},150).to({x:447.75},150).to({x:427.75},150).to({x:447.75},150).to({x:427.75},150).to({x:417.75},150).to({x:437.75},150).to({x:427.75,y:842.45},1500),egret.Tween.get(this.treelizi5).to({x:569},150).to({x:549},150).to({x:569},150).to({x:549},150).to({x:569},150).to({x:549},150).to({x:539},150).to({x:559},150).to({x:549,y:832.45},1500).call(function(){t.treelizi1.texture=t.sheet.getTexture("lizi2"),t.treelizi2.texture=t.sheet.getTexture("lizi2"),t.treelizi3.texture=t.sheet.getTexture("lizi2"),t.treelizi4.texture=t.sheet.getTexture("lizi2"),t.treelizi5.texture=t.sheet.getTexture("lizi2"),t.treelizi1.touchEnabled=!0,t.treelizi2.touchEnabled=!0,t.treelizi3.touchEnabled=!0,t.treelizi4.touchEnabled=!0,t.treelizi5.touchEnabled=!0,t.treelizi1.addEventListener(egret.TouchEvent.TOUCH_TAP,t.boyPickUp,t),t.treelizi2.addEventListener(egret.TouchEvent.TOUCH_TAP,t.boyPickUp,t),t.treelizi3.addEventListener(egret.TouchEvent.TOUCH_TAP,t.boyPickUp,t),t.treelizi4.addEventListener(egret.TouchEvent.TOUCH_TAP,t.boyPickUp,t),t.treelizi5.addEventListener(egret.TouchEvent.TOUCH_TAP,t.boyPickUp,t),t.FLAG_LIZI_PICK_UP=!0}),this.FLAG_TREE_EATING=!1),this.FLAG_LOOK_HOLE&&this.boy.currentFrame===this.boy.totalFrames&&(this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_stand"),this.boy.x=179.75,this.boy.y=670.95,this.boy.gotoAndStop(1),this.addAllEventListener(),this.FLAG_LOOK_HOLE=!1),this.FLAG_BOY_PICK_UP&&(0===this.COUNTER_PICKED_UP?(this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_get0"),this.boy.x=this.treelizi1.x-this.boy.width/2,this.boy.y=this.treelizi1.y-this.boy.height/2,this.boy.gotoAndStop(1),this.boy.nextFrame(),this.COUNTER_PICKED_UP++):5===this.COUNTER_PICKED_UP?(this.treelizi5.visible=!1,this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_back"),this.boy.x=336.4,this.boy.y=677.45,this.boy.play(-1),egret.Tween.get(this.boy).to({x:this.boy.x-666},3800).call(function(){t.boy.movieClipData=t.mcFactory.generateMovieClipData("sh_give"),t.boy.x=-410,t.boy.y=642.5,t.boy.gotoAndPlay(1),t.leftArrowTouched()}).wait(1e3).call(function(){t.boy.movieClipData=t.mcFactory.generateMovieClipData("sh_clear"),t.boy.x=-307.5,t.boy.y=645.5,t.boy.gotoAndPlay(1),t.lizi.visible=!0,t.liziair.visible=!0,t.FLAG_END_CLEAR=!0}),this.FLAG_BOY_PICK_UP=!1):this.boy.currentFrame===this.boy.totalFrames?(this["treelizi"+this.COUNTER_PICKED_UP].visible=!1,this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_get"+this.COUNTER_PICKED_UP),this.COUNTER_PICKED_UP++,this.boy.x=this["treelizi"+this.COUNTER_PICKED_UP].x-this.boy.width/2,this.boy.y=this["treelizi"+this.COUNTER_PICKED_UP].y-this.boy.height/2,this.boy.gotoAndStop(1)):this.boy.nextFrame()),this.FLAG_TREE_ACTION&&this.treeHand.currentFrame===this.treeHand.totalFrames&&(this.treeHand.movieClipData=this.mcFactory.generateMovieClipData("tree_leaf"),this.treeHand.play(),SoundManager.getInstance().playSound(SoundEnum.OPENSOUND_MP3),this.FLAG_TREE_EATING=!0,this.FLAG_TREE_ACTION=!1),this.FLAG_YAO_TREE_BAD&&(this.COUNT_YAO_TIME++,this.COUNT_YAO_TIME>60&&(egret.Tween.get(this.treelizi1).to({x:291.5},150).to({x:271.5},150).to({x:291.5},150).to({x:271.5},150).to({x:291.5},150).to({x:271.5},150).to({x:261.5},150).to({x:281.5},150).to({x:271.5,y:800.8},1500),egret.Tween.get(this.treelizi2).to({x:344.15},150).to({x:324.15},150).to({x:344.15},150).to({x:324.15},150).to({x:344.15},150).to({x:324.15},150).to({x:314.15},150).to({x:334.15},150).to({x:324.15,y:798.1},1500),egret.Tween.get(this.treelizi3).to({x:436},150).to({x:416},150).to({x:436},150).to({x:416},150).to({x:436},150).to({x:416},150).to({x:406},150).to({x:426},150).to({x:416,y:817.45},1500),egret.Tween.get(this.treelizi4).to({x:447.75},150).to({x:427.75},150).to({x:447.75},150).to({x:427.75},150).to({x:447.75},150).to({x:427.75},150).to({x:417.75},150).to({x:437.75},150).to({x:427.75,y:842.45},1500),egret.Tween.get(this.treelizi5).to({x:569},150).to({x:549},150).to({x:569},150).to({x:549},150).to({x:569},150).to({x:549},150).to({x:539},150).to({x:559},150).to({x:549,y:832.45},1500),SoundManager.getInstance().playSound(SoundEnum.HIT2SOUND_MP3),this.COUNT_YAO_TIME=0,this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_za_bad"),this.boy.play(-1),this.FLAG_END_GAMEOVER=!0)),this.FLAG_THROW_MUSHROOM&&this.mama.currentFrame===this.mama.totalFrames-10&&(SoundManager.getInstance().playSound(SoundEnum.JUMPSOUND_MP3),this.mogu.visible=!0,this.mogu.x=-452,this.mogu.y=730.95,this.mama.movieClipData=this.mcFactory.generateMovieClipData("ma_stand"),egret.Tween.get(this.mogu).to({x:-417,y:805.95,rotation:45},1e3).call(function(){t.mogu.visible=!1,t.ash.visible=!0}),this.FLAG_FIRED_MUSHROOM=!0,this.FLAG_THROW_MUSHROOM=!1),void(this.FLAG_TASTE_MUSHROOM&&(this.boy.currentFrame>=110&&this.mogu.visible===!1&&(this.mogu.texture=this.sheet.getTexture("eatmogu"),this.mogu.x=234.9,this.mogu.y=602.95,this.mogu.visible=!0,egret.Tween.get(this.mogu).to({y:752.95,rotation:-140},800).to({y:782.95,rotation:-60},200)),this.boy.currentFrame===this.boy.totalFrames&&(this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_hack"),this.boy.gotoAndPlay(1),this.FLAG_END_GAMEOVER=!0))))},e.prototype._remove=function(){egret.Tween.removeAllTweens()},e.prototype.registItem=function(t){if(ItemController.getInstance().addItem(t))switch(t){case ItemEnum.ITEM_MUSHROOM:this.mogu.visible=!1;break;case ItemEnum.ITEM_SWEET_POTATO:this.hongshu.visible=!1;break;case ItemEnum.ITEM_FIRED_SWEET_POTATO:}},e.prototype.useItem=function(t,e,i){var s=this;if(t===ItemEnum.ITEM_MUSHROOM){if(this.treeArea.hitTestPoint(e,i))return this.mogu.x=467.25,this.mogu.y=556.5,this.mogu.visible=!0,egret.Tween.get(this.mogu).wait(300).to({x:257.25,y:873.95},1e3),!0;if(this.boy.hitTestPoint(e,i))return this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_taste"),this.boy.gotoAndPlay(1),this.FLAG_TASTE_MUSHROOM=!0,Util.singletonPush(this.cards,93),!0;if(this.mama.hitTestPoint(e,i))return this.mama.movieClipData=this.mcFactory.generateMovieClipData("ma_throw"),this.mama.gotoAndPlay(1),this.FLAG_THROW_MUSHROOM=!0,Util.singletonPush(this.cards,97),!0;if(this.fire.hitTestPoint(e,i))return this.container.setChildIndex(this.mogu,this.container.getChildIndex(this.fire)+1),this.mogu.x=-417,this.mogu.y=835.95,this.mogu.rotation=45,this.mogu.visible=!0,this.FLAG_FIRED_MUSHROOM=!0,egret.Tween.get(this.mogu).wait(500).call(function(){s.mogu.visible=!1,s.ash.visible=!0}),!0}if(t===ItemEnum.ITEM_SWEET_POTATO){if(this.treeArea.hitTestPoint(e,i))return this.hongshu.x=467.25,this.hongshu.y=556.5,this.hongshu.visible=!0,egret.Tween.get(this.hongshu).wait(300).to({x:257.25},1e3),egret.Tween.get(this.hongshu).wait(300).to({y:873.95},1e3),!0;if(this.fire.hitTestPoint(e,i))return this.hongshu.visible=!0,this.hongshu.x=-391.7,this.hongshu.y=850,this.hongshu.touchEnabled=!1,this.FLAG_POTATO_SMELL_WELL=!0,this.FLAG_FACE_OUT=!0,this.well_air1.visible=this.well_air2.visible=this.well_air3.visible=this.well_air4.visible=!0,egret.Tween.get(this.well_air1,{loop:!0}).to({alpha:1}).to({x:468.25,y:560.45,scaleX:1.58,scaleY:1.58},4200).to({scaleX:2.4,scaleY:2.4,alpha:0},300).wait(3200),egret.Tween.get(this.well_air2,{loop:!0}).wait(800).to({alpha:1}).to({x:468.25,y:560.45,scaleX:1.58,scaleY:1.58},4200).to({scaleX:2.4,scaleY:2.4,alpha:0},300).wait(2400),egret.Tween.get(this.well_air3,{loop:!0}).wait(1600).to({alpha:1}).to({x:468.25,y:560.45,scaleX:1.58,scaleY:1.58},4200).to({scaleX:2.4,scaleY:2.4,alpha:0},300).wait(1600),egret.Tween.get(this.well_air4,{loop:!0}).wait(2400).to({alpha:1}).to({x:468.25,y:560.45,scaleX:1.58,scaleY:1.58},4200).to({scaleX:2.4,scaleY:2.4,alpha:0},300).wait(800).call(function(){s.FLAG_POTATO_SMELL_WELL===!1&&(egret.Tween.removeTweens(s.well_air1),egret.Tween.removeTweens(s.well_air2),egret.Tween.removeTweens(s.well_air3),egret.Tween.removeTweens(s.well_air4))}),!0}return t===ItemEnum.ITEM_FIRED_SWEET_POTATO&&this.treeArea.hitTestPoint(e,i)?(this.treeFace.movieClipData=this.mcFactory.generateMovieClipData("face_smell"),this.treeFace.x=0,this.treeFace.y=0,this.treeFace.gotoAndPlay(1),this.treeHand.movieClipData=this.mcFactory.generateMovieClipData("leaf_smell"),this.treeHand.gotoAndPlay(1),this.FLAG_TREE_ACTION=!0,!0):!1},e.prototype.getDisplayArea=function(){return new egret.Rectangle},e.prototype.ctrl_right=function(){},e.prototype.ctrl_left=function(){},e.prototype.ctrl_up=function(){},e.prototype.ctrl_down=function(){},e.prototype.ctrl_ok=function(){},e.prototype.ctrl_cancel=function(){},e}(egret.DisplayObjectContainer);__reflect(Stage22.prototype,"Stage22",["IFKaihiStage"]);var Stage23=function(t){function e(){var e=t.call(this)||this;return e.stageid=23,e.ANIMATE_PLAYING=!1,e.FLAG_POS_FAR_LEFT_X=-83.05,e.FLAG_POS_FAR_MIDDLE_X=320,e.FLAG_POS_FAR_RIGHT_X=752.6,e.FLAG_POS_LEFT_X=113.65,e.FLAG_POS_MIDDLE_X=320,e.FLAG_POS_RIGHT_X=525.85,e.FLAG_POS_FAR_LEFT_Y=624.05,e.FLAG_POS_FAR_MIDDLE_Y=212.1,e.FLAG_POS_FAR_RIGHT_Y=598.95,e.FLAG_POS_LEFT_Y=733.45,e.FLAG_POS_MIDDLE_Y=721.9,e.FLAG_POS_RIGHT_Y=733.45,e.FLAG_EAT_PEPER=!1,e.FLAG_END_GAMEOVER=!1,e.FLAG_END_CLEAR=!1,e.COUNTER_END=0,e.FLAG_ROOM_2_EATED=!1,e.FLAG_ROOM_3_RUNNING=0,e.FLAG_ROOM_3_LIGHTING=1,e.FLAG_ROOM_3_LIGHTED=2,e.FLAG_ROOM_3_STATUS=e.FLAG_ROOM_3_RUNNING,e.FLAG_CURRENT_ROOM=0,e.cards=[],e.itemPosX=[231.4,82.7-65.55,230.85,561.3-55],e.itemPosY=[845.45,747,660.15,705.5],e._init(),e}return __extends(e,t),e.prototype._init=function(){return __awaiter(this,void 0,void 0,function(){var t,e,i;return __generator(this,function(s){switch(s.label){case 0:return UIManager.getInstance().showLoading(),[4,this._loadRes()];case 1:return s.sent(),this.mcFactory=new egret.MovieClipDataFactory(RES.getRes("stage23_action_json"),RES.getRes("stage23_action_png")),this.sheet=RES.getRes("stage23_texture"),t=new TSBitmap("bg",this.sheet),t.x=-120,t.y=-100,this.addChild(t),e=new TSBitmap("ground",this.sheet),e.x=-120,e.y=0,this.addChild(e),this.room1=new egret.Sprite,this.initRoom1(),this.bang=new TSBitmap("bang",this.sheet,!0),this.bang.visible=!1,this.addChild(this.bang),this.lie=new TSBitmap("lie",this.sheet),this.lie.visible=!1,this.addChild(this.lie),i=new TSBitmap("jianbian",this.sheet),i.x=-120,i.y=0,i.alpha=.8,i.touchEnabled=!1,this.addChild(i),this.screen_splash=new egret.Shape,this.screen_splash.graphics.beginFill(16777215),this.screen_splash.graphics.drawRect(0,0,Util.curWidth(),Util.curHeight()),this.screen_splash.graphics.endFill(),this.screen_splash.alpha=0,this.screen_splash.visible=!1,this.screen_splash.touchEnabled=!1,this.addChild(this.screen_splash),this.peppers=[],this.lights=[],UIManager.getInstance().hideLoading(),[2]}})})},e.prototype.initRoom1=function(){this.rightMirror=new TSBitmap("cebian2",this.sheet),this.rightMirror.x=474.65,this.rightMirror.y=795.05-530,this.rightMirror.touchEnabled=!0,this.room1.addChild(this.rightMirror),this.rightMirrorBoy=new egret.Sprite,this.rboyMc=new egret.MovieClip(this.mcFactory.generateMovieClipData("r_run")),this.rightMirrorBoy.x=715.65,this.rightMirrorBoy.y=574.5,this.rboyMc.play(-1),this.room1.addChild(this.rightMirrorBoy),this.rightMirrorBoy.addChild(this.rboyMc),this.rightShape=new egret.Shape,this.rightShape.graphics.beginFill(16777215,1),this.rightShape.graphics.drawRect(-76.35+561.65,-518.5+795.05,152.65,547.85),this.rightShape.graphics.endFill(),this.rightMirrorBoy.mask=this.rightShape,this.room1.addChild(this.rightShape),this.midMirror=new TSBitmap("zhengbian",this.sheet),this.midMirror.x=152.7,this.midMirror.y=763.55-498,this.midMirror.touchEnabled=!0,this.room1.addChild(this.midMirror),this.midMirrorBoy=new egret.Sprite,this.mboyMc=new egret.MovieClip(this.mcFactory.generateMovieClipData("m_run2")),this.midMirrorBoy.x=328.2,this.midMirrorBoy.y=450.25,this.mboyMc.play(-1),this.room1.addChild(this.midMirrorBoy),this.midMirrorBoy.addChild(this.mboyMc),this.midShape=new egret.Shape,this.midShape.graphics.beginFill(16777215,1),this.midShape.graphics.drawRect(164.6,763.55-489.05,312.6,486.2),this.midShape.graphics.endFill(),this.midMirrorBoy.mask=this.midShape,this.room1.addChild(this.midShape),this.leftMirror=new TSBitmap("cebian",this.sheet),this.leftMirror.x=81.85-87-3,this.leftMirror.y=264.5,this.leftMirror.touchEnabled=!0,this.room1.addChild(this.leftMirror),this.leftMirrorBoy=new egret.Sprite,this.lboyMc=new egret.MovieClip(this.mcFactory.generateMovieClipData("l_run")),this.leftMirrorBoy.x=-36.7,this.leftMirrorBoy.y=634.65,this.lboyMc.play(-1),this.room1.addChild(this.leftMirrorBoy),this.leftMirrorBoy.addChild(this.lboyMc),this.leftShape=new egret.Shape,this.leftShape.graphics.beginFill(16777215,1),this.leftShape.graphics.drawRect(81.85-76.4,275,152.65,547.85),this.leftShape.graphics.endFill(),this.leftMirrorBoy.mask=this.leftShape,this.room1.addChild(this.leftShape),egret.Tween.get(this.leftMirrorBoy).to({x:81.85-27.85,y:565.7},1e3),egret.Tween.get(this.midMirrorBoy).to({x:328.2,y:518.45},1e3),egret.Tween.get(this.rightMirrorBoy).to({x:593.15,y:542.2},1e3),this.boy=new egret.MovieClip(this.mcFactory.generateMovieClipData("m_run")),this.boy.x=320,this.boy.y=901.75,this.boy.play(-1),this.room1.addChild(this.boy),egret.Tween.get(this.boy).to({x:320,y:822.95},1e3),this.addMirrorEventListener(),this.addChild(this.room1),this.FLAG_CURRENT_ROOM=1},e.prototype.initRoom2=function(){Util.singletonPush(this.cards,100),this.lboyMc.movieClipData=this.mcFactory.generateMovieClipData("l_run"),this.leftMirrorBoy.x=-36.7,this.leftMirrorBoy.y=555.85,this.lboyMc.play(-1),this.rboyMc.movieClipData=this.mcFactory.generateMovieClipData("l_run"),this.rboyMc.scaleX=-1,this.rightMirrorBoy.x=715.65,this.rightMirrorBoy.y=495.7,this.rboyMc.play(-1),this.mboyMc.movieClipData=this.mcFactory.generateMovieClipData("m_run2"),this.midMirrorBoy.x=328.2,this.midMirrorBoy.y=371.45,this.mboyMc.play(-1),this.boy.movieClipData=this.mcFactory.generateMovieClipData("m_run"),this.boy.x=320,this.boy.y=1093.05,this.boy.play(-1),egret.Tween.get(this.leftMirrorBoy).to({x:81.85-27.85,y:565.7},1e3),egret.Tween.get(this.midMirrorBoy).to({x:328.2,y:518.45},1e3),egret.Tween.get(this.rightMirrorBoy).to({x:593.15,y:542.2},1e3),egret.Tween.get(this.boy).to({x:320,y:822.95},1e3);for(var t,e=0;4>e;e++)t=new TSBitmap("pepper",this.sheet,!0),t.x=this.itemPosX[e],t.y=this.itemPosY[e],this.peppers.push(t);this.room1.addChild(this.peppers[0]),this.room1.addChildAt(this.peppers[1],this.room1.getChildIndex(this.rightMirror)),this.room1.addChildAt(this.peppers[2],this.room1.getChildIndex(this.midMirror)),this.room1.addChildAt(this.peppers[3],this.room1.getChildIndex(this.leftMirror)),this.peppers[0].touchEnabled=!0,this.peppers[0].addEventListener(egret.TouchEvent.TOUCH_TAP,this.pepperTouched,this),this.FLAG_CURRENT_ROOM=2,this.screen_splash.visible=!1,this.screen_splash.alpha=0,this.addMirrorEventListener()},e.prototype.initRoom3=function(){Util.singletonPush(this.cards,101),this.lboyMc.movieClipData=this.mcFactory.generateMovieClipData("l_run"),this.leftMirrorBoy.x=-36.7,this.leftMirrorBoy.y=634.65,this.lboyMc.scaleX=1,this.lboyMc.play(-1),this.rboyMc.movieClipData=this.mcFactory.generateMovieClipData("l_run"),this.rboyMc.scaleX=-1,this.rightMirrorBoy.x=715.65,this.rightMirrorBoy.y=574.5,this.rboyMc.play(-1),this.mboyMc.movieClipData=this.mcFactory.generateMovieClipData("m_run2"),this.midMirrorBoy.x=328.2,this.midMirrorBoy.y=450.25,this.mboyMc.play(-1),this.boy.movieClipData=this.mcFactory.generateMovieClipData("m_run"),this.boy.x=320,this.boy.y=1093.05,this.boy.play(-1),egret.Tween.get(this.leftMirrorBoy).to({x:81.85-27.85,y:565.7},1e3),egret.Tween.get(this.midMirrorBoy).to({x:328.2,y:518.45},1e3),egret.Tween.get(this.rightMirrorBoy).to({x:593.15,y:542.2},1e3),egret.Tween.get(this.boy).to({x:320,y:822.95},1e3);for(var t,e=0;4>e;e++)t=new TSBitmap("handlight",this.sheet,!0),t.x=this.itemPosX[e],t.y=this.itemPosY[e],this.lights.push(t);this.room1.addChild(this.lights[0]),this.room1.addChildAt(this.lights[1],this.room1.getChildIndex(this.rightMirror)+1),this.room1.addChildAt(this.lights[2],this.room1.getChildIndex(this.midMirror)+1),this.room1.addChildAt(this.lights[3],this.room1.getChildIndex(this.leftMirror)+1),this.lights[0].touchEnabled=!0,this.boy.addEventListener(egret.TouchEvent.TOUCH_TAP,this.boyTouched,this),this.addMirrorEventListener(),this.lights[0].addEventListener(egret.TouchEvent.TOUCH_TAP,this.lightTouched,this),this.FLAG_CURRENT_ROOM=3,this.screen_splash.visible=!1,this.screen_splash.alpha=0},e.prototype.initRoom4=function(){Util.singletonPush(this.cards,102),this.room4=new egret.Sprite;var t=new TSBitmap("straitmirror",this.sheet);t.scaleX=-1,t.x=248,t.y=264,this.left1=new TSBitmap("cemirror",this.sheet,!0),this.left1.scaleX=-1,this.left1.x=203,this.left1.y=489.2,this.room4.addChild(this.left1);var e=new TSBitmap("straitmirror",this.sheet,!0);e.scaleX=-1,e.x=155.4,e.y=531.85,this.room4.addChild(e),this.left2=new TSBitmap("cemirror",this.sheet,!0),this.left2.scaleX=-1,this.left2.x=110.4,this.left2.y=571.85,this.room4.addChild(this.left2);var i=new TSBitmap("straitmirror",this.sheet,!0);i.scaleX=-1,i.x=63.1,i.y=615,this.room4.addChild(i),this.left3=new TSBitmap("cemirror",this.sheet,!0),this.left3.scaleX=-1,this.left3.x=18.1,this.left3.y=655,this.room4.addChild(this.left3),this.exit=new TSBitmap("midmirror2",this.sheet,!0),this.exit.x=320,this.exit.y=430.5,this.exit.touchEnabled=!0,this.room4.addChild(this.exit),this.right1=new TSBitmap("cemirror",this.sheet,!0),this.right1.x=436,this.right1.y=489.2,this.room4.addChild(this.right1);var s=new TSBitmap("straitmirror",this.sheet,!0);s.x=481,s.y=529.2,this.room4.addChild(s),this.right2=new TSBitmap("cemirror",this.sheet,!0),this.right2.x=524.4,this.right2.y=573.85,this.room4.addChild(this.right2);var h=new TSBitmap("straitmirror",this.sheet,!0);h.x=569.4,h.y=613.85,this.room4.addChild(h),this.right3=new TSBitmap("cemirror",this.sheet,!0),this.right3.x=613.75,this.right3.y=655,this.room4.addChild(this.right3),this.ototo=new TSBitmap("ott",this.sheet,!0),this.ototo.scaleX=this.ototo.scaleY=.6,this.ototo.x=320,this.ototo.y=445.5;var a=new egret.MovieClip(this.mcFactory.generateMovieClipData("m_run2"));a.scaleX=a.scaleY=.6,a.x=this.left1.x,a.y=this.left1.y,a.play(-1),this.room4.addChild(a);var o=new egret.MovieClip(this.mcFactory.generateMovieClipData("m_run2"));o.scaleX=o.scaleY=.6,o.x=this.left2.x,o.y=this.left2.y,o.play(-1),this.room4.addChild(o);var n=new egret.MovieClip(this.mcFactory.generateMovieClipData("m_run2"));n.scaleX=n.scaleY=.6,n.x=this.left3.x,n.y=this.left3.y,n.play(-1),this.room4.addChild(n);var r=new egret.MovieClip(this.mcFactory.generateMovieClipData("m_run2"));r.scaleX=r.scaleY=.6,r.x=this.right1.x,r.y=this.right1.y,r.play(-1),this.room4.addChild(r);var l=new egret.MovieClip(this.mcFactory.generateMovieClipData("m_run2"));l.scaleX=l.scaleY=.6,l.x=this.right2.x,l.y=this.right2.y,l.play(-1),this.room4.addChild(l);var c=new egret.MovieClip(this.mcFactory.generateMovieClipData("m_run2"));c.scaleX=c.scaleY=.6,c.x=this.right3.x,c.y=this.right3.y,c.play(-1),this.room4.addChild(c),this.addChild(this.room4),this.removeChild(this.room1),this.boy.movieClipData=this.mcFactory.generateMovieClipData("m_run"),this.boy.x=320,this.boy.y=1093.05,this.boy.play(-1),this.addChild(this.boy),egret.Tween.get(this.boy).to({y:822.95},500),this.addChild(this.ototo),this.exit.touchEnabled=!0,this.addRoom4Events(),this.setChildIndex(this.screen_splash,this.numChildren),this.screen_splash.visible=!1,this.screen_splash.alpha=0},e.prototype.addRoom4Events=function(){this.exit.addEventListener(egret.TouchEvent.TOUCH_TAP,this.exitTouched,this),this.left1.addEventListener(egret.TouchEvent.TOUCH_TAP,this.left1Touched,this),this.left2.addEventListener(egret.TouchEvent.TOUCH_TAP,this.left2Touched,this),this.left3.addEventListener(egret.TouchEvent.TOUCH_TAP,this.left3Touched,this),this.right1.addEventListener(egret.TouchEvent.TOUCH_TAP,this.right1Touched,this),this.right2.addEventListener(egret.TouchEvent.TOUCH_TAP,this.right2Touched,this),this.right3.addEventListener(egret.TouchEvent.TOUCH_TAP,this.right3Touched,this)},e.prototype.addMirrorEventListener=function(){this.ANIMATE_PLAYING=!1,this.leftMirror.addEventListener(egret.TouchEvent.TOUCH_TAP,this.leftMirrorTouched,this),this.midMirror.addEventListener(egret.TouchEvent.TOUCH_TAP,this.midMirrorTouched,this),this.rightMirror.addEventListener(egret.TouchEvent.TOUCH_TAP,this.rightMirrorTouched,this)},e.prototype.removeMirrorEventListener=function(){this.ANIMATE_PLAYING=!0,this.leftMirror.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.leftMirrorTouched,this),this.midMirror.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.midMirrorTouched,this),this.rightMirror.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.rightMirrorTouched,this)},e.prototype.left1Touched=function(t){this.FLAG_END_GAMEOVER=!0,Util.singletonPush(this.cards,98)},e.prototype.left2Touched=function(t){this.FLAG_END_GAMEOVER=!0,Util.singletonPush(this.cards,98)},e.prototype.left3Touched=function(t){this.FLAG_END_GAMEOVER=!0,Util.singletonPush(this.cards,98)},e.prototype.right1Touched=function(t){this.FLAG_END_GAMEOVER=!0,Util.singletonPush(this.cards,98)},e.prototype.right2Touched=function(t){this.FLAG_END_GAMEOVER=!0,Util.singletonPush(this.cards,98)},e.prototype.right3Touched=function(t){this.FLAG_END_GAMEOVER=!0,Util.singletonPush(this.cards,98)},e.prototype.exitTouched=function(t){var e=this;this.screen_splash.visible=!0,egret.Tween.get(this.screen_splash).to({alpha:.15}).to({alpha:0},80).to({alpha:1},1e3).wait(1e3).call(function(){var t=new TSBitmap("bg",e.sheet);t.x=-100,t.y=-100,e.addChild(t);var i=new TSBitmap("room",e.sheet);i.x=230,i.y=264,e.addChild(i),e.setChildIndex(e.ototo,e.numChildren),e.ototo.scaleX=e.ototo.scaleY=1,e.ototo.x=207+e.ototo.width/2,e.ototo.y=702+e.ototo.height/2,e.setChildIndex(e.boy,e.numChildren),e.boy.movieClipData=e.mcFactory.generateMovieClipData("m_run2"),e.boy.x=490.6,e.boy.y=657.65,e.boy.play(-1),e.boy.scaleX=e.boy.scaleY=.579178,egret.Tween.get(e.boy).to({x:380.05,y:749.6,scaleX:1,scaleY:1},1200).wait(500).call(function(){e.boy.visible=!1;var t=new TSBitmap("clear",e.sheet,!0);t.x=380.05,t.y=749.6,e.addChild(t),Util.singletonPush(e.cards,103),e.FLAG_END_CLEAR=!0})})},e.prototype.leftMirrorTouched=function(t){var e=this;1===this.FLAG_CURRENT_ROOM?(this.removeMirrorEventListener(),this.boy.movieClipData=this.mcFactory.generateMovieClipData("r_run"),this.boy.scaleX=-1,this.boy.play(-1),this.mboyMc.movieClipData=this.mcFactory.generateMovieClipData("r_run2"),this.mboyMc.play(-1),this.rboyMc.movieClipData=this.mcFactory.generateMovieClipData("m_run"),this.rboyMc.play(-1),egret.Tween.get(this.boy).to({x:113.65,y:733.45},1e3).call(function(){SoundManager.getInstance().playSound(SoundEnum.GLASSBREAK2SOUND_MP3),e.bang.x=92.35,e.bang.y=543.15,e.bang.visible=!0,e.lie.x=62,e.lie.y=508,e.lie.visible=!0}).wait(100).call(function(){e.boy.movieClipData=e.mcFactory.generateMovieClipData("sh_dun1"),e.bang.visible=!1,e.FLAG_END_GAMEOVER=!0,Util.singletonPush(e.cards,98)}),egret.Tween.get(this.leftMirrorBoy).to({x:81.85,y:654.65},1e3).wait(100).call(function(){e.leftMirrorBoy.scaleX=-1,e.lboyMc.movieClipData=e.mcFactory.generateMovieClipData("sh_dun2")}),egret.Tween.get(this.midMirrorBoy).to({x:81.85-27.85},1e3),egret.Tween.get(this.rightMirrorBoy).to({x:113.65},1e3)):2===this.FLAG_CURRENT_ROOM?this.FLAG_ROOM_2_EATED?(this.boy.movieClipData=this.mcFactory.generateMovieClipData("r_run"),this.boy.scaleX=-1,this.boy.play(-1),this.mboyMc.movieClipData=this.mcFactory.generateMovieClipData("r_run2"),this.mboyMc.play(-1),this.rboyMc.movieClipData=this.mcFactory.generateMovieClipData("l_run"),this.rboyMc.play(-1),egret.Tween.get(this.boy).to({x:this.FLAG_POS_FAR_LEFT_X,y:this.FLAG_POS_FAR_LEFT_Y},2e3).call(function(){}).wait(100).call(function(){}),this.lboyMc.movieClipData=this.mcFactory.generateMovieClipData("l_run2"),this.lboyMc.scaleX=-1,this.lboyMc.play(-1),egret.Tween.get(this.leftMirrorBoy).to({x:this.FLAG_POS_FAR_LEFT_X,y:this.FLAG_POS_FAR_LEFT_Y},1e3).wait(100).call(function(){e.screen_splash.visible=!0,egret.Tween.get(e.screen_splash).to({alpha:.15}).to({alpha:0},80).to({alpha:1},1e3).call(function(){e.initRoom3()})}),egret.Tween.get(this.midMirrorBoy).to({x:81.85-27.85},1e3),egret.Tween.get(this.rightMirrorBoy).to({x:113.65},1e3)):(this.removeMirrorEventListener(),this.boy.movieClipData=this.mcFactory.generateMovieClipData("r_run"),this.boy.scaleX=-1,this.boy.play(-1),this.mboyMc.movieClipData=this.mcFactory.generateMovieClipData("r_run2"),this.mboyMc.play(-1),this.rboyMc.movieClipData=this.mcFactory.generateMovieClipData("l_run"),this.rboyMc.scaleX=-1,this.rboyMc.play(-1),egret.Tween.get(this.boy).to({x:113.65,y:733.45},1e3).call(function(){SoundManager.getInstance().playSound(SoundEnum.GLASSBREAK2SOUND_MP3),e.bang.x=92.35,e.bang.y=543.15,e.bang.visible=!0}).wait(100).call(function(){e.boy.movieClipData=e.mcFactory.generateMovieClipData("sh_dun1"),e.bang.visible=!1,e.FLAG_END_GAMEOVER=!0,Util.singletonPush(e.cards,99)}),egret.Tween.get(this.leftMirrorBoy).to({x:81.85,y:654.65},1e3).wait(100).call(function(){e.leftMirrorBoy.scaleX=-1,e.lboyMc.movieClipData=e.mcFactory.generateMovieClipData("sh_dun2")}),egret.Tween.get(this.midMirrorBoy).to({x:81.85-27.85},1e3),egret.Tween.get(this.rightMirrorBoy).to({x:113.65},1e3)):3===this.FLAG_CURRENT_ROOM?this.FLAG_ROOM_3_STATUS===this.FLAG_ROOM_3_RUNNING?(this.removeMirrorEventListener(),this.boy.movieClipData=this.mcFactory.generateMovieClipData("r_run"),this.boy.scaleX=-1,this.boy.play(-1),this.mboyMc.movieClipData=this.mcFactory.generateMovieClipData("r_run2"),this.mboyMc.play(-1),this.rboyMc.movieClipData=this.mcFactory.generateMovieClipData("l_run"),this.rboyMc.play(-1),egret.Tween.get(this.boy).to({x:113.65,y:733.45},1e3).call(function(){SoundManager.getInstance().playSound(SoundEnum.GLASSBREAK2SOUND_MP3),e.bang.x=92.35,e.bang.y=543.15,e.bang.visible=!0,e.lie.x=62,e.lie.y=508,e.lie.visible=!0}).wait(100).call(function(){e.boy.movieClipData=e.mcFactory.generateMovieClipData("sh_dun1"),e.bang.visible=!1,e.FLAG_END_GAMEOVER=!0,Util.singletonPush(e.cards,98)}),egret.Tween.get(this.leftMirrorBoy).to({x:81.85,y:654.65},1e3).wait(100).call(function(){e.leftMirrorBoy.scaleX=-1,e.lboyMc.movieClipData=e.mcFactory.generateMovieClipData("sh_dun2")}),egret.Tween.get(this.midMirrorBoy).to({x:81.85-27.85},1e3),egret.Tween.get(this.rightMirrorBoy).to({x:113.65},1e3)):this.FLAG_ROOM_3_STATUS===this.FLAG_ROOM_3_LIGHTING?(this.boyPng.texture=this.sheet.getTexture("zhengguang2"),this.boyPng.x=this.boy.x+62,this.boyPng.y=this.boy.y-123+112,this.lboyPng.texture=this.sheet.getTexture("ligthinmirro"),this.lboyPngPlus.texture=this.sheet.getTexture("guang"),this.lboyPngPlus.x=-95,this.lboyPngPlus.y=-33,this.lboyPngPlus.visible=!0,this.mboyPng.texture=this.sheet.getTexture("lightleft2"),this.mboyPng.x=this.lboyMc.x-170,this.rboyPng.texture=this.sheet.getTexture("lightleft"),this.rboyPng.scaleX=1,this.rboyPng.x=this.rboyMc.x-170):this.FLAG_ROOM_3_STATUS===this.FLAG_ROOM_3_LIGHTED&&(this.removeMirrorEventListener(),this.boy.visible=this.lboyMc.visible=this.rboyMc.visible=!0,this.boyPng.visible=this.lboyPng.visible=this.rboyPng.visible=!1,this.boy.movieClipData=this.mcFactory.generateMovieClipData("r_run"),this.boy.scaleX=-1,this.boy.play(-1),this.mboyMc.movieClipData=this.mcFactory.generateMovieClipData("r_run2"),this.mboyMc.play(-1),this.rboyMc.movieClipData=this.mcFactory.generateMovieClipData("m_run"),this.rboyMc.play(-1),egret.Tween.get(this.boy).to({x:113.65,y:733.45},1e3).call(function(){SoundManager.getInstance().playSound(SoundEnum.GLASSBREAK2SOUND_MP3),e.bang.x=92.35,e.bang.y=543.15,e.bang.visible=!0,e.lie.x=62,e.lie.y=508,e.lie.visible=!0
}).wait(100).call(function(){e.boy.movieClipData=e.mcFactory.generateMovieClipData("sh_dun1"),e.bang.visible=!1,e.FLAG_END_GAMEOVER=!0,Util.singletonPush(e.cards,98)}),egret.Tween.get(this.leftMirrorBoy).to({x:81.85,y:654.65},1e3).wait(100).call(function(){e.leftMirrorBoy.scaleX=-1,e.lboyMc.movieClipData=e.mcFactory.generateMovieClipData("sh_dun2")}),egret.Tween.get(this.midMirrorBoy).to({x:81.85-27.85},1e3),egret.Tween.get(this.rightMirrorBoy).to({x:113.65},1e3)):4===this.FLAG_CURRENT_ROOM},e.prototype.midMirrorTouched=function(t){var e=this;1===this.FLAG_CURRENT_ROOM||2===this.FLAG_CURRENT_ROOM?(this.removeMirrorEventListener(),this.boy.movieClipData=this.mcFactory.generateMovieClipData("m_run"),this.boy.scaleX=-1,this.boy.play(-1),this.mboyMc.movieClipData=this.mcFactory.generateMovieClipData("m_run2"),this.mboyMc.play(-1),this.rboyMc.movieClipData=this.mcFactory.generateMovieClipData("m_run"),this.rboyMc.play(-1),egret.Tween.get(this.boy).to({x:320,y:721},1e3).call(function(){e.bang.x=320,e.bang.y=543.15,e.bang.visible=!0,e.lie.x=320,e.lie.y=508,e.lie.visible=!0}).wait(100).call(function(){e.boy.movieClipData=e.mcFactory.generateMovieClipData("sh_dun1"),e.bang.visible=!1,e.FLAG_END_GAMEOVER=!0,Util.singletonPush(e.cards,98)}),egret.Tween.get(this.leftMirrorBoy).to({x:320},1e3),egret.Tween.get(this.midMirrorBoy).to({x:320,y:597.25},1e3).wait(100).call(function(){e.mboyMc.scaleX=-1,e.mboyMc.movieClipData=e.mcFactory.generateMovieClipData("sh_dun2")}),egret.Tween.get(this.rightMirrorBoy).to({x:320},1e3)):2===this.FLAG_CURRENT_ROOM?(this.removeMirrorEventListener(),this.boy.movieClipData=this.mcFactory.generateMovieClipData("m_run"),this.boy.scaleX=-1,this.boy.play(-1),this.mboyMc.movieClipData=this.mcFactory.generateMovieClipData("m_run2"),this.mboyMc.play(-1),this.rboyMc.movieClipData=this.mcFactory.generateMovieClipData("r_run2"),this.rboyMc.play(-1),egret.Tween.get(this.boy).to({x:320,y:721},1e3).call(function(){e.bang.x=320,e.bang.y=543.15,e.bang.visible=!0}).wait(100).call(function(){e.boy.movieClipData=e.mcFactory.generateMovieClipData("sh_dun1"),e.bang.visible=!1,e.FLAG_END_GAMEOVER=!0,Util.singletonPush(e.cards,98)}),egret.Tween.get(this.leftMirrorBoy).to({x:320},1e3),egret.Tween.get(this.midMirrorBoy).to({x:320,y:597.25},1e3).wait(100).call(function(){e.mboyMc.scaleX=-1,e.mboyMc.movieClipData=e.mcFactory.generateMovieClipData("sh_dun2")}),egret.Tween.get(this.rightMirrorBoy).to({x:320},1e3)):3===this.FLAG_CURRENT_ROOM?this.FLAG_ROOM_3_STATUS===this.FLAG_ROOM_3_RUNNING?(this.removeMirrorEventListener(),this.boy.movieClipData=this.mcFactory.generateMovieClipData("m_run"),this.boy.scaleX=-1,this.boy.play(-1),this.mboyMc.movieClipData=this.mcFactory.generateMovieClipData("m_run2"),this.mboyMc.play(-1),this.rboyMc.movieClipData=this.mcFactory.generateMovieClipData("m_run"),this.rboyMc.play(-1),egret.Tween.get(this.boy).to({x:320,y:721},1e3).call(function(){e.bang.x=320,e.bang.y=543.15,e.bang.visible=!0,e.lie.x=320,e.lie.y=508,e.lie.visible=!0}).wait(100).call(function(){e.boy.movieClipData=e.mcFactory.generateMovieClipData("sh_dun1"),e.bang.visible=!1,e.FLAG_END_GAMEOVER=!0,Util.singletonPush(e.cards,99)}),egret.Tween.get(this.leftMirrorBoy).to({x:320},1e3),egret.Tween.get(this.midMirrorBoy).to({x:320,y:597.25},1e3).wait(100).call(function(){e.mboyMc.scaleX=-1,e.mboyMc.movieClipData=e.mcFactory.generateMovieClipData("sh_dun2")}),egret.Tween.get(this.rightMirrorBoy).to({x:320},1e3)):this.FLAG_ROOM_3_STATUS===this.FLAG_ROOM_3_LIGHTING?(this.boyPng.texture=this.sheet.getTexture("lightqian"),this.boyPng.x=this.boy.x,this.boyPng.y=this.boy.y-463,this.lboyPng.texture=this.sheet.getTexture("lightright"),this.mboyPng.texture=this.sheet.getTexture("huang"),this.rboyPng.texture=this.sheet.getTexture("lightleft2"),this.rboyPng.scaleX=1,this.rboyPng.x=this.rboyMc.x-170,egret.Tween.get(this.midMirrorBoy).wait(300).call(function(){e.mboyPng.visible=!1,e.mboyMc.movieClipData=e.mcFactory.generateMovieClipData("m_run"),e.mboyMc.visible=!0,e.mboyMc.play(-1)}).to({y:this.FLAG_POS_FAR_MIDDLE_Y-500},1e3).call(function(){e.FLAG_ROOM_3_STATUS=e.FLAG_ROOM_3_LIGHTED})):this.FLAG_ROOM_3_STATUS===this.FLAG_ROOM_3_LIGHTED&&(this.removeMirrorEventListener(),this.boy.visible=!0,this.boyPng.visible=!1,this.lboyMc.visible=!0,this.lboyPng.visible=!1,this.rboyMc.visible=!0,this.rboyPng.visible=!1,egret.Tween.get(this.boy).to({x:320,y:721},1e3).call(function(){e.initRoom4()}),egret.Tween.get(this.leftMirrorBoy).to({x:320},1e3),egret.Tween.get(this.rightMirrorBoy).to({x:320},1e3)):4===this.FLAG_CURRENT_ROOM},e.prototype.rightMirrorTouched=function(t){var e=this;1===this.FLAG_CURRENT_ROOM?(this.removeMirrorEventListener(),SoundManager.getInstance().playSound(SoundEnum.RUNECHOSOUND_MP3),this.boy.movieClipData=this.mcFactory.generateMovieClipData("r_run"),this.boy.play(-1),this.mboyMc.movieClipData=this.mcFactory.generateMovieClipData("m_run2"),this.mboyMc.play(-1),this.rboyMc.movieClipData=this.mcFactory.generateMovieClipData("r_run"),this.rboyMc.play(-1),egret.Tween.get(this.boy).to({x:this.FLAG_POS_FAR_RIGHT_X,y:this.FLAG_POS_FAR_RIGHT_Y},1e3).call(function(){}).wait(100).call(function(){e.screen_splash.visible=!0,egret.Tween.get(e.screen_splash).to({alpha:.15}).to({alpha:0},80).to({alpha:1},1e3).call(function(){e.initRoom2()})}),egret.Tween.get(this.leftMirrorBoy).to({x:this.FLAG_POS_RIGHT_Y},1e3),egret.Tween.get(this.midMirrorBoy).to({x:this.FLAG_POS_RIGHT_Y},1e3),egret.Tween.get(this.rightMirrorBoy).to({x:this.FLAG_POS_FAR_RIGHT_X,y:this.FLAG_POS_FAR_RIGHT_Y},1e3).wait(100).call(function(){})):2===this.FLAG_CURRENT_ROOM?(this.removeMirrorEventListener(),SoundManager.getInstance().playSound(SoundEnum.RUNECHOSOUND_MP3),this.boy.movieClipData=this.mcFactory.generateMovieClipData("r_run"),this.boy.play(-1),this.mboyMc.movieClipData=this.mcFactory.generateMovieClipData("m_run2"),this.mboyMc.play(-1),this.rboyMc.movieClipData=this.mcFactory.generateMovieClipData("r_run2"),this.rboyMc.play(-1),egret.Tween.get(this.boy).to({x:this.FLAG_POS_RIGHT_X,y:this.FLAG_POS_RIGHT_Y},1e3).call(function(){}),egret.Tween.get(this.leftMirrorBoy).to({x:this.FLAG_POS_RIGHT_Y},1e3),egret.Tween.get(this.midMirrorBoy).to({x:this.FLAG_POS_RIGHT_Y},1e3),egret.Tween.get(this.rightMirrorBoy).to({x:this.FLAG_POS_RIGHT_X+50,y:this.FLAG_POS_RIGHT_Y-50},1e3).call(function(){SoundManager.getInstance().playSound(SoundEnum.GLASSBREAK2SOUND_MP3),e.bang.x=552,e.bang.y=543.15,e.bang.visible=!0,e.lie.x=520,e.lie.y=508,e.lie.visible=!0}).wait(100).call(function(){e.rightMirrorBoy.scaleX=-1,e.rboyMc.movieClipData=e.mcFactory.generateMovieClipData("sh_dun2"),e.boy.movieClipData=e.mcFactory.generateMovieClipData("sh_dun1"),e.bang.visible=!1,e.FLAG_END_GAMEOVER=!0,Util.singletonPush(e.cards,98)})):3===this.FLAG_CURRENT_ROOM?this.FLAG_ROOM_3_STATUS===this.FLAG_ROOM_3_RUNNING?(this.removeMirrorEventListener(),SoundManager.getInstance().playSound(SoundEnum.RUNECHOSOUND_MP3),this.boy.movieClipData=this.mcFactory.generateMovieClipData("r_run"),this.boy.play(-1),this.mboyMc.movieClipData=this.mcFactory.generateMovieClipData("m_run2"),this.mboyMc.play(-1),this.rboyMc.movieClipData=this.mcFactory.generateMovieClipData("r_run2"),this.rboyMc.play(-1),egret.Tween.get(this.boy).to({x:this.FLAG_POS_RIGHT_X,y:this.FLAG_POS_RIGHT_Y},1e3).call(function(){}),egret.Tween.get(this.leftMirrorBoy).to({x:this.FLAG_POS_RIGHT_Y},1e3),egret.Tween.get(this.midMirrorBoy).to({x:this.FLAG_POS_RIGHT_Y},1e3),egret.Tween.get(this.rightMirrorBoy).to({x:this.FLAG_POS_RIGHT_X+50,y:this.FLAG_POS_RIGHT_Y-50},1e3).call(function(){SoundManager.getInstance().playSound(SoundEnum.GLASSBREAK2SOUND_MP3),e.bang.x=552,e.bang.y=543.15,e.bang.visible=!0,e.lie.x=520,e.lie.y=508,e.lie.visible=!0}).wait(100).call(function(){e.rboyMc.movieClipData=e.mcFactory.generateMovieClipData("sh_dun2"),e.rightMirrorBoy.scaleX=-1,e.boy.movieClipData=e.mcFactory.generateMovieClipData("sh_dun1"),e.bang.visible=!1,e.FLAG_END_GAMEOVER=!0,Util.singletonPush(e.cards,98)})):this.FLAG_ROOM_3_STATUS===this.FLAG_ROOM_3_LIGHTING?(this.boyPng.texture=this.sheet.getTexture("zheguang"),this.boyPng.x=this.boy.x,this.boyPng.y=this.boy.y-123+112,this.lboyPng.texture=this.sheet.getTexture("lightright2"),this.lboyPng.x=this.lboyMc.x,this.mboyPng.texture=this.sheet.getTexture("lightright"),this.mboyPng.x=this.mboyMc.x,this.rboyPng.texture=this.sheet.getTexture("ligthinmirro"),this.rboyPng.x=this.rboyMc.x):this.FLAG_ROOM_3_STATUS===this.FLAG_ROOM_3_LIGHTED&&(this.removeMirrorEventListener(),this.boy.visible=this.lboyMc.visible=this.rboyMc.visible=!0,this.boyPng.visible=this.lboyPng.visible=this.rboyPng.visible=!1,SoundManager.getInstance().playSound(SoundEnum.RUNECHOSOUND_MP3),this.boy.movieClipData=this.mcFactory.generateMovieClipData("r_run"),this.boy.play(-1),this.mboyMc.movieClipData=this.mcFactory.generateMovieClipData("m_run2"),this.mboyMc.play(-1),this.rboyMc.movieClipData=this.mcFactory.generateMovieClipData("r_run2"),this.rboyMc.play(-1),egret.Tween.get(this.boy).to({x:this.FLAG_POS_RIGHT_X,y:this.FLAG_POS_RIGHT_Y},1e3).call(function(){}),egret.Tween.get(this.leftMirrorBoy).to({x:this.FLAG_POS_RIGHT_Y},1e3),egret.Tween.get(this.midMirrorBoy).to({x:this.FLAG_POS_RIGHT_Y},1e3),egret.Tween.get(this.rightMirrorBoy).to({x:this.FLAG_POS_RIGHT_X+50,y:this.FLAG_POS_RIGHT_Y-50},1e3).call(function(){SoundManager.getInstance().playSound(SoundEnum.GLASSBREAK2SOUND_MP3),e.bang.x=552,e.bang.y=543.15,e.bang.visible=!0,e.lie.x=520,e.lie.y=508,e.lie.visible=!0}).wait(100).call(function(){e.rightMirrorBoy.scaleX=-1,e.rboyMc.movieClipData=e.mcFactory.generateMovieClipData("sh_dun2"),e.boy.movieClipData=e.mcFactory.generateMovieClipData("sh_dun1"),e.bang.visible=!1,e.FLAG_END_GAMEOVER=!0,Util.singletonPush(e.cards,98)})):4===this.FLAG_CURRENT_ROOM},e.prototype.boyTouched=function(t){this.FLAG_ROOM_3_STATUS>this.FLAG_ROOM_3_RUNNING&&(this.registItem(ItemEnum.ITEM_FLASHLIGHT),this.FLAG_ROOM_3_STATUS===this.FLAG_ROOM_3_LIGHTING&&(this.FLAG_ROOM_3_STATUS=this.FLAG_ROOM_3_RUNNING))},e.prototype.pepperTouched=function(t){this.registItem(ItemEnum.ITEM_PEPER)},e.prototype.lightTouched=function(t){this.registItem(ItemEnum.ITEM_FLASHLIGHT)},e.prototype._loadRes=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,StageController.getInstance().loadStage(this.stageid)];case 1:return e.sent(),[3,3];case 2:return t=e.sent(),console.error(t),[3,3];case 3:return[2]}})})},e.prototype._start=function(){},e.prototype.play_loop=function(){return this.FLAG_END_GAMEOVER||this.FLAG_END_CLEAR?(this.COUNTER_END++,void(this.COUNTER_END>=60&&(this.FLAG_END_CLEAR&&StageController.getInstance().clearStage(this.stageid,this.cards),this.FLAG_END_GAMEOVER&&StageController.getInstance().gameOverStage(this.stageid,this.cards)))):void(this.FLAG_EAT_PEPER&&(29===this.boy.currentFrame&&(this.peppers[0].visible=!0,this.peppers[0].x=this.boy.x-49.85,this.peppers[0].y=this.boy.y-171.25,egret.Tween.get(this.peppers[0]).to({x:this.boy.x-49.85-100,y:this.boy.y-171.25-200},500).to({x:this.boy.x-49.85-400,y:this.boy.y-171.25},500)),this.boy.currentFrame===this.boy.totalFrames&&(this.addMirrorEventListener(),this.FLAG_EAT_PEPER=!1,this.boy.movieClipData=this.mcFactory.generateMovieClipData("m_run"),this.boy.play(-1),this.mboyMc.movieClipData=this.mcFactory.generateMovieClipData("m_run2"),this.mboyMc.play(-1),this.rboyMc.movieClipData=this.mcFactory.generateMovieClipData("l_run"),this.rboyMc.play(-1))))},e.prototype._remove=function(){egret.Tween.removeAllTweens()},e.prototype.registItem=function(t){ItemController.getInstance().addItem(t)&&(t===ItemEnum.ITEM_PEPER?(this.peppers[0].visible=!1,this.peppers[1].visible=!1,this.peppers[2].visible=!1,this.peppers[3].visible=!1):t===ItemEnum.ITEM_FLASHLIGHT&&(this.lights[0].visible=!1,this.lights[1].visible=!1,this.lights[2].visible=!1,this.lights[3].visible=!1))},e.prototype.useItem=function(t,e,i){if(this.ANIMATE_PLAYING)return!1;if(this.boy.hitTestPoint(e,i)){if(t===ItemEnum.ITEM_PEPER&&2===this.FLAG_CURRENT_ROOM)return this.FLAG_ROOM_2_EATED=!0,this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_eating2"),this.boy.gotoAndPlay(1),this.lboyMc.movieClipData=this.mcFactory.generateMovieClipData("sh_eating"),this.lboyMc.gotoAndPlay(1),this.mboyMc.movieClipData=this.mcFactory.generateMovieClipData("sh_eating3"),this.mboyMc.gotoAndPlay(1),this.rboyMc.movieClipData=this.mcFactory.generateMovieClipData("sh_eating3"),this.rboyMc.scaleX=-1,this.rboyMc.gotoAndPlay(1),this.removeMirrorEventListener(),this.FLAG_EAT_PEPER=!0,!0;if(ItemEnum.ITEM_FLASHLIGHT===t&&3===this.FLAG_CURRENT_ROOM)return this.FLAG_ROOM_3_STATUS=this.FLAG_ROOM_3_LIGHTING,this.boy.visible=!1,this.lboyMc.visible=!1,this.mboyMc.visible=!1,this.rboyMc.visible=!1,this.boyPng=new TSBitmap("lightself2",this.sheet,!0),this.boyPng.x=this.boy.x,this.boyPng.y=this.boy.y,this.room1.addChild(this.boyPng),this.lboyPng=new TSBitmap("lightself",this.sheet,!0),this.lboyPng.x=this.lboyMc.x,this.lboyPng.y=this.lboyMc.y,this.leftMirrorBoy.addChild(this.lboyPng),this.lboyPngPlus=new TSBitmap("guang",this.sheet,!0),this.lboyPngPlus.visible=!1,this.room1.addChild(this.lboyPngPlus),this.leftMirrorBoy.addChild(this.lboyPng),this.mboyPng=new TSBitmap("lightself",this.sheet,!0),this.mboyPng.x=this.mboyMc.x,this.mboyPng.y=this.mboyMc.y,this.midMirrorBoy.addChild(this.mboyPng),this.rboyPng=new TSBitmap("lightself",this.sheet,!0),this.rboyPng.x=this.rboyMc.x,this.rboyPng.y=this.rboyMc.y,this.rboyPng.scaleX=-1,this.rightMirrorBoy.addChild(this.rboyPng),this.rboyPngPlus=new TSBitmap("guang",this.sheet,!0),this.rboyPngPlus.scaleX=-1,this.rboyPngPlus.visible=!1,this.room1.addChild(this.rboyPngPlus),!0}return!1},e.prototype.getDisplayArea=function(){return new egret.Rectangle},e.prototype.ctrl_right=function(){},e.prototype.ctrl_left=function(){},e.prototype.ctrl_up=function(){},e.prototype.ctrl_down=function(){},e.prototype.ctrl_ok=function(){},e.prototype.ctrl_cancel=function(){},e}(egret.DisplayObjectContainer);__reflect(Stage23.prototype,"Stage23",["IFKaihiStage"]);var Stage24=function(t){function e(){var e=t.call(this)||this;return e.stageid=24,e.FLAG_CURRENT_FISH=0,e.FLAG_BOY_FISHING=!1,e.FLAG_END_GAMEOVER=!1,e.FLAG_END_CLEAR=!1,e.COUNTER_END=0,e.cards=[],e._init(),e}return __extends(e,t),e.prototype._init=function(){return __awaiter(this,void 0,void 0,function(){var t,e,i,s,h=this;return __generator(this,function(a){switch(a.label){case 0:return UIManager.getInstance().showLoading(),[4,this._loadRes()];case 1:return a.sent(),this.mcFactory=new egret.MovieClipDataFactory(RES.getRes("stage24_action_json"),RES.getRes("stage24_action_png")),this.shFactory=new egret.MovieClipDataFactory(RES.getRes("stage24_sh_action_json"),RES.getRes("stage24_sh_action_png")),this.fishFactory=new egret.MovieClipDataFactory(RES.getRes("stage24_fish_action_json"),RES.getRes("stage24_fish_action_png")),this.sheet=RES.getRes("stage24_texture"),this.container=new egret.Sprite,this.container.x=0,this.container.y=0,this.addChild(this.container),t=new TSBitmap("bg",this.sheet),t.x=-760,t.y=-100,this.container.addChild(t),e=new TSBitmap("sea",this.sheet,!0),e.y=597.1,e.x=640,this.container.addChild(e),egret.Tween.get(e,{loop:!0}).to({y:594.1},1e3).to({y:597.1},1e3),i=new TSBitmap("stones",this.sheet),i.x=-760,i.y=436,this.container.addChild(i),this.title=new TSBitmap("fishingplace",this.sheet,!0),this.title.x=-572.45,this.title.y=558,this.title.touchEnabled=!0,this.container.addChild(this.title),this.boy=new egret.MovieClip(this.shFactory.generateMovieClipData("sh_default")),this.boy.x=-316,this.boy.y=577,this.boy.gotoAndStop(1),this.container.addChild(this.boy),s=new TSBitmap("stone",this.sheet),s.x=-295,s.y=428,this.container.addChild(s),this.fish=new egret.MovieClip(this.mcFactory.generateMovieClipData("fish1_jump")),this.fish.visible=!1,this.container.addChild(this.fish),this.white=new egret.MovieClip(this.mcFactory.generateMovieClipData("white_jump")),this.white.x=232.2,this.white.y=669.1,this.white.play(-1),this.container.addChild(this.white),this.fat=new egret.MovieClip(this.mcFactory.generateMovieClipData("fat_jump")),this.fat.x=486.55,this.fat.y=693.5,this.fat.play(-1),this.container.addChild(this.fat),this.turtle=new egret.MovieClip(this.mcFactory.generateMovieClipData("turtle_stand")),this.turtle.x=349.95,this.turtle.y=811.9,this.turtle.touchEnabled=!0,this.container.addChild(this.turtle),this.thin=new egret.MovieClip(this.mcFactory.generateMovieClipData("thin_tong")),this.thin.x=185.3,this.thin.y=800.25,this.thin.play(-1),this.container.addChild(this.thin),this.startBtn=new TSBitmap("startbtn",this.sheet,!0),this.startBtn.x=-320,this.startBtn.y=852,this.startBtn.touchEnabled=!0,this.container.addChild(this.startBtn),this.grass=new TSBitmap("grass",this.sheet,!0),this.grass.x=-592.9,this.grass.y=766.3,this.grass.touchEnabled=!0,this.grass.visible=!1,this.container.addChild(this.grass),this.leftArrow=new TSBitmap("arrow_png"),this.leftArrow.x=40,this.leftArrow.y=510,this.leftArrow.touchEnabled=!0,this.addChild(this.leftArrow),this.rightArrow=new TSBitmap("arrow_png"),this.rightArrow.scaleX=-1,this.rightArrow.x=600,this.rightArrow.y=510,this.rightArrow.visible=!1,this.rightArrow.touchEnabled=!0,this.addChild(this.rightArrow),this.leftArrow.addEventListener(egret.TouchEvent.TOUCH_TAP,this.leftArrowTouched,this),this.rightArrow.addEventListener(egret.TouchEvent.TOUCH_TAP,this.rightArrowTouched,this),UIManager.getInstance().hideLoading(),egret.Tween.get(this.container).wait(1e3).call(function(){h.leftArrow.visible=!1}).to({x:640},500).call(function(){h.rightArrow.visible=!0,h.addAllEventListener()}),[2]}})})},e.prototype.addAllEventListener=function(){this.grass.addEventListener(egret.TouchEvent.TOUCH_TAP,this.grassTouched,this),this.startBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.startTouched,this),this.title.addEventListener(egret.TouchEvent.TOUCH_TAP,this.titleTouched,this),this.turtle.addEventListener(egret.TouchEvent.TOUCH_TAP,this.turtleTouched,this)},e.prototype.removeAllEventListener=function(){this.grass.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.grassTouched,this),this.startBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.startTouched,this),this.title.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.titleTouched,this),this.turtle.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.turtleTouched,this)},e.prototype.grassTouched=function(t){this.registItem(ItemEnum.ITEM_KELP)},e.prototype.startTouched=function(t){var e=this;this.removeAllEventListener(),this.startBtn.visible=!1,this.title.touchEnabled=!1,0===this.FLAG_CURRENT_FISH?(Util.singletonPush(this.cards,104),this.container.setChildIndex(this.boy,this.container.getChildIndex(this.turtle)),this.boy.movieClipData=this.shFactory.generateMovieClipData("sh_default_walk"),this.boy.play(-1),egret.Tween.get(this.boy).to({x:this.boy.x+480,y:this.boy.y+30},2e3).call(function(){e.boy.movieClipData=e.shFactory.generateMovieClipData("sh_bad"),e.boy.x=469,e.boy.y=874.1,e.boy.play(-1),egret.Tween.get(e.container).call(function(){e.rightArrow.visible=!1}).to({x:0},500).call(function(){e.FLAG_END_GAMEOVER=!0})})):4===this.FLAG_CURRENT_FISH?(Util.singletonPush(this.cards,110),this.container.setChildIndex(this.boy,this.container.getChildIndex(this.turtle)),this.container.setChildIndex(this.boy,this.container.getChildIndex(this.thin)),egret.Tween.get(this.boy).to({x:this.boy.x+480,y:this.boy.y+30},2e3).call(function(){egret.Tween.get(e.container).call(function(){e.rightArrow.visible=!1}).to({x:0},800).call(function(){e.boy.movieClipData=e.fishFactory.generateMovieClipData("sh_clear"),e.boy.x=294.8,e.boy.y=673.2,e.boy.gotoAndPlay(1),SoundManager.getInstance().playSound(SoundEnum.KICKSOUND_MP3),e.thin.movieClipData=e.mcFactory.generateMovieClipData("thin_run"),e.thin.play()}).wait(500).call(function(){SoundManager.getInstance().playSound(SoundEnum.KICKSOUND_MP3),e.fat.movieClipData=e.mcFactory.generateMovieClipData("fat_run"),e.fat.play()}).wait(500).call(function(){SoundManager.getInstance().playSound(SoundEnum.KICKSOUND_MP3),e.white.movieClipData=e.mcFactory.generateMovieClipData("white_run"),e.white.play()}).wait(5e3).call(function(){e.turtle.movieClipData=e.mcFactory.generateMovieClipData("turtle_out"),e.turtle.x=356,e.turtle.y=811.9,e.turtle.gotoAndPlay(1)}).wait(900).call(function(){e.turtle.movieClipData=e.mcFactory.generateMovieClipData("turtle_move"),e.turtle.play(-1),egret.Tween.get(e.turtle).to({x:424.15,y:639.7-45.4,scaleX:.78,scaleY:.78},3e3)}).wait(3e3).call(function(){e.boy.movieClipData=e.shFactory.generateMovieClipData("sh_fish_wait"),e.boy.x=184,e.boy.y=647,e.boy.gotoAndPlay(1),e.turtle.movieClipData=e.mcFactory.generateMovieClipData("turtle_get_up"),e.turtle.scaleX=e.turtle.scaleY=1,e.turtle.x=424.15,e.turtle.y=639.7,e.turtle.gotoAndPlay(1)}).wait(900).call(function(){e.turtle.scaleX=e.turtle.scaleY=.78,e.turtle.movieClipData=e.mcFactory.generateMovieClipData("turtle_fish_move"),e.turtle.play(-1),egret.Tween.get(e.turtle).to({x:506,y:568.7,scaleX:.34,scaleY:.34},3500)}).wait(3500).call(function(){Util.singletonPush(e.cards,111),e.FLAG_END_CLEAR=!0})})):(this.container.setChildIndex(this.boy,this.container.getChildIndex(this.turtle)),this.boy.movieClipData=this.shFactory.generateMovieClipData("sh_fish_walk"),this.boy.play(-1),egret.Tween.get(this.boy).to({x:this.boy.x+480,y:this.boy.y+30},2e3).call(function(){switch(e.boy.movieClipData=e.shFactory.generateMovieClipData("sh_bad"),e.boy.x=469,e.boy.y=874.1,e.boy.play(-1),e.FLAG_CURRENT_FISH){case 1:Util.singletonPush(e.cards,108),e.thin.movieClipData=e.mcFactory.generateMovieClipData("thin_fish_out"),e.thin.play(-1);break;case 2:Util.singletonPush(e.cards,106),e.white.movieClipData=e.mcFactory.generateMovieClipData("white_fish"),e.white.play(-1);break;case 3:Util.singletonPush(e.cards,107),e.fat.movieClipData=e.mcFactory.generateMovieClipData("fat_fish"),e.fat.play(-1)}egret.Tween.get(e.container).call(function(){e.rightArrow.visible=!1}).to({x:0},500).call(function(){e.FLAG_END_GAMEOVER=!0})}),egret.Tween.get(this.fish).to({x:this.fish.x+480,y:this.fish.y+30},2e3).call(function(){e.fish.visible=!1}))},e.prototype.titleTouched=function(t){this.removeAllEventListener(),this.startBtn.visible=!1,this.boy.x=-529.45,this.boy.y=640.8,this.FLAG_BOY_FISHING=!0,this.rightArrow.visible=!1,0===this.FLAG_CURRENT_FISH?this.grass.visible===!1?(this.boy.movieClipData=this.shFactory.generateMovieClipData("sh_fishing"),this.boy.play()):(this.boy.movieClipData=this.shFactory.generateMovieClipData("sh_fishing_nothing"),this.boy.play()):1===this.FLAG_CURRENT_FISH?(this.fish.visible=!1,this.boy.movieClipData=this.shFactory.generateMovieClipData("sh_fishing_1fish"),this.boy.play()):2===this.FLAG_CURRENT_FISH?(this.fish.visible=!1,this.boy.movieClipData=this.shFactory.generateMovieClipData("sh_fishing_2fish"),this.boy.play()):3===this.FLAG_CURRENT_FISH?(this.fish.visible=!1,this.boy.movieClipData=this.shFactory.generateMovieClipData("sh_fishing_3fish"),this.boy.play()):4===this.FLAG_CURRENT_FISH&&(this.fish.visible=!1,this.boy.movieClipData=this.shFactory.generateMovieClipData("sh_fishing_4fish"),this.boy.play(),Util.singletonPush(this.cards,109))},e.prototype.littleFishTouched=function(t){this.registItem(ItemEnum.ITEM_FISH)},e.prototype.turtleTouched=function(t){this.turtle.touchEnabled=!1,this.littleFish=new egret.MovieClip(this.mcFactory.generateMovieClipData("little_fish")),this.littleFish.x=232.55,this.littleFish.y=868.15,this.littleFish.play(),this.littleFish.touchEnabled=!0,this.container.addChild(this.littleFish),this.littleFish.addEventListener(egret.TouchEvent.TOUCH_TAP,this.littleFishTouched,this)},e.prototype.rightArrowTouched=function(t){this.rightArrow.visible=!1,this.leftArrow.visible=!0,egret.Tween.get(this.container).to({x:0},500)},e.prototype.leftArrowTouched=function(t){this.leftArrow.visible=!1,this.rightArrow.visible=!0,egret.Tween.get(this.container).to({x:640},500)},e.prototype._loadRes=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,StageController.getInstance().loadStage(this.stageid)];case 1:return e.sent(),[3,3];case 2:return t=e.sent(),console.error(t),[3,3];case 3:return[2]}})})},e.prototype._start=function(){},e.prototype.play_loop=function(){return this.FLAG_END_GAMEOVER||this.FLAG_END_CLEAR?(this.COUNTER_END++,void(this.COUNTER_END>=60&&(this.FLAG_END_CLEAR&&StageController.getInstance().clearStage(this.stageid,this.cards),this.FLAG_END_GAMEOVER&&StageController.getInstance().gameOverStage(this.stageid,this.cards)))):void(this.FLAG_BOY_FISHING&&(25===this.boy.currentFrame&&SoundManager.getInstance().playSound(SoundEnum.WATER3SOUND_MP3),this.boy.currentFrame===this.boy.totalFrames&&(0===this.FLAG_CURRENT_FISH?(this.grass.visible=!0,this.boy.movieClipData=this.shFactory.generateMovieClipData("sh_default"),this.boy.x=-316,this.boy.y=577,this.rightArrow.visible=!0,this.FLAG_BOY_FISHING=!1,this.addAllEventListener(),this.startBtn.visible=!0):1===this.FLAG_CURRENT_FISH?(this.boy.movieClipData=this.shFactory.generateMovieClipData("sh_fish_wait"),this.boy.x=-316,this.boy.y=577,this.fish.movieClipData=this.mcFactory.generateMovieClipData("fish2_jump"),this.fish.play(-1),this.fish.x=this.boy.x+105.55,this.fish.y=this.boy.y+38.2,this.fish.visible=!0,this.rightArrow.visible=!0,this.FLAG_BOY_FISHING=!1,this.FLAG_CURRENT_FISH++,this.addAllEventListener(),this.startBtn.visible=!0):2===this.FLAG_CURRENT_FISH?(this.boy.movieClipData=this.shFactory.generateMovieClipData("sh_fish_wait"),this.boy.x=-316,this.boy.y=577,this.fish.movieClipData=this.mcFactory.generateMovieClipData("fish3_jump"),this.fish.x=this.boy.x+93.05,this.fish.y=this.boy.y+31.95,this.fish.play(-1),this.fish.visible=!0,this.rightArrow.visible=!0,this.FLAG_BOY_FISHING=!1,this.FLAG_CURRENT_FISH++,this.addAllEventListener(),this.startBtn.visible=!0):3===this.FLAG_CURRENT_FISH?(this.boy.movieClipData=this.fishFactory.generateMovieClipData("sh_fish4_jump"),this.boy.x=-316,this.boy.y=577,this.boy.play(-1),this.rightArrow.visible=!0,this.FLAG_BOY_FISHING=!1,this.FLAG_CURRENT_FISH++,this.addAllEventListener(),this.startBtn.visible=!0):4===this.FLAG_CURRENT_FISH&&(this.FLAG_END_GAMEOVER=!0))))},e.prototype._remove=function(){egret.Tween.removeAllTweens()},e.prototype.registItem=function(t){ItemController.getInstance().addItem(t)&&(t===ItemEnum.ITEM_FISH&&(this.littleFish.visible=!1),t===ItemEnum.ITEM_KELP&&(this.grass.visible=!1))},e.prototype.useItem=function(t,e,i){return t===ItemEnum.ITEM_FISH&&this.boy.hitTestPoint(e,i)&&!this.FLAG_BOY_FISHING?(this.boy.movieClipData=this.shFactory.generateMovieClipData("sh_fish_wait"),this.boy.x=-316,this.boy.y=577,this.fish.x=-235.8,this.fish.y=566.15,this.fish.visible=!0,this.FLAG_CURRENT_FISH=1,this.container.setChildIndex(this.boy,this.container.getChildIndex(this.white)),!0):t===ItemEnum.ITEM_KELP&&this.boy.hitTestPoint(e,i)&&!this.FLAG_BOY_FISHING?(Util.singletonPush(this.cards,105),SoundManager.getInstance().playSound(SoundEnum.ASERISOUND_MP3),this.boy.movieClipData=this.shFactory.generateMovieClipData("sh_grass"),this.boy.play(-1),this.FLAG_END_GAMEOVER=!0,!0):!1},e.prototype.getDisplayArea=function(){return new egret.Rectangle},e.prototype.ctrl_right=function(){},e.prototype.ctrl_left=function(){},e.prototype.ctrl_up=function(){},e.prototype.ctrl_down=function(){},e.prototype.ctrl_ok=function(){},e.prototype.ctrl_cancel=function(){},e}(egret.DisplayObjectContainer);__reflect(Stage24.prototype,"Stage24",["IFKaihiStage"]);var Stage25=function(t){function e(){var e=t.call(this)||this;return e.stageId=25,e.FLAG_END_CLEAR=!1,e.FLAG_END_GAMEOVER=!1,e.COUNTER_END=0,e.BOY_STATUS_DRINKING=!1,e.BOY_STATUS_DRINKING_OVER=!1,e.THIRSTY_DOG_FEED=!1,e.THIRSTY_DOG_FEED_UNEAT=!1,e.FLAG_GRASS_GROWING=!1,e.FLAG_UFO_COMMING=!1,e.FLAG_COWS_NUMBER=0,e.FLAG_GRASS_CLEAR=!1,e.DOG_STATUS_THIRSTY=0,e.DOG_STATUS_DRINKING=4,e.DOG_STATUS_HUNGRY=1,e.DOG_STATUS_HAPPY=2,e.DOG_STATUS_CALL_COW=3,e.DOG_STATUS_CLEAR=5,e.COUNTER_DOG=0,e.FLAG_BOY_EATING=!1,e.FLAG_DOG_STATUS=e.DOG_STATUS_THIRSTY,e.FLAG_FOOD_USED_TO_DOG=!1,e.cards=[],e.grassX=[414.55,263.5,179.65,341.7,467.75,116.35,249.65,401.75,325.7,467.75,146.65,201.4,434.75,268.65,363.25],e.grassY=[734.05,734.05,744.1,744.1,769.15,789.1,799.15,806,824.15,834.1,846,856.85,868.6,875.1,882],e._init(),e}return __extends(e,t),e.prototype._init=function(){return __awaiter(this,void 0,void 0,function(){var t,e,i,s,h,a,o;return __generator(this,function(n){switch(n.label){case 0:return UIManager.getInstance().showLoading(),[4,this._loadRes()];case 1:for(n.sent(),this.mcFactory=new egret.MovieClipDataFactory(RES.getRes("stage25_action_json"),RES.getRes("stage25_action_png")),this.sheet=RES.getRes("stage25_texture"),this.container=new egret.Sprite,this.container.x=0,this.container.y=0,this.addChild(this.container),t=new TSBitmap("bg",this.sheet),t.x=-120,t.y=-100,this.container.addChild(t),e=new TSBitmap("tree",this.sheet),e.x=371,e.y=241,this.container.addChild(e),this.house=new TSBitmap("house",this.sheet),this.house.x=714,this.house.y=200,this.container.addChild(this.house),i=new egret.MovieClip(this.mcFactory.generateMovieClipData("cock")),i.x=941.7,i.y=176.95,i.play(-1),this.container.addChild(i),s=new TSBitmap("doghouse",this.sheet),s.x=1127,s.y=659,this.container.addChild(s),this.cowMask=new egret.Shape,this.cowMask.graphics.beginFill(0,1),this.cowMask.graphics.drawRect(670.35,437,412,430),this.cowMask.graphics.endFill(),this.cow1=new egret.MovieClip(this.mcFactory.generateMovieClipData("cow_move")),this.cow1.x=1198.25,this.cow1.y=611.3,this.cow2=new egret.MovieClip(this.mcFactory.generateMovieClipData("cow_move")),this.cow2.x=1198.25,this.cow2.y=611.3,this.cow3=new egret.MovieClip(this.mcFactory.generateMovieClipData("cow_move")),this.cow3.x=1198.25,this.cow3.y=611.3,this.dog=new egret.MovieClip(this.mcFactory.generateMovieClipData("dog_thirsty")),this.dog.x=1142.3,this.dog.y=770.2,this.dog.play(-1),this.container.addChild(this.dog),this.pen=new TSBitmap("pen",this.sheet,!0),this.pen.y=810.7,this.pen.x=1128.25,this.container.addChild(this.pen),this.water=new TSBitmap("water",this.sheet),this.water.x=1100.25,this.water.y=798.7,this.container.addChild(this.water),this.water.visible=!1,this.food=new TSBitmap("food",this.sheet,!0),this.food.x=489.4,this.food.y=513.8,this.food.touchEnabled=!0,this.container.addChild(this.food),this.bottle=new TSBitmap("bottle",this.sheet,!0),this.bottle.x=475,this.bottle.y=513.8,this.bottle.touchEnabled=!0,this.container.addChild(this.bottle),this.grass3=new TSBitmap("grass1",this.sheet,!0),this.grass3.x=510,this.grass3.y=518.05-14,this.container.addChild(this.grass3),this.grass2=new TSBitmap("grass1",this.sheet,!0),this.grass2.x=450,this.grass2.y=518.05-14,this.container.addChild(this.grass2),this.grass1=new TSBitmap("grass1",this.sheet,!0),this.grass1.x=482,this.grass1.y=514.05,this.container.addChild(this.grass1),this.treeArea=new egret.Shape,this.treeArea.graphics.beginFill(0,0),this.treeArea.graphics.drawRect(406,518.05-40,136,80),this.treeArea.graphics.endFill(),this.treeArea.touchEnabled=!0,this.container.addChild(this.treeArea),this.grasses=new egret.Sprite,this.grasses.x=0,this.grasses.y=0,this.container.addChild(this.grasses),h=new TSBitmap("grasses",this.sheet),h.x=89,h.y=675,this.grasses.touchChildren=!0,this.grasses.addChild(h),this.grassArray=[],o=0;o<this.grassX.length;o++)a=new egret.MovieClip(this.mcFactory.generateMovieClipData("grassgrow")),a.x=this.grassX[o],a.y=this.grassY[o],a.gotoAndStop(a.totalFrames-Math.floor(3*Math.random())),a.touchEnabled=!0,a.addEventListener(egret.TouchEvent.TOUCH_TAP,this.litGrassTouched,this),this.grasses.addChild(a),this.grassArray.push(a);return this.boy=new egret.MovieClip(this.mcFactory.generateMovieClipData("sh_bacao")),this.boy.anchorOffsetX=this.boy.width/2,this.boy.anchorOffsetY=this.boy.height,this.boy.x=this.grassArray[6].x+35,this.boy.y=this.grassArray[6].y+91,this.boy.gotoAndStop(1),this.grasses.addChild(this.boy),this.machine=new TSBitmap("machine",this.sheet,!0),this.machine.x=827.55,this.machine.y=652.7,this.machine.touchEnabled=!0,this.container.addChild(this.machine),this.machineMc=new egret.MovieClip(this.mcFactory.generateMovieClipData("grassmachine")),this.machineMc.x=551.15,this.machineMc.y=495.35,this.machineMc.touchEnabled=!0,this.machineMc.visible=!1,this.machineMc.gotoAndStop(1),this.container.addChild(this.machineMc),this.dogArea=new egret.Shape,this.dogArea.graphics.beginFill(0,0),this.dogArea.graphics.drawRect(1088.25,770.7,80,80),this.dogArea.graphics.endFill(),this.dogArea.touchEnabled=!0,this.container.addChild(this.dogArea),this.leftArrow=new TSBitmap("arrow_png"),this.leftArrow.x=40,this.leftArrow.y=510,this.leftArrow.touchEnabled=!0,this.leftArrow.visible=!1,this.addChild(this.leftArrow),this.rightArrow=new TSBitmap("arrow_png"),this.rightArrow.scaleX=-1,this.rightArrow.x=600,this.rightArrow.y=510,this.rightArrow.touchEnabled=!0,this.addChild(this.rightArrow),this.leftArrow.addEventListener(egret.TouchEvent.TOUCH_TAP,this.leftArrowTouched,this),this.rightArrow.addEventListener(egret.TouchEvent.TOUCH_TAP,this.rightArrowTouched,this),UIManager.getInstance().hideLoading(),this.addAllEventListener(),[2]
}})})},e.prototype.addAllEventListener=function(){this.grasses.touchChildren=!0,this.boy.addEventListener(egret.TouchEvent.TOUCH_TAP,this.boyTouched,this),this.bottle.addEventListener(egret.TouchEvent.TOUCH_TAP,this.cupTouched,this),this.food.addEventListener(egret.TouchEvent.TOUCH_TAP,this.breadTouched,this),this.machine.addEventListener(egret.TouchEvent.TOUCH_TAP,this.machineTouched,this),this.treeArea.addEventListener(egret.TouchEvent.TOUCH_TAP,this.treeGrassTouched,this),this.dogArea.addEventListener(egret.TouchEvent.TOUCH_TAP,this.dogAreaTouched,this)},e.prototype.removeAllEventListener=function(){this.grasses.touchChildren=!1,this.boy.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.boyTouched,this),this.bottle.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.cupTouched,this),this.food.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.breadTouched,this),this.machine.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.machineTouched,this),this.treeArea.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.treeGrassTouched,this),this.dogArea.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.dogAreaTouched,this)},e.prototype.dogAreaTouched=function(t){this.THIRSTY_DOG_FEED_UNEAT&&(this.registItem(ItemEnum.ITEM_BREAD),this.THIRSTY_DOG_FEED_UNEAT=!1,this.FLAG_FOOD_USED_TO_DOG=!1)},e.prototype.boyTouched=function(t){this.boy.touchEnabled=!1,this.BOY_STATUS_DRINKING_OVER&&(this.BOY_STATUS_DRINKING_OVER=!1,this.registItem(ItemEnum.ITEM_CUP),this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_bacao"),this.boy.anchorOffsetX=this.boy.width/2,this.boy.anchorOffsetY=this.boy.height,this.boy.x=this.grassArray[6].x+35,this.boy.y=this.grassArray[6].y+91,this.boy.gotoAndStop(1))},e.prototype.machineTouched=function(t){this.registItem(ItemEnum.ITEM_WEEDER)},e.prototype.cupTouched=function(){this.registItem(ItemEnum.ITEM_CUP)},e.prototype.breadTouched=function(){this.FLAG_FOOD_USED_TO_DOG=!1,this.registItem(ItemEnum.ITEM_BREAD)},e.prototype.treeGrassTouched=function(t){},e.prototype.litGrassTouched=function(t){var e=this;if(!this.BOY_STATUS_DRINKING&&!this.BOY_STATUS_DRINKING_OVER){this.currentLitGrass=t.target,SoundManager.getInstance().playSound(SoundEnum.KUSASOUND_MP3),egret.Tween.get(this.currentLitGrass).wait(300).call(function(){e.currentLitGrass.gotoAndPlay(1)}),this.boy.x=t.target.x+35,this.boy.y=t.target.y+91,this.boy.gotoAndPlay(1);for(var i=0;i<this.grassArray.length;i++)this.boy.y-91>this.grassY[i]&&this.grasses.setChildIndex(this.boy,this.grasses.getChildIndex(this.grassArray[i]));this.FLAG_GRASS_GROWING=!0}},e.prototype.rightArrowTouched=function(t){this.rightArrow.visible=!1,this.leftArrow.visible=!0,egret.Tween.get(this.container).to({x:-640},500)},e.prototype.leftArrowTouched=function(t){void 0===t&&(t=null),null!==t&&(this.leftArrow.visible=!1,this.rightArrow.visible=!0),egret.Tween.get(this.container).to({x:0},500)},e.prototype._loadRes=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,StageController.getInstance().loadStage(this.stageId)];case 1:return e.sent(),[3,3];case 2:return t=e.sent(),console.error(t),[3,3];case 3:return[2]}})})},e.prototype._start=function(){},e.prototype.play_loop=function(){var t=this;if(this.FLAG_END_CLEAR||this.FLAG_END_GAMEOVER)return this.COUNTER_END++,void(30===this.COUNTER_END&&(this.FLAG_END_CLEAR&&(Util.singletonPush(this.cards,115),StageController.getInstance().clearStage(this.stageId,this.cards)),this.FLAG_END_GAMEOVER&&StageController.getInstance().gameOverStage(this.stageId,this.cards)));if(this.FLAG_GRASS_CLEAR&&this.grassMc.currentFrame===this.grassMc.totalFrames&&(this.FLAG_END_CLEAR=!0,this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_clear"),this.boy.gotoAndPlay(1)),this.BOY_STATUS_DRINKING&&this.boy.currentFrame===this.boy.totalFrames&&(this.boy.touchEnabled=!0,this.BOY_STATUS_DRINKING=!1,this.BOY_STATUS_DRINKING_OVER=!0),this.FLAG_DOG_STATUS===this.DOG_STATUS_THIRSTY&&this.THIRSTY_DOG_FEED&&this.dog.currentFrame===this.dog.totalFrames&&(this.dog.movieClipData=this.mcFactory.generateMovieClipData("dog_thirsty"),this.dog.x=1142.3,this.dog.y=770.2,this.dog.play(-1),this.THIRSTY_DOG_FEED=!1,this.THIRSTY_DOG_FEED_UNEAT=!0,this.dogArea.touchEnabled=!0),this.DOG_STATUS_DRINKING===this.FLAG_DOG_STATUS&&(this.COUNTER_DOG++,this.COUNTER_DOG>20&&(this.dog.movieClipData=this.mcFactory.generateMovieClipData("dog_hungry"),this.container.setChildIndex(this.dog,this.container.getChildIndex(this.pen)),this.dog.x=1166.3,this.dog.y=765.1,this.COUNTER_DOG=0,this.water.visible=!1,this.FLAG_DOG_STATUS=this.DOG_STATUS_HUNGRY)),this.FLAG_DOG_STATUS===this.DOG_STATUS_HAPPY&&(this.dog.movieClipData=this.mcFactory.generateMovieClipData("dog_callcow"),this.dog.mask=this.cowMask,this.dog.gotoAndPlay(-1),this.leftArrow.visible=!1,SoundManager.getInstance().playSound(SoundEnum.DOGSOUND_MP3),this.FLAG_DOG_STATUS=this.DOG_STATUS_CALL_COW,this.dog.mask=this.cowMask),this.FLAG_DOG_STATUS===this.DOG_STATUS_CALL_COW&&(this.dog.currentFrame===this.dog.totalFrames-40&&this.container.setChildIndex(this.dog,this.container.getChildIndex(this.house)),this.dog.currentFrame===this.dog.totalFrames)){this.FLAG_DOG_STATUS=this.DOG_STATUS_CLEAR,this.container.setChildIndex(this.dog,this.container.getChildIndex(this.pen)+1),this.removeAllEventListener(),this.dog.movieClipData=this.mcFactory.generateMovieClipData("dog_run"),this.dog.play(-1),this.container.addChild(this.cowMask),this.cow1.play(-1),this.cow1.visible=!0,this.cow1.mask=this.cowMask,this.container.addChild(this.cow1);var e=new egret.MovieClip(this.mcFactory.generateMovieClipData("sh_stand"));e.x=157.5,e.y=542.5,e.gotoAndStop(1),this.container.addChildAt(e,this.container.getChildIndex(this.dog)),this.boy.visible=!1,egret.Tween.get(this.dog).to({x:838.7,y:736.8+55.15},1500).call(function(){t.dog.mask=null}).to({x:284,y:627.5},1e3),egret.Tween.get(this.cow1).to({x:849.05,y:597.15+53.8},2800).call(function(){}).to({x:954.25-768.2,y:597.15+53.8},6400),egret.Tween.get(this.cow2).wait(2800).call(function(){t.cow1.mask=null,t.cow2.play(-1),t.cow2.visible=!0,t.cow2.mask=t.cowMask,t.container.addChild(t.cow2)}).to({x:849.05,y:597.15+53.8},2800).call(function(){t.cow2.mask=null}).to({x:954.25-768.2,y:597.15+53.8},6400),egret.Tween.get(this.cow3).wait(5600).call(function(){t.cow3.play(-1),t.cow3.visible=!0,t.cow3.mask=t.cowMask,t.container.addChild(t.cow3)}).to({x:849.05,y:597.15+53.8},2800).to({x:143.4,y:740.35,scaleX:-1}).call(function(){t.cowMask.alpha=0,egret.Tween.removeTweens(t.cow1),egret.Tween.removeTweens(t.cow2),t.cow1.movieClipData=t.mcFactory.generateMovieClipData("cow_eat"),t.cow1.x=397.4,t.cow1.y=697.45,t.cow2.movieClipData=t.mcFactory.generateMovieClipData("cow_eat"),t.cow2.x=471,t.cow2.y=780.35,t.cow3.mask=null,t.cow3.movieClipData=t.mcFactory.generateMovieClipData("cow_eat"),t.cow3.x=143.4,t.cow3.y=740.35,t.boy.visible=!1,e.movieClipData=t.mcFactory.generateMovieClipData("sh_clear"),t.leftArrowTouched(),t.dog.movieClipData=t.mcFactory.generateMovieClipData("dog_callcow"),t.dog.gotoAndStop(6),t.cow1.play(-1),t.cow2.play(-1),t.cow3.play(-1)}).wait(1500).call(function(){t.grassMc=new egret.MovieClip(t.mcFactory.generateMovieClipData("grass_chu")),t.grassMc.x=t.grasses.x,t.grassMc.y=t.grasses.y,t.grassMc.gotoAndPlay(1),t.grasses.visible=!1,t.container.addChildAt(t.grassMc,t.container.getChildIndex(t.grasses)),t.FLAG_GRASS_CLEAR=!0})}this.FLAG_BOY_EATING&&this.boy.currentFrame===this.boy.totalFrames&&(this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_bad"),this.boy.x=432,this.boy.y=942,this.boy.play(),this.FLAG_BOY_EATING=!1,this.FLAG_END_GAMEOVER=!0)},e.prototype._remove=function(){egret.Tween.removeAllTweens()},e.prototype.registItem=function(t){if(ItemController.getInstance().addItem(t))switch(t){case ItemEnum.ITEM_WEEDER:this.machine.visible=!1;break;case ItemEnum.ITEM_BREAD:this.food.visible=!1;break;case ItemEnum.ITEM_CUP:this.bottle.visible=!1}},e.prototype.useItem=function(t,e,i){var s=this;switch(t){case ItemEnum.ITEM_WEEDER:if(this.treeArea.hitTestPoint(e,i))return this.machineMc.visible=!0,SoundManager.getInstance().playSound(SoundEnum.KUSAKARIKISOUND_MP3),egret.Tween.get(this.machineMc).to({x:418.65},1300).call(function(){s.machineMc.visible=!1,s.machine.x=418.65,s.machine.y=495.35,s.machine.scaleX=101/144,s.machine.scaleY=112/155,s.machine.visible=!0}),this.machineMc.play(-1),this.grass1.visible=!1,this.grass2.visible=!1,this.grass3.visible=!1,this.treeArea.visible=!1,!0;if(this.grasses.hitTestPoint(e,i)){Util.singletonPush(this.cards,112),this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_move"),this.boy.x=338.95,this.boy.y=778.35+this.boy.height/2,this.boy.visible=!1,this.boy.visible=!0,this.boy.play(-1),this.grasses.setChildIndex(this.boy,this.grasses.numChildren-1);var h=new TSBitmap("blackcircle",this.sheet,!0);h.x=298.45,h.y=778.35,this.container.addChild(h);var a=new TSBitmap("mistery",this.sheet);return a.x=135.45,a.y=690.35,this.grasses.addChildAt(a,this.grasses.getChildIndex(this.boy)),a.mask=h,egret.Tween.get(h).to({scaleX:5,scaleY:5},3e3),egret.Tween.get(this.boy).to({x:251.45},1e3).to({x:178.75,y:653.75+this.boy.height/2,scaleX:-1}).to({x:366.25,y:654.35+this.boy.height/2},1e3).to({x:438.95,y:710.35+this.boy.height/2,scaleX:1}).to({x:351.45,y:778.35-68.3+this.boy.height/2},1e3).call(function(){s.machine.visible=!0,s.machine.x=286.55-96.6,s.machine.y=737.55,s.boy.movieClipData=s.mcFactory.generateMovieClipData("sh_stand"),s.boy.gotoAndStop(1);var t=new egret.MovieClip(s.mcFactory.generateMovieClipData("ufo"));t.x=286.55-384.75,t.y=138.55,t.gotoAndPlay(1),s.container.addChild(t),t.play(-1);var e=new TSBitmap("light",s.sheet,!0);e.x=286.55,e.y=500.65,e.visible=!1,s.container.addChild(e),SoundManager.getInstance().playSound(SoundEnum.UFOSOUND_1_MP3),egret.Tween.get(t).to({x:287.5,y:220.95},1e3).wait(700).call(function(){e.visible=!0}).wait(1500).call(function(){egret.Tween.get(s.boy).to({x:337.05,y:548.35+s.boy.height/2,scaleX:.75,scaleY:.75},1200).to({x:307.05,y:398.35+s.boy.height/2,scaleX:.58,scaleY:.58,alpha:0},1e3)}).wait(300).call(function(){egret.Tween.get(s.machine).to({x:230.45,y:548.35,scaleX:.75,scaleY:.75},1200).to({x:287.45,y:398.35,scaleX:.58,scaleY:.58,alpha:0},1e3)}).wait(3e3).call(function(){e.visible=!1}).to({x:286.55-384.75,y:138.55},1e3).call(function(){StageController.getInstance().gameOverStage(s.stageId,s.cards)})}),this.FLAG_UFO_COMMING=!0,!0}return!1;case ItemEnum.ITEM_BREAD:return this.boy.hitTestPoint(e,i)?(Util.singletonPush(this.cards,113),SoundManager.getInstance().playSound(SoundEnum.EATSOUND_MP3),this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_eat"),this.boy.play(),this.boy.x=438,this.boy.y=929,this.FLAG_BOY_EATING=!0,!0):this.dogArea.hitTestPoint(e,i)?(this.food.visible=!0,this.food.texture=this.sheet.getTexture("food2"),this.food.anchorOffsetX=0,this.food.anchorOffsetY=0,this.food.x=1093.25,this.food.y=785.7,this.food.touchEnabled=!0,this.FLAG_DOG_STATUS===this.DOG_STATUS_THIRSTY?(this.dog.movieClipData=this.mcFactory.generateMovieClipData("dog_eatover"),this.dog.x=1174.3,this.dog.y=771.2,this.dog.gotoAndPlay(1),this.THIRSTY_DOG_FEED=!0):this.FLAG_DOG_STATUS===this.DOG_STATUS_HUNGRY&&(this.dog.movieClipData=this.mcFactory.generateMovieClipData("dog_eat"),this.dog.x=1169.75,this.dog.y=770.2,this.dog.play(-1),this.leftArrow.visible=!1,this.rightArrow.visible=!1,this.FLAG_DOG_STATUS=this.DOG_STATUS_HAPPY),this.FLAG_FOOD_USED_TO_DOG=!0,!0):!1;case ItemEnum.ITEM_CUP:if(this.boy.hitTestPoint(e,i))return Util.singletonPush(this.cards,114),this.BOY_STATUS_DRINKING=!0,this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_drink"),this.boy.gotoAndPlay(1),!0;if(this.dogArea.hitTestPoint(e,i)){if(this.FLAG_FOOD_USED_TO_DOG)return!1;SoundManager.getInstance().playSound(SoundEnum.WATER8SOUND_MP3);var o=new TSBitmap("bottledao",this.sheet,!0);o.x=1056.25,o.y=745.6,o.rotation=-14,this.container.addChild(o);var n=new egret.Shape;n.graphics.beginFill(0,1),n.graphics.drawRect(1066.25,708.1,82.05,97.35),n.graphics.endFill();var r=new egret.MovieClip(this.mcFactory.generateMovieClipData("water"));return egret.Tween.get(o).to({rotation:0},300).call(function(){s.container.addChild(n),r.scaleX=-1,r.mask=n,r.x=1056.25+r.width,r.y=745.6+r.height/2,r.play(-1),s.container.addChild(r),s.water.visible=!0,s.dog.movieClipData=s.mcFactory.generateMovieClipData("dog_drink"),s.dog.x=1169.75,s.dog.y=770.2,s.container.setChildIndex(s.dog,s.container.getChildIndex(s.pen)+1),s.dog.play(-1),s.FLAG_DOG_STATUS=s.DOG_STATUS_DRINKING}).wait(600).to({rotation:-14},200).call(function(){r.visible=!1,o.visible=!1}),!0}return!1}return!1},e.prototype.getDisplayArea=function(){return new egret.Rectangle},e.prototype.ctrl_right=function(){},e.prototype.ctrl_left=function(){},e.prototype.ctrl_up=function(){},e.prototype.ctrl_down=function(){},e.prototype.ctrl_ok=function(){},e.prototype.ctrl_cancel=function(){},e}(egret.DisplayObjectContainer);__reflect(Stage25.prototype,"Stage25",["IFKaihiStage"]);var Stage26=function(t){function e(){var e=t.call(this)||this;return e.FLAG_DOOR1_OPENED=!1,e.FLAG_DOOR2_OPENED=!1,e.FLAG_LOCKER_OPEND=!1,e.water_bucket_list=[ItemEnum.ITEM_WATER_BUCKET,ItemEnum.ITEM_WATER_BUCKET_1,ItemEnum.ITEM_WATER_BUCKET_2],e.empty_bucket_list=[ItemEnum.ITEM_EMPTY_BUCKET,ItemEnum.ITEM_EMPTY_BUCKET_1],e.FLAG_BOYS_BUCKET=2,e.FLAG_BOYS_WATER_BUCKET=2,e.FLAG_BOYS_HEAD_BUCKET=!0,e.THIRD_BUCKET_GOT=!1,e.FLAG_KEY_GOT=!1,e.FLAG_TEACHER_PLAYING=!1,e.FLAG_TEACHER_DRAGING=!1,e.FLAG_FILLING=!1,e.FLAG_POURING=!1,e.FLAG_END_GAMEOVER=!1,e.FLAG_END_CLEAR=!1,e.COUNTER_END=0,e.cards=[],e._init(),e}return __extends(e,t),e.prototype._init=function(){return __awaiter(this,void 0,void 0,function(){var t,e,i,s,h,a;return __generator(this,function(o){switch(o.label){case 0:return UIManager.getInstance().showLoading(),[4,this._loadRes()];case 1:return o.sent(),this.mcFactory=new egret.MovieClipDataFactory(RES.getRes("stage26_action_json"),RES.getRes("stage26_action_png")),this.sheet=RES.getRes("stage26_texture"),this.container=new egret.Sprite,this.container.x=0,this.container.y=0,this.addChild(this.container),t=new TSBitmap("bg",this.sheet),t.x=-759,t.y=-100,this.container.addChild(t),this.locker=new egret.MovieClip(this.mcFactory.generateMovieClipData("guizi")),this.locker.x=298.65,this.locker.y=593.55,this.locker.touchEnabled=!0,this.container.addChild(this.locker),this.third_bucket=new TSBitmap("bucket",this.sheet,!0),this.third_bucket.x=288.65,this.third_bucket.y=-112.5+593.55,this.third_bucket.touchEnabled=!1,this.third_bucket.visible=!1,this.container.addChild(this.third_bucket),this.bucket_pouring=new egret.MovieClip(this.mcFactory.generateMovieClipData("pourwater")),this.bucket_pouring.x=-486.85,this.bucket_pouring.y=601.2,this.bucket_pouring.gotoAndStop(1),this.bucket_pouring.visible=!1,this.container.addChild(this.bucket_pouring),this.bucket_filling=new egret.MovieClip(this.mcFactory.generateMovieClipData("getwater")),this.bucket_filling.x=-465.45,this.bucket_filling.y=616.05,this.bucket_filling.gotoAndStop(1),this.bucket_filling.visible=!1,this.bucket_filling.touchEnabled=!0,this.container.addChild(this.bucket_filling),this.shuichi=new egret.MovieClip(this.mcFactory.generateMovieClipData("shuichi")),this.shuichi.x=-485.9,this.shuichi.y=675,this.shuichi.gotoAndStop(1),this.shuichi.touchEnabled=!0,this.container.addChild(this.shuichi),this.pipe=new egret.MovieClip(this.mcFactory.generateMovieClipData("pipe")),this.pipe.x=-448.35,this.pipe.y=719.95,this.pipe.gotoAndStop(1),this.pipe.visible=!1,this.pipe.touchEnabled=!0,this.container.addChild(this.pipe),this.door1=new TSBitmap("door1",this.sheet,!0),this.door1.x=-481.75,this.door1.y=583.05,this.door1.touchEnabled=!0,this.container.addChild(this.door1),this.shadow=new egret.MovieClip(this.mcFactory.generateMovieClipData("teacher_run")),this.shadow.x=753.8,this.shadow.y=610.45,this.shadow.gotoAndStop(1),this.shadow.visible=!1,this.container.addChild(this.shadow),this.teacher=new egret.MovieClip(this.mcFactory.generateMovieClipData("teacher_stand")),this.teacher.x=250.55,this.teacher.y=616,this.teacher.gotoAndStop(1),this.teacher.visible=!1,this.container.addChild(this.teacher),this.key=new TSBitmap("key1",this.sheet,!0),this.key.x=232.75,this.key.y=602.65,this.key.visible=!1,this.container.addChild(this.key),this.door2=new TSBitmap("door2",this.sheet,!0),this.door2.x=217.75,this.door2.y=583.8,this.door2.touchEnabled=!0,this.container.addChild(this.door2),e=new TSBitmap("wall",this.sheet),e.x=-760,e.y=-100,this.container.addChild(e),i=new TSBitmap("water1",this.sheet),i.x=342,i.y=838,this.container.addChild(i),s=new TSBitmap("water2",this.sheet),s.x=507,s.y=821,this.container.addChild(s),h=new TSBitmap("liroom",this.sheet),h.x=-365,h.y=359,this.container.addChild(h),a=new TSBitmap("classroom",this.sheet),a.x=336,a.y=359,this.container.addChild(a),this.boy=new egret.MovieClip(this.mcFactory.generateMovieClipData("sh_dou")),this.boy.x=412.1,this.boy.y=695.8,this.boy.play(-1),this.boy.touchEnabled=!0,this.container.addChild(this.boy),this.leftBucket=new egret.MovieClip(this.mcFactory.generateMovieClipData("bucket_left")),this.leftBucket.x=-63.4+412.1,this.leftBucket.y=31.05+695.8,this.leftBucket.gotoAndStop(2),this.leftBucket.touchEnabled=!0,this.container.addChild(this.leftBucket),this.rightBucket=new egret.MovieClip(this.mcFactory.generateMovieClipData("bucket_right")),this.rightBucket.x=73.3+412.1,this.rightBucket.y=41.4+695.8,this.rightBucket.gotoAndStop(2),this.rightBucket.touchEnabled=!0,this.container.addChild(this.rightBucket),this.headBucket=new egret.MovieClip(this.mcFactory.generateMovieClipData("bucket")),this.headBucket.x=405.05,this.headBucket.y=512.95,this.headBucket.touchEnabled=!0,this.headBucket.visible=!1,this.container.addChild(this.headBucket),this.midBucket=new egret.MovieClip(this.mcFactory.generateMovieClipData("bucket_mid")),this.midBucket.x=413.3,this.midBucket.y=749.3,this.midBucket.visible=!1,this.midBucket.touchEnabled=!0,this.container.addChild(this.midBucket),this.keyArea=new egret.Shape,this.keyArea.graphics.beginFill(0,0),this.keyArea.graphics.drawRect(225.55,591,50,50),this.keyArea.graphics.endFill(),this.keyArea.touchEnabled=!0,this.container.addChild(this.keyArea),this.leftArrow=new TSBitmap("arrow_png"),this.leftArrow.x=40,this.leftArrow.y=510,this.leftArrow.touchEnabled=!0,this.addChild(this.leftArrow),this.rightArrow=new TSBitmap("arrow_png"),this.rightArrow.scaleX=-1,this.rightArrow.x=600,this.rightArrow.y=510,this.rightArrow.touchEnabled=!0,this.rightArrow.visible=!1,this.addChild(this.rightArrow),this.addAllEventListener(),this.leftArrow.addEventListener(egret.TouchEvent.TOUCH_TAP,this.leftArrowTouched,this),this.rightArrow.addEventListener(egret.TouchEvent.TOUCH_TAP,this.rightArrowTouched,this),UIManager.getInstance().hideLoading(),[2]}})})},e.prototype.addAllEventListener=function(){this.door1.addEventListener(egret.TouchEvent.TOUCH_TAP,this.door1Touched,this),this.door2.addEventListener(egret.TouchEvent.TOUCH_TAP,this.door2Touched,this),this.locker.addEventListener(egret.TouchEvent.TOUCH_TAP,this.lockerTouched,this),this.midBucket.addEventListener(egret.TouchEvent.TOUCH_TAP,this.midTouched,this),this.leftBucket.addEventListener(egret.TouchEvent.TOUCH_TAP,this.leftTouched,this),this.rightBucket.addEventListener(egret.TouchEvent.TOUCH_TAP,this.rightTouched,this),this.third_bucket.addEventListener(egret.TouchEvent.TOUCH_TAP,this.thirdTouched,this),this.headBucket.addEventListener(egret.TouchEvent.TOUCH_TAP,this.headTouched,this),this.boy.addEventListener(egret.TouchEvent.TOUCH_TAP,this.boyTouched,this),this.keyArea.addEventListener(egret.TouchEvent.TOUCH_TAP,this.keyTouched,this),this.shuichi.addEventListener(egret.TouchEvent.TOUCH_TAP,this.shuichiTouched,this),this.pipe.addEventListener(egret.TouchEvent.TOUCH_TAP,this.pipeTouched,this),this.bucket_filling.addEventListener(egret.TouchEvent.TOUCH_TAP,this.fillingBucketTouched,this)},e.prototype.fillingBucketTouched=function(t){this.bucket_filling.visible=!1;for(var e=0;e<this.empty_bucket_list.length;e++)if(!ItemController.getInstance().hasItem(this.empty_bucket_list[e])){this.registItem(this.empty_bucket_list[e]);break}},e.prototype.pipeTouched=function(t){this.pipe.touchEnabled=!1,this.pipe.gotoAndStop(2)},e.prototype.shuichiTouched=function(t){this.pipe.visible=!0,this.shuichi.gotoAndStop(2),this.shuichi.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.shuichiTouched,this)},e.prototype.keyTouched=function(t){this.teacher.visible===!0&&this.registItem(ItemEnum.ITEM_KEY)},e.prototype.boyTouched=function(t){this.leftBucket.visible&&this.rightBucket.visible&&2===this.leftBucket.currentFrame&&2===this.rightBucket.currentFrame&&(Util.singletonPush(this.cards,116),this.leftBucket.visible=this.rightBucket.visible=!1,this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_bad1"),this.boy.play(),this.FLAG_END_GAMEOVER=!0)},e.prototype.teacherAction=function(){var t=this;this.FLAG_TEACHER_PLAYING||(this.FLAG_TEACHER_PLAYING=!0,this.shadow.visible=!0,this.shadow.play(-1),egret.Tween.get(this.shadow).to({x:753.8-426},1200).call(function(){egret.Tween.get(t.door2).to({x:27.75},400),t.shadow.visible=!1,t.shadow.gotoAndStop(1),t.shadow.x=753.8,t.teacher.visible=!0,t.FLAG_KEY_GOT?t.key.visible=!1:t.key.visible=!0,t.teacher.play(-1)}).wait(3e3).call(function(){if(t.leftBucket.visible&&t.rightBucket.visible){if(1===t.leftBucket.currentFrame&&1===t.rightBucket.currentFrame){t.teacher.movieClipData=t.mcFactory.generateMovieClipData("teacher_knock"),t.teacher.gotoAndPlay(1),t.boy.movieClipData=t.mcFactory.generateMovieClipData("sh_clear"),t.leftBucket.visible=!1,t.rightBucket.visible=!1;var e=new egret.MovieClip(t.mcFactory.generateMovieClipData("bucket"));e.gotoAndStop(1),e.x=363.05,e.y=792.5,t.container.addChild(e);var i=new egret.MovieClip(t.mcFactory.generateMovieClipData("bucket"));i.gotoAndStop(1),i.x=550.9,i.y=792.5,t.container.addChild(i),t.headBucket.visible=!1,t.midBucket.visible=!1,t.FLAG_END_CLEAR=!0}else t.leftArrow.visible=!0,egret.Tween.get(t.door2).to({x:217.75},400).call(function(){t.teacher.visible=!1,t.shadow.x=753.8,t.shadow.y=610.45,t.shadow.gotoAndStop(1),t.teacher.x=250.55,t.teacher.y=616,t.teacher.gotoAndStop(1),t.FLAG_KEY_GOT||(t.key.visible=!1),t.teacher.gotoAndStop(1)});t.FLAG_TEACHER_PLAYING=!1}else{t.teacher.visible=!1;var e=void 0;t.midBucket.visible&&(e=new egret.MovieClip(t.mcFactory.generateMovieClipData("bucket")),e.gotoAndStop(t.midBucket.currentFrame),e.x=363.05,e.y=792.5,t.container.addChildAt(e,t.container.getChildIndex(t.boy)),t.midBucket.visible=!1),t.headBucket.visible&&(e=new egret.MovieClip(t.mcFactory.generateMovieClipData("bucket")),e.gotoAndStop(t.headBucket.currentFrame),e.x=550.9,e.y=792.5,t.container.addChildAt(e,t.container.getChildIndex(t.boy)),t.headBucket.visible=!1),t.boy.movieClipData=t.mcFactory.generateMovieClipData("teacher_drag"),t.boy.x=319,t.boy.y=703,t.boy.play(-1),t.FLAG_TEACHER_DRAGING=!0;new TSBitmap("key2",t.sheet,!0);t.key.x=378.2,t.key.y=677.35,egret.Tween.get(t.boy).to({x:919},2e3).call(function(){t.FLAG_BOYS_BUCKET<2&&Util.singletonPush(t.cards,118),t.FLAG_END_GAMEOVER=!0}),egret.Tween.get(t.key).to({x:978.2},2e3)}}))},e.prototype.headTouched=function(t){var e=!1;e=1===this.headBucket.currentFrame?!0:!1;var i;if(e){for(i=0;i<this.empty_bucket_list.length;i++)if(!ItemController.getInstance().hasItem(this.empty_bucket_list[i])){this.registItem(this.empty_bucket_list[i]);break}}else for(i=0;i<this.water_bucket_list.length;i++)if(!ItemController.getInstance().hasItem(this.water_bucket_list[i])){this.registItem(this.water_bucket_list[i]),this.FLAG_BOYS_WATER_BUCKET--;break}this.headBucket.visible=!1,this.FLAG_BOYS_BUCKET--},e.prototype.thirdTouched=function(t){this.THIRD_BUCKET_GOT=!0,this.third_bucket.visible=!1,this.registItem(ItemEnum.ITEM_EMPTY_BUCKET)},e.prototype.midTouched=function(t){var e=!1;e=1===this.midBucket.currentFrame?!0:!1;var i;if(e){for(i=0;i<this.empty_bucket_list.length;i++)if(!ItemController.getInstance().hasItem(this.empty_bucket_list[i])){this.registItem(this.empty_bucket_list[i]);break}}else for(i=0;i<this.water_bucket_list.length;i++)if(!ItemController.getInstance().hasItem(this.water_bucket_list[i])){this.registItem(this.water_bucket_list[i]),this.FLAG_BOYS_WATER_BUCKET--;break}this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_free"),this.boy.gotoAndPlay(1),this.midBucket.visible=!1,this.FLAG_BOYS_BUCKET--},e.prototype.rightTouched=function(t){this.teacherAction(),this.leftArrow.visible=!1;var e=!1;e=1===this.rightBucket.currentFrame?!0:!1;var i;if(e){for(i=0;i<this.empty_bucket_list.length;i++)if(!ItemController.getInstance().hasItem(this.empty_bucket_list[i])){this.registItem(this.empty_bucket_list[i]);break}}else for(i=0;i<this.water_bucket_list.length;i++)if(!ItemController.getInstance().hasItem(this.water_bucket_list[i])){this.registItem(this.water_bucket_list[i]),this.FLAG_BOYS_WATER_BUCKET--;break}this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_onebucket"),this.midBucket.gotoAndStop(this.leftBucket.currentFrame),this.midBucket.visible=!0,this.leftBucket.visible=!1,this.rightBucket.visible=!1,this.FLAG_BOYS_BUCKET--},e.prototype.leftTouched=function(t){this.teacherAction(),this.leftArrow.visible=!1;var e=!1;e=1===this.leftBucket.currentFrame?!0:!1;var i;if(e){for(i=0;i<this.empty_bucket_list.length;i++)if(!ItemController.getInstance().hasItem(this.empty_bucket_list[i])){this.registItem(this.empty_bucket_list[i]);break}}else for(i=0;i<this.water_bucket_list.length;i++)if(!ItemController.getInstance().hasItem(this.water_bucket_list[i])){this.registItem(this.water_bucket_list[i]),this.FLAG_BOYS_WATER_BUCKET--;break}this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_onebucket"),this.midBucket.gotoAndStop(this.rightBucket.currentFrame),this.midBucket.visible=!0,this.leftBucket.visible=!1,this.rightBucket.visible=!1,this.FLAG_BOYS_BUCKET--},e.prototype.door1Touched=function(t){this.FLAG_DOOR1_OPENED||egret.Tween.get(this.door1).to({x:-481.75,y:588.05},100).to({x:-478.75,y:580.05},100).to({x:-485.75,y:584.05},100).to({x:-479.75,y:582.05},100).to({x:-484.75,y:585.05},100).to({x:-477.75,y:579.05},100).to({x:-482.75,y:587.05},100).to({x:-481.75,y:583.05},100)},e.prototype.lockerTouched=function(t){this.FLAG_DOOR2_OPENED&&(this.FLAG_LOCKER_OPEND?(this.FLAG_LOCKER_OPEND=!1,this.third_bucket.visible=!1,this.third_bucket.touchEnabled=!1,this.locker.gotoAndStop(1)):(this.FLAG_LOCKER_OPEND=!0,this.THIRD_BUCKET_GOT||(this.third_bucket.visible=!0,this.third_bucket.touchEnabled=!0),this.locker.gotoAndStop(2)))},e.prototype.door2Touched=function(t){this.FLAG_DOOR2_OPENED?(this.FLAG_DOOR2_OPENED=!1,egret.Tween.get(this.door2).to({x:217.75},400)):(this.FLAG_DOOR2_OPENED=!0,egret.Tween.get(this.door2).to({x:27.75},400))},e.prototype.rightArrowTouched=function(t){this.rightArrow.visible=!1,this.leftArrow.visible=!0,egret.Tween.get(this.container).to({x:0},500)},e.prototype.leftArrowTouched=function(t){this.leftArrow.visible=!1,this.rightArrow.visible=!0,egret.Tween.get(this.container).to({x:640},500)},e.prototype._loadRes=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,StageController.getInstance().loadStage(26)];case 1:return e.sent(),[3,3];case 2:return t=e.sent(),console.error(t),[3,3];case 3:return[2]}})})},e.prototype._start=function(){},e.prototype.play_loop=function(){if(this.FLAG_END_GAMEOVER||this.FLAG_END_CLEAR)return this.COUNTER_END++,void(this.COUNTER_END>60&&(this.FLAG_END_CLEAR&&(Util.singletonPush(this.cards,119),StageController.getInstance().clearStage(26,this.cards)),this.FLAG_END_GAMEOVER&&StageController.getInstance().gameOverStage(26,this.cards)));if(this.FLAG_FILLING&&this.bucket_filling.currentFrame===this.bucket_filling.totalFrames){this.bucket_filling.visible=!1,this.bucket_filling.gotoAndStop(1);for(var t=0;t<this.water_bucket_list.length;t++)if(!ItemController.getInstance().hasItem(this.water_bucket_list[t])){this.registItem(this.water_bucket_list[t]),this.FLAG_BOYS_WATER_BUCKET--;break}}if(this.FLAG_POURING&&this.bucket_pouring.currentFrame===this.bucket_pouring.totalFrames){this.bucket_pouring.visible=!1,this.bucket_pouring.gotoAndStop(1);for(var t=0;t<this.empty_bucket_list.length;t++)if(!ItemController.getInstance().hasItem(this.empty_bucket_list[t])){this.registItem(this.empty_bucket_list[t]);break}this.FLAG_POURING=!1}},e.prototype._remove=function(){egret.Tween.removeAllTweens()},e.prototype.registItem=function(t){ItemController.getInstance().addItem(t)&&t===ItemEnum.ITEM_KEY&&(this.key.visible=!1,this.FLAG_KEY_GOT=!0)},e.prototype.useItem=function(t,e,i){return this.FLAG_TEACHER_DRAGING?!1:t===ItemEnum.ITEM_KEY?this.door1.hitTestPoint(e,i)?(egret.Tween.get(this.door1).to({x:this.door1.x+210},500),this.door1.touchEnabled=!1,this.FLAG_DOOR1_OPENED=!0,!0):!1:-1!==this.empty_bucket_list.indexOf(t)?this.boy.hitTestPoint(e,i)?(this.FLAG_BOYS_BUCKET++,this.headBucket.visible===!1?1===this.FLAG_BOYS_BUCKET?(this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_onebucket"),this.midBucket.visible=!0,this.midBucket.gotoAndStop(1),this.boy.gotoAndPlay(1)):2===this.FLAG_BOYS_BUCKET?(this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_dou"),this.boy.gotoAndPlay(1),this.leftBucket.visible=!0,this.leftBucket.gotoAndStop(this.midBucket.currentFrame),this.rightBucket.visible=!0,this.rightBucket.gotoAndStop(1),this.midBucket.visible=!1):3===this.FLAG_BOYS_BUCKET&&(this.headBucket.visible=!0,this.headBucket.gotoAndStop(1)):2===this.FLAG_BOYS_BUCKET?(this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_onebucket"),this.midBucket.visible=!0,this.midBucket.gotoAndStop(2),this.boy.gotoAndPlay(1)):(this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_dou"),this.boy.gotoAndPlay(1),this.leftBucket.visible=!0,this.leftBucket.gotoAndStop(this.midBucket.currentFrame),this.rightBucket.visible=!0,this.rightBucket.gotoAndStop(1),this.midBucket.visible=!1),!0):this.shuichi.hitTestPoint(e,i)?(this.bucket_filling.visible=!0,2===this.pipe.currentFrame?(this.bucket_filling.movieClipData=this.mcFactory.generateMovieClipData("getwater"),this.bucket_filling.touchEnabled=!1,this.bucket_filling.gotoAndPlay(1),this.FLAG_FILLING=!0):(this.bucket_filling.movieClipData=this.mcFactory.generateMovieClipData("bucket"),this.bucket_filling.touchEnabled=!0,this.bucket_filling.gotoAndStop(1)),!0):!1:-1!==this.water_bucket_list.indexOf(t)?this.boy.hitTestPoint(e,i)?(this.FLAG_BOYS_BUCKET++,this.FLAG_BOYS_WATER_BUCKET++,this.headBucket.visible===!1?1===this.FLAG_BOYS_BUCKET?(this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_onebucket"),this.midBucket.visible=!0,this.midBucket.gotoAndStop(2),this.boy.gotoAndPlay(1)):2===this.FLAG_BOYS_BUCKET?(this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_dou"),this.boy.gotoAndPlay(1),this.leftBucket.visible=!0,this.leftBucket.gotoAndStop(this.midBucket.currentFrame),this.rightBucket.visible=!0,this.rightBucket.gotoAndStop(2),this.midBucket.visible=!1):3===this.FLAG_BOYS_BUCKET&&(this.headBucket.visible=!0,this.headBucket.gotoAndStop(2),this.leftBucket.visible&&this.rightBucket.visible&&2===this.leftBucket.currentFrame&&2===this.rightBucket.currentFrame&&(Util.singletonPush(this.cards,117),this.headBucket.visible=this.leftBucket.visible=this.rightBucket.visible=!1,this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_bad2"),this.boy.play(),this.FLAG_END_GAMEOVER=!0)):2===this.FLAG_BOYS_BUCKET?(this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_onebucket"),this.midBucket.visible=!0,this.midBucket.gotoAndStop(2),this.boy.gotoAndPlay(1)):(this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_dou"),this.boy.gotoAndPlay(1),this.leftBucket.visible=!0,this.leftBucket.gotoAndStop(this.midBucket.currentFrame),this.rightBucket.visible=!0,this.rightBucket.gotoAndStop(2),this.midBucket.visible=!1),!0):this.shuichi.hitTestPoint(e,i)&&this.FLAG_DOOR1_OPENED?(this.bucket_pouring.visible=!0,this.bucket_pouring.gotoAndPlay(1),this.FLAG_POURING=!0,!0):!1:!1
},e.prototype.getDisplayArea=function(){return new egret.Rectangle},e.prototype.ctrl_right=function(){},e.prototype.ctrl_left=function(){},e.prototype.ctrl_up=function(){},e.prototype.ctrl_down=function(){},e.prototype.ctrl_ok=function(){},e.prototype.ctrl_cancel=function(){},e}(egret.DisplayObjectContainer);__reflect(Stage26.prototype,"Stage26",["IFKaihiStage"]);var Stage27=function(t){function e(){var e=t.call(this)||this;return e.stageID=27,e.FLAG_INITED=!1,e.FLAG_END_GAMEOVER=!1,e.FLAG_END_CLEAR=!1,e.FLAG_STICK_GOT=!1,e.FLAG_SPADE_GOT=!1,e.COUNTER_END=0,e.FLAG_ZOMBI_ACTION_END=0,e.FLAG_ZOMBI_HAKA=!1,e.HEROES_TURN=!1,e.boyX=3,e.boyY=0,e.boyFace=-1,e.zombiX=[0,1,6,6],e.zombiY=[6,0,0,6],e.zombiFace=[0,1,3,0],e.zombiList=[],e.handX=[7],e.handY=[6],e.handStick=[0],e.handList=[],e.spadeX=7,e.spadeY=7,e.stickX=0,e.stickY=0,e.kengX=[2,5,1],e.kengY=[1,3,5],e.kengList=[],e.gridWidth=81,e.stoneX=[1,4,5,6,7,0,1,2,3,6,2,4,7,4,4,5],e.stoneY=[1,1,1,1,1,3,3,3,3,3,5,5,5,6,7,7],e.newStoneList=[],e.cards=[],e._init(),e}return __extends(e,t),e.prototype._init=function(){return __awaiter(this,void 0,void 0,function(){var t,e,i,s,h,a;return __generator(this,function(o){switch(o.label){case 0:return UIManager.getInstance().showLoading(),[4,this._loadRes()];case 1:for(o.sent(),this.mcFactory=new egret.MovieClipDataFactory(RES.getRes("stage27_action_json"),RES.getRes("stage27_action_png")),this.sheet=RES.getRes("stage27_texture"),t=new TSBitmap("bg",this.sheet),t.x=-120,t.y=-100,this.addChild(t),e=new TSBitmap("cemetery",this.sheet),e.x=-120,e.y=248,this.addChild(e),i=new TSBitmap("grid",this.sheet),i.x=-5,i.y=266.5,this.addChild(i),s=new TSBitmap("wall",this.sheet),s.x=-120,s.y=163,this.addChild(s),this.container=new egret.Sprite,this.addChild(this.container),this.keng1=new TSBitmap("keng",this.sheet,!0),this.keng1.x=this.kengX[0]*this.gridWidth+38,this.keng1.y=this.kengY[0]*this.gridWidth+304.35,this.container.addChild(this.keng1),this.keng2=new TSBitmap("keng",this.sheet,!0),this.keng2.x=this.kengX[1]*this.gridWidth+38,this.keng2.y=this.kengY[1]*this.gridWidth+304.35,this.container.addChild(this.keng2),this.keng3=new TSBitmap("keng",this.sheet,!0),this.keng3.x=36+this.kengX[2]*this.gridWidth,this.keng3.y=this.kengY[2]*this.gridWidth+304.35,this.container.addChild(this.keng3),this.kengList=[this.keng1,this.keng2,this.keng3],this.zombi1=new egret.MovieClip(this.mcFactory.generateMovieClipData("zombi_up")),this.zombi1.x=36+this.zombiX[0]*this.gridWidth,this.zombi1.y=300+this.zombiY[0]*this.gridWidth-33,this.zombi1.play(-1),this.container.addChild(this.zombi1),this.zombi2=new egret.MovieClip(this.mcFactory.generateMovieClipData("zombi_right")),this.zombi2.x=36+this.zombiX[1]*this.gridWidth,this.zombi2.y=300+this.zombiY[1]*this.gridWidth-33,this.zombi2.play(-1),this.container.addChild(this.zombi2),this.zombi3=new egret.MovieClip(this.mcFactory.generateMovieClipData("zombi_left")),this.zombi3.x=36+this.zombiX[2]*this.gridWidth,this.zombi3.y=300+this.zombiY[2]*this.gridWidth-33,this.zombi3.play(-1),this.container.addChild(this.zombi3),this.zombi4=new egret.MovieClip(this.mcFactory.generateMovieClipData("zombi_up")),this.zombi4.x=36+this.zombiX[3]*this.gridWidth,this.zombi4.y=300+this.zombiY[3]*this.gridWidth-33,this.zombi4.play(-1),this.container.addChild(this.zombi4),this.zombiList=[this.zombi1,this.zombi2,this.zombi3,this.zombi4],this.hand1=new egret.MovieClip(this.mcFactory.generateMovieClipData("hand")),this.hand1.x=this.handX[0]*this.gridWidth+38,this.hand1.y=this.handY[0]*this.gridWidth+304.35,this.hand1.gotoAndStop(1),this.container.addChild(this.hand1),this.handList=[this.hand1],this.stick=new egret.MovieClip(this.mcFactory.generateMovieClipData("stick")),this.stick.x=38,this.stick.y=304.35,this.stick.gotoAndStop(1),this.container.addChild(this.stick),this.spade=new egret.MovieClip(this.mcFactory.generateMovieClipData("spade")),this.spade.x=this.spadeX*this.gridWidth+38,this.spade.y=this.spadeY*this.gridWidth+305,this.spade.gotoAndStop(1),this.container.addChild(this.spade),this.stoneList=[],a=0;a<this.stoneX.length;a++)h=this.newStone(this.stoneX[a],this.stoneY[a]),this.container.addChild(h);return this.leftArea=new egret.Shape,this.leftArea.graphics.beginFill(6697881),this.leftArea.graphics.drawRect(0,0,this.gridWidth,this.gridWidth),this.leftArea.graphics.endFill(),this.leftArea.touchEnabled=!0,this.container.addChild(this.leftArea),this.upArea=new egret.Shape,this.upArea.graphics.beginFill(6697881),this.upArea.graphics.drawRect(0,0,this.gridWidth,this.gridWidth),this.upArea.graphics.endFill(),this.upArea.touchEnabled=!0,this.upArea.visible=!1,this.container.addChild(this.upArea),this.rightArea=new egret.Shape,this.rightArea.graphics.beginFill(6697881),this.rightArea.graphics.drawRect(0,0,this.gridWidth,this.gridWidth),this.rightArea.graphics.endFill(),this.rightArea.touchEnabled=!0,this.container.addChild(this.rightArea),this.downArea=new egret.Shape,this.downArea.graphics.beginFill(6697881),this.downArea.graphics.drawRect(0,0,this.gridWidth,this.gridWidth),this.downArea.graphics.endFill(),this.downArea.touchEnabled=!0,this.container.addChild(this.downArea),this.boy=new egret.MovieClip(this.mcFactory.generateMovieClipData("sh_stop")),this.boy.x=this.boyX*this.gridWidth+36,this.boy.y=this.boyY*this.gridWidth+305,this.container.addChild(this.boy),this.leftArea.x=this.boy.x-3*this.gridWidth/2,this.leftArea.y=this.boy.y-this.gridWidth/2,this.rightArea.x=this.boy.x+this.gridWidth/2,this.rightArea.y=this.boy.y-this.gridWidth/2,this.upArea.x=this.boy.x-this.gridWidth/2,this.upArea.y=this.boy.y-this.gridWidth-this.gridWidth/2,this.downArea.x=this.boy.x-this.gridWidth/2,this.downArea.y=this.boy.y+this.gridWidth-this.gridWidth/2,this.areaAlpha=1,this.alphaChange=.1,this.FLAG_INITED=!0,this.HEROES_TURN=!0,this.setChildrenIndex(),this.addAllEventListener(),UIManager.getInstance().hideLoading(),[2]}})})},e.prototype.newKeng=function(t,e,i){void 0===i&&(i=!1);var s=new TSBitmap("keng",this.sheet,!0);return s.x=40+t*this.gridWidth,s.y=306+e*this.gridWidth,i&&(this.kengX.push(t),this.kengY.push(e)),this.kengList.push(s),s},e.prototype.newStone=function(t,e,i){void 0===i&&(i=!1);var s=new TSBitmap("stone",this.sheet,!0);return s.x=40+t*this.gridWidth,s.y=306+e*this.gridWidth,i&&(this.stoneX.push(t),this.stoneY.push(e)),this.stoneList.push(s),s},e.prototype.addAllEventListener=function(){this.leftArea.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onLeftTouched,this),this.rightArea.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onRightTouched,this),this.upArea.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onUpTouched,this),this.downArea.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onDownTouched,this)},e.prototype.removeAllEventListener=function(){this.leftArea.visible=!1,this.rightArea.visible=!1,this.upArea.visible=!1,this.downArea.visible=!1,this.leftArea.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onLeftTouched,this),this.rightArea.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onRightTouched,this),this.upArea.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onUpTouched,this),this.downArea.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onDownTouched,this)},e.prototype.onLeftTouched=function(t){var e=this;this.boyX--,this.removeAllEventListener(),3!==this.boyFace&&(this.boyFace=3,this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_left"),this.boy.y=this.boyY*this.gridWidth+300-33,this.boy.play(-1)),egret.Tween.get(this.boy).to({x:this.boyX*this.gridWidth+36},1e3).call(function(){e.update(3)})},e.prototype.onRightTouched=function(t){var e=this;this.boyX++,this.removeAllEventListener(),1!==this.boyFace&&(this.boyFace=1,this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_right"),this.boy.y=this.boyY*this.gridWidth+300-33,this.boy.play(-1)),egret.Tween.get(this.boy).to({x:this.boyX*this.gridWidth+36},1e3).call(function(){e.update(1)})},e.prototype.onUpTouched=function(t){var e=this;this.removeAllEventListener(),this.boyY--,0!==this.boyFace&&(this.boyFace=0,this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_up"),this.boy.play(-1)),egret.Tween.get(this.boy).to({y:this.boyY*this.gridWidth+300-33},1e3).call(function(){e.update(0)})},e.prototype.onDownTouched=function(t){var e=this;this.removeAllEventListener(),this.boyY++,2!==this.boyFace&&(this.boyFace=2,this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_down"),this.boy.play(-1)),egret.Tween.get(this.boy).to({y:this.boyY*this.gridWidth+300-33},1e3).call(function(){e.update(2)})},e.prototype.isHero=function(t,e,i){return t===this.boyX&&e===this.boyY?!0:!1},e.prototype.isZombiDiaoKeng=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:t=this.zombiList.length-1,e.label=1;case 1:return t>=0?[4,this.isDiaoKeng(this.zombiX[t],this.zombiY[t],!0)]:[3,4];case 2:e.sent()&&(this.zombiList[t].movieClipData=this.mcFactory.generateMovieClipData("zombi_haka"),this.zombiList[t].play(),this.diedZombie=this.zombiList[t],this.zombiList[t].y+=33,this.zombiList.splice(t,1),this.zombiX.splice(t,1),this.zombiY.splice(t,1),this.FLAG_ZOMBI_HAKA=!0,SoundManager.getInstance().playSound(SoundEnum.ZOMBIDEADSOUND_MP3)),e.label=3;case 3:return t--,[3,1];case 4:return[2]}})})},e.prototype.isDiaoKeng=function(t,e,i){for(var s=0;s<this.kengX.length;s++)if(t===this.kengX[s]&&e===this.kengY[s]){if(i){var h=this.newStone(this.kengX[s],this.kengY[s],!0);this.container.addChildAt(h,this.container.getChildIndex(this.kengList[s])),this.newStoneList.push(h),h.visible=!1}return this.container.removeChild(this.kengList[s]),this.kengList.splice(s,1),this.kengX.splice(s,1),this.kengY.splice(s,1),!0}return!1},e.prototype.update=function(t){return __awaiter(this,void 0,void 0,function(){var e,i,s,h;return __generator(this,function(a){switch(a.label){case 0:return SoundManager.getInstance().playSound(SoundEnum.ZOMBIMOVEFASTSOUND_MP3),this.isStick(this.boyX,this.boyY)&&this.registItem(ItemEnum.ITEM_STICK),this.isSpade(this.boyX,this.boyY)&&this.registItem(ItemEnum.ITEM_SPADE),this.handNearBy()?[2]:[3,1];case 1:return this.isDiaoKeng(this.boyX,this.boyY,!1)?(SoundManager.getInstance().playSound(SoundEnum.ZOMBIDIGGINGSOUND_MP3),this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_sh_haka"),this.boy.y+=33,this.boy.play(),this.FLAG_END_GAMEOVER=!0,[3,7]):[3,2];case 2:if(null===this.isZombi(this.boyX,this.boyY))return[3,3];switch(Util.singletonPush(this.cards,120),SoundManager.getInstance().playSound(SoundEnum.ZOMBIATTACKSOUND_MP3),e=this.isZombi(this.boyX,this.boyY),this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_bad"),this.boy.y+=33,this.boy.play(),t){case 0:e.movieClipData=this.mcFactory.generateMovieClipData("zombi_attack_down"),e.play();break;case 1:e.movieClipData=this.mcFactory.generateMovieClipData("zombi_attack_left"),e.play();break;case 2:e.movieClipData=this.mcFactory.generateMovieClipData("zombi_attack_up"),e.play();break;case 3:e.movieClipData=this.mcFactory.generateMovieClipData("zombi_attack_left"),e.scaleX=-1,e.play()}return this.FLAG_END_GAMEOVER=!0,[3,7];case 3:i=void 0,s=0,a.label=4;case 4:return s<this.zombiX.length?[4,this.zombiAction(this.zombiX[s],this.zombiY[s],this.zombiFace[s])]:[3,7];case 5:i=a.sent(),this.zombiFace[s]=i.direction,this.zombiChangeFace(this.zombiList[s],i.direction),h=void 0,0===i.direction?(this.zombiY[s]-=1,h=300+this.zombiY[s]*this.gridWidth-33):1===i.direction?(this.zombiX[s]+=1,h=36+this.zombiX[s]*this.gridWidth):2===i.direction?(this.zombiY[s]+=1,h=300+this.zombiY[s]*this.gridWidth-33):3===i.direction&&(this.zombiX[s]-=1,h=36+this.zombiX[s]*this.gridWidth),this.zombiMove(this.zombiList[s],h,i.direction,this.isHero(this.zombiX[s],this.zombiY[s],i.direction)),a.label=6;case 6:return s++,[3,4];case 7:return this.setChildrenIndex(),[2]}})})},e.prototype.setChildrenIndex=function(){for(var t=0,e=0;8>e;e++){var i=void 0;for(i=0;i<this.kengList.length;i++)this.kengY[i]===e&&(this.container.setChildIndex(this.kengList[i],t),t++);for(0===e&&(this.container.setChildIndex(this.stick,t),t++),i=0;i<this.zombiY.length;i++)this.zombiY[i]===e&&(this.container.setChildIndex(this.zombiList[i],t),t++);for(i=0;i<this.handY.length;i++)this.handY[i]===e&&(this.container.setChildIndex(this.handList[i],t),t++);for(i=0;i<this.stoneY.length;i++)this.stoneY[i]===e&&(this.container.setChildIndex(this.stoneList[i],t),t++);this.boyY===e&&(this.container.setChildIndex(this.boy,t),t++)}this.container.setChildIndex(this.upArea,this.container.getChildIndex(this.boy)),this.container.setChildIndex(this.downArea,this.container.numChildren),this.container.setChildIndex(this.leftArea,this.container.getChildIndex(this.boy)),this.container.setChildIndex(this.rightArea,this.container.getChildIndex(this.boy))},e.prototype.heroDie=function(){Util.singletonPush(this.cards,120),this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_bad"),this.boy.play(),this.boy.y+=33,this.FLAG_END_GAMEOVER=!0},e.prototype.zombiMove=function(t,e,i,s){var h=this;if(s)switch(i){case 0:t.movieClipData=this.mcFactory.generateMovieClipData("zombi_attack_up"),t.play(),this.heroDie();break;case 2:t.movieClipData=this.mcFactory.generateMovieClipData("zombi_attack_down"),t.play(),this.heroDie();break;case 1:t.movieClipData=this.mcFactory.generateMovieClipData("zombi_attack_left"),t.scaleX=-1,t.play(),this.heroDie();break;case 3:t.movieClipData=this.mcFactory.generateMovieClipData("zombi_attack_left"),t.play(),this.heroDie()}else switch(i){case 0:case 2:egret.Tween.get(t).to({y:e},1e3).call(function(){h.FLAG_ZOMBI_ACTION_END++});break;case 1:case 3:egret.Tween.get(t).to({x:e},1e3).call(function(){h.FLAG_ZOMBI_ACTION_END++})}},e.prototype.zombiChangeFace=function(t,e){switch(e){case 0:t.movieClipData=this.mcFactory.generateMovieClipData("zombi_up"),t.play(-1);break;case 1:t.movieClipData=this.mcFactory.generateMovieClipData("zombi_right"),t.play(-1);break;case 2:t.movieClipData=this.mcFactory.generateMovieClipData("zombi_down"),t.play(-1);break;case 3:t.movieClipData=this.mcFactory.generateMovieClipData("zombi_left"),t.play(-1);break;default:console.log("error zombi direction")}},e.prototype.directionXY=function(t){switch(t){case 0:return{x:0,y:-1};case 1:return{x:1,y:0};case 2:return{x:0,y:1};case 3:return{x:-1,y:0}}return{x:0,y:0}},e.prototype.canMove=function(t,e,i){void 0===i&&(i=-1);var s,h=t,a=e;return-1!==i&&(s=this.directionXY(i),h=t+s.x,a=e+s.y),!this.isStone(h,a)&&!this.isHand(h,a)&&null===this.isZombi(h,a)&&h>=0&&7>=h&&a>=0&&7>=a?!0:!1},e.prototype.getDirectionCanMove=function(t,e,i){void 0===i&&(i=[]);for(var s=[0,1,2,3],h=[],a=0;a<i.length;a++)h.push(i[a]);for(var o=0;o<s.length;o++)-1===h.indexOf(s[o])&&h.push(s[o]);for(var o=0;o<h.length;o++)if(this.canMove(t,e,h[o]))return h[o];return-1},e.prototype.zombiAction=function(t,e,i){var s={move:!0,direction:-1},h=t-this.boyX>0?!0:!1,a=e-this.boyY>0?!0:!1;return Math.abs(t-this.boyX)-Math.abs(e-this.boyY)>=0?h?this.canMove(t-1,e)?(s.move=!0,s.direction=3):3!==i&&this.canMove(t,e,i)?(s.move=!0,s.direction=i):(s.move=!0,s.direction=this.getDirectionCanMove(t,e,[h===!0?3:1,a===!0?0:2])):h||(this.canMove(t+1,e)?(s.move=!0,s.direction=1):1!==i&&this.canMove(t,e,i)?(s.move=!0,s.direction=i):(s.move=!0,s.direction=this.getDirectionCanMove(t,e,[h===!0?3:1,a===!0?0:2]))):a?this.canMove(t,e-1)?(s.move=!0,s.direction=0):0!==i&&this.canMove(t,e,i)?(s.move=!0,s.direction=i):(s.move=!0,s.direction=this.getDirectionCanMove(t,e,[h===!0?3:1,a===!0?0:2])):a||(this.canMove(t,e+1)?(s.move=!0,s.direction=2):2!==i&&this.canMove(t,e,i)?(s.move=!0,s.direction=i):(s.move=!0,s.direction=this.getDirectionCanMove(t,e,[h===!0?3:1,a===!0?0:2]))),s},e.prototype.handNearBy=function(){for(var t=0;t<this.handX.length;t++)if(1!==this.handStick[t]){if(this.boyX-this.handX[t]===0&&this.boyY-this.handY[t]===1)return this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_hand_up"),this.boy.play(-1),this.handList[t].visible=!1,this.FLAG_END_GAMEOVER=!0,!0;if(this.boyX-this.handX[t]===0&&this.boyY-this.handY[t]===-1)return this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_hand_down"),this.boy.play(-1),this.handList[t].visible=!1,this.FLAG_END_GAMEOVER=!0,!0;if(this.boyX-this.handX[t]===1&&this.boyY-this.handY[t]===0)return this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_hand_right"),this.boy.play(-1),this.handList[t].visible=!1,this.FLAG_END_GAMEOVER=!0,!0;if(this.boyX-this.handX[t]===-1&&this.boyY-this.handY[t]===0)return this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_hand_left"),this.boy.play(-1),this.handList[t].visible=!1,this.FLAG_END_GAMEOVER=!0,!0}return!1},e.prototype.isSpade=function(t,e){return this.FLAG_SPADE_GOT||t!==this.spadeX||e!==this.spadeY?!1:!0},e.prototype.isStick=function(t,e){return this.FLAG_STICK_GOT||t!==this.stickX||e!==this.stickY?!1:!0},e.prototype.isHand=function(t,e){for(var i=0;i<this.handX.length;i++)if(this.handX[i]===t&&this.handY[i]===e)return!0;return!1},e.prototype.isZombi=function(t,e){for(var i=0;i<this.zombiX.length;i++)if(this.zombiX[i]===t&&this.zombiY[i]===e)return this.zombiList[i];return null},e.prototype.isStone=function(t,e){for(var i=0;i<this.stoneX.length;i++)if(this.stoneX[i]===t&&this.stoneY[i]===e)return!0;return!1},e.prototype.setMoveArea=function(){this.leftArea.visible=!0,this.rightArea.visible=!0,this.upArea.visible=!0,this.downArea.visible=!0,this.addAllEventListener(),this.boyX-1<0&&(this.leftArea.visible=!1),this.boyX+1>7&&(this.rightArea.visible=!1),this.boyY-1<0&&(this.upArea.visible=!1),this.boyY+1>7&&(this.downArea.visible=!1);for(var t=0;t<this.stoneX.length;t++)this.stoneY[t]>=this.boyY-1&&this.stoneY[t]<=this.boyY+1&&this.stoneX[t]>=this.boyX-1&&this.stoneX[t]<=this.boyX+1&&Math.abs(this.stoneX[t]-this.boyX)+Math.abs(this.stoneY[t]-this.boyY)===1&&(1===Math.abs(this.stoneX[t]-this.boyX)?this.stoneX[t]>this.boyX?this.rightArea.visible=!1:this.leftArea.visible=!1:1===Math.abs(this.stoneY[t]-this.boyY)&&(this.stoneY[t]>this.boyY?this.downArea.visible=!1:this.upArea.visible=!1));for(var t=0;t<this.handList.length;t++)this.handX[t]>=this.boyX-1&&this.handX[t]<=this.boyX+1&&this.handY[t]>=this.boyY-1&&this.handY[t]<=this.boyY+1&&Math.abs(this.handX[t]-this.boyX)+Math.abs(this.handY[t]-this.boyY)===1&&(1===Math.abs(this.handX[t]-this.boyX)?this.handX[t]>this.boyX?this.rightArea.visible=!1:this.leftArea.visible=!1:1===Math.abs(this.handY[t]-this.boyY)&&(this.handY[t]>this.boyY?this.downArea.visible=!1:this.upArea.visible=!1));this.leftArea.x=this.boy.x-3*this.gridWidth/2,this.leftArea.y=this.boy.y,this.rightArea.x=this.boy.x+this.gridWidth/2,this.rightArea.y=this.boy.y,this.upArea.x=this.boy.x-this.gridWidth/2,this.upArea.y=this.boy.y-this.gridWidth,this.downArea.x=this.boy.x-this.gridWidth/2,this.downArea.y=this.boy.y+this.gridWidth},e.prototype._loadRes=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,StageController.getInstance().loadStage(this.stageID)];case 1:return e.sent(),[3,3];case 2:return t=e.sent(),console.error(t),[3,3];case 3:return[2]}})})},e.prototype._start=function(){},e.prototype.play_loop=function(){if(this.FLAG_END_GAMEOVER||this.FLAG_END_CLEAR)return this.FLAG_END_GAMEOVER&&(20===this.COUNTER_END&&SoundManager.getInstance().playSound(SoundEnum.ZOMBIGAMEOVERSOUND_MP3),this.COUNTER_END++,60===this.COUNTER_END&&StageController.getInstance().gameOverStage(this.stageID,this.cards)),void(this.FLAG_END_CLEAR&&(this.COUNTER_END++,20===this.COUNTER_END&&SoundManager.getInstance().playSound(SoundEnum.ZOMBICLEARSOUND_MP3),60===this.COUNTER_END&&StageController.getInstance().clearStage(this.stageID,this.cards)));if(this.FLAG_INITED){if(this.FLAG_ZOMBI_HAKA&&this.diedZombie.currentFrame===this.diedZombie.totalFrames){this.container.removeChild(this.diedZombie);for(var t=0;t<this.newStoneList.length;t++)this.newStoneList[t].visible===!1&&(this.newStoneList[t].visible=!0);this.FLAG_ZOMBI_HAKA=!1}this.FLAG_ZOMBI_ACTION_END>=this.zombiX.length&&(this.isZombiDiaoKeng(),0===this.zombiX.length?(this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_clear"),this.boy.play(),this.boy.y=this.boy.y+33,this.FLAG_END_CLEAR=!0):(this.setMoveArea(),this.FLAG_ZOMBI_ACTION_END=0,SoundManager.getInstance().playSound(SoundEnum.ZOMBIMOVEFASTSOUND_MP3),this.HEROES_TURN=!0)),this.areaAlpha+=this.alphaChange,this.areaAlpha>=.8?this.alphaChange=-.05:this.areaAlpha<=.4&&(this.alphaChange=.05),this.leftArea.alpha=this.rightArea.alpha=this.upArea.alpha=this.downArea.alpha=this.areaAlpha}},e.prototype._remove=function(){egret.Tween.removeAllTweens()},e.prototype.registItem=function(t){ItemController.getInstance().addItem(t)&&(t===ItemEnum.ITEM_STICK?(this.stick.visible=!1,this.FLAG_STICK_GOT=!0):ItemEnum.ITEM_SPADE&&(this.spade.visible=!1,this.FLAG_SPADE_GOT=!0))},e.prototype.useItem=function(t,e,i){if(t===ItemEnum.ITEM_STICK&&this.hand1.hitTestPoint(e,i))return this.handStick[0]=1,SoundManager.getInstance().playSound(SoundEnum.ZOMBIMARAKASUSOUND_MP3),this.hand1.movieClipData=this.mcFactory.generateMovieClipData("hand_stick"),this.hand1.play(-1),!0;if(t===ItemEnum.ITEM_SPADE){var s=Math.floor((e-Util.x_fix()/2-40)/this.gridWidth),h=Math.floor((i-Util.y_fix()/2-306)/this.gridWidth);if(this.canMove(s,h)||this.isZombi(s,h))return this.container.addChildAt(this.newKeng(s,h,!0),0),this.isDiaoKeng(this.boyX,this.boyY,!1)?(Util.singletonPush(this.cards,121),SoundManager.getInstance().playSound(SoundEnum.ZOMBIDIGGINGSOUND_MP3),this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_sh_haka"),this.boy.y+=33,this.boy.play(),this.FLAG_END_GAMEOVER=!0):this.isZombiDiaoKeng()&&(Util.singletonPush(this.cards,122),this.FLAG_END_CLEAR=!0),!0}return!1},e.prototype.getDisplayArea=function(){return new egret.Rectangle},e.prototype.ctrl_right=function(){},e.prototype.ctrl_left=function(){},e.prototype.ctrl_up=function(){},e.prototype.ctrl_down=function(){},e.prototype.ctrl_ok=function(){},e.prototype.ctrl_cancel=function(){},e}(egret.DisplayObjectContainer);__reflect(Stage27.prototype,"Stage27",["IFKaihiStage"]);var Stage28=function(t){function e(){var e=t.call(this)||this;return e.POSITION_LEFT=0,e.POSITION_MIDDLE=1,e.POSITION_RIGHT=2,e.FLAG_POSITION=e.POSITION_LEFT,e.BOY_Y=738.2,e.BOY_POSITION_LEFT=168.35,e.BOY_POSITION_MIDDLE=747.45,e.BOY_POSITION_RIGHT=1423.95,e.FLAG_INITED=!1,e.FLAG_BOY_LOOK_ONE=!1,e.FLAG_BOY_LOOK_TWO=!1,e.FLAG_TWO_PASSED=!1,e.FLAG_CHERRY_TO_PIC_ONE=!1,e.FLAG_CHERRY_APPEAR=!1,e.FLAG_BOY_LOOK_ONE_OVER=!1,e.FLAG_BOY_LOOK_TWO_OVER=!1,e.FLAG_BOY_LOOK_THREE_OVER=!1,e.FLAG_FORWARD_TO_TWO=!1,e.FLAG_FORWARD_TO_THREE=!1,e.FLAG_END_CLEAR=!1,e.FLAG_END_GAMEOVER=!1,e.COUNTER_END=0,e.FLAG_PLACE_TWO_FILLED=2,e.FLAG_PLACE_THREE_FILLED=3,e.FLAG_CAT_ACTION=!1,e.FLAG_OLD_SMILE=!1,e.FLAG_MOUSE_OK=!1,e.bitmaps=[],e.cards=[],e._init(),e}return __extends(e,t),e.prototype._init=function(){return __awaiter(this,void 0,void 0,function(){var t,e,i,s,h,a,o,n,r,l,c,d,_,g,p,u,y,E,T,b=this;return __generator(this,function(m){switch(m.label){case 0:return UIManager.getInstance().showLoading(),[4,this._loadRes()];case 1:return m.sent(),this.mcFactory=new egret.MovieClipDataFactory(RES.getRes("stage28_action_json"),RES.getRes("stage28_action_png")),this.sheet=RES.getRes("stage28_texture"),this.container=new egret.Sprite,this.container.x=0,this.container.y=0,this.addChild(this.container),this.bg=new TSBitmap("bg",this.sheet),this.bg.x=-120,this.bg.y=-100,this.container.addChild(this.bg),t=new TSBitmap("road",this.sheet),t.x=-120,t.y=829,this.container.addChild(t),e=new TSBitmap("picbg1",this.sheet,!0),e.x=379.85,e.y=517.4,this.container.addChild(e),this.pic1Sprite=new egret.Sprite,this.container.addChild(this.pic1Sprite),this.pic1=new TSBitmap("pic1",this.sheet,!0),this.pic1Sprite.addChild(this.pic1),i=new TSBitmap("kuang1",this.sheet,!0),this.pic1Sprite.addChild(i),this.pic1Sprite.x=379.85,this.pic1Sprite.y=517.4,this.pic1Sprite.touchEnabled=!0,this.pic2Place=new TSBitmap("picbg2",this.sheet,!0),this.pic2Place.x=797.1,this.pic2Place.y=543.9,this.container.addChild(this.pic2Place),this.pic3Place=new TSBitmap("picbg2",this.sheet,!0),this.pic3Place.x=1104.75,this.pic3Place.y=264.55,this.pic3Place.rotation=90,this.container.addChild(this.pic3Place),this.pic2Sprite=new egret.Sprite,this.container.addChild(this.pic2Sprite),s=new TSBitmap("pic2bg",this.sheet,!0),this.pic2Sprite.addChild(s),h=new TSBitmap("bei",this.sheet,!0),this.pic2Sprite.addChild(h),a=new TSBitmap("zhi",this.sheet,!0),this.pic2Sprite.addChild(a),o=new TSBitmap("guan",this.sheet,!0),this.pic2Sprite.addChild(o),this.cherryInPic3=new TSBitmap("berry",this.sheet,!0),this.cherryInPic3.x=31,this.cherryInPic3.y=-20,this.pic2Sprite.addChild(this.cherryInPic3),this.gai=new TSBitmap("gai",this.sheet,!0),this.pic2Sprite.addChild(this.gai),n=new TSBitmap("guan2",this.sheet,!0),this.pic2Sprite.addChild(n),r=new TSBitmap("kuang2",this.sheet,!0),this.pic2Sprite.addChild(r),this.pic2Sprite.rotation=90,this.pic2Sprite.x=797.1,this.pic2Sprite.y=543.9,this.pic3Sprite=new egret.Sprite,this.container.addChild(this.pic3Sprite),l=new TSBitmap("pic2bg",this.sheet,!0),this.pic3Sprite.addChild(l),this.cat=new egret.MovieClip(this.mcFactory.generateMovieClipData("cat_action")),this.cat.rotation=90,this.cat.gotoAndStop(1),this.pic3Sprite.addChild(this.cat),c=new TSBitmap("kuang2",this.sheet,!0),this.pic3Sprite.addChild(c),this.pic3Sprite.x=1104.75,this.pic3Sprite.y=264.55,this.woman=new TSBitmap("woman",this.sheet,!0),this.woman.x=1000.95,this.woman.y=567,this.container.addChild(this.woman),d=new TSBitmap("weilan2",this.sheet),d.x=208,d.y=688,this.container.addChild(d),_=new TSBitmap("weilan",this.sheet),_.x=714,_.y=688,this.container.addChild(_),this.oldHead=new egret.MovieClip(this.mcFactory.generateMovieClipData("old")),this.oldHead.x=1607.2,this.oldHead.y=534.3,this.oldHead.gotoAndStop(1),this.container.addChild(this.oldHead),g=new TSBitmap("stone",this.sheet),g.x=1555,g.y=661,this.container.addChild(g),this.circle1=new egret.Bitmap,this.circle1.texture=RES.getRes("circle_png"),this.circle1.anchorOffsetX=this.circle1.anchorOffsetY=200,this.circle1.blendMode=egret.BlendMode.ERASE,this.darkContainer=new egret.Sprite,p=new egret.Shape,p.graphics.beginFill(1120802),p.graphics.drawRect(0,0,1920,1320),p.graphics.endFill(),this.darkContainer.y=-100,this.darkContainer.addChild(p),this.container.addChild(this.darkContainer),this.dark=new TSBitmap("dark",this.sheet),this.dark.x=184,this.dark.y=-120,this.container.addChild(this.dark),this.dark1=new egret.Bitmap,this.dark1.texture=RES.getRes("square_png"),this.dark1.y=-100,this.container.addChild(this.dark1),this.cherry=new TSBitmap("berry",this.sheet,!0),this.cherry.x=1104.75,this.cherry.y=264.55,this.cherry.visible=!1,this.container.addChild(this.cherry),this.boy=new egret.MovieClip(this.mcFactory.generateMovieClipData("sh_walk")),this.boy.x=-148,this.boy.y=this.BOY_Y,this.container.addChild(this.boy),this.handLight=new egret.Sprite,this.addChild(this.handLight),this.handLight.visible=!1,u=new TSBitmap("handlight",this.sheet),u.x=-18,u.y=-13,this.handLight.addChild(u),y=new TSBitmap("handlighting",this.sheet),y.x=18,y.y=-66,this.handLight.addChild(y),E=new TSBitmap("exit",this.sheet,!0),E.x=1844.95,E.y=374.75,this.container.addChild(E),T=new TSBitmap("light",this.sheet),T.x=1700,T.y=196,this.container.addChild(T),this.startBtn=new TSBitmap("startBtn",this.sheet,!0),this.startBtn.x=320,this.startBtn.y=852,this.startBtn.touchEnabled=!0,this.startBtn.visible=!1,this.addChild(this.startBtn),this.leftArrow=new TSBitmap("arrow_png"),this.leftArrow.x=40,this.leftArrow.y=510,this.leftArrow.touchEnabled=!0,this.leftArrow.visible=!1,this.addChild(this.leftArrow),this.rightArrow=new TSBitmap("arrow_png"),this.rightArrow.scaleX=-1,this.rightArrow.x=600,this.rightArrow.y=510,this.rightArrow.touchEnabled=!0,this.addChild(this.rightArrow),this.dark1.mask=this.darkContainer,this.FLAG_INITED=!0,this.boy.play(-1),egret.Tween.get(this.boy).to({x:this.BOY_POSITION_LEFT},1500).call(function(){b.addAllEventListener(),b.startBtn.visible=!0,b.boy.movieClipData=b.mcFactory.generateMovieClipData("sh_look1"),b.boy.gotoAndStop(1)}),UIManager.getInstance().hideLoading(),[2]}})})},e.prototype.addDark1=function(){},e.prototype.addAllEventListener=function(){this.pic1Sprite.addEventListener(egret.TouchEvent.TOUCH_TAP,this.pic1Touched,this),this.pic2Place.addEventListener(egret.TouchEvent.TOUCH_TAP,this.pic2Touched,this),this.pic3Place.addEventListener(egret.TouchEvent.TOUCH_TAP,this.pic3Touched,this),this.pic2Sprite.addEventListener(egret.TouchEvent.TOUCH_TAP,this.bottleTouched,this),this.startBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onStart,this),this.cherry.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onCherryTouched,this),this.leftArrow.addEventListener(egret.TouchEvent.TOUCH_TAP,this.leftArrowTouched,this),this.rightArrow.addEventListener(egret.TouchEvent.TOUCH_TAP,this.rightArrowTouched,this)},e.prototype.removeAllEventListener=function(){this.pic1Sprite.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.pic1Touched,this),this.pic2Place.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.pic2Touched,this),this.pic3Place.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.pic3Touched,this),this.startBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onStart,this),this.cherry.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onCherryTouched,this),this.leftArrow.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.leftArrowTouched,this),this.rightArrow.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.rightArrowTouched,this),this.pic2Sprite.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.bottleTouched,this)},e.prototype.onCherryTouched=function(t){this.pic1Sprite.touchEnabled=!0,this.registItem(ItemEnum.ITEM_BERRY)},e.prototype.bottleTouched=function(t){var e=this;this.gai.rotation=45,this.gai.x=-30,this.pic3Mask=new egret.Shape,this.pic3Mask.graphics.beginFill(1120802),this.pic3Mask.graphics.drawRect(1031.75,171.55,186,146),this.pic3Mask.graphics.endFill(),this.container.addChild(this.pic3Mask),this.gai.mask=this.pic3Mask,this.cherryInPic3.visible=!1,this.cherry.visible=!0,this.pic3Mask2=new egret.Shape,this.pic3Mask2.graphics.beginFill(1120802),this.pic3Mask2.graphics.drawRect(1031.75,171.55,186,146),this.pic3Mask2.graphics.endFill(),this.container.addChild(this.pic3Mask2),this.cherry.mask=this.pic3Mask2,SoundManager.getInstance().playSound(SoundEnum.KOROGARISOUND_MP3),egret.Tween.get(this.cherry).to({x:984.75,y:334.55,rotation:360},1e3).call(function(){e.FLAG_CHERRY_TO_PIC_ONE=!0}),this.pic2Sprite.touchEnabled=!1},e.prototype.pic1Touched=function(t){var e=this;0===this.pic1Sprite.rotation?egret.Tween.get(this.pic1Sprite).to({rotation:180},500):egret.Tween.get(this.pic1Sprite).to({rotation:360},500).call(function(){e.pic1Sprite.rotation=0})},e.prototype.pic2Touched=function(t){2===this.FLAG_PLACE_TWO_FILLED?this.registItem(ItemEnum.ITEM_BERRY_BOTTLE):3===this.FLAG_PLACE_TWO_FILLED&&this.registItem(ItemEnum.ITEM_CAT_TURE),this.FLAG_PLACE_TWO_FILLED=0},e.prototype.pic3Touched=function(t){2===this.FLAG_PLACE_THREE_FILLED?this.registItem(ItemEnum.ITEM_BERRY_BOTTLE):3===this.FLAG_PLACE_THREE_FILLED&&this.registItem(ItemEnum.ITEM_CAT_TURE),this.FLAG_PLACE_THREE_FILLED=0},e.prototype.onStart=function(t){var e=this;this.removeAllEventListener(),this.startBtn.visible=!1,this.leftArrow.visible=!1,this.rightArrow.visible=!1,this.boy.x===this.BOY_POSITION_LEFT&&(this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_walk"),this.boy.play(-1),egret.Tween.get(this.boy).to({x:this.BOY_POSITION_LEFT+120},1230).call(function(){e.boy.movieClipData=e.mcFactory.generateMovieClipData("sh_look1"),e.boy.gotoAndPlay(1)}).wait(1e3).call(function(){e.circle1.x=379.85,e.circle1.y=617.4,e.darkContainer.addChild(e.circle1),0===e.pic1Sprite.rotation&&(e.pic1.texture=e.sheet.getTexture("pic1light"))
}).wait(1e3).call(function(){e.FLAG_BOY_LOOK_ONE=!0})),this.boy.x===this.BOY_POSITION_MIDDLE&&(this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_walk"),this.boy.play(-1),egret.Tween.get(this.boy).to({x:this.BOY_POSITION_MIDDLE+120},1230).call(function(){e.boy.movieClipData=e.mcFactory.generateMovieClipData("sh_look1"),e.boy.gotoAndPlay(1)}).wait(1e3).call(function(){if(e.circle1.x=960,e.circle1.y=517,e.darkContainer.addChild(e.circle1),e.FLAG_MOUSE_OK)egret.Tween.get(e.circle1).wait(500).to({x:1104.75,y:364.55},800).wait(1e3).call(function(){2!==e.FLAG_PLACE_THREE_FILLED&&(Util.singletonPush(e.cards,125),e.FLAG_BOY_LOOK_TWO=!0)}).to({x:797.1,y:643.9},2e3).wait(2e3).call(function(){e.FLAG_TWO_PASSED=!0,e.FLAG_BOY_LOOK_TWO=!0});else{Util.singletonPush(e.cards,124);var t=new TSBitmap("eyes",e.sheet,!0);t.x=906.5,t.y=470.75,t.alpha=1,t.visible=!1,e.container.addChild(t),SoundManager.getInstance().playSound(SoundEnum.HORRORSOUND_MP3),egret.Tween.get(t).wait(200).call(function(){t.visible=!0}).to({alpha:0},0).to({alpha:1},800).call(function(){t.visible=!1}).wait(500).call(function(){e.FLAG_BOY_LOOK_TWO=!0})}})),this.boy.x===this.BOY_POSITION_RIGHT&&(this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_walk"),this.boy.play(-1),egret.Tween.get(this.boy).to({x:this.BOY_POSITION_RIGHT+120},1230).call(function(){e.boy.movieClipData=e.mcFactory.generateMovieClipData("sh_look1"),e.boy.gotoAndPlay(1)}).wait(1e3).call(function(){e.circle1.x=1607.2,e.circle1.y=643,e.darkContainer.addChild(e.circle1),egret.Tween.get(e.boy).wait(500).to({x:e.boy.x-12,y:e.BOY_Y-90},1e3).wait(500).call(function(){e.FLAG_OLD_SMILE?(e.boy.movieClipData=e.mcFactory.generateMovieClipData("hand_ok"),e.boy.play(-1)):(SoundManager.getInstance().playSound(SoundEnum.HORRORSOUND_MP3),e.boy.movieClipData=e.mcFactory.generateMovieClipData("hand_bad"),e.boy.play(-1),e.handLight.visible=!0,e.handLight.x=e.boy.x+30.95,e.handLight.y=e.boy.y-34.75,egret.Tween.get(e.handLight).to({y:e.boy.y-34.75+175},1250,egret.Ease.bounceInOut),Util.singletonPush(e.cards,126),e.FLAG_END_GAMEOVER=!0)}).wait(500).call(function(){e.FLAG_OLD_SMILE&&(e.boy.movieClipData=e.mcFactory.generateMovieClipData("sh_ok3"),e.boy.x=e.BOY_POSITION_RIGHT+120,e.boy.y=e.BOY_Y,e.boy.play(-1))}).wait(500).call(function(){e.FLAG_OLD_SMILE&&(e.boy.movieClipData=e.mcFactory.generateMovieClipData("sh_walk"),e.boy.play(-1),egret.Tween.get(e.boy).to({x:2109},500),Util.singletonPush(e.cards,127),e.FLAG_END_CLEAR=!0)}),egret.Tween.get(e.circle1).wait(500).to({scaleX:.8,scaleY:.8},1e3)}))},e.prototype.rightArrowTouched=function(t){void 0===t&&(t=null),this.FLAG_POSITION===this.POSITION_LEFT?(this.leftArrow.visible=!0,this.FLAG_POSITION=this.POSITION_MIDDLE,egret.Tween.get(this.container).to({x:-640},500)):this.FLAG_POSITION===this.POSITION_MIDDLE&&(this.rightArrow.visible=!1,this.FLAG_POSITION=this.POSITION_RIGHT,egret.Tween.get(this.container).to({x:-1280},500))},e.prototype.leftArrowTouched=function(t){void 0===t&&(t=null),this.FLAG_POSITION===this.POSITION_MIDDLE?(this.leftArrow.visible=!1,this.FLAG_POSITION=this.POSITION_LEFT,egret.Tween.get(this.container).to({x:0},500)):this.FLAG_POSITION===this.POSITION_RIGHT&&(this.rightArrow.visible=!0,this.FLAG_POSITION=this.POSITION_MIDDLE,egret.Tween.get(this.container).to({x:-640},500))},e.prototype._loadRes=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,StageController.getInstance().loadStage(28)];case 1:return e.sent(),[3,3];case 2:return t=e.sent(),console.error(t),[3,3];case 3:return[2]}})})},e.prototype._start=function(){},e.prototype.play_loop=function(){var t=this;if(this.FLAG_END_GAMEOVER||this.FLAG_END_CLEAR)return this.COUNTER_END++,1===this.COUNTER_END&&this.FLAG_END_GAMEOVER&&SoundManager.getInstance().playSound(SoundEnum.HORRORSOUND_MP3),void(60===this.COUNTER_END&&(this.FLAG_END_CLEAR&&StageController.getInstance().clearStage(28,this.cards),this.FLAG_END_GAMEOVER&&StageController.getInstance().gameOverStage(28,this.cards)));if(this.FLAG_INITED&&(this.dark.x=this.boy.x+100),this.FLAG_CHERRY_TO_PIC_ONE&&!this.FLAG_CHERRY_APPEAR&&0===this.pic1Sprite.rotation&&(this.FLAG_CHERRY_APPEAR=!0,this.pic1Sprite.touchEnabled=!1,this.cherry.touchEnabled=!0,this.cherry.x=504.85,this.cherry.y=504.4,this.cherry.visible=!0,this.pic1Mask=new egret.Shape,this.pic1Mask.graphics.beginFill(1120802),this.pic1Mask.graphics.drawRect(258.85,421.9,242,191),this.pic1Mask.graphics.endFill(),this.container.addChild(this.pic1Mask),this.cherry.mask=this.pic1Mask,SoundManager.getInstance().playSound(SoundEnum.KOROGARI2SOUND_MP3),egret.Tween.get(this.cherry).to({x:377.85,y:565.4,rotation:720},1e3)),this.FLAG_BOY_LOOK_ONE&&(this.FLAG_BOY_LOOK_ONE=!1,this.darkContainer.removeChild(this.circle1),0===this.pic1Sprite.rotation&&(this.pic1.texture=this.sheet.getTexture("pic1"),this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_bad1"),this.boy.gotoAndPlay(1),this.handLight.visible=!0,this.handLight.x=this.boy.x+30.95,this.handLight.y=this.boy.y-34.75,egret.Tween.get(this.handLight).to({rotation:360},1e3),egret.Tween.get(this.handLight).to({x:this.boy.x+30.95+95},1e3,egret.Ease.bounceIn).to({x:this.boy.x+30.95+205},250),egret.Tween.get(this.handLight).to({y:this.boy.y-34.75-25},150).to({y:this.boy.y-34.75+175},1100,egret.Ease.bounceInOut),SoundManager.getInstance().playSound(SoundEnum.HORRORSOUND_MP3),this.FLAG_END_GAMEOVER=!0,Util.singletonPush(this.cards,123)),180===this.pic1Sprite.rotation&&(this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_ok1"),this.boy.gotoAndPlay(1),this.FLAG_FORWARD_TO_TWO=!0)),this.FLAG_FORWARD_TO_TWO&&this.boy.currentFrame===this.boy.totalFrames&&(this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_walk"),this.boy.play(-1),egret.Tween.get(this.boy).to({x:640},2e3).call(function(){t.rightArrowTouched()}).to({x:this.BOY_POSITION_MIDDLE},1e3).call(function(){t.boy.movieClipData=t.mcFactory.generateMovieClipData("sh_look1"),t.boy.gotoAndStop(1),t.startBtn.visible=!0,t.leftArrow.visible=!0,t.rightArrow.visible=!0,t.pic2Place.touchEnabled=!0,t.pic3Place.touchEnabled=!0,t.addAllEventListener()}),this.FLAG_FORWARD_TO_TWO=!1),this.FLAG_CAT_ACTION&&this.cat.currentFrame===this.cat.totalFrames){this.FLAG_CAT_ACTION=!1;var e=new egret.MovieClip(this.mcFactory.generateMovieClipData("mouse_run"));e.x=909,e.y=469.2,e.gotoAndStop(1),this.container.addChild(e),egret.Tween.get(e).to({x:1109,y:819.2},1e3).call(function(){e.play(-1)}).to({x:2109,y:819.2},2e3),this.FLAG_MOUSE_OK=!0,this.addAllEventListener()}this.FLAG_BOY_LOOK_TWO&&this.boy.currentFrame===this.boy.totalFrames&&(this.FLAG_BOY_LOOK_TWO=!1,this.darkContainer.removeChild(this.circle1),this.FLAG_TWO_PASSED?(this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_ok2"),this.boy.gotoAndPlay(1),this.FLAG_FORWARD_TO_THREE=!0):(SoundManager.getInstance().playSound(SoundEnum.HORRORSOUND_MP3),this.pic1.texture=this.sheet.getTexture("pic1"),this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_bad1"),this.boy.gotoAndPlay(1),this.handLight.visible=!0,this.handLight.x=this.boy.x+30.95,this.handLight.y=this.boy.y-34.75,egret.Tween.get(this.handLight).to({rotation:360},1e3),egret.Tween.get(this.handLight).to({x:this.boy.x+30.95+95},1e3,egret.Ease.bounceIn).to({x:this.boy.x+30.95+205},250),egret.Tween.get(this.handLight).to({y:this.boy.y-34.75-25},150).to({y:this.boy.y-34.75+175},1100,egret.Ease.bounceInOut),this.FLAG_END_GAMEOVER=!0)),this.FLAG_FORWARD_TO_THREE&&this.boy.currentFrame===this.boy.totalFrames&&(this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_walk"),this.boy.play(-1),egret.Tween.get(this.boy).to({x:1280},2e3).call(function(){t.rightArrowTouched()}).to({x:this.BOY_POSITION_RIGHT},1e3).call(function(){t.boy.movieClipData=t.mcFactory.generateMovieClipData("sh_look1"),t.boy.gotoAndStop(1),t.startBtn.visible=!0,t.leftArrow.visible=!0,t.addAllEventListener()}),this.FLAG_FORWARD_TO_THREE=!1)},e.prototype._remove=function(){egret.Tween.removeAllTweens()},e.prototype.registItem=function(t){if(ItemController.getInstance().addItem(t))switch(t){case ItemEnum.ITEM_CAT_TURE:this.pic3Sprite.visible=!1;break;case ItemEnum.ITEM_BERRY_BOTTLE:this.pic2Sprite.visible=!1;break;case ItemEnum.ITEM_BERRY:this.cherry.visible=!1}},e.prototype.useItem=function(t,e,i){var s=this;if(t===ItemEnum.ITEM_CAT_TURE){if(this.pic2Place.hitTestPoint(e,i)&&0===this.FLAG_PLACE_TWO_FILLED){this.pic3Sprite.x=797.1,this.pic3Sprite.y=543.9,this.pic3Sprite.rotation=-90,this.pic3Sprite.visible=!0,this.FLAG_PLACE_TWO_FILLED=3,this.pic2Place.touchEnabled=!1,this.cat.gotoAndPlay(1),this.removeAllEventListener();var h=new TSBitmap("eyes",this.sheet,!0);return h.x=906.5,h.y=470.75,h.alpha=1,h.visible=!1,this.container.addChild(h),egret.Tween.get(h).wait(200).call(function(){h.visible=!0}).to({alpha:0},100).to({alpha:1},800).call(function(){h.visible=!1}).wait(500).call(function(){s.FLAG_CAT_ACTION=!0}),!0}return this.pic3Place.hitTestPoint(e,i)&&0===this.FLAG_PLACE_THREE_FILLED?(this.pic3Sprite.x=1104.75,this.pic3Sprite.y=264.55,this.pic3Sprite.rotation=0,this.pic3Sprite.visible=!0,this.FLAG_PLACE_THREE_FILLED=3,!0):!1}return t===ItemEnum.ITEM_BERRY_BOTTLE?this.pic2Place.hitTestPoint(e,i)&&0===this.FLAG_PLACE_TWO_FILLED?(this.pic2Sprite.x=797.1,this.pic2Sprite.y=543.9,this.pic2Sprite.rotation=90,this.pic2Sprite.visible=!0,this.FLAG_PLACE_TWO_FILLED=2,!0):this.pic3Place.hitTestPoint(e,i)&&0===this.FLAG_PLACE_THREE_FILLED?(this.pic2Sprite.x=1104.75,this.pic2Sprite.y=264.55,this.pic2Sprite.rotation=0,this.pic2Sprite.visible=!0,this.FLAG_PLACE_THREE_FILLED=2,this.pic3Place.touchEnabled=!1,egret.Tween.get(this.cherryInPic3).to({x:1,y:-11},800).call(function(){s.pic2Sprite.touchEnabled=!0}),!0):!1:t===ItemEnum.ITEM_BERRY&&this.oldHead.hitTestPoint(e,i)?(this.cherry.visible=!0,this.cherry.x=1607.2,this.cherry.y=534.3,this.oldHead.movieClipData=this.mcFactory.generateMovieClipData("old_tanqi"),this.oldHead.gotoAndPlay(1),this.FLAG_OLD_SMILE=!0,!0):!1},e.prototype.getDisplayArea=function(){return new egret.Rectangle},e.prototype.ctrl_right=function(){},e.prototype.ctrl_left=function(){},e.prototype.ctrl_up=function(){},e.prototype.ctrl_down=function(){},e.prototype.ctrl_ok=function(){},e.prototype.ctrl_cancel=function(){},e}(egret.DisplayObjectContainer);__reflect(Stage28.prototype,"Stage28",["IFKaihiStage"]);var Stage29=function(t){function e(){var e=t.call(this)||this;return e.stageid=29,e.FLAG_END_GAMEOVER=!1,e.FLAG_END_CLEAR=!1,e.COUNTER_END=0,e.POSITION_LEFT=0,e.POSITION_MIDDLE=1,e.POSITION_RIGHT=2,e.BOY_Y=618.25,e.BOY_POSITION_LEFT=302.8,e.BOY_POSITION_MIDDLE=942.8,e.BOY_POSITION_RIGHT=1382.8,e.BOY_POSITION_LIST=[302.8,942.8,1382.8],e.BOY_ITEM_GOT=0,e.BOY_POP_FRAME=[4,1,2,3,5],e.BOY_NEED_LIST=[ItemEnum.ITEM_GARLIC,ItemEnum.ITEM_TOMATO,ItemEnum.ITEM_FISH_FILLET,ItemEnum.ITEM_YELLOW_EGGS],e.FLAG_BOY_CURRENT_NEED=e.BOY_NEED_LIST[e.BOY_ITEM_GOT],e.FLAG_POSITION=e.POSITION_LEFT,e.FLAG_WOMEN_COMING=!1,e.FLAG_WOMEN_BILLING=!1,e.FLAG_WOMEN_BILLED=!1,e.FLAG_BOY_LUAN_MO=!1,e.FLAG_COIN_DROPPING=!1,e.FLAG_BOY_TASTING=!1,e.FLAG_OTOTO_TOKEN=!1,e.FLAG_OTOTO_CARTING=!1,e.FLAG_SPLASH_TOCLEAR=!1,e.FLAG_OTT_THROWING=!1,e.FLAG_EGG_SOLD=!1,e.FLAG_DRAG_NIQIU=!1,e.FLAG_GIVE_MONEY=!1,e.FLAG_TASTE_GOT=!1,e.eggItemList=[ItemEnum.ITEM_WHITE_EGGS,ItemEnum.ITEM_WHITE_EGGS_1,ItemEnum.ITEM_WHITE_EGGS_2,ItemEnum.ITEM_WHITE_EGGS_3],e.cards=[],e._init(),e}return __extends(e,t),e.prototype._init=function(){return __awaiter(this,void 0,void 0,function(){var t,e,i,s,h,a,o,n,r,l,c,d,_,g,p,u,y,E,T,b,m,A,v,S,C;return __generator(this,function(I){switch(I.label){case 0:return UIManager.getInstance().showLoading(),[4,this._loadRes()];case 1:for(I.sent(),this.itemsJson=new Object,this.mcFactory=new egret.MovieClipDataFactory(RES.getRes("stage29_action_json"),RES.getRes("stage29_action_png")),this.womenFactory=new egret.MovieClipDataFactory(RES.getRes("stage29_women_action_json"),RES.getRes("stage29_women_action_png")),this.sheet=RES.getRes("stage29_texture"),this.container=new egret.Sprite,this.container.x=0,this.container.y=0,this.addChild(this.container),t=new TSBitmap("bg",this.sheet),t.x=-120,t.y=-100,this.container.addChild(t),this.billWoman=new egret.MovieClip(this.mcFactory.generateMovieClipData("bill2")),this.billWoman.x=173.8,this.billWoman.y=547.45,this.billWoman.gotoAndStop(1),this.billWoman.touchEnabled=!0,this.container.addChild(this.billWoman),this.billWomanPop=new TSBitmap("ask",this.sheet),this.billWomanPop.x=189.15,this.billWomanPop.y=349.2,this.billWomanPop.visible=!1,this.container.addChild(this.billWomanPop),e=new TSBitmap("bill",this.sheet),e.x=41,e.y=172,this.container.addChild(e),i=new TSBitmap("all200",this.sheet),i.x=376,i.y=315,this.container.addChild(i),this.chipArray=[],h=0;12>h;h++)s=new TSBitmap("chips",this.sheet,!0),s.x=438.05+60*(h%3),s.y=425.4+65*Math.floor(h/3),this.container.addChild(s),this.chipArray.push(s);for(this.itemsJson[ItemEnum.ITEM_FRIES]=this.chipArray[1],this.chipArea=new egret.Shape,this.chipArea.graphics.beginFill(0,0),this.chipArea.graphics.drawRect(413.05,403.15,168,247),this.chipArea.graphics.endFill(),this.chipArea.touchEnabled=!0,this.container.addChild(this.chipArea),a=new TSBitmap("billmachine",this.sheet,!0),a.x=158.8,a.y=588.4,this.container.addChild(a),this.ototoMc=new egret.MovieClip(this.mcFactory.generateMovieClipData("ott_stand")),this.ototoMc.x=487.85,this.ototoMc.y=605.5,this.ototoMc.touchEnabled=!0,this.container.addChild(this.ototoMc),this.ototoCartingMc=new egret.MovieClip(this.mcFactory.generateMovieClipData("ott_cart_in")),this.ototoCartingMc.x=397.45,this.ototoCartingMc.y=664.3,this.ototoCartingMc.visible=!1,this.addChild(this.ototoCartingMc),o=new TSBitmap("bazhe",this.sheet),o.x=1442,o.y=177,this.container.addChild(o),n=new TSBitmap("exit",this.sheet),n.x=1719,n.y=177,this.container.addChild(n),r=new TSBitmap("sea",this.sheet),r.x=1369,r.y=434,this.container.addChild(r),l=new TSBitmap("sea",this.sheet),l.x=1914,l.y=434,this.container.addChild(l),this.salebottom=new TSBitmap("salebottom",this.sheet),this.salebottom.x=1802,this.salebottom.y=624,this.salebottom.touchEnabled=!0,this.container.addChild(this.salebottom),this.beaf=new TSBitmap("beaf",this.sheet,!0),this.beaf.x=1434,this.beaf.y=525,this.beaf.touchEnabled=!0,this.container.addChild(this.beaf),this.itemsJson[ItemEnum.ITEM_BEAF]=this.beaf,c=new TSBitmap("beaf",this.sheet),c.x=1393,c.y=539,this.container.addChild(c),this.beafArea=new egret.Shape,this.beafArea.graphics.beginFill(0,0),this.beafArea.graphics.drawRect(1393,455,81.6,129.6),this.beafArea.graphics.endFill(),this.beafArea.touchEnabled=!0,this.container.addChild(this.beafArea),this.chiken=new TSBitmap("chiken",this.sheet,!0),this.chiken.x=1520,this.chiken.y=526,this.chiken.touchEnabled=!0,this.container.addChild(this.chiken),this.itemsJson[ItemEnum.ITEM_DRUMSTICKS]=this.chiken,d=new TSBitmap("chiken",this.sheet),d.x=1479,d.y=540,this.container.addChild(d),_=new TSBitmap("chiken",this.sheet),_.x=1566,_.y=503,this.container.addChild(_),this.chikenArea=new egret.Shape,this.chikenArea.graphics.beginFill(0,0),this.chikenArea.graphics.drawRect(1522.4,455,81.6,129.6),this.chikenArea.graphics.endFill(),this.chikenArea.touchEnabled=!0,this.container.addChild(this.chikenArea),this.fish=new TSBitmap("fish",this.sheet,!0),this.fish.x=1866,this.fish.y=560,this.container.addChild(this.fish),this.itemsJson[ItemEnum.ITEM_FISH_FILLET]=this.fish,this.fishArea=new egret.Shape,this.fishArea.graphics.beginFill(0,0),this.fishArea.graphics.drawRect(1825.2,455,81.6,129.6),this.fishArea.graphics.endFill(),this.fishArea.touchEnabled=!0,this.container.addChild(this.fishArea),this.tasteArea=new egret.Shape,this.tasteArea.graphics.beginFill(0,0),this.tasteArea.graphics.drawRect(1579.95,435.95,80,80),this.tasteArea.graphics.endFill(),this.tasteArea.touchEnabled=!0,this.container.addChild(this.tasteArea),this.sale=new TSBitmap("sale",this.sheet,!0),this.sale.x=1874.65,this.sale.y=509.4,this.sale.touchEnabled=!0,this.container.addChild(this.sale),this.saler=new egret.MovieClip(this.mcFactory.generateMovieClipData("saler_yaohe1")),this.saler.x=1699.45,this.saler.y=561.3,this.saler.play(-1),this.container.addChild(this.saler),g=new TSBitmap("desk",this.sheet),g.x=1530,g.y=542,this.container.addChild(g),this.boolens=new TSBitmap("boolen",this.sheet,!0),this.boolens.x=780.85,this.boolens.y=488.95,this.container.addChild(this.boolens),this.coin=new egret.MovieClip(this.mcFactory.generateMovieClipData("coin")),this.coin.x=736.5,this.coin.y=413.85,this.coin.gotoAndStop(1),this.coin.visible=!1,this.container.addChild(this.coin),this.boloonBoom=new egret.MovieClip(this.mcFactory.generateMovieClipData("boolen_boom")),this.boloonBoom.x=736.85,this.boloonBoom.y=392.45,this.boloonBoom.gotoAndStop(1),this.boloonBoom.touchEnabled=!0,this.container.addChild(this.boloonBoom),this.salebottom2=new TSBitmap("salebottom",this.sheet),this.salebottom2.x=807,this.salebottom2.y=622,this.salebottom2.touchEnabled=!0,this.container.addChild(this.salebottom2),p=new TSBitmap("pengzi",this.sheet),p.x=925,p.y=321,this.container.addChild(p),this.eggsArray=[],y=0;15>y;y++)u=1!==y?new TSBitmap("egg",this.sheet,!0):new TSBitmap("yegg",this.sheet,!0),u.name="egg"+y,u.x=999.7+90*(y%3),u.y=525.9-33.25*Math.floor(y/3),u.touchEnabled=!0,this.container.addChild(u),this.eggsArray.push(u);for(this.itemsJson[ItemEnum.ITEM_YELLOW_EGGS]=this.eggsArray[1],this.eggArea=new egret.Shape,this.eggArea.graphics.beginFill(0,0),this.eggArea.graphics.drawRect(1092.85-140,385.95,279.85,135.35),this.eggArea.graphics.endFill(),this.eggArea.touchEnabled=!1,this.container.addChild(this.eggArea),this.eggdesk=new TSBitmap("eggdesk",this.sheet),this.eggdesk.x=923,this.eggdesk.y=533,this.container.addChild(this.eggdesk),this.boySprite=new egret.Sprite,this.boySprite.x=this.BOY_POSITION_LEFT,this.boySprite.y=this.BOY_Y,this.boy=new egret.MovieClip(this.mcFactory.generateMovieClipData("sh_pull")),this.boy.x=-37.9,this.boy.y=32.45,this.boySprite.addChild(this.boy),this.ototo=new TSBitmap("cartott",this.sheet,!0),this.ototo.x=40.45-63.55,this.ototo.y=94.85-25.65,this.ototo.visible=!1,this.boySprite.addChild(this.ototo),this.cart=new TSBitmap("cart",this.sheet,!0),this.cart.x=40.4,this.cart.y=94.85,this.boySprite.addChild(this.cart),this.arm=new TSBitmap("arm",this.sheet,!0),this.arm.x=-46,this.arm.y=34,this.arm.visible=!1,this.boySprite.addChild(this.arm),this.pop=new egret.MovieClip(this.mcFactory.generateMovieClipData("sh_pull_pop")),this.pop.x=-39.4,this.pop.y=-106.85,this.pop.gotoAndStop(this.BOY_POP_FRAME[this.BOY_ITEM_GOT]),this.boySprite.addChild(this.pop),this.container.addChild(this.boySprite),E=new TSBitmap("seafooddesk",this.sheet),E.x=1271,E.y=771,this.container.addChild(E),this.touchBoy=new egret.MovieClip,this.touchBoy.visible=!1,this.yu=new TSBitmap("yu",this.sheet,!0),this.yu.x=1429,this.yu.y=839,this.yu.touchEnabled=!0,this.container.addChild(this.yu),this.xie=new TSBitmap("xie",this.sheet,!0),this.xie.x=1630.5,this.xie.y=841,this.xie.touchEnabled=!0,this.container.addChild(this.xie),this.she=new TSBitmap("she",this.sheet,!0),this.she.x=1815.95,this.she.y=845,this.she.touchEnabled=!0,this.container.addChild(this.she),h=0;6>h;h++)T=new TSBitmap("vagetabledesk",this.sheet,!0),T.x=133.55+190*h+66*Math.floor(h/3),T.y=872.95,this.container.addChild(T);return b=new TSBitmap("qingjiao",this.sheet),b.x=39,b.y=833,this.container.addChild(b),m=new TSBitmap("dasuan",this.sheet),m.x=229,m.y=819,this.container.addChild(m),A=new TSBitmap("tudo",this.sheet),A.x=419,A.y=835,this.container.addChild(A),v=new TSBitmap("huluobo",this.sheet),v.x=676,v.y=823,this.container.addChild(v),S=new TSBitmap("fanqie",this.sheet),S.x=870,S.y=829,this.container.addChild(S),C=new TSBitmap("liulian",this.sheet),C.x=1057,C.y=819,this.container.addChild(C),this.qingjiao=new TSBitmap("qj1",this.sheet,!0),this.qingjiao.x=123,this.qingjiao.y=862,this.qingjiao.touchEnabled=!0,this.container.addChild(this.qingjiao),this.itemsJson[ItemEnum.ITEM_PEPER]=this.qingjiao,this.qingjiaoArea=new egret.Shape,this.qingjiaoArea.graphics.beginFill(0,0),this.qingjiaoArea.graphics.drawRect(130.65-78,819.2,155.9,86.4),this.qingjiaoArea.graphics.endFill(),this.qingjiaoArea.touchEnabled=!0,this.container.addChild(this.qingjiaoArea),this.dasuan=new TSBitmap("ds1",this.sheet,!0),this.dasuan.x=302,this.dasuan.y=859.5,this.dasuan.touchEnabled=!0,this.container.addChild(this.dasuan),this.itemsJson[ItemEnum.ITEM_GARLIC]=this.dasuan,this.dasuanArea=new egret.Shape,this.dasuanArea.graphics.beginFill(0,0),this.dasuanArea.graphics.drawRect(251.2,819.2,155.9,86.4),this.dasuanArea.graphics.endFill(),this.dasuanArea.touchEnabled=!0,this.container.addChild(this.dasuanArea),this.tudou=new TSBitmap("td1",this.sheet,!0),this.tudou.x=517,this.tudou.y=868.5,this.tudou.touchEnabled=!0,this.container.addChild(this.tudou),this.itemsJson[ItemEnum.ITEM_POTATO]=this.tudou,this.fanqie=new TSBitmap("fq1",this.sheet,!0),this.fanqie.x=1019,this.fanqie.y=850.5,this.fanqie.touchEnabled=!0,this.container.addChild(this.fanqie),this.itemsJson[ItemEnum.ITEM_TOMATO]=this.fanqie,this.tudouArea=new egret.Shape,this.tudouArea.graphics.beginFill(0,0),this.tudouArea.graphics.drawRect(440.65,819.2,155.9,86.4),this.tudouArea.graphics.endFill(),this.tudouArea.touchEnabled=!0,this.container.addChild(this.tudouArea),this.huluobo=new TSBitmap("hlb1",this.sheet,!0),this.huluobo.x=783.5,this.huluobo.y=864,this.huluobo.touchEnabled=!0,this.container.addChild(this.huluobo),this.itemsJson[ItemEnum.ITEM_CARROT]=this.huluobo,this.huluoboArea=new egret.Shape,this.huluoboArea.graphics.beginFill(0,0),this.huluoboArea.graphics.drawRect(692.65,819.2,155.9,86.4),this.huluoboArea.graphics.endFill(),this.huluoboArea.touchEnabled=!0,this.container.addChild(this.huluoboArea),this.fanqieArea=new egret.Shape,this.fanqieArea.graphics.beginFill(0,0),this.fanqieArea.graphics.drawRect(882.05,819.2,155.9,86.4),this.fanqieArea.graphics.endFill(),this.fanqieArea.touchEnabled=!0,this.container.addChild(this.fanqieArea),this.liulian=new TSBitmap("ll1",this.sheet,!0),this.liulian.x=1155.5,this.liulian.y=855,this.liulian.touchEnabled=!0,this.container.addChild(this.liulian),this.liulianArea=new egret.Shape,this.liulianArea.graphics.beginFill(0,0),this.liulianArea.graphics.drawRect(1071.45,819.2,155.9,86.4),this.liulianArea.graphics.endFill(),this.liulianArea.touchEnabled=!0,this.container.addChild(this.liulianArea),this.leftArrow=new TSBitmap("arrow_png"),this.leftArrow.anchorOffsetX=this.leftArrow.width/2,this.leftArrow.anchorOffsetY=this.leftArrow.height/2,this.leftArrow.x=40,this.leftArrow.y=510,this.leftArrow.touchEnabled=!0,this.leftArrow.visible=!1,this.addChild(this.leftArrow),this.rightArrow=new TSBitmap("arrow_png"),this.rightArrow.anchorOffsetX=this.rightArrow.width/2,this.rightArrow.anchorOffsetY=this.rightArrow.height/2,this.rightArrow.scaleX=-1,this.rightArrow.x=600,this.rightArrow.y=510,this.rightArrow.touchEnabled=!0,this.addChild(this.rightArrow),this.leftArrow.addEventListener(egret.TouchEvent.TOUCH_TAP,this.leftArrowTouched,this),this.rightArrow.addEventListener(egret.TouchEvent.TOUCH_TAP,this.rightArrowTouched,this),ItemController.getInstance().addItem(ItemEnum.ITEM_HUNDRED_YUAN,!1),ItemCtrlView.getInstance().updateItems(!1),this.screen_splash=new egret.Shape,this.screen_splash.graphics.beginFill(16777215),this.screen_splash.graphics.drawRect(0,0,Util.curWidth(),Util.curHeight()),this.screen_splash.graphics.endFill(),this.screen_splash.alpha=0,this.screen_splash.visible=!1,this.screen_splash.touchEnabled=!1,this.addChild(this.screen_splash),UIManager.getInstance().hideLoading(),this.addAllEventListener(),[2]}})})},e.prototype.addAllEventListener=function(){this.billWoman.addEventListener(egret.TouchEvent.TOUCH_TAP,this.billTouched,this),this.sale.addEventListener(egret.TouchEvent.TOUCH_TAP,this.saleTouched,this),this.chipArea.addEventListener(egret.TouchEvent.TOUCH_TAP,this.chipsTouched,this),this.fishArea.addEventListener(egret.TouchEvent.TOUCH_TAP,this.fishTouched,this),this.beafArea.addEventListener(egret.TouchEvent.TOUCH_TAP,this.beafTouched,this),this.chikenArea.addEventListener(egret.TouchEvent.TOUCH_TAP,this.chikenTouched,this),this.fish.addEventListener(egret.TouchEvent.TOUCH_TAP,this.fishTouched,this),this.qingjiaoArea.addEventListener(egret.TouchEvent.TOUCH_TAP,this.qingjiaoTouched,this),this.dasuanArea.addEventListener(egret.TouchEvent.TOUCH_TAP,this.dasuanTouched,this),this.tudouArea.addEventListener(egret.TouchEvent.TOUCH_TAP,this.tudouTouched,this),this.huluoboArea.addEventListener(egret.TouchEvent.TOUCH_TAP,this.huluoboTouched,this),this.fanqieArea.addEventListener(egret.TouchEvent.TOUCH_TAP,this.fanqieTouched,this),this.liulianArea.addEventListener(egret.TouchEvent.TOUCH_TAP,this.liulianTouched,this),this.yu.addEventListener(egret.TouchEvent.TOUCH_TAP,this.yuTouched,this),this.she.addEventListener(egret.TouchEvent.TOUCH_TAP,this.sheTouched,this),this.xie.addEventListener(egret.TouchEvent.TOUCH_TAP,this.xieTouched,this),this.tasteArea.addEventListener(egret.TouchEvent.TOUCH_TAP,this.tasteTouched,this),this.boolens.addEventListener(egret.TouchEvent.TOUCH_TAP,this.boolensTouched,this),this.coin.addEventListener(egret.TouchEvent.TOUCH_TAP,this.coinTouched,this),this.ototoMc.addEventListener(egret.TouchEvent.TOUCH_TAP,this.ototoTouched,this);for(var t=0;t<this.eggsArray.length;t++)this.eggsArray[t].addEventListener(egret.TouchEvent.TOUCH_TAP,this.eggsTouched,this)},e.prototype.removeAllEventListener=function(){this.billWoman.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.billTouched,this),this.sale.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.saleTouched,this),this.chipArea.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.chipsTouched,this),this.fishArea.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.fishTouched,this),this.beafArea.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.beafTouched,this),this.chikenArea.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.chikenTouched,this),this.fish.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.fishTouched,this),this.qingjiaoArea.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.qingjiaoTouched,this),this.dasuanArea.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.dasuanTouched,this),this.tudouArea.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.tudouTouched,this),this.huluoboArea.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.huluoboTouched,this),this.fanqieArea.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.fanqieTouched,this),this.liulianArea.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.liulianTouched,this),this.yu.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.yuTouched,this),this.she.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.sheTouched,this),this.xie.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.xieTouched,this),this.tasteArea.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.tasteTouched,this),this.boolens.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.boolensTouched,this),this.coin.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.coinTouched,this),this.ototoMc.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.ototoTouched,this);for(var t=0;t<this.eggsArray.length;t++)this.eggsArray[t].removeEventListener(egret.TouchEvent.TOUCH_TAP,this.eggsTouched,this)},e.prototype.ototoTouched=function(t){this.FLAG_WOMEN_BILLING||this.FLAG_WOMEN_BILLED||(this.removeAllEventListener(),this.ototoMc.touchEnabled=!1,this.ototoMc.visible=!1,this.ototoCartingMc.visible=!0,this.ototoCartingMc.play(),this.FLAG_OTOTO_CARTING=!0)},e.prototype.coinTouched=function(t){this.registItem(ItemEnum.ITEM_HUNDRED_ONE_YUAN)},e.prototype.boolensTouched=function(t){SoundManager.getInstance().playSound(SoundEnum.PUYONSOUND_MP3)},e.prototype.boloonTouched=function(t){this.boloonBoom.touchEnabled=!1,this.boloonBoom.gotoAndPlay(1),this.coin.gotoAndPlay(1),this.coin.touchEnabled=!0,this.coin.visible=!0},e.prototype.billTouched=function(t){this.FLAG_WOMEN_BILLING||this.FLAG_WOMEN_BILLED||this.BOY_ITEM_GOT>=4&&(this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_billstand"),this.boySprite.x=238.45,this.boySprite.y=615.5,this.boy.x=-115.1,this.boy.y=-28.75,this.boy.gotoAndStop(1),this.arm.visible=!1,this.pop.visible=!1,this.cart.x=0,this.cart.y=0,this.FLAG_OTOTO_TOKEN&&(this.ototo.x=-63.55,this.ototo.y=-25.65),this.container.setChildIndex(this.ototoMc,this.container.getChildIndex(this.boySprite)+1),this.removeAllEventListener(),this.chipArea.touchEnabled=!1,this.rightArrow.visible=!1,this.FLAG_OTOTO_TOKEN?(this.billWoman.gotoAndPlay(1),this.FLAG_WOMEN_BILLING=!0):(this.ototoMc.movieClipData=this.mcFactory.generateMovieClipData("ott_throw"),this.ototoMc.x=383.85,this.ototoMc.y=605.3,this.ototoMc.play(),this.chipArray[6].visible=!1,this.FLAG_OTT_THROWING=!0,this.BOY_ITEM_GOT=5,this.billWoman.movieClipData=this.mcFactory.generateMovieClipData("bill"),this.billWoman.gotoAndPlay(1),this.FLAG_WOMEN_BILLING=!0))},e.prototype.fishTouched=function(t){this.registItem(ItemEnum.ITEM_FISH_FILLET)},e.prototype.beafTouched=function(t){this.registItem(ItemEnum.ITEM_BEAF)},e.prototype.chikenTouched=function(t){this.registItem(ItemEnum.ITEM_DRUMSTICKS)},e.prototype.yuTouched=function(t){this.arm.visible=!1,Util.singletonPush(this.cards,131),this.yu.visible=!1,this.boy.visible=!1,this.pop.visible=!1;var e=new egret.MovieClip(this.mcFactory.generateMovieClipData("fish_jump"));e.x=this.yu.x,e.y=this.yu.y,e.play(-1),this.container.addChild(e),this.touchBoy.movieClipData=this.mcFactory.generateMovieClipData("sh_touch"),this.touchBoy.visible=!0,this.touchBoy.x=1435.6,this.touchBoy.y=728,this.touchBoy.gotoAndPlay(1),this.container.addChild(this.touchBoy),SoundManager.getInstance().playSound(SoundEnum.ASERISOUND_MP3),this.FLAG_END_GAMEOVER=!0},e.prototype.chipsTouched=function(t){this.chipArea.touchEnabled=!1,this.registItem(ItemEnum.ITEM_FRIES)},e.prototype.eggsTouched=function(t){var e=t.target;if("egg1"===e.name)t.target.visible=!1,this.registItem(ItemEnum.ITEM_YELLOW_EGGS);else if(this.FLAG_EGG_SOLD){t.target.visible=!1;for(var i=0;i<this.eggItemList.length;i++)if(!ItemController.getInstance().hasItem(this.eggItemList[i])){this.registItem(this.eggItemList[i]);break}}else t.target.visible=!1,this.playDanSuiEffect()},e.prototype.suiEffect=function(t,e){var i=this;this.container.setChildIndex(t,this.container.getChildIndex(this.boySprite)),0===e?(this.container.setChildIndex(t,this.container.getChildIndex(this.eggdesk)),egret.Tween.get(t).to({x:t.x-30,y:t.y+275},1e3).call(function(){t.visible=!1;var s=new TSBitmap("eggsui"+(e+1),i.sheet,!0);s.x=t.x,s.y=t.y,i.container.addChildAt(s,i.container.getChildIndex(i.boySprite))})):1===e?egret.Tween.get(t).to({y:t.y+260+40*Math.random()},1e3).call(function(){t.visible=!1;var s=new TSBitmap("eggsui"+(e+1),i.sheet,!0);s.x=t.x,s.y=t.y,i.container.addChildAt(s,i.container.getChildIndex(i.boySprite))}):2===e&&egret.Tween.get(t).to({x:t.x+20,y:t.y+275},1e3).call(function(){t.visible=!1;var s=new TSBitmap("eggsui"+(e+1),i.sheet,!0);s.x=t.x,s.y=t.y,i.container.addChildAt(s,i.container.getChildIndex(i.boySprite))})},e.prototype.playDanSuiEffect=function(){var t=this;Util.singletonPush(this.cards,132),SoundManager.getInstance().playSound(SoundEnum.TAMAGOCRASHSOUND_MP3);for(var e=14;e>=3;e--)this.eggsArray[e].visible&&this.suiEffect(this.eggsArray[e],e%3);egret.Tween.get(this.container).wait(100).call(function(){t.boy.movieClipData=t.mcFactory.generateMovieClipData("sh_pull_bad"),t.boy.gotoAndPlay(1),t.arm.visible=!1,t.FLAG_END_GAMEOVER=!0})},e.prototype.xieTouched=function(t){this.arm.touchEnabled=!1,this.boy.visible=!1,this.pop.visible=!1,this.touchBoy.movieClipData=this.mcFactory.generateMovieClipData("sh_touch"),this.touchBoy.visible=!0,this.touchBoy.scaleX=-1,this.touchBoy.x=1565.6,this.touchBoy.y=728,this.touchBoy.gotoAndPlay(1),this.container.addChild(this.touchBoy),this.FLAG_BOY_LUAN_MO=!0
},e.prototype.sheTouched=function(t){Util.singletonPush(this.cards,130),this.arm.visible=!1,this.boy.visible=!1,this.pop.visible=!1,this.touchBoy.movieClipData=this.mcFactory.generateMovieClipData("sh_drag"),this.touchBoy.visible=!0,this.touchBoy.x=1793.5,this.touchBoy.y=728.55,this.touchBoy.gotoAndPlay(1),this.container.addChild(this.touchBoy),SoundManager.getInstance().playSound(SoundEnum.ASERISOUND_MP3),this.FLAG_DRAG_NIQIU=!0},e.prototype.saleTouched=function(t){this.registItem(ItemEnum.ITEM_ON_SALE)},e.prototype.dasuanTouched=function(t){this.registItem(ItemEnum.ITEM_GARLIC)},e.prototype.tudouTouched=function(){this.registItem(ItemEnum.ITEM_POTATO)},e.prototype.qingjiaoTouched=function(t){this.registItem(ItemEnum.ITEM_PEPER)},e.prototype.huluoboTouched=function(t){this.registItem(ItemEnum.ITEM_CARROT)},e.prototype.liulianTouched=function(t){this.registItem(ItemEnum.ITEM_DURIAN)},e.prototype.fanqieTouched=function(t){this.registItem(ItemEnum.ITEM_TOMATO)},e.prototype.tasteTouched=function(t){this.FLAG_TASTE_GOT||this.registItem(ItemEnum.ITEM_TRY_TASTE)},e.prototype.rightArrowTouched=function(t){this.FLAG_WOMEN_BILLING||(this.FLAG_POSITION===this.POSITION_LEFT?(this.leftArrow.visible=!0,this.FLAG_POSITION=this.POSITION_MIDDLE,egret.Tween.get(this.container).to({x:-640},500).call(this.shMove,this,[this.BOY_POSITION_MIDDLE,this.POSITION_RIGHT])):this.FLAG_POSITION===this.POSITION_MIDDLE&&(this.rightArrow.visible=!1,this.FLAG_POSITION=this.POSITION_RIGHT,egret.Tween.get(this.container).to({x:-1280},500).call(this.shMove,this,[this.BOY_POSITION_RIGHT,this.POSITION_RIGHT])))},e.prototype.leftArrowTouched=function(t){this.FLAG_WOMEN_BILLING||(this.FLAG_POSITION===this.POSITION_MIDDLE?(this.leftArrow.visible=!1,this.FLAG_POSITION=this.POSITION_LEFT,egret.Tween.get(this.container).to({x:0},500).call(this.shMove,this,[this.BOY_POSITION_LEFT,this.POSITION_LEFT])):this.FLAG_POSITION===this.POSITION_RIGHT&&(this.rightArrow.visible=!0,this.FLAG_POSITION=this.POSITION_MIDDLE,egret.Tween.get(this.container).to({x:-640},500).call(this.shMove,this,[this.BOY_POSITION_MIDDLE,this.POSITION_LEFT])))},e.prototype.shMove=function(t){var e=this;this.FLAG_WOMEN_BILLED||(this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_pull_move"),this.boy.play(-1),egret.Tween.get(this.boySprite).to({x:t},500).call(function(){e.boy.movieClipData=e.mcFactory.generateMovieClipData("sh_pull_stand")}))},e.prototype._loadRes=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,StageController.getInstance().loadStage(this.stageid)];case 1:return e.sent(),[3,3];case 2:return t=e.sent(),console.error(t),[3,3];case 3:return[2]}})})},e.prototype._start=function(){},e.prototype.play_loop=function(){if(this.FLAG_END_GAMEOVER||this.FLAG_END_CLEAR)return this.COUNTER_END++,void(this.COUNTER_END>=60&&(this.FLAG_END_CLEAR&&StageController.getInstance().clearStage(this.stageid,this.cards),this.FLAG_END_GAMEOVER&&StageController.getInstance().gameOverStage(this.stageid,this.cards)));if(this.FLAG_COIN_DROPPING&&this.coin.currentFrame===this.coin.totalFrames&&(SoundManager.getInstance().playSound(SoundEnum.COIN6SOUND_MP3),this.FLAG_COIN_DROPPING=!1),this.FLAG_SPLASH_TOCLEAR&&this.screen_splash.visible===!1&&(this.screen_splash.visible=!0,egret.Tween.get(this.screen_splash).to({alpha:.15}).to({alpha:0},80).to({alpha:1},1e3).call(function(){})),this.FLAG_WOMEN_BILLING&&this.billWoman.currentFrame===this.billWoman.totalFrames&&(this.billWoman.gotoAndStop(1),this.billWomanPop.visible=!0,this.FLAG_OTOTO_TOKEN?(this.askMoney=new TSBitmap("yin1000",this.sheet),this.askMoney.x=206.15,this.askMoney.y=364.2):(this.askMoney=new TSBitmap("yin1100",this.sheet),this.askMoney.x=206.15,this.askMoney.y=364.2),this.container.addChild(this.askMoney),this.FLAG_GIVE_MONEY=!0,this.FLAG_WOMEN_BILLING=!1,this.FLAG_WOMEN_BILLED=!0,this.addAllEventListener(),this.rightArrow.visible=!0),this.FLAG_OTT_THROWING&&this.ototoMc.currentFrame===this.ototoMc.totalFrames){this.ototoMc.movieClipData=this.mcFactory.generateMovieClipData("ott_stand"),this.ototoMc.x=192.55,this.ototoMc.y=631;var t=new TSBitmap("chip",this.sheet);t.x=373.85,t.y=595.3,this.container.addChildAt(t,this.getChildIndex(this.boySprite)),egret.Tween.get(t).to({x:333.85,y:555.3},200)}this.FLAG_BOY_LUAN_MO&&this.touchBoy.currentFrame===this.touchBoy.totalFrames-1&&(this.touchBoy.visible=!1,this.FLAG_BOY_LUAN_MO=!1,this.FLAG_OTOTO_CARTING&&(this.arm.visible=!0),this.boy.visible=!0,this.pop.visible=!0,this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_pull"),this.boy.x=-37.9,this.boy.y=32.45,this.boy.gotoAndStop(1)),this.FLAG_BOY_TASTING&&this.boy.currentFrame===this.boy.totalFrames&&(this.FLAG_BOY_TASTING=!1,this.FLAG_WOMEN_BILLED?(this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_billstand"),this.boySprite.x=238.45,this.boySprite.y=615.5,this.boy.x=-115.1,this.boy.y=-28.75,this.boy.gotoAndStop(1),this.arm.visible=!1,this.pop.visible=!1,this.cart.x=0,this.cart.y=0):(this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_pull_stand"),this.FLAG_OTOTO_CARTING&&(this.arm.visible=!0)),this.registItem(ItemEnum.ITEM_TRY_TASTE_STICK)),this.FLAG_OTOTO_CARTING&&!this.ototo.visible&&this.ototoCartingMc.currentFrame===this.ototoCartingMc.totalFrames&&(this.FLAG_OTOTO_TOKEN=!0,this.arm.visible=!0,this.FLAG_OTOTO_CARTING=!0,this.ototoCartingMc.visible=!1,this.ototo.visible=!0,this.addAllEventListener()),this.FLAG_DRAG_NIQIU&&this.touchBoy.currentFrame===this.touchBoy.totalFrames-1&&(this.she.visible=!1,this.FLAG_END_GAMEOVER=!0)},e.prototype._remove=function(){egret.Tween.removeAllTweens()},e.prototype.registItem=function(t){if(ItemController.getInstance().addItem(t))switch(t){case ItemEnum.ITEM_DRUMSTICKS:this.chiken.visible=!1;break;case ItemEnum.ITEM_FISH_FILLET:this.fish.visible=!1;break;case ItemEnum.ITEM_DURIAN:this.liulian.visible=!1;break;case ItemEnum.ITEM_GARLIC:this.dasuan.visible=!1,this.dasuanArea.touchEnabled=!1;break;case ItemEnum.ITEM_TOMATO:this.fanqie.visible=!1,this.fanqieArea.touchEnabled=!1;break;case ItemEnum.ITEM_ON_SALE:this.sale.visible=!1;break;case ItemEnum.ITEM_PEPER:this.qingjiao.visible=!1;break;case ItemEnum.ITEM_BEAF:this.beaf.visible=!1;break;case ItemEnum.ITEM_POTATO:this.tudou.visible=!1;break;case ItemEnum.ITEM_CARROT:this.huluobo.visible=!1;break;case ItemEnum.ITEM_FRIES:this.chipArray[1].visible=!1;break;case ItemEnum.ITEM_TRY_TASTE:this.FLAG_TASTE_GOT=!0,this.saler.movieClipData=this.mcFactory.generateMovieClipData("saler_yaohe"),this.saler.play(-1);break;case ItemEnum.ITEM_WHITE_EGGS_1:case ItemEnum.ITEM_WHITE_EGGS_2:case ItemEnum.ITEM_WHITE_EGGS_3:case ItemEnum.ITEM_WHITE_EGGS:for(var e=0;4>e;e++)if(this.eggsArray[13-3*e].visible===!0){this.eggsArray[13-3*e].visible=!1;break}break;case ItemEnum.ITEM_YELLOW_EGGS:this.FLAG_EGG_SOLD||this.playDanSuiEffect(),this.eggsArray[1].visible=!1;break;case ItemEnum.ITEM_HUNDRED_YUAN:break;case ItemEnum.ITEM_HUNDRED_ONE_YUAN:ItemController.getInstance().useItem(ItemEnum.ITEM_HUNDRED_YUAN),this.coin.visible=!1;break;case ItemEnum.ITEM_TRY_TASTE_STICK:}},e.prototype.useItem=function(t,e,i){var s=this;if(this.FLAG_END_GAMEOVER||this.FLAG_END_CLEAR)return!1;if(this.boySprite.hitTestPoint(e,i)&&null!==this.itemsJson[t]&&void 0!==this.itemsJson[t]){if(this.FLAG_BOY_CURRENT_NEED===t)return this.pop.visible=!1,this.itemsJson[t].visible=!0,this.itemsJson[t].x=this.boySprite.x+55.95,this.itemsJson[t].y=this.boySprite.y-36.55,console.log(this.itemsJson[t]),t===ItemEnum.ITEM_TOMATO?this.container.setChildIndex(this.itemsJson[t],this.container.getChildIndex(this.boySprite)):this.container.setChildIndex(this.itemsJson[t],this.container.getChildIndex(this.boySprite)-1),this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_pull_wish"),this.arm.visible=!1,this.boy.gotoAndPlay(1),this.BOY_ITEM_GOT++,egret.Tween.get(this.itemsJson[t]).to({y:this.boySprite.y+100-36.55},1e3).call(function(){s.pop.visible=!0,s.pop.gotoAndStop(s.BOY_POP_FRAME[s.BOY_ITEM_GOT]),s.BOY_ITEM_GOT<s.BOY_NEED_LIST.length&&(s.FLAG_BOY_CURRENT_NEED=s.BOY_NEED_LIST[s.BOY_ITEM_GOT]),s.arm.visible=!0,s.boy.movieClipData=s.mcFactory.generateMovieClipData("sh_pull")}).call(function(){s.itemsJson[t].visible=!1}),!0;if(void 0!==this.itemsJson[t]&&null!==this.itemsJson[t])return this.pop.visible=!1,this.itemsJson[t].visible=!0,this.itemsJson[t].x=this.boySprite.x+55.95,this.itemsJson[t].y=this.boySprite.y-36.55,this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_pull_sayno"),this.boy.gotoAndPlay(1),egret.Tween.get(this.pop).wait(500).call(function(){s.registItem(t),s.pop.visible=!0,s.boy.movieClipData=s.mcFactory.generateMovieClipData("sh_pull")}),!0}if(-1!==this.eggItemList.indexOf(t)&&this.eggArea.hitTestPoint(e,i)){for(var h=0;h<this.eggsArray.length;h++)if(this.eggsArray[h].visible===!1&&"egg1"!==this.eggsArray[h].name){this.eggsArray[h].visible=!0;break}return!0}switch(t){case ItemEnum.ITEM_PEPER:return this.qingjiaoArea.hitTestPoint(e,i)?(this.qingjiao.x=123,this.qingjiao.y=862,this.qingjiao.visible=!0,this.container.setChildIndex(this.qingjiao,this.container.getChildIndex(this.qingjiaoArea)),this.qingjiaoArea.touchEnabled=!0,!0):!1;case ItemEnum.ITEM_GARLIC:return this.dasuanArea.hitTestPoint(e,i)?(this.dasuan.x=302,this.dasuan.y=859.5,this.dasuan.visible=!0,this.container.setChildIndex(this.dasuan,this.container.getChildIndex(this.dasuanArea)),this.dasuanArea.touchEnabled=!0,!0):!1;case ItemEnum.ITEM_POTATO:return this.tudouArea.hitTestPoint(e,i)?(this.tudou.x=517,this.tudou.y=868.5,this.tudou.visible=!0,this.container.setChildIndex(this.tudou,this.container.getChildIndex(this.tudouArea)),this.tudouArea.touchEnabled=!0,!0):!1;case ItemEnum.ITEM_CARROT:return this.huluoboArea.hitTestPoint(e,i)?(this.huluobo.x=783.5,this.huluobo.y=864,this.huluobo.visible=!0,this.container.setChildIndex(this.huluobo,this.container.getChildIndex(this.huluoboArea)),this.huluoboArea.touchEnabled=!0,!0):!1;case ItemEnum.ITEM_TOMATO:return this.fanqieArea.hitTestPoint(e,i)?(this.fanqie.x=1019,this.fanqie.y=850.5,this.fanqie.visible=!0,this.container.setChildIndex(this.fanqie,this.container.getChildIndex(this.fanqieArea)),this.fanqieArea.touchEnabled=!0,!0):!1;case ItemEnum.ITEM_DURIAN:return this.liulianArea.hitTestPoint(e,i)?(this.liulian.x=1155.5,this.liulian.y=855,this.liulian.visible=!0,this.container.setChildIndex(this.liulian,this.container.getChildIndex(this.liulianArea)),this.liulianArea.touchEnabled=!0,!0):this.boySprite.hitTestPoint(e,i)?(Util.singletonPush(this.cards,129),this.arm.visible=!1,SoundManager.getInstance().playSound(SoundEnum.KUSAISOUND_MP3),this.boySprite.setChildIndex(this.boy,this.boySprite.numChildren),this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_pull_llbad"),this.boy.gotoAndPlay(1),this.FLAG_END_GAMEOVER=!0,!0):!1;case ItemEnum.ITEM_BEAF:return this.beafArea.hitTestPoint(e,i)?(this.beaf.x=1434,this.beaf.y=525,this.beaf.visible=!0,this.container.setChildIndex(this.beaf,this.container.getChildIndex(this.beafArea)),this.beafArea.touchEnabled=!0,!0):!1;case ItemEnum.ITEM_DRUMSTICKS:if(this.chikenArea.hitTestPoint(e,i))return this.chiken.x=1520,this.chiken.y=526,this.chiken.visible=!0,this.container.setChildIndex(this.chiken,this.container.getChildIndex(this.chikenArea)),this.chikenArea.touchEnabled=!0,!0;case ItemEnum.ITEM_FISH_FILLET:return this.fishArea.hitTestPoint(e,i)?(this.fish.x=1866,this.fish.y=560,this.fish.visible=!0,this.container.setChildIndex(this.fish,this.container.getChildIndex(this.fishArea)),this.fishArea.touchEnabled=!0,!0):!1;case ItemEnum.ITEM_ON_SALE:if(this.salebottom.hitTestPoint(e,i))return this.sale.visible=!0,this.sale.x=1874.65,this.sale.y=508.4,!0;if(this.salebottom2.hitTestPoint(e,i)){if(this.sale.visible=!0,this.removeAllEventListener(),this.sale.x=880,this.sale.y=508.4,this.eggsArray[0].visible===!0){var a=new egret.Sprite;a.x=1324,a.y=565.15;var o=new egret.MovieClip(this.womenFactory.generateMovieClipData("woman1"));o.x=112,o.y=7.2,o.play(-1),a.addChild(o);var n=new egret.MovieClip(this.womenFactory.generateMovieClipData("woman2"));n.x=191.45,n.y=7.2,n.play(-1),a.addChild(n);var r=new egret.MovieClip(this.womenFactory.generateMovieClipData("woman3"));r.x=279,r.y=11.2,r.play(-1),a.addChild(r),this.container.addChildAt(a,this.container.getChildIndex(this.boySprite)),egret.Tween.get(a).to({x:954},1100).wait(200).call(function(){o.movieClipData=s.womenFactory.generateMovieClipData("woman1_stand"),o.x=340,n.movieClipData=s.womenFactory.generateMovieClipData("woman2_stand"),n.x=418,r.movieClipData=s.womenFactory.generateMovieClipData("woman3_stand"),r.x=496;for(var t=0,e=14;e>0&&(s.eggsArray[e].visible===!0&&(t++,s.eggsArray[e].visible=!1),3!==t);e--);}).wait(200).call(function(){for(var t=0,e=14;e>0&&(s.eggsArray[e].visible===!0&&(t++,s.eggsArray[e].visible=!1),3!==t);e--);}).wait(200).call(function(){for(var t=0,e=14;e>0&&(s.eggsArray[e].visible===!0&&(t++,s.eggsArray[e].visible=!1),3!==t);e--);o.movieClipData=s.womenFactory.generateMovieClipData("woman1"),o.play(-1),n.movieClipData=s.womenFactory.generateMovieClipData("woman2"),n.play(-1),r.movieClipData=s.womenFactory.generateMovieClipData("woman3"),r.play(-1)}).to({x:254},1e3).call(function(){s.addAllEventListener(),s.FLAG_EGG_SOLD=!0,s.container.removeChild(a)})}return!0}return!1;case ItemEnum.ITEM_TRY_TASTE:return this.boySprite.hitTestPoint(e,i)?(Util.singletonPush(this.cards,135),SoundManager.getInstance().playSound(SoundEnum.EATSOUND_MP3),this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_pull_taste"),this.boy.gotoAndPlay(1),this.arm.visible=!1,this.FLAG_BOY_TASTING=!0,!0):!1;case ItemEnum.ITEM_TRY_TASTE_STICK:return this.boloonBoom.hitTestPoint(e,i)?(SoundManager.getInstance().playSound(SoundEnum.DON2SOUND_MP3),this.boloonBoom.touchEnabled=!1,this.boloonBoom.gotoAndPlay(1),this.coin.gotoAndPlay(1),this.coin.touchEnabled=!0,this.coin.visible=!0,this.FLAG_COIN_DROPPING=!0,!0):!1;case ItemEnum.ITEM_HUNDRED_YUAN:if(this.billWoman.hitTestPoint(e,i)&&this.FLAG_WOMEN_BILLED){if(4===this.BOY_ITEM_GOT){this.billWomanPop.visible=!1,this.askMoney.visible=!1;var l=new TSBitmap("pass",this.sheet);return l.x=this.billWoman.x-24-l.width,l.y=this.billWoman.y-113.5-l.height,this.container.addChild(l),this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_pull_move"),this.boy.gotoAndPlay(1),egret.Tween.get(this.boySprite).to({x:-500},500).call(function(){s.screen_splash.visible=!0,egret.Tween.get(s.screen_splash).to({alpha:.15}).to({alpha:0},80).to({alpha:1},1e3).wait(1e3).call(function(){var t=new TSBitmap("clear",s.sheet);t.x=-100,t.y=-100,s.addChild(t),s.FLAG_END_CLEAR=!0,Util.singletonPush(s.cards,133)})}),egret.Tween.get(this.boySprite).to({x:-100},500),!0}if(5===this.BOY_ITEM_GOT){this.billWomanPop.visible=!1,this.askMoney.visible=!1;var l=new TSBitmap("fail",this.sheet);return l.x=this.billWoman.x-24-l.width,l.y=this.billWoman.y-113.5-l.height,this.container.addChild(l),this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_billbad"),this.boy.play(),this.FLAG_END_GAMEOVER=!0,Util.singletonPush(this.cards,128),!0}return!1}return!1;case ItemEnum.ITEM_HUNDRED_ONE_YUAN:if(this.billWoman.hitTestPoint(e,i)&&this.FLAG_WOMEN_BILLED){this.billWomanPop.visible=!1,this.askMoney.visible=!1;var l=new TSBitmap("pass",this.sheet);return l.x=this.billWoman.x-24-l.width,l.y=this.billWoman.y-113.5-l.height,this.container.addChild(l),this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_pull_move"),this.boy.play(-1),egret.Tween.get(this.boySprite).to({x:-500},500).call(function(){s.screen_splash.visible=!0,egret.Tween.get(s.screen_splash).to({alpha:.15}).to({alpha:0},80).to({alpha:1},1e3).wait(1e3).call(function(){var t=new TSBitmap("clear",s.sheet);t.x=-100,t.y=-100,s.addChild(t);var e=new TSBitmap("chip",s.sheet);e.x=255,e.y=681,s.addChild(e),Util.singletonPush(s.cards,134),s.FLAG_END_CLEAR=!0})}),!0}return!1;case ItemEnum.ITEM_FRIES:return this.chipArea.hitTestPoint(e,i)?(this.chipArray[1].visible=!0,!0):!1}return!1},e.prototype.getDisplayArea=function(){return new egret.Rectangle},e.prototype.ctrl_right=function(){},e.prototype.ctrl_left=function(){},e.prototype.ctrl_up=function(){},e.prototype.ctrl_down=function(){},e.prototype.ctrl_ok=function(){},e.prototype.ctrl_cancel=function(){},e}(egret.DisplayObjectContainer);__reflect(Stage29.prototype,"Stage29",["IFKaihiStage"]);var Stage3=function(t){function e(){var e=t.call(this)||this;return e.STAGE_ID=3,e.FLAG_CLEAR=!1,e.FLAG_GAME_OVER=!1,e.COUNTER_END=0,e.FLAG_GAME_STARTED=!1,e.FLAG_CAN_RESEAVE=!1,e.FLAG_REVERSE=!1,e.FLAG_SMASH_WIN=!1,e.SH_STAT_STANDBY=0,e.SH_STAT_RECIEVE=1,e.SH_STAT_FAIL=2,e.SH_STAT_SERVE=3,e.SH_STAT_SMASH=4,e.SH_STAT_KIAI=5,e.SH_STAT_FINISH=6,e.shStat=e.SH_STAT_SERVE,e.OTOUTO_STAT_STANDBY=0,e.OTOUTO_STAT_RECIEVE=1,e.OTOUTO_STAT_SMASH_REVERSE=2,e.OTOUTO_STAT_KIAI=3,e.otoutoStat=e.OTOUTO_STAT_STANDBY,e.RIRE_STAT_STANDBY=0,e.RIRE_STAT_START=1,e.RIRE_STAT_END=2,e.rireStat=e.RIRE_STAT_STANDBY,e.SMASH_STAT_NONE=0,e.SMASH_STAT_START=1,e.SMASH_STAT_HIT=2,e.SMASH_STAT_END=3,e.SMASH_STAT_SET=4,e.smashStat=e.SMASH_STAT_NONE,e.HANE_RECIEVE_SH_X=180,e.HANE_RECIEVE_SH_Y=640,e.HANE_RECIEVE_OTOUTO_X=505,e.HANE_RECIEVE_OTOUTO_Y=680,e.RIRE_NUM_MAX=10,e.rireCnt=0,e.SMASH_CAN_RIRE=3,e.RECIEVE_POWER_START=-15,e.recievePower=e.RECIEVE_POWER_START,e.recieveCnt=0,e.defXperFrame=0,e.RADIAN_UP=90*Math.PI/180,e.RADIAN_UP_SIN=Math.sin(e.RADIAN_UP),e.GRAVITY=.98,e.JIMEN_Y=780,e.CLEAR_Y=-9e3,e.SMASH_Y=480,e.MARGIN_TOP_MIN=150,e.DISP_HEIGHT_MAX=e.JIMEN_Y-e.MARGIN_TOP_MIN,e.ZOOM_STD_X=320,e.ZOOM_STD_Y=900,e.cloud_x=[-306,331,-120,462,1096,-579,584,-218,261,402,105],e.cloud_y=[-2698,-2221,-1577,-1376,-1101,-1054,-746,-528,-360,157,251],e.cloud_rate=[463,413,324,324,246,247,199,163,134,100,100],e._init(),e}return __extends(e,t),e.prototype._init=function(){return __awaiter(this,void 0,void 0,function(){var t,e,i,s,h,a,o,n,r,l,c;return __generator(this,function(d){switch(d.label){case 0:return UIManager.getInstance().showLoading(),[4,this._loadRes()];case 1:for(d.sent(),this.sheet=RES.getRes("stage3_texture"),t=new TSBitmap("bg",this.sheet),t.x=-120,t.y=-150,this.addChild(t),this.container=new egret.DisplayObjectContainer,this.addChild(this.container),this.ground=new TSBitmap("ground",this.sheet),this.ground.x=-598,this.ground.y=586,this.container.addChild(this.ground),e=this.sheet.getTexture("cloud"),s=0;11>s;s++)i=new egret.Bitmap,i.texture=e,i.scaleX=this.cloud_rate[s]/100,i.scaleY=this.cloud_rate[s]/100,i.x=this.cloud_x[s],i.y=this.cloud_y[s],this.container.addChild(i);return h=RES.getRes("stage3_boy_action_json"),a=RES.getRes("stage3_boy_action_png"),this.boyMcFactory=new egret.MovieClipDataFactory(h,a),this.boy=new egret.MovieClip(this.boyMcFactory.generateMovieClipData("start_ball")),this.boy.x=120.45,this.boy.y=636,this.boy.gotoAndStop(1),this.container.addChild(this.boy),o=RES.getRes("stage3_brother_action_json"),n=RES.getRes("stage3_brother_action_png"),this.brotherMcFactory=new egret.MovieClipDataFactory(o,n),this.brother=new egret.MovieClip(this.brotherMcFactory.generateMovieClipData("brother_stand")),this.brother.x=529.35,this.brother.y=675.55,this.container.addChild(this.brother),this.hane=new TSBitmap("hane",this.sheet),this.hane.anchorOffsetX=this.hane.width/2,this.hane.anchorOffsetY=this.hane.height/2,this.hane.x=161.45,this.hane.y=640.75,this.hane.visible=!1,this.container.addChild(this.hane),this.smashHane=new TSBitmap("hane",this.sheet),this.smashHane.x=215.3,this.smashHane.y=553.25,this.smashHane.rotation=-80,this.smashHane.visible=!1,this.container.addChild(this.smashHane),this.start_btn=new TSBitmap("start",this.sheet),this.start_btn.anchorOffsetX=this.start_btn.width/2,this.start_btn.anchorOffsetY=this.start_btn.height/2,this.start_btn.x=320,this.start_btn.y=852,this.start_btn.touchEnabled=!0,this.addChild(this.start_btn),this.back_btn=new TSBitmap("hit_back",this.sheet,!0),this.back_btn.x=320,this.back_btn.y=852,this.back_btn.touchEnabled=!1,this.back_btn.visible=!1,this.addChild(this.back_btn),r=RES.getRes("stage3_fire_effect_json"),l=RES.getRes("stage3_fire_effect_png"),c=new egret.MovieClipDataFactory(r,l),this.blue_fire=new egret.MovieClip(c.generateMovieClipData("blue_fire")),this.blue_fire.x=114.8,this.blue_fire.y=710,this.blue_fire.visible=!1,this.container.addChild(this.blue_fire),this.red_fire=new egret.MovieClip(c.generateMovieClipData("red_fire")),this.red_fire.x=517,this.red_fire.y=727,this.red_fire.visible=!1,this.container.addChild(this.red_fire),this.smash_btn=new TSBitmap("smash",this.sheet,!0),this.smash_btn.x=this.smash_btn.width/2,this.smash_btn.y=865.5,this.smash_btn.touchEnabled=!0,this.smash_btn.visible=!1,this.addChild(this.smash_btn),this.start_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.startClick,this),this.back_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.backClick,this),this.smash_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.smashClick,this),this.screen_splash=new egret.Shape,this.screen_splash.graphics.beginFill(16777215),this.screen_splash.graphics.drawRect(0,0,Util.curWidth(),Util.curHeight()),this.screen_splash.graphics.endFill(),this.screen_splash.alpha=0,this.screen_splash.visible=!1,this.screen_splash.touchEnabled=!1,this.addChild(this.screen_splash),this.cards=[],UIManager.getInstance().hideLoading(),[2]}})})},e.prototype.splash=function(t){var e=this;this.screen_splash.visible=!0,egret.Tween.get(this.screen_splash).to({alpha:.15}).to({alpha:0},80).to({alpha:1},1e3).call(function(){e.screen_splash.visible=!1,e.boy.visible=!1,e.brother.visible=!1,e.blue_fire.visible=e.red_fire.visible=!1,1===t?e.boyWin():2===t?e.boyLoss():3===t&&e.toSpace()})},e.prototype.startClick=function(){this.FLAG_GAME_STARTED=!0,this.start_btn.visible=!1,this.back_btn.visible=!0,this.start_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.startClick,this),this.setShStat(this.SH_STAT_SERVE)},e.prototype.backClick=function(){this.rire()},e.prototype.smashClick=function(){this.smashStat==this.SMASH_STAT_NONE&&(this.smashStat=this.SMASH_STAT_SET,this.delCanReseave(),this.back_btn.visible=!1,this.setShStat(this.SH_STAT_KIAI),SoundManager.getInstance().playSound(SoundEnum.AURASOUND_MP3),this.blue_fire.visible=!0,this.blue_fire.play(-1))},e.prototype.delCanReseave=function(){this.back_btn.touchEnabled=!1,this.back_btn.alpha=.5},e.prototype.setCanReseave=function(){this.back_btn.touchEnabled=!0,this.back_btn.alpha=1},e.prototype.setSmashBtn=function(){this.smash_btn.visible=!0,this.smash_btn.touchEnabled=!0,egret.Tween.get(this.smash_btn).to({alpha:1,x:this.smash_btn.width/2},500)},e.prototype.delSmashBtn=function(){this.smash_btn.touchEnabled=!1,egret.Tween.get(this.smash_btn).to({alpha:.5,x:-1.5*this.smash_btn.width},500)},e.prototype.smash=function(){this.rireStat=this.RIRE_STAT_END,this.setShStat(this.SH_STAT_SMASH),this.smash_btn.visible=!1,this.blue_fire.stop(),this.blue_fire.visible=!1},e.prototype.startRire=function(){this.rireCnt=1,this.recieveHane(),this.delCanReseave(),this.rireStat=this.RIRE_STAT_START,this.hane.visible=!0},e.prototype.rire=function(){this.recieveHane(),this.delCanReseave(),this.setShStat(this.SH_STAT_RECIEVE),this.setOtoutoStat(this.OTOUTO_STAT_STANDBY),this.rireCnt++,this.SMASH_CAN_RIRE<=this.rireCnt&&this.delSmashBtn()},e.prototype.rire_reverse=function(){this.recieveHane(!0),this.setOtoutoStat(this.OTOUTO_STAT_RECIEVE),this.setShStat(this.SH_STAT_STANDBY),this.boy.gotoAndStop(1),this.SMASH_CAN_RIRE<=this.rireCnt&&this.setSmashBtn()},e.prototype.recieveHane=function(t){void 0===t&&(t=!1),this.FLAG_REVERSE=t,this.recieveCnt=0;var e;this.FLAG_REVERSE?(this.recieveStartX=this.HANE_RECIEVE_OTOUTO_X,this.recieveStartY=this.HANE_RECIEVE_OTOUTO_Y,e=this.HANE_RECIEVE_SH_X-this.HANE_RECIEVE_OTOUTO_X):(this.recieveStartX=this.HANE_RECIEVE_SH_X,this.recieveStartY=this.HANE_RECIEVE_SH_Y,e=this.HANE_RECIEVE_OTOUTO_X-this.HANE_RECIEVE_SH_X),this.hane.x=this.recieveStartX,this.hane.y=this.recieveStartY,this.recievePower*=1.15,this.yosou_recieveCnt=2*this.recievePower*this.RADIAN_UP_SIN/this.GRAVITY*-1,this.defXperFrame=e/this.yosou_recieveCnt},e.prototype.setShStat=function(t){switch(this.shStat=t,t){case this.SH_STAT_STANDBY:this.boy.movieClipData=this.boyMcFactory.generateMovieClipData("boy_take_pass"),this.boy.gotoAndStop(1);break;case this.SH_STAT_RECIEVE:this.boy.movieClipData=this.boyMcFactory.generateMovieClipData("boy_take_pass2"),this.boy.gotoAndPlay(1),SoundManager.getInstance().playSound(SoundEnum.HITSOUND_MP3);break;case this.SH_STAT_SERVE:this.boy.movieClipData=this.boyMcFactory.generateMovieClipData("start_ball"),this.boy.gotoAndPlay(1);break;case this.SH_STAT_SMASH:this.boy.movieClipData=this.boyMcFactory.generateMovieClipData("boy_smash"),this.boy.gotoAndPlay(1);break;case this.SH_STAT_KIAI:this.boy.movieClipData=this.boyMcFactory.generateMovieClipData("fear"),this.boy.gotoAndPlay(1)}},e.prototype.setOtoutoStat=function(t){switch(this.otoutoStat=t,t){case this.OTOUTO_STAT_STANDBY:this.brother.movieClipData=this.brotherMcFactory.generateMovieClipData("brother_stand"),this.brother.gotoAndPlay(1),this.red_fire.stop(),this.red_fire.visible=!1;break;case this.OTOUTO_STAT_RECIEVE:this.brother.movieClipData=this.brotherMcFactory.generateMovieClipData("brother_take_pass"),this.brother.gotoAndPlay(1),this.red_fire.stop(),this.red_fire.visible=!1,SoundManager.getInstance().playSound(SoundEnum.HITSOUND_MP3);break;case this.OTOUTO_STAT_SMASH_REVERSE:this.brother.movieClipData=this.brotherMcFactory.generateMovieClipData("brother_smash"),this.brother.gotoAndPlay(1),this.red_fire.stop(),this.red_fire.visible=!1;break;case this.OTOUTO_STAT_KIAI:this.brother.movieClipData=this.brotherMcFactory.generateMovieClipData("brother_fear"),this.brother.gotoAndPlay(1),SoundManager.getInstance().playSound(SoundEnum.AURA2SOUND_MP3),this.red_fire.visible=!0,this.red_fire.play(-1)}},e.prototype.boyWin=function(){var t=RES.getRes("stage3_result_mc_json"),e=RES.getRes("stage3_result_mc_png"),i=new egret.MovieClipDataFactory(t,e),s=new egret.MovieClip(i.generateMovieClipData("clear_mc"));s.x=302.65,s.y=627.6,s.play(-1),Util.singletonPush(this.cards,8),this.FLAG_CLEAR=!0,this.container.addChild(s)},e.prototype.boyLoss=function(){SoundManager.getInstance().playSound(SoundEnum.BOKESOUND_MP3);var t=RES.getRes("stage3_result_mc_json"),e=RES.getRes("stage3_result_mc_png"),i=new egret.MovieClipDataFactory(t,e),s=new egret.MovieClip(i.generateMovieClipData("bad_mc"));s.x=302.65,s.y=627.6,s.play(-1),Util.singletonPush(this.cards,7),this.FLAG_GAME_OVER=!0,this.container.addChild(s)},e.prototype.toSpace=function(){var t=new egret.Sprite;t.x=320,t.y=560,this.addChild(t);var e=new TSBitmap("space",this.sheet);e.x=-440,e.y=-660,t.addChild(e);var i=new TSBitmap("sun",this.sheet,!0);i.x=-110,i.y=46,t.addChild(i),egret.Tween.get(i).to({x:-145,y:16},3e3);var s=new TSBitmap("jane2",this.sheet,!0);s.x=-109.05,s.y=-177.8,s.scaleX=s.scaleY=.7,egret.Tween.get(s).to({x:-120.05,y:-165.8,scaleX:.8,scaleY:.8},3e3),t.addChild(s);var h=new TSBitmap("jane3",this.sheet,!0);h.x=-109.05,h.y=-177.8,h.scaleX=h.scaleY=.7,h.alpha=100,t.addChild(h),egret.Tween.get(h).wait(100).to({alpha:0},2500),egret.Tween.get(h).to({x:-120.05,y:-165.8,scaleX:.8,scaleY:.8},3e3);var a=new TSBitmap("earth",this.sheet);a.x=-255,a.y=-189,t.addChild(a);var o=new TSBitmap("earth_shadow",this.sheet,!0);o.x=73,o.y=215,t.addChild(o),egret.Tween.get(h).to({x:63,y:240},100).to({x:61,y:245},100).to({x:60,y:247},100),Util.singletonPush(this.cards,9),this.FLAG_CLEAR=!0},e.prototype._loadRes=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,StageController.getInstance().loadStage(3)];case 1:return e.sent(),[3,3];case 2:return t=e.sent(),console.error(t),[3,3];case 3:return[2]}})})},e.prototype._start=function(){},e.prototype.play_loop=function(){var t=this;if(this.FLAG_CLEAR||this.FLAG_GAME_OVER)return this.COUNTER_END++,void(this.COUNTER_END>120&&(this.FLAG_CLEAR&&StageController.getInstance().clearStage(this.STAGE_ID,this.cards),this.FLAG_GAME_OVER&&StageController.getInstance().gameOverStage(this.STAGE_ID,this.cards)));if(this.FLAG_GAME_STARTED===!0&&this.shStat===this.SH_STAT_SERVE&&this.boy.isPlaying===!0&&this.boy.currentFrame>=16&&(SoundManager.getInstance().playSound(SoundEnum.HITSOUND_MP3),this.startRire(),this.hane.visible=!0,this.FLAG_GAME_STARTED=!1),this.smashStat==this.SMASH_STAT_NONE||this.smashStat==this.SMASH_STAT_SET)switch(this.rireStat){case this.RIRE_STAT_START:this.recieveCnt++,this.hane.x=this.hane.x+this.defXperFrame,this.hane.y=this.recievePower*this.recieveCnt+.5*this.recieveCnt*this.recieveCnt*this.GRAVITY+this.recieveStartY,this.FLAG_REVERSE?(this.yosou_recieveCnt<this.recieveCnt?(this.delCanReseave(),this.splash(2)):this.yosou_recieveCnt-8<=this.recieveCnt&&this.setCanReseave(),this.JIMEN_Y<this.hane.y&&(this.hane.y=this.JIMEN_Y,this.rireStat=this.RIRE_STAT_END,this.smash_btn.visible=!1,this.back_btn.visible=!1)):this.yosou_recieveCnt<=this.recieveCnt?this.rire_reverse():this.yosou_recieveCnt-2==this.recieveCnt&&this.setOtoutoStat(this.OTOUTO_STAT_RECIEVE),this.hane.y<=this.CLEAR_Y&&(this.smash_btn.visible=!1,this.back_btn.visible=!1,this.splash(3));var e=this.JIMEN_Y-this.hane.y;if(this.DISP_HEIGHT_MAX<e){var i=this.DISP_HEIGHT_MAX/e,s=this.container.scaleX;this.container.scaleX=i,this.container.scaleY=i,this.container.x-=(i-s)*this.ZOOM_STD_X,this.container.y-=(i-s)*this.ZOOM_STD_Y}else this.container.x=0,this.container.y=0,this.container.scaleX=1,this.container.scaleY=1}switch(this.smashStat){case this.SMASH_STAT_SET:this.SMASH_Y<this.hane.y&&(this.hane.y=this.SMASH_Y,this.smashStat=this.SMASH_STAT_START,this.smash());break;case this.SMASH_STAT_START:this.hane.y+=1;break;case this.SMASH_STAT_NONE:this.FLAG_REVERSE&&this.yosou_recieveCnt/2<this.recieveCnt&&this.SMASH_Y<this.hane.y&&this.delSmashBtn()}if(this.otoutoStat===this.OTOUTO_STAT_RECIEVE&&this.brother.currentFrame===this.brother.totalFrames){if(this.SMASH_CAN_RIRE<=this.rireCnt){var h=this.rireCnt-this.SMASH_CAN_RIRE,a=3;if(a-1>h%a)return void this.setOtoutoStat(this.OTOUTO_STAT_KIAI)}this.setOtoutoStat(this.OTOUTO_STAT_STANDBY)}if(this.shStat===this.SH_STAT_SMASH){if(16===this.boy.currentFrame&&SoundManager.getInstance().playSound(SoundEnum.SUBURISOUND_MP3),24===this.boy.currentFrame){var o=new TSBitmap("star",this.sheet,!0);o.x=this.boy.x+38,o.y=this.boy.y-170,this.addChild(o),egret.Tween.get(o).wait(800).call(function(){o.visible=!1}),SoundManager.getInstance().playSound(SoundEnum.SHINE2SOUND_MP3)}this.boy.currentFrame===this.boy.totalFrames&&(this.hane.visible=!1,this.smashHane.visible=!0,SoundManager.getInstance().playSound(SoundEnum.HITSOUND_MP3),this.otoutoStat===this.OTOUTO_STAT_KIAI?(egret.Tween.get(this.smashHane).to({x:500.3,y:673.25},300).call(function(){t.setOtoutoStat(t.OTOUTO_STAT_SMASH_REVERSE),SoundManager.getInstance().playSound(SoundEnum.HITSOUND_MP3)}).to({x:215.3-160,y:813.25},300).to({x:215.3-220},100),egret.Tween.get(this.smashHane).to({rotation:-85},350).to({rotation:58},240).to({rotation:-80},100),egret.Tween.get(this.boy).to({y:736},1500).call(function(){Util.singletonPush(t.cards,10),t.splash(2)})):(egret.Tween.get(this.smashHane).to({x:565.3,y:783.25},400).to({rotation:-45},100).to({x:615.3,rotation:-80},500),egret.Tween.get(this.boy).to({y:736},1500).call(function(){t.splash(1)})),this.shStat=this.SH_STAT_FINISH)}},e.prototype._remove=function(){egret.Tween.removeAllTweens()},e.prototype.registItem=function(t){},e.prototype.useItem=function(t,e,i){return!0},e.prototype.getDisplayArea=function(){return new egret.Rectangle},e.prototype.ctrl_right=function(){},e.prototype.ctrl_left=function(){},e.prototype.ctrl_up=function(){},e.prototype.ctrl_down=function(){},e.prototype.ctrl_ok=function(){},e.prototype.ctrl_cancel=function(){},e}(egret.DisplayObjectContainer);
__reflect(Stage3.prototype,"Stage3",["IFKaihiStage"]);var Stage30=function(t){function e(){var e=t.call(this)||this;return e.stageid=30,e.FLAG_END_GAMEOVER=!1,e.FLAG_END_CLEAR=!1,e.COUNTER_END=0,e.FLAG_AINMATE_PLAYING=!1,e.FLAG_BOY_EATING=!1,e.FLAG_BOY_BANANA_BAD=!1,e.FLAG_BOY_WATCH_SAND=!1,e.FLAG_PLAYING_QQB=!1,e.FLAG_PLAYING_MM=!1,e.FLAG_RING_FOUND=!1,e.FLAG_BOY_BIRD_BAD_PLAYING=!1,e.FLAG_BALL_STOPPING=!1,e.FLAG_NEW_BIRD_IN=!1,e.FLAG_RING_DROPPING=!1,e.FLAG_BOY_TREE_FINDING=!1,e.FLAG_JUMPING_TO_BALL=!1,e.FLAG_SH_USED_BAD=!1,e.FLAG_OTT_FIND_OUT=!1,e.FLAG_GREEN_FIND_OUT=!1,e.FLAG_OLD_AWAY=!1,e.FLAG_GARBAGE_BAD=!1,e.FLAG_OTT_FOUND=!1,e.FLAG_OTT_USED=!1,e.FLAG_XIAOMING_USED=!1,e.FLAG_SH_USED=!1,e.COUNTER_MC_HELP=0,e.FLAG_MM_STATUS=1,e.POSITION_LEFT=0,e.POSITION_MIDDLE=1,e.POSITION_RIGHT=2,e.BOY_Y=764.75,e.BOY_POSITION_LEFT=-101.2,e.BOY_POSITION_MIDDLE=304.8,e.BOY_POSITION_RIGHT=785,e.BOY_POSITION_LIST=[e.BOY_POSITION_LEFT,e.BOY_POSITION_MIDDLE,e.BOY_POSITION_RIGHT],e.FLAG_POSITION=e.POSITION_MIDDLE,e.cards=[],e.birdsX=[-27.75,43.6,3.3,-50.4,-9.25,43.6,-45.7,58.3,-3.4,43,-58.55,3.3],e.birdsY=[16.05,8.65,-2.65,-3.45,-21.1,-28.9,-43.65,-44.65,-53.45,-55.65,-66.45,-68.9],e.birdFlyX=[363.05,-262.35,-464.45,-464.45,393.25,377.5,302.2,393.25,155.9,-417.3,-447.65,-84.7],e.birdFlyY=[-570.15,-733.55,-337,-221.05,-181.3,-430.1,-659.45,-317.8,-733.5,-622.05,-482.65,-733.5],e.birdBackX=[-43.55,50,50,15,-18.35,-16.95,-51.55,-58.55,-45.5,51.6,40.4,29.65],e.birdBackY=[76,63.6,92.3,92.4,25,92.5,92.6,66.85,42.6,81,53.35,23.75],e._init(),e}return __extends(e,t),e.prototype._init=function(){return __awaiter(this,void 0,void 0,function(){var t,e,i,s,h,a;return __generator(this,function(o){switch(o.label){case 0:return UIManager.getInstance().showLoading(),[4,this._loadRes()];case 1:for(o.sent(),this.mcFactory=new egret.MovieClipDataFactory(RES.getRes("stage30_action_json"),RES.getRes("stage30_action_png")),this.ballFactory=new egret.MovieClipDataFactory(RES.getRes("stage30_ball_action_json"),RES.getRes("stage30_ball_action_png")),this.sheet=RES.getRes("stage30_texture"),this.container=new egret.Sprite,this.container.x=0,this.container.y=0,this.addChild(this.container),t=new TSBitmap("bg",this.sheet),t.x=-760,t.y=-100,this.container.addChild(t),e=new TSBitmap("ground",this.sheet),e.x=-760,e.y=422,this.container.addChild(e),i=new TSBitmap("wall",this.sheet),i.x=-760,i.y=370,this.container.addChild(i),this.clock=new TSBitmap("clock",this.sheet,!0),this.clock.x=-561.1,this.clock.y=285.9,this.clock.touchEnabled=!0,this.container.addChild(this.clock),this.ring=new TSBitmap("ring",this.sheet,!0),this.ring.x=917.65,this.ring.y=426.15,this.ring.visible=!1,this.container.addChild(this.ring),s=new TSBitmap("chair",this.sheet,!0),s.x=-534.8,s.y=560.9,this.container.addChild(s),this.sand=new TSBitmap("sand",this.sheet,!0),this.sand.x=-482.95,this.sand.y=765.1,this.sand.touchEnabled=!0,this.container.addChild(this.sand),this.tree=new TSBitmap("tree",this.sheet),this.tree.x=297.35,this.tree.y=638.65-466,this.tree.touchEnabled=!0,this.container.addChild(this.tree),this.bananaplace=new TSBitmap("bananaplace",this.sheet),this.bananaplace.x=465,this.bananaplace.y=644,this.container.addChild(this.bananaplace),this.bananaArea=new egret.Shape,this.bananaArea.graphics.beginFill(0),this.bananaArea.graphics.drawRect(465-this.bananaplace.width/2,644-this.bananaplace.height/2,80,80),this.bananaArea.graphics.endFill(),this.bananaArea.touchEnabled=!0,this.bananaArea.alpha=0,this.container.addChild(this.bananaArea),this.bananaSkin=new TSBitmap("bananaskin",this.sheet,!0),this.bananaSkin.x=482.45,this.bananaSkin.y=641.6,this.bananaSkin.visible=!1,this.bananaSkin.touchEnabled=!0,this.container.addChild(this.bananaSkin),this.treeMask=new egret.Shape,this.grass=new TSBitmap("grass",this.sheet,!0),this.grass.x=-109.95,this.grass.y=455.15,this.grass.touchEnabled=!0,this.container.addChild(this.grass),this.boy=new egret.MovieClip(this.mcFactory.generateMovieClipData("sh_stand")),this.boy.x=this.BOY_POSITION_MIDDLE,this.boy.y=this.BOY_Y,this.container.addChild(this.boy),this.popfriends=new egret.Sprite,this.popfriends.x=337.85,this.popfriends.y=700.35,this.container.addChild(this.popfriends),this.popfriendsInit(),this.garbage=new egret.MovieClip(this.mcFactory.generateMovieClipData("gbg")),this.garbage.x=1220.3,this.garbage.y=435.25,this.garbage.play(-1),this.garbage.touchEnabled=!0,this.container.addChild(this.garbage),this.green=new egret.MovieClip(this.mcFactory.generateMovieClipData("green_show")),this.green.gotoAndStop(1),this.green.x=526.4,this.green.y=528,this.container.addChild(this.green),this.green.visible=!1,this.red=new egret.MovieClip(this.ballFactory.generateMovieClipData("fball_red1")),this.container.addChild(this.red),this.red.visible=!1,this.ototo=new egret.MovieClip(this.mcFactory.generateMovieClipData("ott_up")),this.ototo.gotoAndStop(1),this.ototo.x=-504.65,this.ototo.y=532.3,this.ototo.touchEnabled=!1,this.container.addChild(this.ototo),this.old=new egret.MovieClip(this.mcFactory.generateMovieClipData("old_feed")),this.old.x=-502.5,this.old.y=539.25,this.old.play(-1),this.container.addChild(this.old),this.birds=new egret.Sprite,this.birds.x=-311.75,this.birds.y=632.35,this.container.addChild(this.birds),h=new egret.MovieClip,this.birdsArray=[],a=12;a>0;a--)h=new egret.MovieClip(this.mcFactory.generateMovieClipData("bird"+a+"_eat")),h.x=this.birdsX[a-1],h.y=this.birdsY[a-1],h.id=a,h.play(-1),this.birdsArray.push(h),this.birds.addChild(h);return this.birdsArae=new egret.Shape,this.birdsArae.graphics.beginFill(0),this.birdsArae.graphics.drawRect(-400.75,544.35,178.85,136.95),this.birdsArae.graphics.endFill(),this.birdsArae.touchEnabled=!0,this.birdsArae.alpha=0,this.container.addChild(this.birdsArae),this.qqb=new egret.MovieClip(this.mcFactory.generateMovieClipData("qqb1")),this.qqb.x=214.5,this.qqb.y=501.55,this.qqb.touchEnabled=!0,this.container.addChild(this.qqb),this.mm=new egret.MovieClip(this.mcFactory.generateMovieClipData("mm1")),this.mm.x=865.5,this.mm.y=512.55,this.mm.touchEnabled=!0,this.mm.gotoAndStop(1),this.container.addChild(this.mm),this.ball=new egret.MovieClip(this.ballFactory.generateMovieClipData("ball_fast")),this.ball.play(-1),this.ballFront=new egret.MovieClip,this.ballMiddle=new egret.MovieClip,this.ballBack=new egret.MovieClip,this.ballFront.visible=!1,this.ballMiddle.visible=!1,this.ballBack.visible=!1,this.ballSprite=new egret.Sprite,this.ballSprite.x=1131.2,this.ballSprite.y=664.7,this.ballSprite.touchEnabled=!0,this.ball.visible=!0,this.container.addChild(this.ballSprite),this.ballSprite.addChild(this.ball),this.ballSprite.addChild(this.ballFront),this.ballSprite.addChild(this.ballMiddle),this.ballSprite.addChild(this.ballBack),this.leftArrow=new TSBitmap("arrow_png"),this.leftArrow.x=40,this.leftArrow.y=510,this.leftArrow.touchEnabled=!0,this.addChild(this.leftArrow),this.rightArrow=new TSBitmap("arrow_png"),this.rightArrow.scaleX=-1,this.rightArrow.x=600,this.rightArrow.y=510,this.rightArrow.touchEnabled=!0,this.addChild(this.rightArrow),this.FLAG_POSITION=this.POSITION_MIDDLE,ItemController.getInstance().addItem(ItemEnum.ITEM_BANANA,!1),ItemCtrlView.getInstance().updateItems(!1),this.addAllEventListener(),UIManager.getInstance().hideLoading(),egret.Tween.get(this.garbage,{loop:!0}).to({rotation:3},50).to({rotation:-3},50).to({rotation:3},50).to({rotation:-3},50).to({rotation:3},50).to({rotation:-3},50).wait(400),[2]}})})},e.prototype.addAllEventListener=function(){this.FLAG_AINMATE_PLAYING=!1,this.FLAG_POSITION!==this.POSITION_LEFT&&(this.leftArrow.visible=!0),this.FLAG_POSITION!==this.POSITION_RIGHT&&(this.rightArrow.visible=!0),this.leftArrow.addEventListener(egret.TouchEvent.TOUCH_TAP,this.leftArrowTouched,this),this.rightArrow.addEventListener(egret.TouchEvent.TOUCH_TAP,this.rightArrowTouched,this),this.qqb.addEventListener(egret.TouchEvent.TOUCH_TAP,this.qqbTouched,this),this.tree.addEventListener(egret.TouchEvent.TOUCH_TAP,this.treeTouched,this),this.grass.addEventListener(egret.TouchEvent.TOUCH_TAP,this.grassTouched,this),this.mm.addEventListener(egret.TouchEvent.TOUCH_TAP,this.mmTouched,this),this.sand.addEventListener(egret.TouchEvent.TOUCH_TAP,this.sandTouched,this),this.ring.addEventListener(egret.TouchEvent.TOUCH_TAP,this.ringTouched,this),this.bananaSkin.addEventListener(egret.TouchEvent.TOUCH_TAP,this.bananaSkinTouched,this),this.birdsArae.addEventListener(egret.TouchEvent.TOUCH_TAP,this.birdsAraeTouched,this),this.green.addEventListener(egret.TouchEvent.TOUCH_TAP,this.greenTouched,this),this.ototo.addEventListener(egret.TouchEvent.TOUCH_TAP,this.ototoTouched,this),this.garbage.addEventListener(egret.TouchEvent.TOUCH_TAP,this.garbageTouched,this),this.ballSprite.addEventListener(egret.TouchEvent.TOUCH_TAP,this.ballTouched,this)},e.prototype.removeAllEventListener=function(){this.FLAG_AINMATE_PLAYING=!0,this.leftArrow.visible=!1,this.rightArrow.visible=!1,this.leftArrow.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.leftArrowTouched,this),this.rightArrow.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.rightArrowTouched,this),this.qqb.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.qqbTouched,this),this.tree.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.treeTouched,this),this.grass.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.grassTouched,this),this.mm.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.mmTouched,this),this.sand.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.sandTouched,this),this.ring.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.ringTouched,this),this.green.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.greenTouched,this),this.ototo.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.ototoTouched,this),this.birdsArae.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.birdsAraeTouched,this),this.garbage.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.garbageTouched,this),this.ballSprite.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.ballTouched,this)},e.prototype.garbageTouched=function(t){this.removeAllEventListener(),Util.singletonPush(this.cards,136),egret.Tween.removeTweens(this.garbage),this.boy.visible=!1,SoundManager.getInstance().playSound(SoundEnum.KARASUSOUND_MP3),this.garbage.movieClipData=this.mcFactory.generateMovieClipData("gbg_bad"),this.garbage.x=this.garbage.x,this.garbage.y=this.garbage.y,this.garbage.gotoAndPlay(1),this.FLAG_GARBAGE_BAD=!0},e.prototype.ballTouched=function(t){this.removeAllEventListener(),this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_jump"),this.boy.x=881.9,this.boy.y=735.1,this.boy.gotoAndPlay(1),this.red.gotoAndStop(1),this.red.visible=!0,this.FLAG_JUMPING_TO_BALL=!0},e.prototype.ballAction=function(){var t=this;this.FLAG_OTT_USED&&this.FLAG_XIAOMING_USED&&this.FLAG_SH_USED?(this.ball.visible=!1,this.ballFront.movieClipData=this.ballFactory.generateMovieClipData("ball_front"),this.ballFront.play(5),this.ballMiddle.movieClipData=this.ballFactory.generateMovieClipData("ball_mid"),this.ballMiddle.play(5),this.ballBack.movieClipData=this.ballFactory.generateMovieClipData("ball_back"),this.ballBack.play(5),this.ballFront.visible=this.ballMiddle.visible=this.ballBack.visible=!0,egret.Tween.get(this.container).wait(3e3).call(function(){t.FLAG_BALL_STOPPING=!0})):(this.ball.visible=!1,this.ballFront.movieClipData=this.ballFactory.generateMovieClipData("fball_front"),this.ballFront.play(-1),this.ballMiddle.movieClipData=this.ballFactory.generateMovieClipData("fball_mid"),this.ballMiddle.play(-1),this.ballBack.movieClipData=this.ballFactory.generateMovieClipData("fball_back"),this.ballBack.play(-1),this.ballFront.visible=this.ballMiddle.visible=this.ballBack.visible=!0)},e.prototype.birdsAraeTouched=function(t){Util.singletonPush(this.cards,143),this.removeAllEventListener(),this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_bird_runin"),this.boy.scaleX=1,this.boy.play(),this.old.movieClipData=this.mcFactory.generateMovieClipData("old_sit"),this.old.gotoAndPlay(1),this.FLAG_BOY_BIRD_BAD_PLAYING=!0},e.prototype.ototoTouched=function(t){this.FLAG_OTT_FOUND?this.registItem(ItemEnum.ITEM_BROTHER):(this.ototo.movieClipData=this.mcFactory.generateMovieClipData("ott_up"),this.ototo.gotoAndStop(this.ototo.totalFrames),this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_findout"),this.boy.x=-345.65,this.boy.y=531.75,this.boy.scaleX=1,this.boy.gotoAndPlay(1),this.FLAG_OTT_FIND_OUT=!0)},e.prototype.greenTouched=function(t){this.registItem(ItemEnum.ITEM_LITTLE_MING)},e.prototype.ringTouched=function(t){this.registItem(ItemEnum.ITEM_JUNGLE_BELL)},e.prototype.bananaSkinTouched=function(t){this.registItem(ItemEnum.ITEM_BANANA_SKIN)},e.prototype.mmTouched=function(t){this.removeAllEventListener(),SoundManager.getInstance().playSound(SoundEnum.BELL2SOUND_MP3),this.boy.visible=!1,this.mm.play(),this.FLAG_PLAYING_MM=!0},e.prototype.qqbTouched=function(t){Util.singletonPush(this.cards,141),this.removeAllEventListener(),this.popfriends.visible=!1,this.boy.visible=!1,this.qqb.movieClipData=this.mcFactory.generateMovieClipData("qqb2"),this.qqb.play(2),this.FLAG_PLAYING_QQB=!0},e.prototype.treeTouched=function(t){this.FLAG_GREEN_FIND_OUT||(this.removeAllEventListener(),this.popfriends.visible=!1,this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_treefind"),this.boy.x=426.8,this.boy.y=547.9,this.container.setChildIndex(this.boy,this.container.getChildIndex(this.tree)+1),this.boy.gotoAndPlay(1),this.green.movieClipData=this.mcFactory.generateMovieClipData("green_show"),this.green.visible=!0,this.green.x=526.4,this.green.y=528,this.green.gotoAndPlay(1),this.container.setChildIndex(this.green,this.container.getChildIndex(this.tree)),this.FLAG_BOY_TREE_FINDING=!0)},e.prototype.grassTouched=function(t){this.removeAllEventListener(),this.FLAG_BOY_WATCH_SAND=!0,this.boy.scaleY=.5,this.boy.scaleX=-.5,this.boy.x=-180.55,this.boy.y=422.4},e.prototype.sandTouched=function(t){this.removeAllEventListener(),Util.singletonPush(this.cards,142),this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_sand"),this.FLAG_BOY_WATCH_SAND=!0,this.boy.scaleX=1,this.boy.x=-474.5,this.boy.y=745.5},e.prototype.popfriendsInit=function(){var t=new TSBitmap("bpop",this.sheet);t.x=32,t.y=-25,this.popfriends.addChild(t);var e=new TSBitmap("lpop",this.sheet);e.x=5,e.y=-2,this.popfriends.addChild(e);var i=new TSBitmap("lpop",this.sheet);i.x=26,i.y=9,this.popfriends.addChild(i);var s=new TSBitmap("red",this.sheet);s.x=50,s.y=19,this.popfriends.addChild(s);var h=new TSBitmap("green",this.sheet);h.x=106,h.y=20,this.popfriends.addChild(h);var a=new TSBitmap("ott",this.sheet);a.x=85,a.y=-14,this.popfriends.addChild(a),s.scaleX=s.scaleY=h.scaleX=h.scaleY=a.scaleX=a.scaleY=.626663},e.prototype.shBackToStand=function(){this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_stand"),this.boy.x=this.BOY_POSITION_LIST[this.FLAG_POSITION],this.boy.y=this.BOY_Y,this.FLAG_POSITION===this.POSITION_LEFT?this.boy.scaleX=-1:this.boy.scaleX=1,this.boy.scaleY=1,this.boy.gotoAndStop(1),this.addAllEventListener()},e.prototype.shMove=function(t,e){var i=this;this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_move2"),this.boy.play(-1),this.boy.scaleX=e===this.POSITION_LEFT?-1:1,egret.Tween.get(this.boy).to({x:t},500).call(function(){i.shBackToStand(),i.addAllEventListener()})},e.prototype.birdFlayAway=function(){for(var t,e=this,i=0;i<this.birdsArray.length;i++)t=this.birdsArray[i],t.movieClipData=this.mcFactory.generateMovieClipData("bird_fly"),t.play(-1),egret.Tween.get(t).call(function(){t.scaleX=e.birdFlyX[i]>0?1:-1}).to({x:this.birdFlyX[i],y:this.birdFlyY[i],alpha:0},1e3).call(function(){t.visible=!1})},e.prototype.rightArrowTouched=function(t){this.removeAllEventListener(),this.popfriends.visible=!1,this.FLAG_POSITION===this.POSITION_LEFT?(this.leftArrow.visible=!0,this.FLAG_POSITION=this.POSITION_MIDDLE,egret.Tween.get(this.container).to({x:0},500).call(this.shMove,this,[this.BOY_POSITION_MIDDLE,this.POSITION_RIGHT])):this.FLAG_POSITION===this.POSITION_MIDDLE?(this.rightArrow.visible=!1,this.FLAG_POSITION=this.POSITION_RIGHT,egret.Tween.get(this.container).to({x:-640},500).call(this.shMove,this,[this.BOY_POSITION_RIGHT,this.POSITION_RIGHT])):this.addAllEventListener()},e.prototype.leftArrowTouched=function(t){this.removeAllEventListener(),this.popfriends.visible=!1,this.FLAG_POSITION===this.POSITION_MIDDLE?(this.leftArrow.visible=!1,this.FLAG_POSITION=this.POSITION_LEFT,egret.Tween.get(this.container).to({x:640},500).call(this.shMove,this,[this.BOY_POSITION_LEFT,this.POSITION_LEFT])):this.FLAG_POSITION===this.POSITION_RIGHT?(this.rightArrow.visible=!0,this.FLAG_POSITION=this.POSITION_MIDDLE,egret.Tween.get(this.container).to({x:0},500).call(this.shMove,this,[this.BOY_POSITION_MIDDLE,this.POSITION_LEFT])):this.addAllEventListener()},e.prototype._loadRes=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,StageController.getInstance().loadStage(this.stageid)];case 1:return e.sent(),[3,3];case 2:return t=e.sent(),console.error(t),[3,3];case 3:return[2]}})})},e.prototype._start=function(){},e.prototype.play_loop=function(){var t=this;if(this.FLAG_END_GAMEOVER||this.FLAG_END_CLEAR)return this.COUNTER_END++,void(this.COUNTER_END>=30&&(this.FLAG_END_CLEAR&&(Util.singletonPush(this.cards,139),StageController.getInstance().clearStage(this.stageid,this.cards)),this.FLAG_END_GAMEOVER&&StageController.getInstance().gameOverStage(this.stageid,this.cards)));if(this.FLAG_GARBAGE_BAD&&this.garbage.currentFrame===this.garbage.totalFrames&&(this.FLAG_END_GAMEOVER=!0),this.FLAG_JUMPING_TO_BALL&&(this.removeAllEventListener(),this.boy.currentFrame===this.boy.totalFrames&&(this.boy.movieClipData=this.ballFactory.generateMovieClipData("fball_sh1"),this.boy.x=1131.15,this.boy.y=683.7,this.boy.gotoAndStop(1),this.FLAG_JUMPING_TO_BALL=!1,this.FLAG_SH_USED=!0,this.FLAG_OTT_USED&&this.FLAG_XIAOMING_USED?this.ballAction():this.FLAG_OTT_USED||this.FLAG_XIAOMING_USED?Util.singletonPush(this.cards,138):Util.singletonPush(this.cards,137))),this.FLAG_SH_USED_BAD&&(this.FLAG_SH_USED_BAD=!1,this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_rotation"),this.boy.play(-1),egret.Tween.get(this.boy).to({x:1131.15-320,y:this.BOY_Y},500).call(function(){}).wait(1e3).call(function(){t.boy.movieClipData=t.mcFactory.generateMovieClipData("sh_crybad"),t.boy.play(-1),t.red.visible=!1,t.ototo.visible=!1,t.green.visible=!1,t.FLAG_END_GAMEOVER=!0})),this.FLAG_SH_USED&&(this.boy.currentFrame===this.boy.totalFrames?(this.boy.movieClipData===this.ballFactory.generateMovieClipData("fball_sh1")?(this.boy.movieClipData=this.ballFactory.generateMovieClipData("fball_sh2"),this.container.setChildIndex(this.boy,this.getChildIndex(this.ballSprite)+1),this.boy.x=1131.15-1.05,this.boy.y=654.95):this.boy.movieClipData===this.ballFactory.generateMovieClipData("fball_sh2")&&(this.container.setChildIndex(this.boy,this.getChildIndex(this.ballSprite)),this.boy.x=1125.75,this.boy.y=656.7,this.boy.movieClipData=this.ballFactory.generateMovieClipData("fball_sh1"),this.FLAG_OTT_USED&&this.FLAG_XIAOMING_USED||(this.FLAG_SH_USED=!1,this.FLAG_SH_USED_BAD=!0)),this.boy.gotoAndStop(1)):this.boy.nextFrame()),this.FLAG_OTT_USED&&(this.ototo.currentFrame===this.ototo.totalFrames?this.ototo.gotoAndStop(1):this.ototo.nextFrame()),(this.FLAG_OTT_USED||this.FLAG_XIAOMING_USED||this.FLAG_SH_USED)&&(this.red.currentFrame===this.red.totalFrames?(this.red.movieClipData===this.ballFactory.generateMovieClipData("fball_red1")?(this.red.movieClipData=this.ballFactory.generateMovieClipData("fball_red2"),this.container.setChildIndex(this.red,this.getChildIndex(this.ballSprite)+1),this.red.x=1131.15-1.05,this.red.y=654.95):this.red.movieClipData===this.ballFactory.generateMovieClipData("fball_red2")&&(this.container.setChildIndex(this.red,this.getChildIndex(this.ballSprite)),this.red.x=1125.75,this.red.y=656.7,this.red.movieClipData=this.ballFactory.generateMovieClipData("fball_red1")),this.red.gotoAndStop(1)):this.red.nextFrame()),this.FLAG_XIAOMING_USED&&(this.green.currentFrame===this.green.totalFrames?(this.green.movieClipData===this.ballFactory.generateMovieClipData("fball_green1")?(this.green.movieClipData=this.ballFactory.generateMovieClipData("fball_green2"),this.container.setChildIndex(this.green,this.getChildIndex(this.ballSprite)+1),this.green.x=1131.15-1.05,this.green.y=654.95):this.green.movieClipData===this.ballFactory.generateMovieClipData("fball_green2")&&(this.container.setChildIndex(this.green,this.getChildIndex(this.ballSprite)),this.green.x=1125.75,this.green.y=656.7,this.green.movieClipData=this.ballFactory.generateMovieClipData("fball_green1")),this.green.gotoAndStop(1)):this.green.nextFrame()),this.FLAG_BALL_STOPPING){this.FLAG_SH_USED=!1,this.FLAG_OTT_USED=!1,this.FLAG_XIAOMING_USED=!1,this.ballFront.visible=!1,this.ballMiddle.visible=!1,this.ballBack.visible=!1,this.ball.movieClipData=this.ballFactory.generateMovieClipData("ball_stop"),this.ball.visible=!0,this.ball.y=this.ball.height/2,this.ball.gotoAndStop(1),egret.Tween.removeAllTweens();var e=new egret.MovieClip(this.mcFactory.generateMovieClipData("clear"));this.boy.visible=!1,this.ototo.visible=!1,this.green.visible=!1,this.red.visible=!1,e.x=827.75,e.y=728.5,this.container.addChild(e),this.FLAG_END_CLEAR=!0}if(this.FLAG_BOY_TREE_FINDING&&this.boy.currentFrame===this.boy.totalFrames&&(this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_move"),this.boy.play(-1),this.container.setChildIndex(this.boy,this.container.getChildIndex(this.tree)),this.boy.x=402.25,this.boy.y=529.45,this.boy.scaleX=-1,egret.Tween.get(this.boy).to({x:536.8,y:541.65},900).call(function(){t.boy.scaleX=1,t.container.setChildIndex(t.boy,t.container.getChildIndex(t.tree)+1)}),this.green.movieClipData=this.mcFactory.generateMovieClipData("green_move"),this.green.scaleX=1,this.green.play(-1),this.container.setChildIndex(this.green,this.container.getChildIndex(this.tree)+1),this.green.x=537.25,this.green.y=541.65,this.bananaSkin.visible?egret.Tween.get(this.green).to({x:503.25,y:554.25},500).call(function(){t.green.movieClipData=t.mcFactory.generateMovieClipData("green_fall"),t.green.gotoAndPlay(1),t.boy.movieClipData=t.mcFactory.generateMovieClipData("sh_findout"),t.boy.gotoAndPlay(1),egret.Tween.get(t.bananaSkin).wait(200).to({x:442.45,y:581.6},500).to({x:402.45,y:641.6},500)}).wait(2e3).call(function(){t.shBackToStand(),t.green.movieClipData=t.mcFactory.generateMovieClipData("green_stand"),t.container.setChildIndex(t.green,t.container.getChildIndex(t.boy)),t.green.gotoAndStop(1),t.green.touchEnabled=!0,t.green.x=171.45,t.green.y=719.65,t.bananaSkin.visible=!1,t.FLAG_GREEN_FIND_OUT=!0}):egret.Tween.get(this.green).to({x:503.25,y:554.25},500).to({x:402.25,y:529.45},500).call(function(){t.green.scaleX=-1,t.container.setChildIndex(t.green,t.container.getChildIndex(t.tree)),egret.Tween.get(t.boy).to({x:462.9,y:566.3},480).call(function(){t.shBackToStand()})}).to({x:471.65,y:513.45},500).call(function(){t.green.visible=!1,t.green.scaleX=1,t.container.setChildIndex(t.green,t.container.getChildIndex(t.tree)),t.green.gotoAndStop(1)}),this.FLAG_BOY_TREE_FINDING=!1),this.FLAG_BOY_EATING&&this.boy.currentFrame===this.boy.totalFrames&&(this.shBackToStand(),this.registItem(ItemEnum.ITEM_BANANA_SKIN),this.FLAG_BOY_EATING=!1),this.FLAG_BOY_BANANA_BAD&&this.boy.currentFrame===this.boy.totalFrames&&(egret.Tween.get(this.boy).wait(1e3).call(function(){t.registItem(ItemEnum.ITEM_BANANA_SKIN),t.shBackToStand()}),this.FLAG_BOY_BANANA_BAD=!1),this.FLAG_BOY_WATCH_SAND&&(this.COUNTER_MC_HELP++,this.COUNTER_MC_HELP>=30&&(this.shBackToStand(),this.FLAG_BOY_WATCH_SAND=!1,this.COUNTER_MC_HELP=0)),this.FLAG_OTT_FIND_OUT&&(this.COUNTER_MC_HELP++,this.COUNTER_MC_HELP>=60&&(this.shBackToStand(),this.ototo.movieClipData=this.mcFactory.generateMovieClipData("ott_stand"),this.container.setChildIndex(this.ototo,this.container.getChildIndex(this.boy)),this.ototo.gotoAndStop(1),this.ototo.touchEnabled=!0,this.ototo.x=82.25,this.ototo.y=760.5,this.COUNTER_MC_HELP=0,this.FLAG_OTT_FOUND=!0,this.FLAG_OTT_FIND_OUT=!1)),this.FLAG_PLAYING_QQB&&this.qqb.isPlaying===!1&&(this.boy.visible=!0,this.shBackToStand(),this.qqb.movieClipData=this.mcFactory.generateMovieClipData("qqb1"),this.qqb.gotoAndStop(1),this.FLAG_PLAYING_QQB=!1),this.FLAG_RING_DROPPING&&(this.ring.y+=7,this.ring.x++,this.ring.rotation++,this.ring.y>512.05&&(SoundManager.getInstance().playSound(SoundEnum.BELL3SOUND_MP3),this.ring.rotation-=10,this.ring.touchEnabled=!0,this.FLAG_RING_DROPPING=!1)),this.FLAG_PLAYING_MM&&this.mm.currentFrame===this.mm.totalFrames&&(this.boy.visible=!0,this.FLAG_PLAYING_MM=!1,this.FLAG_MM_STATUS<4&&(this.FLAG_MM_STATUS=this.FLAG_MM_STATUS+1,this.mm.movieClipData=this.mcFactory.generateMovieClipData("mm"+this.FLAG_MM_STATUS),this.mm.gotoAndStop(1)),4===this.FLAG_MM_STATUS&&(this.FLAG_RING_FOUND||(this.ring.visible=!0,this.FLAG_RING_FOUND=!0,this.FLAG_RING_DROPPING=!0),this.mm.movieClipData=this.mcFactory.generateMovieClipData("mm4"),this.mm.gotoAndStop(1)),this.shBackToStand()),this.FLAG_BOY_BIRD_BAD_PLAYING)if(30===this.boy.currentFrame){this.FLAG_BOY_BIRD_BAD_PLAYING=!1;for(var i,s=this.birdBackY.sort(function(t,e){return t>e?t:e}),h=function(){var e=a.birdBackY.indexOf(s[o]);i=a.birdsArray[e],i.movieClipData=a.mcFactory.generateMovieClipData("bird_fly"),i.play(-1),a.birdBackY[e]-70+108>543.85&&a.container.setChildIndex(i,a.container.getChildIndex(a.boy)),egret.Tween.get(i).call(function(){i.scaleX=t.birdFlyX[e]>0?1:-1}).to({x:a.birdFlyX[e],y:a.birdFlyY[e]},1e3).wait(1e3).call(function(){i.scaleX=t.birdFlyX[e]<0?1:-1}).to({x:a.birdBackX[e],y:a.birdBackY[e]-70},1e3).wait(1e3).call(a.birdBack,a,[i,o])},a=this,o=0;o<s.length;o++)h()}else this.boy.currentFrame>30&&this.boy.gotoAndPlay(30);if(this.FLAG_NEW_BIRD_IN){var n=new egret.MovieClip(this.mcFactory.generateMovieClipData("bird_fly"));n.x=-402.6,n.y=8,n.play(-1),n.scaleX=-1,this.container.addChild(n),egret.Tween.get(n).to({x:-311,y:435.35},1e3).call(function(){n.movieClipData=t.mcFactory.generateMovieClipData("bird1_eat"),n.play(-1),t.boy.movieClipData=t.mcFactory.generateMovieClipData("sh_bird_bad"),t.boy.x=-318,t.boy.y=543.85,t.boy.gotoAndPlay(1),t.FLAG_END_GAMEOVER=!0}),this.FLAG_NEW_BIRD_IN=!1}},e.prototype.birdBack=function(t,e){t.movieClipData=this.mcFactory.generateMovieClipData("bird"+t.id+"_eat"),t.play(-1),this.birdsArray.length-1===e&&(this.FLAG_NEW_BIRD_IN=!0)},e.prototype._remove=function(){egret.Tween.removeAllTweens()},e.prototype.registItem=function(t){if(ItemController.getInstance().addItem(t))switch(t){case ItemEnum.ITEM_BROTHER:this.ototo.visible=!1;break;case ItemEnum.ITEM_JUNGLE_BELL:this.ring.visible=!1;break;case ItemEnum.ITEM_LITTLE_MING:this.green.visible=!1;break;case ItemEnum.ITEM_BANANA:break;case ItemEnum.ITEM_BANANA_SKIN:this.bananaSkin.visible&&(this.bananaSkin.visible=!1,this.bananaplace.visible=!0)}},e.prototype.useItem=function(t,e,i){var s=this;if(this.FLAG_AINMATE_PLAYING)return!1;switch(t){case ItemEnum.ITEM_BROTHER:return this.ball.hitTestPoint(e,i)?(SoundManager.getInstance().playSound(SoundEnum.JUMPSOUND_MP3),this.ototo.movieClipData=this.ballFactory.generateMovieClipData("fball_ott1"),this.ototo.x=1131.15,this.ototo.y=683.7,this.red.x=1131.15,this.red.y=683.7,this.red.gotoAndStop(1),this.ototo.gotoAndStop(1),this.FLAG_OTT_USED=!0,this.red.visible=!0,this.ototo.visible=!0,this.ballAction(),!0):!1;case ItemEnum.ITEM_LITTLE_MING:return this.ball.hitTestPoint(e,i)?(SoundManager.getInstance().playSound(SoundEnum.JUMPSOUND_MP3),this.green.movieClipData=this.ballFactory.generateMovieClipData("fball_green1"),this.green.x=1131.15,this.green.y=683.7,this.red.x=1131.15,this.red.y=683.7,this.green.visible=!0,this.green.gotoAndStop(1),this.red.gotoAndStop(1),this.FLAG_XIAOMING_USED=!0,this.red.visible=!0,this.ballAction(),!0):!1;case ItemEnum.ITEM_BANANA:return this.popfriends.visible=!1,this.boy.hitTestPoint(e,i)?(SoundManager.getInstance().playSound(SoundEnum.EATSOUND_MP3),this.removeAllEventListener(),this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_eat"),this.boy.gotoAndPlay(1),this.FLAG_BOY_EATING=!0,!0):!1;case ItemEnum.ITEM_BANANA_SKIN:return this.bananaArea.hitTestPoint(e,i)?(this.bananaSkin.visible=!0,this.bananaplace.visible=!1,!0):this.boy.hitTestPoint(e,i)?(Util.singletonPush(this.cards,140),this.removeAllEventListener(),this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_standbanana"),this.boy.gotoAndStop(1),this.FLAG_BOY_BANANA_BAD=!0,!0):!1;case ItemEnum.ITEM_JUNGLE_BELL:if(this.clock.hitTestPoint(e,i))return SoundManager.getInstance().playSound(SoundEnum.BELL3SOUND_MP3),this.ring.visible=!0,this.ring.anchorOffsetX=this.ring.width/2,this.ring.anchorOffsetY=0,this.ring.x=-559.85,this.ring.y=156.95-this.ring.height/2,this.ring.touchEnabled=!1,egret.Tween.get(this.ring,{loop:!0}).to({rotation:60},100).to({rotation:-60},100),egret.Tween.get(this.clock).to({loop:!0}).to({x:-558.1},100).to({x:-564.1},100),this.birdFlayAway(),egret.Tween.get(this.old).wait(1e3).call(function(){s.old.movieClipData=s.mcFactory.generateMovieClipData("old_sigh"),SoundManager.getInstance().playSound(SoundEnum.BELL3SOUND_MP3)}).wait(1e3).call(function(){egret.Tween.removeTweens(s.ring),s.ring.rotation=0,egret.Tween.removeTweens(s.clock),s.clock.x=-561.1,s.old.movieClipData=s.mcFactory.generateMovieClipData("old_away"),s.old.x=-419.65,s.old.y=508.2,s.old.play(-1)}).to({x:-426.65,y:423.6,scaleX:79.5135/100,scaleY:79.5135/100},2e3).to({x:-433.45,y:385.2,scaleX:53.6835/100,scaleY:53.6835/100},2500).to({x:-433.45,y:395.2,scaleX:33.9081/100,scaleY:33.9081/100,alpha:0},3500).call(function(){s.ototo.touchEnabled=!0,s.addAllEventListener(),s.FLAG_OLD_AWAY}),!0}return!1},e.prototype.getDisplayArea=function(){return new egret.Rectangle},e.prototype.ctrl_right=function(){},e.prototype.ctrl_left=function(){},e.prototype.ctrl_up=function(){},e.prototype.ctrl_down=function(){},e.prototype.ctrl_ok=function(){},e.prototype.ctrl_cancel=function(){},e}(egret.DisplayObjectContainer);__reflect(Stage30.prototype,"Stage30",["IFKaihiStage"]);var Stage4=function(t){function e(){var e=t.call(this)||this;return e.STAGE_ID=4,e.FLAG_STAGE_INIT=!1,e.FLAG_GOT_PIPE=!1,e.FLAG_PIPE_NOT_KIKEN=!1,e.FLAG_PIPE_CONNECT=!1,e.FLAG_ASAGAO_WATERING=!1,e.FLAG_ASAGAO_HAND_WATERING=!1,e.MCHELP_SNAKE_STEP=0,e.MCHELP_PIPE_STEP=0,e.MCHELP_BOOM_PIPE_STEP=0,e.MCHELP_FAIL_STEP=0,e.MCHELP_UNUSED_STEP=0,e.MCHELP_PLAYING_HAND_WATERING=!1,e.USE_HAND_TIME=0,e.COUNTER_SNAKE=0,e.COUNTER_FAN=0,e.COUNTER_WATER_BOOM=0,e.FLAG_CLEAR_1=!1,e.FLAG_CLEAR_2=!1,e.FLAG_GAMEOVER_1=!1,e.FLAG_GAMEOVER_2=!1,e.FLAG_GAMEOVER_3=!1,e.COUNTER_END=0,e.bar_opened=!1,e.cards=[],e._init(),e}return __extends(e,t),e.prototype._init=function(){return __awaiter(this,void 0,void 0,function(){var t,e,i,s,h,a,o,n,r,l,c,d,_,g,p;return __generator(this,function(u){switch(u.label){case 0:return UIManager.getInstance().showLoading(),[4,this._loadRes()];case 1:return u.sent(),UIManager.getInstance().hideLoading(),this.sheet=RES.getRes("stage4_texture"),t=new TSBitmap("bg",this.sheet),t.x=-120,t.y=-150,this.addChild(t),e=new TSBitmap("garden",this.sheet),e.x=-120,e.y=609,this.addChild(e),i=new TSBitmap("bali",this.sheet),i.x=-120,i.y=485,this.addChild(i),s=new TSBitmap("house",this.sheet),s.x=253,s.y=188,this.addChild(s),h=RES.getRes("stage4_boy_action_json"),a=RES.getRes("stage4_boy_action_png"),this.boyActionFactary=new egret.MovieClipDataFactory(h,a),o=RES.getRes("stage4_othermc_json"),n=RES.getRes("stage4_othermc_png"),this.otherMcFactary=new egret.MovieClipDataFactory(o,n),r=RES.getRes("stage4_snake_json"),l=RES.getRes("stage4_snake_png"),this.snakeFactory=new egret.MovieClipDataFactory(r,l),c=RES.getRes("stage4_asagao_action_json"),d=RES.getRes("stage4_asagao_action_png"),this.asagaoFactory=new egret.MovieClipDataFactory(c,d),_=RES.getRes("stage4_hut_fly_json"),g=RES.getRes("stage4_hut_fly_png"),p=new egret.MovieClipDataFactory(_,g),this.mizuSprite=new egret.Sprite,this.mizuSprite.x=554.2,this.mizuSprite.y=698,this.addChild(this.mizuSprite),this.mizubar=new egret.MovieClip(this.otherMcFactary.generateMovieClipData("mizubar")),this.mizubar.x=0,this.mizubar.y=0,this.mizubar.gotoAndStop(1),this.mizuSprite.addChild(this.mizubar),this.mizu=new egret.MovieClip(this.otherMcFactary.generateMovieClipData("mizu")),this.mizu.x=.25,this.mizu.y=8.8,this.mizu.visible=!1,this.mizu.gotoAndStop(1),this.mizuSprite.addChild(this.mizu),this.pipe0=new TSBitmap("pipe0",this.sheet),this.pipe0.anchorOffsetX=this.pipe0.width/2,this.pipe0.anchorOffsetY=this.pipe0.height/2,this.pipe0.x=57,this.pipe0.y=617,this.addChild(this.pipe0),this.pipe1=new TSBitmap("pipe1",this.sheet),this.pipe1.anchorOffsetX=this.pipe1.width/2,this.pipe1.anchorOffsetY=this.pipe1.height/2,this.pipe1.x=555.35,this.pipe1.y=759.15,this.pipe1.visible=!1,this.addChild(this.pipe1),this.pipe2=new TSBitmap("pipe2",this.sheet),this.pipe2.anchorOffsetX=this.pipe2.width/2,this.pipe2.anchorOffsetY=this.pipe2.height/2,this.pipe2.x=418.85,this.pipe2.y=911.7,this.pipe2.visible=!1,this.addChild(this.pipe2),this.pipe3=new TSBitmap("pipe3",this.sheet),this.pipe3.anchorOffsetX=this.pipe3.width/2,this.pipe3.anchorOffsetY=this.pipe3.height/2,this.pipe3.x=555.35,this.pipe3.y=759.15,this.pipe3.visible=!1,this.addChild(this.pipe3),this.fan=new egret.MovieClip(this.otherMcFactary.generateMovieClipData("senpuki_mc")),this.fan.x=459.85,this.fan.y=560,this.fan.gotoAndStop(1),this.addChild(this.fan),this.wind=new egret.MovieClip(this.otherMcFactary.generateMovieClipData("mc_wind")),this.wind.x=177.1,this.wind.y=767,this.wind.visible=!1,this.wind.gotoAndStop(1),this.addChild(this.wind),this.snake=new egret.MovieClip(this.snakeFactory.generateMovieClipData("tail")),this.snake.x=200.65,this.snake.y=618,this.snake.gotoAndStop(1),this.addChild(this.snake),this.boy=new egret.MovieClip(this.boyActionFactary.generateMovieClipData("sh_standby")),this.boy.x=300.8,this.boy.y=789.5,this.addChild(this.boy),this.hut=new egret.MovieClip(p.generateMovieClipData("hut_fly")),this.hut.x=301.65,this.hut.y=675.15,this.hut.visible=!1,this.hut.gotoAndStop(1),this.addChild(this.hut),this.asagao=new egret.MovieClip(this.asagaoFactory.generateMovieClipData("asagao_bad")),this.asagao.x=159.65,this.asagao.y=879.45,this.asagao.gotoAndStop(1),this.addChild(this.asagao),this.water=new egret.MovieClip(this.otherMcFactary.generateMovieClipData("water")),this.water.x=204.55,this.water.y=852.8,this.water.visible=!1,this.addChild(this.water),this.pipeTouchArea=new egret.Shape,this.pipeTouchArea.graphics.beginFill(255),this.pipeTouchArea.x=284.45,this.pipeTouchArea.y=877.8,this.pipeTouchArea.alpha=0,this.pipeTouchArea.graphics.drawRect(0,0,80,80),this.pipeTouchArea.graphics.endFill(),this.addChild(this.pipeTouchArea),this.pipe0.touchEnabled=!0,this.pipe0.addEventListener(egret.TouchEvent.TOUCH_TAP,this.pipeTouched,this),this.snake.touchEnabled=!0,this.snake.addEventListener(egret.TouchEvent.TOUCH_TAP,this.snakeTouched,this),this.fan.touchEnabled=!0,this.fan.addEventListener(egret.TouchEvent.TOUCH_TAP,this.fanTouched,this),this.mizuSprite.touchEnabled=!0,this.mizuSprite.addEventListener(egret.TouchEvent.TOUCH_TAP,this.mizuTouched,this),this.asagao.touchEnabled=!0,this.asagao.addEventListener(egret.TouchEvent.TOUCH_TAP,this.flowerTouched,this),this.pipeTouchArea.addEventListener(egret.TouchEvent.TOUCH_TAP,this.pipeAreaTouched,this),this.pipeTouchArea.touchEnabled=!1,this.addAllEventListener(),this.cards=[],this.FLAG_STAGE_INIT=!0,[2]
}})})},e.prototype.addAllEventListener=function(){this.pipe0.touchEnabled=!0,this.pipe0.addEventListener(egret.TouchEvent.TOUCH_TAP,this.pipeTouched,this),this.snake.touchEnabled=!0,this.snake.addEventListener(egret.TouchEvent.TOUCH_TAP,this.snakeTouched,this),this.fan.touchEnabled=!0,this.fan.addEventListener(egret.TouchEvent.TOUCH_TAP,this.fanTouched,this),this.mizuSprite.touchEnabled=!0,this.mizuSprite.addEventListener(egret.TouchEvent.TOUCH_TAP,this.mizuTouched,this),this.asagao.touchEnabled=!0,this.asagao.addEventListener(egret.TouchEvent.TOUCH_TAP,this.flowerTouched,this),this.pipeTouchArea.addEventListener(egret.TouchEvent.TOUCH_TAP,this.pipeAreaTouched,this)},e.prototype.removeAllEventListener=function(){this.pipe0.touchEnabled=!1,this.pipe0.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.pipeTouched,this),this.snake.touchEnabled=!1,this.snake.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.snakeTouched,this),this.fan.touchEnabled=!1,this.fan.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.fanTouched,this),this.mizuSprite.touchEnabled=!1,this.mizuSprite.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.mizuTouched,this),this.asagao.touchEnabled=!1,this.asagao.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.flowerTouched,this),this.pipeTouchArea.touchEnabled=!1,this.pipeTouchArea.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.pipeAreaTouched,this)},e.prototype.pipeAreaTouched=function(){this.FLAG_PIPE_NOT_KIKEN===!1&&(SoundManager.getInstance().playSound(SoundEnum.PUYONSOUND_MP3),this.boy.movieClipData=this.boyActionFactary.generateMovieClipData("sh_kamae"),this.boy.gotoAndPlay(1),this.FLAG_PIPE_NOT_KIKEN=!0,this.pipeTouchArea.touchEnabled=!1)},e.prototype.pipeTouched=function(){this.pipe0.visible=!1,this.pipe0.touchEnabled=!1,this.boy.movieClipData=this.boyActionFactary.generateMovieClipData("horse_touch"),this.boy.x=112.6,this.boy.y=551.25,this.boy.gotoAndPlay(1),this.MCHELP_PIPE_STEP=1,this.asagao.touchEnabled=!1,this.removeAllEventListener()},e.prototype.snakeTouched=function(){this.removeAllEventListener(),this.MCHELP_SNAKE_STEP=1,this.FLAG_GOT_PIPE?(this.snake.movieClipData=this.snakeFactory.generateMovieClipData("attack2"),this.snake.gotoAndPlay(1),Util.singletonPush(this.cards,13)):(this.snake.movieClipData=this.snakeFactory.generateMovieClipData("attack"),this.snake.gotoAndPlay(1),Util.singletonPush(this.cards,12),this.boy.movieClipData=this.boyActionFactary.generateMovieClipData("sh_hebi_touch"),this.boy.x=232.2,this.boy.y=567.25)},e.prototype.fanTouched=function(){this.removeAllEventListener(),Util.singletonPush(this.cards,11),this.FLAG_GOT_PIPE?(this.fan.play(-1),this.asagao.play(),this.boy.movieClipData=this.boyActionFactary.generateMovieClipData("sh_hut_fly"),this.boy.x=300.85,this.boy.y=790.35,this.boy.gotoAndPlay(1),this.wind.visible=!0,this.wind.play(-1),this.hut.visible=!0,this.hut.gotoAndPlay(1),this.MCHELP_FAIL_STEP=1,this.pipe2.visible=!0):(this.fan.play(-1),this.asagao.play(),this.boy.movieClipData=this.boyActionFactary.generateMovieClipData("sh_hut_fly"),this.boy.x=300.85,this.boy.y=790.35,this.boy.gotoAndPlay(1),this.wind.visible=!0,this.wind.play(-1),this.hut.visible=!0,this.hut.gotoAndPlay(1),this.MCHELP_FAIL_STEP=1)},e.prototype.mizuTouched=function(){this.FLAG_PIPE_CONNECT&&!this.FLAG_PIPE_NOT_KIKEN?(SoundManager.getInstance().playSound(SoundEnum.VALVESOUND_MP3),this.removeAllEventListener(),this.boy.movieClipData=this.boyActionFactary.generateMovieClipData("sh_horse_kiken"),this.boy.x=366.3,this.boy.y=797.8,this.boy.gotoAndPlay(1),this.MCHELP_BOOM_PIPE_STEP=1,this.bar_opened=!0):!this.FLAG_PIPE_CONNECT&&this.FLAG_PIPE_NOT_KIKEN?(SoundManager.getInstance().playSound(SoundEnum.VALVESOUND_MP3),this.bar_opened===!0?(this.mizubar.gotoAndStop(2),this.mizu.visible=!1,this.mizu.stop()):(SoundManager.getInstance().playSound(SoundEnum.WATER7SOUND_MP3),this.mizubar.gotoAndStop(1),this.mizu.visible=!0,this.mizu.play(-1)),this.bar_opened=!this.bar_opened):this.FLAG_PIPE_CONNECT&&this.FLAG_PIPE_NOT_KIKEN?(SoundManager.getInstance().playSound(SoundEnum.VALVESOUND_MP3),this.FLAG_ASAGAO_WATERING=!0,this.boy.movieClipData=this.boyActionFactary.generateMovieClipData("sh_mizuyari"),this.boy.play(-1),this.water.visible=!0,this.water.play(-1),this.asagao.movieClipData=this.asagaoFactory.generateMovieClipData("asagao_kare"),this.asagao.gotoAndPlay(1),this.bar_opened=!0):this.FLAG_PIPE_CONNECT||this.FLAG_PIPE_NOT_KIKEN||(SoundManager.getInstance().playSound(SoundEnum.VALVESOUND_MP3),this.FLAG_GOT_PIPE?(this.bar_opened===!0?(this.mizubar.gotoAndStop(2),this.mizu.visible=!1,this.mizu.stop()):(SoundManager.getInstance().playSound(SoundEnum.WATER7SOUND_MP3),this.mizubar.gotoAndStop(1),this.mizu.visible=!0,this.mizu.play(-1)),this.bar_opened=!this.bar_opened):(SoundManager.getInstance().playSound(SoundEnum.VALVESOUND_MP3),this.MCHELP_PLAYING_HAND_WATERING=!0,this.boy.movieClipData=this.boyActionFactary.generateMovieClipData("sh_hand_mizu"),this.boy.x=378.2,this.boy.y=745.8,this.boy.gotoAndPlay(1),this.mizubar.gotoAndPlay(1),this.MCHELP_UNUSED_STEP=1,this.bar_opened=!0,Util.singletonPush(this.cards,16),this.removeAllEventListener()))},e.prototype.flowerTouched=function(){this.boy.movieClipData=this.boyActionFactary.generateMovieClipData("sh_mochiage"),this.boy.x=180.85,this.boy.y=845.1,this.boy.gotoAndPlay(1),this.asagao.visible=!1,this.MCHELP_UNUSED_STEP=1,Util.singletonPush(this.cards,18)},e.prototype.pipe1Touched=function(){this.pipe1.visible=!1,this.pipe3.visible=!0,this.FLAG_PIPE_CONNECT=!0,this.bar_opened&&(this.mizu.visible=!1,this.mizu.stop())},e.prototype._loadRes=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,StageController.getInstance().loadStage(4)];case 1:return e.sent(),[3,3];case 2:return t=e.sent(),console.error(t),[3,3];case 3:return[2]}})})},e.prototype._start=function(){},e.prototype.play_loop=function(){if(this.FLAG_CLEAR_1||this.FLAG_CLEAR_2||this.FLAG_GAMEOVER_1||this.FLAG_GAMEOVER_2||this.FLAG_GAMEOVER_3)return void((this.FLAG_CLEAR_1||this.FLAG_CLEAR_2)&&(this.COUNTER_END++,this.COUNTER_END>100&&StageController.getInstance().clearStage(this.STAGE_ID,this.cards)));if(this.FLAG_STAGE_INIT&&0===this.MCHELP_SNAKE_STEP&&Util.loopPlay(this.snake),this.MCHELP_PLAYING_HAND_WATERING&&this.boy.currentFrame==this.boy.totalFrames&&(this.MCHELP_PLAYING_HAND_WATERING=!1,this.USE_HAND_TIME++,this.USE_HAND_TIME>10?(this.FLAG_ASAGAO_HAND_WATERING=!0,this.asagao.movieClipData=this.asagaoFactory.generateMovieClipData("asagao_kare"),this.asagao.gotoAndPlay(1)):this.addAllEventListener()),1===this.MCHELP_PIPE_STEP&&this.boy.totalFrames===this.boy.currentFrame&&(this.MCHELP_PIPE_STEP=2,this.boy.x=364.3,this.boy.y=797.8,this.boy.movieClipData=this.boyActionFactary.generateMovieClipData("sh_kamae"),this.boy.gotoAndStop(1),this.pipe1.visible=!0,this.pipe1.touchEnabled=!0,this.pipe1.addEventListener(egret.TouchEvent.TOUCH_TAP,this.pipe1Touched,this),this.FLAG_GOT_PIPE=!0,this.pipeTouchArea.touchEnabled=!0,this.addAllEventListener()),1===this.MCHELP_SNAKE_STEP&&this.snake.totalFrames===this.snake.currentFrame&&(this.MCHELP_SNAKE_STEP=2,SoundManager.getInstance().playSound(SoundEnum.ASERISOUND_MP3),this.boy.movieClipData=this.boyActionFactary.generateMovieClipData("sh_bad_kamae_hebi"),this.boy.gotoAndStop(1),this.snake.visible=!1,this.removeAllEventListener(),this.FLAG_GOT_PIPE?(this.boy.x=301.6,this.boy.y=790.35,this.pipe2.visible=!0):(this.boy.x=230.6,this.boy.y=551.25)),2===this.MCHELP_SNAKE_STEP&&this.boy.currentFrame===this.boy.totalFrames&&(30===this.COUNTER_SNAKE&&(this.FLAG_GAMEOVER_2=!0,StageController.getInstance().gameOverStage(this.STAGE_ID,this.cards)),this.COUNTER_SNAKE++),2===this.MCHELP_FAIL_STEP&&this.boy.totalFrames===this.boy.currentFrame&&(30===this.COUNTER_FAN&&(this.FLAG_GAMEOVER_1=!0,this.cards.push(11),StageController.getInstance().gameOverStage(this.STAGE_ID,this.cards)),this.COUNTER_FAN++),this.FLAG_GOT_PIPE,1===this.MCHELP_UNUSED_STEP&&(3===this.boy.currentFrame&&SoundManager.getInstance().playSound(SoundEnum.WATER7SOUND_MP3),15===this.boy.currentFrame&&SoundManager.getInstance().playSound(SoundEnum.VALVESOUND_MP3),(26===this.boy.currentFrame||34===this.boy.currentFrame||42===this.boy.currentFrame||50===this.boy.currentFrame||64===this.boy.currentFrame)&&SoundManager.getInstance().playSound(SoundEnum.WATER4SOUND_MP3),this.boy.totalFrames===this.boy.currentFrame&&(this.boy.movieClipData=this.boyActionFactary.generateMovieClipData("sh_standby"),this.boy.gotoAndPlay(1),this.boy.x=300.8,this.boy.y=789.5,this.asagao.visible=!0,this.bar_opened=!1,this.MCHELP_UNUSED_STEP=2)),1===this.MCHELP_BOOM_PIPE_STEP&&this.boy.totalFrames===this.boy.currentFrame&&(this.boy.movieClipData=this.boyActionFactary.generateMovieClipData("sh_bad_mizu"),this.boy.gotoAndPlay(1),this.MCHELP_BOOM_PIPE_STEP=2,this.removeAllEventListener()),2===this.MCHELP_BOOM_PIPE_STEP&&this.boy.totalFrames===this.boy.currentFrame){SoundManager.getInstance().playSound(SoundEnum.WATER5SOUND_MP3);var t=new egret.MovieClipDataFactory(RES.getRes("stage4_in_water_json"),RES.getRes("stage4_in_water_png")),e=new egret.MovieClip(t.generateMovieClipData("pipe_boom"));this.boy.movieClipData=t.generateMovieClipData("in_water");var i=new egret.MovieClip(t.generateMovieClipData("hat"));e.x=359.3+15.35,this.boy.x=288.8,i.x=359.3,e.y=816.3,this.boy.y=793.3,i.y=799,this.addChild(e),this.addChildAt(i,this.getChildIndex(this.asagao)-1),e.play(-1),i.play(),this.boy.play(-1),this.MCHELP_BOOM_PIPE_STEP=3}if(3===this.MCHELP_BOOM_PIPE_STEP&&this.boy.totalFrames===this.boy.currentFrame&&(30===this.COUNTER_WATER_BOOM&&(this.FLAG_GAMEOVER_3=!0,StageController.getInstance().gameOverStage(this.STAGE_ID,this.cards)),Util.singletonPush(this.cards,14),this.COUNTER_WATER_BOOM++),1===this.MCHELP_FAIL_STEP&&this.boy.totalFrames===this.boy.currentFrame&&(this.boy.movieClipData=this.boyActionFactary.generateMovieClipData("sh_bad"),this.boy.x=269.3,this.boy.y=814,this.boy.gotoAndPlay(1),this.MCHELP_FAIL_STEP=2,this.removeAllEventListener()),this.FLAG_ASAGAO_HAND_WATERING&&this.asagao.currentFrame===this.asagao.totalFrames){var s=new egret.MovieClip(this.asagaoFactory.generateMovieClipData("star"));s.x=this.asagao.x,s.y=this.asagao.y-90,s.play(-1),this.addChild(s),this.boy.movieClipData=this.boyActionFactary.generateMovieClipData("sh_clear"),this.boy.x=269.5,this.boy.gotoAndPlay(1),SoundManager.getInstance().playSound(SoundEnum.SHINESOUND_MP3),Util.singletonPush(this.cards,17),this.FLAG_CLEAR_2=!0}if(this.FLAG_ASAGAO_WATERING&&(1===this.asagao.currentFrame&&SoundManager.getInstance().playSound(SoundEnum.WATER6SOUND_MP3),this.asagao.currentFrame===this.asagao.totalFrames)){var s=new egret.MovieClip(this.asagaoFactory.generateMovieClipData("star"));s.x=this.asagao.x,s.y=this.asagao.y-90,s.play(-1),this.addChild(s),this.water.visible=!1,this.boy.movieClipData=this.boyActionFactary.generateMovieClipData("sh_clear"),this.boy.x=269.5,this.boy.gotoAndPlay(1),this.pipe2.visible=!0,this.pipe3.visible=!0,SoundManager.getInstance().playSound(SoundEnum.SHINESOUND_MP3),Util.singletonPush(this.cards,15),this.FLAG_CLEAR_1=!0}},e.prototype._remove=function(){egret.Tween.removeAllTweens()},e.prototype.registItem=function(t){},e.prototype.useItem=function(t,e,i){return!0},e.prototype.getDisplayArea=function(){return new egret.Rectangle},e.prototype.ctrl_right=function(){},e.prototype.ctrl_left=function(){},e.prototype.ctrl_up=function(){},e.prototype.ctrl_down=function(){},e.prototype.ctrl_ok=function(){},e.prototype.ctrl_cancel=function(){},e}(egret.DisplayObjectContainer);__reflect(Stage4.prototype,"Stage4",["IFKaihiStage"]);var Stage5=function(t){function e(){var e=t.call(this)||this;return e.STAGE_ID=5,e.FLAG_ICE_EAT=!1,e.FLAG_CAKE_EAT=!1,e.FLAG_OLD_TOOTH_KICK_DOWN=!1,e.NEW_TOOTH_Y_CHANGE_PER_TOUCH=20,e.FLAG_TEETH_WORLD_SHOW=!1,e.FLAG_NEW_TOOTH_TOUCH_TIMES=0,e.MC_HELP_KICK_DOWN=0,e.MC_HELP_ICE=0,e.MC_HELP_CAKE=0,e.COUNTER_CLEAR=0,e.COUNTER_ICE_FAIL=0,e.COUNTER_CAKE_FAIL=0,e.MCHELP_BOY_PLAYING=!1,e.is_door1_opened=!1,e.is_door2_opened=!1,e._init(),e}return __extends(e,t),e.prototype.drawTeethWorld=function(){var t=new TSBitmap("dialog",this.sheet);t.x=-234,t.y=-418,this.teethWorld.addChild(t);var e=new TSBitmap("toothland",this.sheet);e.x=-234,e.y=-418,this.teethWorld.addChild(e);var i=new TSBitmap("left",this.sheet);i.x=-305,i.y=-305,this.teethWorld.addChild(i);var s=new TSBitmap("right",this.sheet);s.x=62,s.y=-305,this.teethWorld.addChild(s),this["new"]=new TSBitmap("new",this.sheet),this["new"].anchorOffsetX=this["new"].width/2,this["new"].anchorOffsetY=this["new"].height/2,this["new"].x=-20.65,this["new"].y=-46.45,this.teethWorld.addChild(this["new"]),this.old=new TSBitmap("old",this.sheet),this.old.anchorOffsetX=this.old.width/2,this.old.anchorOffsetY=this.old.height/2,this.old.x=-24.1,this.old.y=-217.35,this.teethWorld.addChild(this.old),this.boy_left=new TSBitmap("boy_left",this.sheet),this.boy_left.anchorOffsetX=this.boy_left.width/2,this.boy_left.anchorOffsetY=this.boy_left.height/2,this.boy_left.x=-67.75,this.boy_left.y=-301,this.teethWorld.addChild(this.boy_left),this.boy_right=new TSBitmap("boy_right",this.sheet),this.boy_right.anchorOffsetX=this.boy_right.width/2,this.boy_right.anchorOffsetY=this.boy_right.height/2,this.boy_right.x=22.3,this.boy_right.y=-287.9,this.teethWorld.addChild(this.boy_right),this.viewShape=new egret.Shape,this.viewShape.graphics.beginFill(0),this.viewShape.graphics.drawRect(-220,-410,375,350),this.viewShape.graphics.endFill(),this.teethWorld.addChild(this.viewShape),this.teethWorld.mask=this.viewShape,this.cards=[],this.tooth=new egret.MovieClip(this.mcFactory.generateMovieClipData("tooth")),this.tooth.x=262.5,this.tooth.y=800,this.addChild(this.tooth),this.tooth.gotoAndStop(1),this.tooth.visible=!1},e.prototype.addTeethWorldEventListener=function(){this.boy_left.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBoyLeftTouched,this),this.boy_right.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBoyRightTouched,this),this.old.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onOldTouched,this),this["new"].addEventListener(egret.TouchEvent.TOUCH_TAP,this.onNewTouched,this)},e.prototype.removeTeethWorldEventListener=function(){this.boy_left.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onBoyLeftTouched,this),this.boy_right.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onBoyRightTouched,this),this.old.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onOldTouched,this),this["new"].removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onNewTouched,this)},e.prototype.onBoyLeftTouched=function(){SoundManager.getInstance().playSound(SoundEnum.KICKSOUND_MP3),egret.Tween.get(this.boy_left,{loop:!1}).to({rotation:1080,alpha:.2,x:-500,y:-500},1e3).call(this.onBoyLeftTweenFinish,this,[]),this.removeTeethWorldEventListener()},e.prototype.onBoyLeftTweenFinish=function(){this.boy_left.x=-67.75,this.boy_left.y=-251,egret.Tween.get(this.boy_left,{loop:!1}).to({alpha:1,y:-301-this.NEW_TOOTH_Y_CHANGE_PER_TOUCH*this.FLAG_NEW_TOOTH_TOUCH_TIMES},100).call(this.addTeethWorldEventListener,this,[])},e.prototype.onBoyRightTouched=function(){SoundManager.getInstance().playSound(SoundEnum.KICKSOUND_MP3),egret.Tween.get(this.boy_right,{loop:!1}).to({rotation:1080,alpha:.2,x:500,y:-500},1e3).call(this.onBoyRightTweenFinish,this,[])},e.prototype.onBoyRightTweenFinish=function(){this.boy_right.x=22.3,this.boy_right.y=-237.9,egret.Tween.get(this.boy_right,{loop:!1}).to({alpha:1,y:-287.9-this.NEW_TOOTH_Y_CHANGE_PER_TOUCH*this.FLAG_NEW_TOOTH_TOUCH_TIMES},100).call(this.addTeethWorldEventListener,this,[])},e.prototype.onTeethWorldHide=function(){this.teethWorldContainter.visible=!1},e.prototype.onTickDownTheTooth=function(){egret.Tween.get(this.miror,{loop:!1}).to({alpha:0},500),egret.Tween.get(this.teethWorldContainter,{loop:!1}).to({alpha:0,scaleX:.2,scaleY:.2},500).call(this.onTeethWorldHide,this,[]),this.FLAG_OLD_TOOTH_KICK_DOWN=!0,this.tooth.gotoAndPlay(1)},e.prototype.onOldTouched=function(){3===this.FLAG_NEW_TOOTH_TOUCH_TIMES?(this.removeAllEventListener(),egret.Tween.get(this.boy_left,{loop:!1}).to({y:-500,alpha:.5},1e3),egret.Tween.get(this.boy_right,{loop:!1}).to({y:-500,alpha:.5},1e3),egret.Tween.get(this.old,{loop:!1}).to({y:-287.35,alpha:.8,rotation:-90},200).to({y:200,x:-150,alpha:.5},800).call(this.onTickDownTheTooth,this,[])):(this.removeAllEventListener(),egret.Tween.pauseTweens(this.old),egret.Tween.get(this.old,{loop:!1}).to({x:-24.1+10*Math.random(),y:-217.35-this.NEW_TOOTH_Y_CHANGE_PER_TOUCH*this.FLAG_NEW_TOOTH_TOUCH_TIMES+10*Math.random()},100).to({x:-24.1-10*Math.random(),y:-217.35-this.NEW_TOOTH_Y_CHANGE_PER_TOUCH*this.FLAG_NEW_TOOTH_TOUCH_TIMES+10*Math.random()},100).to({x:-24.1+10*Math.random(),y:-217.35-this.NEW_TOOTH_Y_CHANGE_PER_TOUCH*this.FLAG_NEW_TOOTH_TOUCH_TIMES-10*Math.random()},100).to({x:-24.1-10*Math.random(),y:-217.35-this.NEW_TOOTH_Y_CHANGE_PER_TOUCH*this.FLAG_NEW_TOOTH_TOUCH_TIMES-10*Math.random()},100).to({x:-24.1+10*Math.random(),y:-217.35-this.NEW_TOOTH_Y_CHANGE_PER_TOUCH*this.FLAG_NEW_TOOTH_TOUCH_TIMES+10*Math.random()},100).to({x:-24.1-10*Math.random(),y:-217.35-this.NEW_TOOTH_Y_CHANGE_PER_TOUCH*this.FLAG_NEW_TOOTH_TOUCH_TIMES+10*Math.random()},100).to({x:-24.1+10*Math.random(),y:-217.35-this.NEW_TOOTH_Y_CHANGE_PER_TOUCH*this.FLAG_NEW_TOOTH_TOUCH_TIMES-10*Math.random()},100).to({x:-24.1-10*Math.random(),y:-217.35-this.NEW_TOOTH_Y_CHANGE_PER_TOUCH*this.FLAG_NEW_TOOTH_TOUCH_TIMES-10*Math.random()},100).to({x:-24.1,y:-217.35-this.NEW_TOOTH_Y_CHANGE_PER_TOUCH*this.FLAG_NEW_TOOTH_TOUCH_TIMES},100))},e.prototype.onNewTouched=function(){this.FLAG_NEW_TOOTH_TOUCH_TIMES<3&&(this.removeAllEventListener(),SoundManager.getInstance().playSound(SoundEnum.UPSOUND_MP3),this.FLAG_NEW_TOOTH_TOUCH_TIMES++,egret.Tween.get(this.boy_left,{loop:!1}).to({y:-301-this.NEW_TOOTH_Y_CHANGE_PER_TOUCH*this.FLAG_NEW_TOOTH_TOUCH_TIMES},1e3),egret.Tween.get(this.boy_right,{loop:!1}).to({y:-287.9-this.NEW_TOOTH_Y_CHANGE_PER_TOUCH*this.FLAG_NEW_TOOTH_TOUCH_TIMES},1e3),egret.Tween.get(this.old,{loop:!1}).to({y:-217.35-this.NEW_TOOTH_Y_CHANGE_PER_TOUCH*this.FLAG_NEW_TOOTH_TOUCH_TIMES},1e3),egret.Tween.get(this.old,{loop:!1}).to({x:-24.1+5*Math.random()},100).to({x:-24.1-5*Math.random()},200).to({x:-24.1+5*Math.random()},100).to({x:-24.1-5*Math.random()},100).to({x:-24.1-5*Math.random()},100).to({x:-24.1+5*Math.random()},100).to({x:-24.1-5*Math.random()},200).to({x:-24.1+5*Math.random()},100),egret.Tween.get(this["new"],{loop:!1}).to({y:-46.45-this.NEW_TOOTH_Y_CHANGE_PER_TOUCH*this.FLAG_NEW_TOOTH_TOUCH_TIMES},1e3).call(this.resetPosition,this,[]))},e.prototype.resetPosition=function(){this.addAllEventListener(),this["new"].y=-46.45-this.NEW_TOOTH_Y_CHANGE_PER_TOUCH*this.FLAG_NEW_TOOTH_TOUCH_TIMES,this.old.x=-24.1,this.old.y=-217.35-this.NEW_TOOTH_Y_CHANGE_PER_TOUCH*this.FLAG_NEW_TOOTH_TOUCH_TIMES,this.boy_left.y=-301-this.NEW_TOOTH_Y_CHANGE_PER_TOUCH*this.FLAG_NEW_TOOTH_TOUCH_TIMES,this.boy_right.y=-287.9-this.NEW_TOOTH_Y_CHANGE_PER_TOUCH*this.FLAG_NEW_TOOTH_TOUCH_TIMES},e.prototype._init=function(){return __awaiter(this,void 0,void 0,function(){var t,e,i,s,h,a,o,n,r,l;return __generator(this,function(c){switch(c.label){case 0:return UIManager.getInstance().showLoading(),[4,this._loadRes()];case 1:return c.sent(),UIManager.getInstance().hideLoading(),this.sheet=RES.getRes("stage5_texture"),t=RES.getRes("stage5_action_json"),e=RES.getRes("stage5_action_png"),this.mcFactory=new egret.MovieClipDataFactory(t,e),i=new TSBitmap("bg",this.sheet),i.x=-120,i.y=-100,this.addChild(i),s=new TSBitmap("icebox",this.sheet),s.x=488,s.y=532,this.addChild(s),this.store_cake=new TSBitmap("cake",this.sheet),this.store_cake.anchorOffsetX=this.store_cake.width/2,this.store_cake.anchorOffsetY=this.store_cake.height/2,this.store_cake.x=551.65,this.store_cake.y=686.45,this.store_cake.touchEnabled=!0,this.addChild(this.store_cake),this.store_ice=new TSBitmap("ice",this.sheet),this.store_ice.anchorOffsetX=this.store_ice.width/2,this.store_ice.anchorOffsetY=this.store_ice.height/2,this.store_ice.x=550.85,this.store_ice.y=581.35,this.store_ice.touchEnabled=!0,this.addChild(this.store_ice),this.door1=new egret.Sprite,this.door1.x=551.05,this.door1.y=571.7,this.addChild(this.door1),h=new egret.Bitmap,h.name="closed",h.texture=this.sheet.getTexture("door1"),h.anchorOffsetX=h.width/2,h.anchorOffsetY=h.height/2,h.x=0,h.y=.05,h.touchEnabled=!0,this.door1.addChild(h),a=new egret.Bitmap,a.name="opened",a.texture=this.sheet.getTexture("door1_open"),a.anchorOffsetX=a.width/2,a.anchorOffsetY=a.height/2,a.x=55.25,a.y=.05,a.touchEnabled=!0,a.visible=!1,this.door1.addChild(a),this.door2=new egret.Sprite,this.door2.x=551.75,this.door2.y=657.1,this.addChild(this.door2),o=new egret.Bitmap,o.name="closed",o.texture=this.sheet.getTexture("door2"),o.anchorOffsetX=o.width/2,o.anchorOffsetY=o.height/2,o.x=-1.55,o.y=0,o.touchEnabled=!0,this.door2.addChild(o),n=new egret.Bitmap,n.name="opened",n.texture=this.sheet.getTexture("door2_open"),n.anchorOffsetX=n.width/2,n.anchorOffsetY=n.height/2,n.x=48.35,n.y=4.05,n.touchEnabled=!0,n.visible=!1,this.door2.addChild(n),this.clock=new TSBitmap("clock",this.sheet),this.clock.x=17,this.clock.y=232,this.addChild(this.clock),this.furiko_mc=new egret.MovieClip(this.mcFactory.generateMovieClipData("furiko_mc")),this.furiko_mc.x=60.3,this.furiko_mc.y=307.3,this.furiko_mc.play(-1),this.furiko_mc.touchEnabled=!0,this.addChild(this.furiko_mc),this.boy=new egret.MovieClip(this.mcFactory.generateMovieClipData("sh_standby")),this.boy.x=320,this.boy.y=736.45,this.boy.touchEnabled=!0,this.addChild(this.boy),this.boy.gotoAndStop(1),this.teethWorldContainter=new egret.Sprite,this.teethWorldContainter.x=375,this.teethWorldContainter.y=632.5,this.addChild(this.teethWorldContainter),this.teethWorld=new egret.Sprite,this.drawTeethWorld(),this.teethWorldContainter.addChild(this.teethWorld),r=new TSBitmap("dialog2",this.sheet),r.x=-234,r.y=-418,this.teethWorldContainter.addChild(r),this.teethWorldContainter.scaleX=this.teethWorldContainter.scaleY=.2,this.teethWorldContainter.alpha=0,l=new TSBitmap("table",this.sheet),l.x=17,l.y=778,this.addChild(l),this.plate=new TSBitmap("plate",this.sheet),this.plate.x=271,this.plate.x=800.75,this.plate.visible=!1,this.addChild(this.plate),this.table_cake=new TSBitmap("cake3",this.sheet),this.table_cake.anchorOffsetX=this.table_cake.width/2,this.table_cake.anchorOffsetY=this.table_cake.height/2,this.table_cake.x=317,this.table_cake.y=797,this.table_cake.visible=!1,this.addChild(this.table_cake),this.fork=new TSBitmap("fork",this.sheet),this.fork.anchorOffsetX=this.fork.width/2,this.fork.anchorOffsetY=this.fork.height/2,this.fork.x=262.5,this.fork.y=800,this.fork.visible=!1,this.addChild(this.fork),this.bad_ice=new TSBitmap("ice2",this.sheet),this.bad_ice.anchorOffsetX=this.bad_ice.width/2,this.bad_ice.anchorOffsetY=this.bad_ice.height/2,this.bad_ice.x=293,this.bad_ice.y=800,this.bad_ice.visible=!1,this.addChild(this.bad_ice),this.bad_cake=new TSBitmap("cake2",this.sheet),this.bad_cake.anchorOffsetX=this.bad_cake.width/2,this.bad_cake.anchorOffsetY=this.bad_cake.height/2,this.bad_cake.x=317,this.bad_cake.y=796.75,this.bad_cake.visible=!1,this.addChild(this.bad_cake),this.item_use_area=new egret.Shape,this.item_use_area.graphics.beginFill(255),this.item_use_area.graphics.drawRect(277.45,604.85,100,100),this.item_use_area.graphics.endFill(),this.item_use_area.touchEnabled=!0,this.item_use_area.alpha=0,this.addChild(this.item_use_area),this.addAllEventListener(),[2]}})})},e.prototype.addAllEventListener=function(){this.boy.addEventListener(egret.TouchEvent.TOUCH_TAP,this.boyTouched,this),this.door1.addEventListener(egret.TouchEvent.TOUCH_TAP,this.door1Touched,this),this.door2.addEventListener(egret.TouchEvent.TOUCH_TAP,this.door2Touched,this),this.furiko_mc.addEventListener(egret.TouchEvent.TOUCH_TAP,this.furikoTouched,this),this.store_cake.addEventListener(egret.TouchEvent.TOUCH_TAP,this.storeCakeTouched,this),this.store_ice.addEventListener(egret.TouchEvent.TOUCH_TAP,this.storeIceTouched,this)},e.prototype.removeAllEventListener=function(){this.boy.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.boyTouched,this),this.door1.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.door1Touched,this),this.door2.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.door2Touched,this),this.furiko_mc.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.furikoTouched,this),this.store_cake.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.storeCakeTouched,this),this.store_ice.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.storeIceTouched,this)},e.prototype.boyTouched=function(){this.MCHELP_BOY_PLAYING=!0,this.boy.gotoAndPlay(1),this.boy.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.boyTouched,this),Util.singletonPush(this.cards,24)},e.prototype.door1Touched=function(){this.is_door1_opened=!this.is_door1_opened,this.is_door1_opened?(this.door1.getChildByName("opened").visible=!0,this.door1.getChildByName("closed").visible=!1):(this.door1.getChildByName("closed").visible=!0,this.door1.getChildByName("opened").visible=!1)},e.prototype.door2Touched=function(){this.is_door2_opened=!this.is_door2_opened,this.is_door2_opened?(SoundManager.getInstance().playSound(SoundEnum.REIZOUKOCLOSESOUND_MP3),this.door2.getChildByName("opened").visible=!0,this.door2.getChildByName("closed").visible=!1):(SoundManager.getInstance().playSound(SoundEnum.REIZOUKOOPENSOUND_MP3),this.door2.getChildByName("opened").visible=!1,this.door2.getChildByName("closed").visible=!0)},e.prototype.furikoTouched=function(){ItemController.getInstance().addItem(ItemEnum.ITEM_FURIKO)&&(this.furiko_mc.visible=!1,this.furiko_mc.stop())},e.prototype.storeCakeTouched=function(){ItemController.getInstance().addItem(ItemEnum.ITEM_CAKE)&&(this.store_cake.visible=!1)},e.prototype.storeIceTouched=function(){ItemController.getInstance().addItem(ItemEnum.ITEM_ICE)&&(this.store_ice.visible=!1)},e.prototype.onTeethWorldShow=function(){},e.prototype._loadRes=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,StageController.getInstance().loadStage(5)];case 1:return e.sent(),[3,3];case 2:return t=e.sent(),console.error(t),[3,3];case 3:return[2]}})})},e.prototype._start=function(){},e.prototype.play_loop=function(){this.FLAG_OLD_TOOTH_KICK_DOWN&&(0===this.MC_HELP_KICK_DOWN&&this.tooth.totalFrames===this.tooth.currentFrame&&(this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_clear"),this.boy.gotoAndPlay(1),this.MC_HELP_KICK_DOWN=1),1===this.MC_HELP_KICK_DOWN&&this.boy.currentFrame===this.boy.totalFrames&&(30===this.COUNTER_CLEAR?(this.MC_HELP_KICK_DOWN=2,Util.singletonPush(this.cards,21),StageController.getInstance().clearStage(this.STAGE_ID,this.cards)):this.COUNTER_CLEAR++)),this.MCHELP_BOY_PLAYING===!0&&this.boy.currentFrame===this.boy.totalFrames&&(this.boy.gotoAndStop(1),this.MCHELP_BOY_PLAYING=!1,this.boy.addEventListener(egret.TouchEvent.TOUCH_TAP,this.boyTouched,this)),this.FLAG_ICE_EAT===!0&&(0===this.MC_HELP_ICE&&(9===this.boy.currentFrame&&SoundManager.getInstance().playSound(SoundEnum.EATSOUND_MP3),this.boy.currentFrame===this.boy.totalFrames&&(SoundManager.getInstance().playSound(SoundEnum.KUWAGATASOUND_MP3),this.bad_ice.visible=!0,this.MC_HELP_ICE=1)),1===this.MC_HELP_ICE&&(this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_bad"),this.boy.play(-1),this.MC_HELP_ICE=2),2===this.MC_HELP_ICE&&(60===this.COUNTER_ICE_FAIL?StageController.getInstance().gameOverStage(this.STAGE_ID,this.cards):this.COUNTER_ICE_FAIL++)),this.FLAG_CAKE_EAT===!0&&(0===this.MC_HELP_CAKE&&(39===this.boy.currentFrame&&SoundManager.getInstance().playSound(SoundEnum.EATSOUND_MP3),this.boy.currentFrame===this.boy.totalFrames&&(SoundManager.getInstance().playSound(SoundEnum.KUWAGATASOUND_MP3),this.bad_cake.visible=!0,this.table_cake.visible=!1,this.fork.visible=!0,this.MC_HELP_CAKE=1)),1===this.MC_HELP_CAKE&&(this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_bad"),this.boy.play(-1),this.MC_HELP_ICE=2),2===this.MC_HELP_ICE&&(60===this.COUNTER_ICE_FAIL?StageController.getInstance().gameOverStage(this.STAGE_ID,this.cards):this.COUNTER_ICE_FAIL++))},e.prototype._remove=function(){egret.Tween.removeAllTweens()},e.prototype.registItem=function(t){},e.prototype.useItem=function(t,e,i){if(t===ItemEnum.ITEM_FURIKO&&this.item_use_area.hitTestPoint(e,i))return egret.Tween.get(this.teethWorldContainter,{loop:!1}).to({alpha:1,scaleX:1,scaleY:1},1e3).call(this.onTeethWorldShow,this,[]),this.miror=new TSBitmap("miror",this.sheet),this.miror.x=324,this.miror.y=646,this.addChild(this.miror),egret.Tween.get(this.miror,{loop:!1}).to({alpha:1},1e3),this.boy_left.touchEnabled=!0,this.boy_right.touchEnabled=!0,this.old.touchEnabled=!0,this["new"].touchEnabled=!0,this.FLAG_TEETH_WORLD_SHOW=!0,this.addTeethWorldEventListener(),!0;if(t===ItemEnum.ITEM_CAKE){if(this.removeAllEventListener(),this.removeTeethWorldEventListener(),this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_cake"),this.boy.play(),this.FLAG_CAKE_EAT=!0,this.plate.visible=!0,this.table_cake.visible=!0,this.FLAG_TEETH_WORLD_SHOW){this.boy_left.visible=this.boy_right.visible=!1;var s=new TSBitmap("cake_world",this.sheet);s.x=-209.1,s.y=-323,this.teethWorldContainter.addChild(s);var h=new egret.MovieClip(this.mcFactory.generateMovieClipData("cake_boy2"));h.x=59.45-28.5,h.y=-322.65,h.play(-1),this.teethWorldContainter.addChild(h);var a=new egret.MovieClip(this.mcFactory.generateMovieClipData("cake_boy1"));a.x=-74.1,a.y=-322.65,a.play(-1),this.teethWorldContainter.addChild(a),Util.singletonPush(this.cards,23)}else Util.singletonPush(this.cards,20);return!0}if(t===ItemEnum.ITEM_ICE){if(this.removeAllEventListener(),this.removeTeethWorldEventListener(),this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_ice"),this.boy.play(),this.FLAG_ICE_EAT=!0,this.FLAG_TEETH_WORLD_SHOW){this.boy_left.visible=this.boy_right.visible=!1;var o=new TSBitmap("ice_world",this.sheet);o.x=-209.1,o.y=-323,this.teethWorldContainter.addChild(o),this.ice_mc=new egret.MovieClip(this.mcFactory.generateMovieClipData("part_ice_mc")),this.ice_mc.x=-116.1+90,this.ice_mc.y=-208,this.ice_mc.play(-1),this.teethWorldContainter.addChild(this.ice_mc);var n=new TSBitmap("snow_hill",this.sheet);n.x=35-24.1,n.y=-317,this.teethWorldContainter.addChild(n),Util.singletonPush(this.cards,22)}else Util.singletonPush(this.cards,19);return!0}return!1},e.prototype.getDisplayArea=function(){return new egret.Rectangle},e.prototype.ctrl_right=function(){},e.prototype.ctrl_left=function(){},e.prototype.ctrl_up=function(){},e.prototype.ctrl_down=function(){},e.prototype.ctrl_ok=function(){},e.prototype.ctrl_cancel=function(){},e}(egret.DisplayObjectContainer);__reflect(Stage5.prototype,"Stage5",["IFKaihiStage"]);var Stage6=function(t){function e(){var e=t.call(this)||this;return e.FLAG_GAME_OVER=!1,e.FLAG_CLEAR=!1,e.FLAG_TAKE_AWAY=!1,e.FLAG_SAY_BYE_BYE=!1,e.COUNTER_CLEAR=0,e.COUNTER_GAME_OVER=0,e.COUNTER_FAIMILY_AWAY=0,e.FLAG_LIT_HOURSE_UP=!1,e.FLAG_TOY_FLOWER_GOT=!1,e.FLAG_FLOWER_WATERED=!1,e.FLAG_FLOWER_RING_USED=!1,e.FLAG_BERRY_USED=!1,e.FLAG_HORSE_STEP=0,e.MVHELP_HORSE_TAKE_YOU_AWAY_STEP=0,e.MVHELP_FIRST_ENTER=!1,e._init(),e}return __extends(e,t),e.prototype._init=function(){return __awaiter(this,void 0,void 0,function(){var t,e,i,s,h,a,o,n,r,l,c,d,_,g,p;return __generator(this,function(u){switch(u.label){case 0:return UIManager.getInstance().showLoading(),[4,this._loadRes()];case 1:return u.sent(),UIManager.getInstance().hideLoading(),this.sheet=RES.getRes("stage6_texture"),t=RES.getRes("stage6_horse_action_json"),e=RES.getRes("stage6_horse_action_png"),i=RES.getRes("stage6_toy_action_json"),s=RES.getRes("stage6_toy_action_png"),this.horseFactory=new egret.MovieClipDataFactory(t,e),this.toyFactory=new egret.MovieClipDataFactory(i,s),h=new TSBitmap("bg",this.sheet),h.x=-120,h.y=-100,this.addChild(h),a=new TSBitmap("garden",this.sheet),a.x=-120,a.y=401,this.addChild(a),o=new TSBitmap("wall",this.sheet),o.x=-120,o.y=354,this.addChild(o),n=new TSBitmap("pool",this.sheet),n.x=402.75,n.y=465.65,this.addChild(n),this.flower_wall=new TSBitmap("flower",this.sheet),this.flower_wall.scaleX=.503036,this.flower_wall.scaleY=.503036,this.flower_wall.x=28.9,this.flower_wall.y=360.45,this.addChild(this.flower_wall),r=new TSBitmap("grass1",this.sheet),r.x=521,r.y=536,this.addChild(r),this.flower_pool=new egret.MovieClip(this.horseFactory.generateMovieClipData("open")),this.flower_pool.anchorOffsetX=this.flower_pool.width/2,this.flower_pool.anchorOffsetY=this.flower_pool.height/2,this.flower_pool.x=574.6,this.flower_pool.y=555.4,this.flower_pool.gotoAndStop(1),this.addChild(this.flower_pool),this.lithorse=new TSBitmap("lithorse",this.sheet),this.lithorse.scaleX=-67.1112/100,this.lithorse.scaleY=67.1112/100,this.lithorse.anchorOffsetX=this.lithorse.width/2,this.lithorse.anchorOffsetY=this.lithorse.height/2,this.lithorse.x=95.7,this.lithorse.y=661.15,this.addChild(this.lithorse),l=new egret.Shape,l.graphics.beginFill(0),l.graphics.drawRect(-3,376.9,260.5,298.65),l.graphics.endFill(),this.addChild(l),this.lithorse.mask=l,this.litaway=new egret.MovieClip(this.horseFactory.generateMovieClipData("litaway")),this.litaway.anchorOffsetX=this.litaway.width/2,this.litaway.anchorOffsetY=this.litaway.height/2,this.litaway.scaleX=-67.1112/100,this.litaway.scaleY=67.1112/100,this.litaway.x=95.7,this.litaway.y=529.9,this.litaway.gotoAndStop(1),this.litaway.visible=!1,this.addChild(this.litaway),c=new TSBitmap("wall2",this.sheet),c.x=-120,c.y=641,this.addChild(c),d=new TSBitmap("grass0",this.sheet),d.x=-120,d.y=548,this.addChild(d),this.grass_2_left=new TSBitmap("grass2",this.sheet),this.grass_2_left.x=-34,this.grass_2_left.y=546,this.addChild(this.grass_2_left),this.grass_2_right=new TSBitmap("grass2",this.sheet),this.grass_2_right.x=86,this.grass_2_right.y=551,this.addChild(this.grass_2_right),this.grass_area=new egret.Shape,this.grass_area.graphics.beginFill(0),this.grass_area.graphics.drawRect(0,549,300,120.2),this.grass_area.graphics.endFill(),this.grass_area.alpha=0,this.grass_area.touchEnabled=!0,this.addChild(this.grass_area),_=new TSBitmap("slide",this.sheet),_.x=490,_.y=500,this.addChild(_),this.berryleaf=new TSBitmap("berryleaf",this.sheet),this.berryleaf.anchorOffsetX=this.berryleaf.width/2,this.berryleaf.anchorOffsetY=this.berryleaf.height/2,this.berryleaf.x=801.6,this.berryleaf.y=558,this.addChild(this.berryleaf),g=new TSBitmap("slide2",this.sheet),g.x=490,g.y=500,this.addChild(g),this.horse=new egret.MovieClip(this.horseFactory.generateMovieClipData("step0")),this.horse.scaleX=.741,this.horse.scaleY=.741,this.horse.anchorOffsetX=this.horse.width/2,this.horse.anchorOffsetY=this.horse.height/2,this.horse.x=608,this.horse.y=704,this.horse.gotoAndStop(1),this.addChild(this.horse),p=new TSBitmap("toy_under",this.sheet),p.x=46,p.y=997,this.addChild(p),this.toy=new egret.MovieClip(this.toyFactory.generateMovieClipData("toyboyflo")),this.toy.x=132.55,this.toy.y=883.85,this.toy.gotoAndStop(1),this.addChild(this.toy),this.toy_area=new egret.Shape,this.toy_area.graphics.beginFill(0),this.toy_area.graphics.drawRect(35,731,140,220),this.toy_area.graphics.endFill(),this.toy_area.touchEnabled=!0,this.toy_area.alpha=0,this.addChild(this.toy_area),this.toy_flower_area=new egret.Shape,this.toy_flower_area.graphics.beginFill(0),this.toy_flower_area.graphics.drawRect(185.65,781,80,80),this.toy_flower_area.graphics.endFill(),this.toy_flower_area.touchEnabled=!0,this.toy_flower_area.alpha=0,this.addChild(this.toy_flower_area),this.wall_flower_area=new egret.Shape,this.wall_flower_area.graphics.beginFill(0),this.wall_flower_area.graphics.drawRect(39.9-40,329.45,80,80),this.wall_flower_area.graphics.endFill(),this.wall_flower_area.touchEnabled=!0,this.wall_flower_area.alpha=0,this.addChild(this.wall_flower_area),this.pool_flower_area=new egret.Shape,this.pool_flower_area.graphics.beginFill(0),this.pool_flower_area.graphics.drawRect(524.6,515.4,100,80),this.pool_flower_area.graphics.endFill(),this.pool_flower_area.touchEnabled=!1,this.pool_flower_area.alpha=0,this.addChild(this.pool_flower_area),this.berry_area=new egret.Shape,this.berry_area.graphics.beginFill(0),this.berry_area.graphics.drawRect(480,794.7,80,80),this.berry_area.graphics.endFill(),this.berry_area.touchEnabled=!1,this.berry_area.alpha=0,this.addChild(this.berry_area),this.pool_area=new egret.Shape,this.pool_area.graphics.beginFill(0),this.pool_area.graphics.drawRect(426.25,446.95,145,88),this.pool_area.graphics.endFill(),this.pool_area.alpha=0,this.pool_area.touchEnabled=!1,this.addChild(this.pool_area),this.screen_splash=new egret.Shape,this.screen_splash.graphics.beginFill(16777215),this.screen_splash.graphics.drawRect(0,0,Util.curWidth(),Util.curHeight()),this.screen_splash.graphics.endFill(),this.screen_splash.alpha=0,this.screen_splash.visible=!1,this.screen_splash.touchEnabled=!1,this.addChild(this.screen_splash),this.pool_area.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onPoolTouched,this),this.toy_area.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onToyTouched,this),this.grass_area.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onGrassAreaTouched,this),this.toy_flower_area.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onToyFlowerAreaTouched,this),this.wall_flower_area.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onWallFlowerAreaTouched,this),this.pool_flower_area.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onPoolFlowerAreaTouched,this),this.berry_area.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBerryAreaTouched,this),this.cards=[],[2]
}})})},e.prototype.addedTakeYouAwayStep=function(){this.MVHELP_HORSE_TAKE_YOU_AWAY_STEP++,this.MVHELP_FIRST_ENTER=!0},e.prototype.onPoolTouched=function(){SoundManager.getInstance().playSound(SoundEnum.WATER8SOUND_MP3),this.pool_area.touchEnabled=!1;var t=new egret.MovieClip;t.movieClipData=this.horseFactory.generateMovieClipData("water"),t.x=499,t.y=485.65,this.addChildAt(t,this.getChildIndex(this.flower_wall)),this.flower_pool.play(),t.play(-1),this.pool_area.touchEnabled=!1,this.pool_flower_area.touchEnabled=!0,this.FLAG_FLOWER_WATERED=!0,this.addedTakeYouAwayStep()},e.prototype.onBerryAreaTouched=function(){this.addedTakeYouAwayStep(),this.berryleaf.visible=!1,this.registItem(ItemEnum.ITEM_BERRY)},e.prototype.onToyFlowerAreaTouched=function(){this.addedTakeYouAwayStep(),this.FLAG_TOY_FLOWER_GOT=!0,ItemController.getInstance().hasItem(ItemEnum.ITEM_FLOWER_TWO)&&ItemController.getInstance().hasItem(ItemEnum.ITEM_FLOWER_THREE)?ItemController.getInstance().useItem(ItemEnum.ITEM_FLOWER_TWO)&&ItemController.getInstance().useItem(ItemEnum.ITEM_FLOWER_THREE)&&this.registItem(ItemEnum.ITEM_FLOWER_RING):this.registItem(ItemEnum.ITEM_FLOWER_ONE)},e.prototype.onWallFlowerAreaTouched=function(){this.addedTakeYouAwayStep(),ItemController.getInstance().hasItem(ItemEnum.ITEM_FLOWER_ONE)&&ItemController.getInstance().hasItem(ItemEnum.ITEM_FLOWER_THREE)?ItemController.getInstance().useItem(ItemEnum.ITEM_FLOWER_ONE)&&ItemController.getInstance().useItem(ItemEnum.ITEM_FLOWER_THREE)&&this.registItem(ItemEnum.ITEM_FLOWER_RING):this.registItem(ItemEnum.ITEM_FLOWER_TWO)},e.prototype.onPoolFlowerAreaTouched=function(){this.addedTakeYouAwayStep(),ItemController.getInstance().hasItem(ItemEnum.ITEM_FLOWER_TWO)&&ItemController.getInstance().hasItem(ItemEnum.ITEM_FLOWER_ONE)?ItemController.getInstance().useItem(ItemEnum.ITEM_FLOWER_TWO)&&ItemController.getInstance().useItem(ItemEnum.ITEM_FLOWER_ONE)&&this.registItem(ItemEnum.ITEM_FLOWER_RING):this.registItem(ItemEnum.ITEM_FLOWER_THREE)},e.prototype.onGrassAreaTouched=function(){this.FLAG_FLOWER_RING_USED&&this.FLAG_BERRY_USED?(SoundManager.getInstance().playSound(SoundEnum.BUSHSOUND_MP3),this.FLAG_LIT_HOURSE_UP=!0,egret.Tween.get(this.lithorse,{loop:!1}).to({y:529.9},1e3),egret.Tween.get(this.grass_2_left,{loop:!1}).to({x:-34-this.grass_2_left.width/2},1e3),egret.Tween.get(this.grass_2_right,{loop:!1}).to({x:86+this.grass_2_right.width/2},1e3)):(SoundManager.getInstance().playSound(SoundEnum.BUSH2SOUND_MP3),this.addedTakeYouAwayStep())},e.prototype.onToyTouched=function(){Util.singletonPush(this.cards,27),this.addedTakeYouAwayStep(),this.toy.gotoAndPlay(1)},e.prototype._loadRes=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,StageController.getInstance().loadStage(6)];case 1:return e.sent(),[3,3];case 2:return t=e.sent(),console.error(t),[3,3];case 3:return[2]}})})},e.prototype._start=function(){},e.prototype.play_loop=function(){var t=this;if(this.FLAG_GAME_OVER,this.FLAG_FLOWER_RING_USED&&this.FLAG_BERRY_USED&&!this.FLAG_LIT_HOURSE_UP)this.grass_2_left.x=-34+2*Math.random(),this.grass_2_right.x=86+2*Math.random();else if(this.FLAG_LIT_HOURSE_UP)this.COUNTER_FAIMILY_AWAY++,1===this.COUNTER_FAIMILY_AWAY&&(this.redHorse=new egret.MovieClip(this.horseFactory.generateMovieClipData("move")),this.redHorse.scaleX=67.1112/100,this.redHorse.scaleY=67.1112/100,this.redHorse.x=795.9,this.redHorse.y=531.6,this.addChildAt(this.redHorse,this.getChildIndex(this.litaway)+1),this.redHorse.play(-1),this.horse.movieClipData=this.horseFactory.generateMovieClipData("away"),this.horse.gotoAndStop(1)),this.COUNTER_FAIMILY_AWAY<60&&(this.redHorse.x-=9),61===this.COUNTER_FAIMILY_AWAY&&(this.lithorse.visible=!1,this.litaway.visible=!0,this.redHorse.stop(),this.litaway.play(-1),this.redHorse.movieClipData=this.horseFactory.generateMovieClipData("redaway"),this.redHorse.play(-1),this.horse.movieClipData=this.horseFactory.generateMovieClipData("away"),this.setChildIndex(this.horse,this.getChildIndex(this.redHorse)+1),this.horse.play(-1),this.toy.movieClipData=this.toyFactory.generateMovieClipData("toyboybye"),this.toy.play(),this.screen_splash.visible=!0,egret.Tween.get(this.screen_splash).to({alpha:.15}).to({alpha:0},80).to({alpha:1},1e3).call(function(){t.litaway.y=650,t.horse.x=495.45,t.horse.y=683.5,t.litaway.scaleX=-0.571112,t.redHorse.scaleX=-67.1112/100,t.horse.scaleX=67.1112/100,t.litaway.scaleY=.571112,t.redHorse.scaleY=67.1112/100,t.horse.scaleY=67.1112/100}).wait(1500).to({alpha:0},1200).call(function(){egret.Tween.get(t.litaway).to({x:254.45,y:456.5,scaleX:-.3,scaleY:.3},1e3),egret.Tween.get(t.redHorse).to({x:294.45,y:401.5,scaleX:-.3,scaleY:.3},1e3),egret.Tween.get(t.horse).to({x:454.45,y:456,scaleX:.4,scaleY:.4},1e3)})),210===this.COUNTER_FAIMILY_AWAY&&(this.FLAG_SAY_BYE_BYE=!0);else{if(this.MVHELP_FIRST_ENTER){if(egret.Tween.get(this.horse).to({x:this.horse.x-8*this.MVHELP_HORSE_TAKE_YOU_AWAY_STEP,y:this.horse.y+8*this.MVHELP_HORSE_TAKE_YOU_AWAY_STEP,scaleX:this.horse.scaleX*Math.pow(1.01,this.MVHELP_HORSE_TAKE_YOU_AWAY_STEP),scaleY:this.horse.scaleY*Math.pow(1.01,this.MVHELP_HORSE_TAKE_YOU_AWAY_STEP)},500),this.horse.gotoAndPlay(1),7===this.MVHELP_HORSE_TAKE_YOU_AWAY_STEP){this.horse.visible=!1,this.FLAG_TOY_FLOWER_GOT?this.toy.movieClipData=this.toyFactory.generateMovieClipData("toy"):this.toy.movieClipData=this.toyFactory.generateMovieClipData("toyflo");var e=new TSBitmap("take_boy",this.sheet);e.anchorOffsetX=e.width/2,e.anchorOffsetY=e.height/2,e.x=268.3,e.y=655,this.addChildAt(e,this.getChildIndex(this.toy)-1),this.FLAG_TAKE_AWAY=!0}5===this.MVHELP_HORSE_TAKE_YOU_AWAY_STEP&&(egret.Tween.get(this.berryleaf).to({x:520,y:834.7},1e3),this.berry_area.touchEnabled=!0),2===this.MVHELP_HORSE_TAKE_YOU_AWAY_STEP&&(this.pool_area.touchEnabled=!0)}this.MVHELP_FIRST_ENTER=!1}this.FLAG_SAY_BYE_BYE&&(this.COUNTER_CLEAR++,30===this.COUNTER_CLEAR&&(Util.singletonPush(this.cards,26),StageController.getInstance().clearStage(6,this.cards))),this.FLAG_TAKE_AWAY&&(this.COUNTER_GAME_OVER++,15===this.COUNTER_GAME_OVER&&(Util.singletonPush(this.cards,25),StageController.getInstance().gameOverStage(6,this.cards)))},e.prototype._remove=function(){egret.Tween.removeAllTweens()},e.prototype.registItem=function(t){ItemController.getInstance();if(ItemController.getInstance().addItem(t))switch(t){case ItemEnum.ITEM_FLOWER_ONE:this.toy.movieClipData=this.toyFactory.generateMovieClipData("toyboy"),this.toy.gotoAndStop(1),this.toy_flower_area.touchEnabled=!1,this.toy_flower_area.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onToyFlowerAreaTouched,this);break;case ItemEnum.ITEM_FLOWER_TWO:this.flower_wall.visible=!1,this.flower_wall.touchEnabled=!1,this.wall_flower_area.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onWallFlowerAreaTouched,this);break;case ItemEnum.ITEM_FLOWER_THREE:this.flower_pool.visible=!1,this.pool_flower_area.touchEnabled=!1,this.pool_flower_area.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onPoolFlowerAreaTouched,this);break;case ItemEnum.ITEM_FLOWER_RING:this.flower_pool.visible=!1,this.pool_flower_area.touchEnabled=!1,this.toy_flower_area.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onToyFlowerAreaTouched,this),this.wall_flower_area.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onWallFlowerAreaTouched,this),this.pool_flower_area.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onPoolFlowerAreaTouched,this);break;case ItemEnum.ITEM_BERRY:}},e.prototype.useItem=function(t,e,i){switch(t){case ItemEnum.ITEM_FLOWER_ONE:return!1;case ItemEnum.ITEM_FLOWER_TWO:return!1;case ItemEnum.ITEM_FLOWER_THREE:return!1;case ItemEnum.ITEM_FLOWER_RING:return this.horse.hitTestPoint(e,i)?(0===this.FLAG_HORSE_STEP?(this.FLAG_HORSE_STEP=2,this.horse.movieClipData=this.horseFactory.generateMovieClipData("step2")):2===this.FLAG_HORSE_STEP&&(this.FLAG_HORSE_STEP=3,this.horse.movieClipData=this.horseFactory.generateMovieClipData("step3")),this.FLAG_FLOWER_RING_USED=!0,this.addedTakeYouAwayStep(),!0):!1;case ItemEnum.ITEM_BERRY:return this.horse.hitTestPoint(e,i)?(0===this.FLAG_HORSE_STEP?(this.FLAG_HORSE_STEP=1,this.horse.movieClipData=this.horseFactory.generateMovieClipData("step1")):(this.FLAG_HORSE_STEP=3,this.horse.movieClipData=this.horseFactory.generateMovieClipData("step3")),this.FLAG_BERRY_USED=!0,this.addedTakeYouAwayStep(),!0):!1}return!1},e.prototype.getDisplayArea=function(){return new egret.Rectangle},e.prototype.ctrl_right=function(){},e.prototype.ctrl_left=function(){},e.prototype.ctrl_up=function(){},e.prototype.ctrl_down=function(){},e.prototype.ctrl_ok=function(){},e.prototype.ctrl_cancel=function(){},e}(egret.DisplayObjectContainer);__reflect(Stage6.prototype,"Stage6",["IFKaihiStage"]);var Stage7=function(t){function e(){var e=t.call(this)||this;return e.stageId=7,e.FLAG_IS_INITED=!1,e.FLAG_IS_RAINING=!1,e.FlAG_MORE_HEAVY_RAINING=!1,e.FLAG_MOST_HEAVY_RAINING=!1,e.FLAG_BOY_IN_RAINING=!1,e.FLAG_GOT_ITEM_UMBRELLA=!1,e.FLAG_BOY_WITH_UMBRELLA=!1,e.MOST_HEAVY_RAINING_BEGIN=!1,e.FLAG_BOY_IN_ROOM=!1,e.FLAG_DOOR_CLOSING=!1,e.FLAG_DOOR_OPENING=!1,e.FLAG_DOOR_OPENED=!1,e.FLAG_GAMEOVER=!1,e.MCHELP_BOY_ENTER_ROOM=0,e.MCHELP_BOY_BAD1=0,e.MCHELP_BOY_BAD2=0,e.COUNTER_BAD=0,e.COUNTER_CLEAR=0,e._init(),e}return __extends(e,t),e.prototype._init=function(){return __awaiter(this,void 0,void 0,function(){var t,e,i,s,h,a,o;return __generator(this,function(n){switch(n.label){case 0:return UIManager.getInstance().showLoading(),[4,this._loadRes()];case 1:for(n.sent(),this.sheet=RES.getRes("stage7_texture"),this.mcFactory=new egret.MovieClipDataFactory(RES.getRes("stage7_action_json"),RES.getRes("stage7_action_png")),t=new TSBitmap("bg",this.sheet),t.x=-120,t.y=-100,this.addChild(t),e=new TSBitmap("street",this.sheet),e.x=-120,e.y=246,this.addChild(e),this.room=new TSBitmap("room",this.sheet),this.room.x=-1,this.room.y=491,this.room.touchEnabled=!1,this.addChild(this.room),this.door=new TSBitmap("door",this.sheet),this.door.anchorOffsetX=this.door.width/2,this.door.anchorOffsetY=this.door.height/2,this.door.x=94.1,this.door.y=639.65,this.door.touchEnabled=!0,this.addChild(this.door),this.umbrella_sprite=new egret.Sprite,this.umbrella_sprite.x=206.75,this.umbrella_sprite.y=794.6,this.addChild(this.umbrella_sprite),this.umbrella=new TSBitmap("umbrella",this.sheet),this.umbrella.x=28.15-26,this.umbrella.y=-186,this.umbrella.touchEnabled=!0,this.umbrella_sprite.addChild(this.umbrella),this.umbrella_stand=new TSBitmap("umbrella_stand",this.sheet),this.umbrella_stand.x=-5,this.umbrella_stand.y=-112,this.umbrella_sprite.addChild(this.umbrella_stand),this.boy=new egret.MovieClip(this.mcFactory.generateMovieClipData("sh_standby")),this.boy.x=339.4,this.boy.y=731.25,this.boy.gotoAndStop(1),this.boy.touchEnabled=!0,this.addChild(this.boy),this.rainbow=new TSBitmap("rainbow",this.sheet),this.rainbow.anchorOffsetX=this.rainbow.width/2,this.rainbow.anchorOffsetY=this.rainbow.height/2,this.rainbow.x=320,this.rainbow.y=420,this.rainbow.visible=!1,this.addChild(this.rainbow),this.cloudSprite=new egret.Sprite,this.cloudSprite.x=638.75,this.cloudSprite.y=66,this.addChild(this.cloudSprite),i=new TSBitmap("cloud1",this.sheet),i.x=-1,i.y=185,this.cloudSprite.addChild(i),s=new TSBitmap("cloud2",this.sheet),s.x=276,s.y=86,this.cloudSprite.addChild(s),h=new TSBitmap("cloud3",this.sheet),h.x=618,h.y=0,this.cloudSprite.addChild(h),this.headShape=new egret.Shape,this.headShape.x=705.25,this.headShape.y=185,this.headShape.graphics.beginFill(0),this.headShape.graphics.drawRect(0,0,80,80),this.headShape.graphics.endFill(),this.headShape.alpha=0,this.headShape.visible=!1,this.headShape.touchEnabled=!1,this.cloudSprite.addChild(this.headShape),this.midShape=new egret.Shape,this.midShape.x=1230.45,this.midShape.y=185,this.midShape.graphics.beginFill(0),this.midShape.graphics.drawRect(0,0,80,80),this.midShape.graphics.endFill(),this.midShape.alpha=0,this.midShape.visible=!1,this.midShape.touchEnabled=!1,this.cloudSprite.addChild(this.midShape),this.rain=new egret.MovieClip(this.mcFactory.generateMovieClipData("rain1")),this.rain.x=1312.5,this.rain.y=611.45,this.cloudSprite.addChild(this.rain),this.rippleArray=[],o=0;13>o;o++)a=new egret.MovieClip(this.mcFactory.generateMovieClipData("ripple")),this.rippleArray.push(a);return this.cards=[],this.umbrella.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onUmbrellaTouched,this),this.door.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onDoorTouched,this),this.room.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onRoomTouched,this),this.FLAG_IS_INITED=!0,UIManager.getInstance().hideLoading(),[2]}})})},e.prototype.removeAllEventListener=function(){this.umbrella.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onUmbrellaTouched,this),this.door.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onDoorTouched,this),this.room.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onRoomTouched,this)},e.prototype.onDoorTouched=function(t){this.FLAG_BOY_IN_ROOM||(SoundManager.getInstance().playSound(SoundEnum.AUTODOORSOUND_MP3),this.FLAG_DOOR_OPENING=!0)},e.prototype.onRoomTouched=function(t){this.FLAG_BOY_IN_ROOM||(this.room.touchEnabled=!1,this.FLAG_BOY_IN_ROOM=!0,this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_dash"),this.boy.play(),this.boy.x=339.4-this.boy.width,this.boy.y=731.25,this.MCHELP_BOY_ENTER_ROOM=1,this.FLAG_BOY_WITH_UMBRELLA&&(this.umbrella.visible=!0))},e.prototype.onUmbrellaTouched=function(){this.FLAG_BOY_IN_ROOM||this.FLAG_GOT_ITEM_UMBRELLA||(this.FLAG_GOT_ITEM_UMBRELLA=!0,this.registItem(ItemEnum.ITEM_UMBRELLA))},e.prototype._loadRes=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,StageController.getInstance().loadStage(7)];case 1:return e.sent(),[3,3];case 2:return t=e.sent(),console.error(t),[3,3];case 3:return[2]}})})},e.prototype._start=function(){},e.prototype.play_loop=function(){if(this.FLAG_GAMEOVER)return void(60===this.COUNTER_BAD?(this.FLAG_BOY_WITH_UMBRELLA?Util.singletonPush(this.cards,29):Util.singletonPush(this.cards,28),StageController.getInstance().gameOverStage(this.stageId,this.cards)):this.COUNTER_BAD++);if(this.FLAG_IS_INITED){if(1===this.MCHELP_BOY_ENTER_ROOM)this.boy.currentFrame===this.boy.totalFrames&&(this.FLAG_DOOR_CLOSING=!0,SoundManager.getInstance().playSound(SoundEnum.AUTODOORSOUND_MP3),this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_enter"),this.setChildIndex(this.boy,this.getChildIndex(this.umbrella_sprite)),this.boy.x=97,this.boy.y=665.2,this.boy.play(),this.MCHELP_BOY_ENTER_ROOM=2);else if(2===this.MCHELP_BOY_ENTER_ROOM&&this.boy.currentFrame===this.boy.totalFrames){this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_hinan"),this.boy.x=289.6,this.boy.y=666.5;var t=new egret.Shape;t.graphics.beginFill(0),t.graphics.drawRect(201.3,517.85,142,157.8),t.graphics.endFill(),this.addChild(t),this.boy.mask=t,this.MCHELP_BOY_ENTER_ROOM=3}this.FLAG_DOOR_OPENING&&(this.door.x-=5,this.door.x+this.door.width<this.room.x&&(this.FLAG_DOOR_OPENING=!1,this.room.touchEnabled=!0)),this.FLAG_DOOR_CLOSING&&(this.door.x+=5,this.door.x>=-2+this.door.width/2&&(this.FLAG_DOOR_CLOSING=!1)),this.cloudSprite.x-=4,this.FLAG_BOY_IN_RAINING&&!this.FLAG_BOY_IN_ROOM?this.FLAG_GAMEOVER=!0:this.FLAG_BOY_IN_ROOM&&(Util.loopPlay(this.rain),this.midShape.localToGlobal().x<-960&&(3===this.MCHELP_BOY_ENTER_ROOM&&this.boy.currentFrame===this.boy.totalFrames&&(this.MCHELP_BOY_ENTER_ROOM=3,this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_clear"),this.boy.x=289.6,this.boy.y=666.5,this.boy.gotoAndStop(1),SoundManager.getInstance().playSound(SoundEnum.SHINESOUND_MP3),this.rainbow.visible=!0),30===this.COUNTER_CLEAR?(Util.singletonPush(this.cards,30),StageController.getInstance().clearStage(this.stageId,[30])):this.COUNTER_CLEAR++)),this.FLAG_MOST_HEAVY_RAINING?(this.MOST_HEAVY_RAINING_BEGIN||(SoundManager.getInstance().playSound(SoundEnum.WINDSOUND_1_MP3),egret.Tween.get(this.umbrella_sprite).to({x:this.umbrella_sprite.x,rotation:-90},800),this.MOST_HEAVY_RAINING_BEGIN=!0),this.FLAG_BOY_IN_ROOM||this.midShape.localToGlobal().x<-120&&(this.FLAG_BOY_IN_RAINING=!0),this.midShape.localToGlobal().x<0&&(this.FLAG_BOY_IN_ROOM||(this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_bad2s"),Util.loopPlay(this.boy)))):this.FlAG_MORE_HEAVY_RAINING?this.headShape.localToGlobal().x<0&&(this.FLAG_BOY_IN_ROOM||this.FLAG_BOY_WITH_UMBRELLA&&(this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_bad2"),this.boy.play(-1)),this.rain.movieClipData=this.mcFactory.generateMovieClipData("rain3"),this.rain.play(-1),this.FLAG_MOST_HEAVY_RAINING=!0):this.FLAG_IS_RAINING?this.headShape.localToGlobal().x<this.boy.x&&(this.removeAllEventListener(),this.FLAG_BOY_IN_ROOM||(this.FLAG_BOY_WITH_UMBRELLA?(this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_amagasa2"),this.boy.play(-1)):(this.FLAG_BOY_IN_RAINING=!0,this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_bad1"),this.boy.nextFrame())),this.rain.movieClipData=this.mcFactory.generateMovieClipData("rain2"),this.rain.play(-1),this.FlAG_MORE_HEAVY_RAINING=!0):this.headShape.localToGlobal().x<Util.curWidth()&&(this.rain.play(-1),this.FLAG_IS_RAINING=!0)}},e.prototype._remove=function(){egret.Tween.removeAllTweens()},e.prototype.registItem=function(t){ItemController.getInstance().addItem(t)&&t===ItemEnum.ITEM_UMBRELLA&&(this.umbrella.visible=!1)},e.prototype.useItem=function(t,e,i){return t===ItemEnum.ITEM_UMBRELLA&&this.boy.hitTestPoint(e,i)&&!this.FLAG_BOY_IN_ROOM?(SoundManager.getInstance().playSound(SoundEnum.UMBRELLASOUND_MP3),this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_amagasa"),this.boy.play(-1),this.FLAG_BOY_WITH_UMBRELLA=!0,!0):!1},e.prototype.getDisplayArea=function(){return new egret.Rectangle},e.prototype.ctrl_right=function(){},e.prototype.ctrl_left=function(){},e.prototype.ctrl_up=function(){},e.prototype.ctrl_down=function(){},e.prototype.ctrl_ok=function(){},e.prototype.ctrl_cancel=function(){},e}(egret.DisplayObjectContainer);__reflect(Stage7.prototype,"Stage7",["IFKaihiStage"]);var Stage8=function(t){function e(){var e=t.call(this)||this;return e.stageID=8,e.FLAG_INITED=!1,e.FLAG_END_GAMEOVER=!1,e.FLAG_END_CLEAR=!1,e.COUNTER_END=0,e.FLAG_ZOMBI_ACTION_END=0,e.FLAG_ZOMBI_HAKA=!1,e.HEROES_TURN=!1,e.cards=[],e.boyX=3,e.boyY=4,e.boyFace=-1,e.zombiX=[1,6],e.zombiY=[4,4],e.zombiList=[],e.zombiFace=[1,3],e.kengX=[2,5],e.kengY=[2,5],e.kengList=[],e.gridWidth=81,e.stoneX=[0,1,3,4,5,6,7,0,4,5,6,7,0,4,5,6,7,0,7,0,7,0,1,2,3,7,0,1,2,3,7,0,1,2,3,4,5,6,7],e.stoneY=[0,0,0,0,0,0,0,1,1,1,1,1,2,2,2,2,2,3,3,4,4,5,5,5,5,5,6,6,6,6,6,7,7,7,7,7,7,7,7],e.stoneList=[],e._init(),e}return __extends(e,t),e.prototype._init=function(){return __awaiter(this,void 0,void 0,function(){var t,e,i,s,h,a;return __generator(this,function(o){switch(o.label){case 0:return UIManager.getInstance().showLoading(),[4,this._loadRes()];case 1:for(o.sent(),this.sheet=RES.getRes("stage8_texture"),this.mcFactory=new egret.MovieClipDataFactory(RES.getRes("stage8_action_json"),RES.getRes("stage8_action_png")),t=new TSBitmap("bg",this.sheet),t.x=-120,t.y=-100,this.addChild(t),e=new TSBitmap("cemetery",this.sheet),e.x=-120,e.y=248,this.addChild(e),i=new TSBitmap("grid",this.sheet),i.x=-5,i.y=266.5,this.addChild(i),s=new TSBitmap("wall",this.sheet),s.x=-120,s.y=163,this.addChild(s),this.container=new egret.Sprite,this.addChild(this.container),this.keng1=new TSBitmap("keng",this.sheet,!0),this.keng1.x=200.85,this.keng1.y=466.35,this.container.addChild(this.keng1),this.keng2=new TSBitmap("keng",this.sheet,!0),this.keng2.x=440.9,this.keng2.y=704,this.container.addChild(this.keng2),this.kengList=[this.keng1,this.keng2],this.zombi1=new egret.MovieClip(this.mcFactory.generateMovieClipData("zombi_right")),this.zombi1.x=36+this.zombiX[0]*this.gridWidth,this.zombi1.y=300+this.zombiY[0]*this.gridWidth-33,this.zombi1.play(-1),this.container.addChild(this.zombi1),this.zombi2=new egret.MovieClip(this.mcFactory.generateMovieClipData("zombi_left")),this.zombi2.x=36+this.zombiX[1]*this.gridWidth,this.zombi2.y=300+this.zombiY[1]*this.gridWidth-33,this.zombi2.play(-1),this.container.addChild(this.zombi2),this.zombiList=[this.zombi1,this.zombi2],a=0;a<this.stoneX.length;a++)h=this.newStone(this.stoneX[a],this.stoneY[a]),this.container.addChild(h);return this.leftArea=new egret.Shape,this.leftArea.graphics.beginFill(6697881),this.leftArea.graphics.drawRect(0,0,this.gridWidth,this.gridWidth),this.leftArea.graphics.endFill(),this.leftArea.touchEnabled=!0,this.container.addChild(this.leftArea),this.upArea=new egret.Shape,this.upArea.graphics.beginFill(6697881),this.upArea.graphics.drawRect(0,0,this.gridWidth,this.gridWidth),this.upArea.graphics.endFill(),this.upArea.touchEnabled=!0,this.container.addChild(this.upArea),this.rightArea=new egret.Shape,this.rightArea.graphics.beginFill(6697881),this.rightArea.graphics.drawRect(0,0,this.gridWidth,this.gridWidth),this.rightArea.graphics.endFill(),this.rightArea.touchEnabled=!0,this.container.addChild(this.rightArea),this.downArea=new egret.Shape,this.downArea.graphics.beginFill(6697881),this.downArea.graphics.drawRect(0,0,this.gridWidth,this.gridWidth),this.downArea.graphics.endFill(),this.downArea.touchEnabled=!0,this.downArea.visible=!1,this.container.addChild(this.downArea),this.boy=new egret.MovieClip(this.mcFactory.generateMovieClipData("sh_stop")),this.boy.x=this.boyX*this.gridWidth+36,this.boy.y=this.boyY*this.gridWidth+305,this.container.addChild(this.boy),this.leftArea.x=this.boy.x-3*this.gridWidth/2,this.leftArea.y=this.boy.y-this.gridWidth/2,this.rightArea.x=this.boy.x+this.gridWidth/2,this.rightArea.y=this.boy.y-this.gridWidth/2,this.upArea.x=this.boy.x-this.gridWidth/2,this.upArea.y=this.boy.y-this.gridWidth-this.gridWidth/2,this.downArea.x=this.boy.x-this.gridWidth/2,this.downArea.y=this.boy.y+this.gridWidth-this.gridWidth/2,this.areaAlpha=1,this.alphaChange=.1,this.FLAG_INITED=!0,this.HEROES_TURN=!0,this.setChildrenIndex(),this.addAllEventListener(),UIManager.getInstance().hideLoading(),[2]}})})},e.prototype.newStone=function(t,e,i){void 0===i&&(i=!1);var s=new TSBitmap("stone",this.sheet,!0);return s.x=40+t*this.gridWidth,s.y=306+e*this.gridWidth,i&&(this.stoneX.push(t),this.stoneY.push(e)),this.stoneList.push(s),s},e.prototype.addAllEventListener=function(){this.leftArea.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onLeftTouched,this),this.rightArea.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onRightTouched,this),this.upArea.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onUpTouched,this),this.downArea.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onDownTouched,this)},e.prototype.removeAllEventListener=function(){this.leftArea.visible=!1,this.rightArea.visible=!1,this.upArea.visible=!1,this.downArea.visible=!1,this.leftArea.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onLeftTouched,this),this.rightArea.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onRightTouched,this),this.upArea.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onUpTouched,this),this.downArea.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onDownTouched,this)},e.prototype.onLeftTouched=function(t){var e=this;this.boyX--,this.removeAllEventListener(),3!==this.boyFace&&(this.boyFace=3,this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_left"),this.boy.y=this.boyY*this.gridWidth+300-33,this.boy.play(-1)),egret.Tween.get(this.boy).to({x:this.boyX*this.gridWidth+36},1e3).call(function(){e.update(3)})},e.prototype.onRightTouched=function(t){var e=this;this.boyX++,this.removeAllEventListener(),1!==this.boyFace&&(this.boyFace=1,this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_right"),this.boy.y=this.boyY*this.gridWidth+300-33,this.boy.play(-1)),egret.Tween.get(this.boy).to({x:this.boyX*this.gridWidth+36},1e3).call(function(){e.update(1)})},e.prototype.onUpTouched=function(t){var e=this;this.removeAllEventListener(),this.boyY--,0!==this.boyFace&&(this.boyFace=0,this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_up"),this.boy.play(-1)),egret.Tween.get(this.boy).to({y:this.boyY*this.gridWidth+300-33},1e3).call(function(){e.update(0)})},e.prototype.onDownTouched=function(t){var e=this;this.removeAllEventListener(),this.boyY++,2!==this.boyFace&&(this.boyFace=2,this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_down"),this.boy.play(-1)),egret.Tween.get(this.boy).to({y:this.boyY*this.gridWidth+300-33},1e3).call(function(){e.update(2)})},e.prototype.isHero=function(t,e,i){return t===this.boyX&&e===this.boyY?!0:!1},e.prototype.isZombiDiaoKeng=function(){for(var t=0;t<this.zombiList.length;t++)this.isDiaoKeng(this.zombiX[t],this.zombiY[t],!0)&&(this.zombiList[t].movieClipData=this.mcFactory.generateMovieClipData("zombi_haka"),this.zombiList[t].play(),this.diedZombie=this.zombiList[t],this.zombiList[t].y+=33,this.zombiList.splice(t,1),this.zombiX.splice(t,1),this.zombiY.splice(t,1),this.FLAG_ZOMBI_HAKA=!0,SoundManager.getInstance().playSound(SoundEnum.ZOMBIDEADSOUND_MP3))},e.prototype.isDiaoKeng=function(t,e,i){for(var s=0;s<this.kengX.length;s++)if(t===this.kengX[s]&&e===this.kengY[s])return this.container.removeChild(this.kengList[s]),i&&(this.newBuildStone=this.newStone(this.kengX[s],this.kengY[s],!0),this.container.addChild(this.newBuildStone),this.newBuildStone.visible=!1),this.kengList.splice(s,1),this.kengX.splice(s,1),this.kengY.splice(s,1),!0;return!1},e.prototype.update=function(t){return __awaiter(this,void 0,void 0,function(){var e,i,s,h;return __generator(this,function(a){switch(a.label){case 0:return SoundManager.getInstance().playSound(SoundEnum.ZOMBIMOVESOUND_MP3),this.isDiaoKeng(this.boyX,this.boyY,!1)?(SoundManager.getInstance().playSound(SoundEnum.ZOMBIDIGGINGSOUND_MP3),this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_sh_haka"),this.boy.y+=33,this.boy.play(),this.FLAG_END_GAMEOVER=!0,Util.singletonPush(this.cards,32),[3,6]):[3,1];case 1:if(null===this.isZombi(this.boyX,this.boyY))return[3,2];switch(SoundManager.getInstance().playSound(SoundEnum.ZOMBIATTACKSOUND_MP3),e=this.isZombi(this.boyX,this.boyY),this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_bad"),this.boy.y+=33,this.boy.play(),t){case 0:e.movieClipData=this.mcFactory.generateMovieClipData("zombi_attack_down"),e.play();break;case 1:e.movieClipData=this.mcFactory.generateMovieClipData("zombi_attack_left"),e.play();break;case 2:e.movieClipData=this.mcFactory.generateMovieClipData("zombi_attack_up"),e.play();break;case 3:e.movieClipData=this.mcFactory.generateMovieClipData("zombi_attack_left"),e.scaleX=-1,e.play()}return this.FLAG_END_GAMEOVER=!0,Util.singletonPush(this.cards,31),[3,6];case 2:i=void 0,s=0,a.label=3;case 3:return s<this.zombiX.length?[4,this.zombiAction(this.zombiX[s],this.zombiY[s],this.zombiFace[s])]:[3,6];case 4:i=a.sent(),i.move===!0?(h=void 0,0===i.direction?(this.zombiY[s]-=1,h=300+this.zombiY[s]*this.gridWidth-33):1===i.direction?(this.zombiX[s]+=1,h=36+this.zombiX[s]*this.gridWidth):2===i.direction?(this.zombiY[s]+=1,h=300+this.zombiY[s]*this.gridWidth-33):3===i.direction&&(this.zombiX[s]-=1,h=36+this.zombiX[s]*this.gridWidth),this.zombiMove(this.zombiList[s],h,i.direction,this.isHero(this.zombiX[s],this.zombiY[s],i.direction))):(this.zombiFace[s]=i.direction,this.zombiChangeFace(this.zombiList[s],i.direction)),a.label=5;case 5:return s++,[3,3];case 6:return this.setChildrenIndex(),[2]}})})},e.prototype.setChildrenIndex=function(){for(var t=0,e=0;8>e;e++){var i=void 0;for(i=0;i<this.kengList.length;i++)this.kengY[i]===e&&(this.container.setChildIndex(this.kengList[i],t),t++);for(i=0;i<this.zombiY.length;i++)this.zombiY[i]===e&&(this.container.setChildIndex(this.zombiList[i],t),t++);for(i=0;i<this.stoneY.length;i++)this.stoneY[i]===e&&(this.container.setChildIndex(this.stoneList[i],t),t++);this.boyY===e&&(this.container.setChildIndex(this.boy,t),t++)}this.container.setChildIndex(this.upArea,this.container.getChildIndex(this.boy)),this.container.setChildIndex(this.downArea,this.container.numChildren),this.container.setChildIndex(this.leftArea,this.container.getChildIndex(this.boy)),this.container.setChildIndex(this.rightArea,this.container.getChildIndex(this.boy))},e.prototype.heroDie=function(){Util.singletonPush(this.cards,31),this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_bad"),this.boy.play(),this.boy.y+=33,this.FLAG_END_GAMEOVER=!0},e.prototype.zombiMove=function(t,e,i,s){var h=this;if(s)switch(i){case 0:t.movieClipData=this.mcFactory.generateMovieClipData("zombi_attack_up"),t.play(),this.heroDie();break;case 2:t.movieClipData=this.mcFactory.generateMovieClipData("zombi_attack_down"),t.play(),this.heroDie();break;case 1:t.movieClipData=this.mcFactory.generateMovieClipData("zombi_attack_left"),t.scaleX=-1,t.play(),this.heroDie();break;case 3:t.movieClipData=this.mcFactory.generateMovieClipData("zombi_attack_left"),t.play(),this.heroDie()}else switch(i){case 0:case 2:egret.Tween.get(t).to({y:e},1e3).call(function(){h.FLAG_ZOMBI_ACTION_END++});break;case 1:case 3:egret.Tween.get(t).to({x:e},1e3).call(function(){h.FLAG_ZOMBI_ACTION_END++})}},e.prototype.zombiChangeFace=function(t,e){switch(e){case 0:t.movieClipData=this.mcFactory.generateMovieClipData("zombi_up"),t.play(-1);break;case 1:t.movieClipData=this.mcFactory.generateMovieClipData("zombi_right"),t.play(-1);break;case 2:t.movieClipData=this.mcFactory.generateMovieClipData("zombi_down"),t.play(-1);break;case 3:t.movieClipData=this.mcFactory.generateMovieClipData("zombi_left"),t.play(-1);break;default:console.log("error zombi direction")}this.FLAG_ZOMBI_ACTION_END++},e.prototype.zombiAction=function(t,e,i){var s={move:!1,direction:-1},h=t-this.boyX>0?!0:!1,a=e-this.boyY>0?!0:!1;return Math.abs(t-this.boyX)-Math.abs(e-this.boyY)>=0?h&&!this.isStone(t-1,e)&&null===this.isZombi(t-1,e)?(3===i&&(s.move=!0),s.direction=3):this.isStone(t+1,e)||null!==this.isZombi(t+1,e)?(2===i&&null===this.isZombi(t,e+1)?s.move=!0:0===i&&null===this.isZombi(t,e-1)&&(s.move=!0),s.direction=i):(1===i&&(s.move=!0),s.direction=1):a&&!this.isStone(t,e-1)&&null===this.isZombi(t,e-1)?(0===i&&(s.move=!0),s.direction=0):this.isStone(t,e+1)||null!==this.isZombi(t,e+1)?(3===i&&null===this.isZombi(t-1,e)?s.move=!0:1===i&&null===this.isZombi(t+1,e)&&(s.move=!0),s.direction=i):(2===i&&(s.move=!0),s.direction=2),s},e.prototype.isZombi=function(t,e){for(var i=0;i<this.zombiX.length;i++)if(this.zombiX[i]===t&&this.zombiY[i]===e)return this.zombiList[i];return null},e.prototype.isStone=function(t,e){for(var i=0;i<this.stoneX.length;i++)if(this.stoneX[i]===t&&this.stoneY[i]===e)return!0;return!1},e.prototype.setMoveArea=function(){this.leftArea.visible=!0,this.rightArea.visible=!0,this.upArea.visible=!0,this.downArea.visible=!0,this.addAllEventListener();for(var t=0;t<this.stoneX.length;t++)this.stoneX[t]>=this.boyX-1&&this.stoneX[t]<=this.boyX+1&&this.stoneY[t]>=this.boyY-1&&this.stoneY[t]<=this.boyY+1&&Math.abs(this.stoneX[t]-this.boyX)+Math.abs(this.stoneY[t]-this.boyY)===1&&(1===Math.abs(this.stoneX[t]-this.boyX)?this.stoneX[t]>this.boyX?this.rightArea.visible=!1:this.leftArea.visible=!1:1===Math.abs(this.stoneY[t]-this.boyY)&&(this.stoneY[t]>this.boyY?this.downArea.visible=!1:this.upArea.visible=!1));0===this.boyY&&(this.upArea.visible=!1),this.leftArea.x=this.boy.x-3*this.gridWidth/2,this.leftArea.y=this.boy.y,this.rightArea.x=this.boy.x+this.gridWidth/2,this.rightArea.y=this.boy.y,this.upArea.x=this.boy.x-this.gridWidth/2,this.upArea.y=this.boy.y-this.gridWidth,this.downArea.x=this.boy.x-this.gridWidth/2,this.downArea.y=this.boy.y+this.gridWidth},e.prototype._loadRes=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,StageController.getInstance().loadStage(8)];case 1:return e.sent(),[3,3];case 2:return t=e.sent(),console.error(t),[3,3];
case 3:return[2]}})})},e.prototype._start=function(){},e.prototype.play_loop=function(){return this.FLAG_END_GAMEOVER||this.FLAG_END_CLEAR?(this.FLAG_END_GAMEOVER&&(20===this.COUNTER_END&&SoundManager.getInstance().playSound(SoundEnum.ZOMBIGAMEOVERSOUND_MP3),this.COUNTER_END++,60===this.COUNTER_END&&StageController.getInstance().gameOverStage(this.stageID,this.cards)),void(this.FLAG_END_CLEAR&&(this.COUNTER_END++,20===this.COUNTER_END&&SoundManager.getInstance().playSound(SoundEnum.ZOMBICLEARSOUND_MP3),60===this.COUNTER_END&&(Util.singletonPush(this.cards,33),StageController.getInstance().clearStage(this.stageID,this.cards))))):void(this.FLAG_INITED&&(this.FLAG_ZOMBI_HAKA&&this.diedZombie.currentFrame===this.diedZombie.totalFrames&&(this.container.removeChild(this.diedZombie),this.newBuildStone.visible=!0,this.FLAG_ZOMBI_HAKA=!1),this.FLAG_ZOMBI_ACTION_END>=this.zombiX.length&&(this.isZombiDiaoKeng(),0===this.zombiX.length?(this.boy.movieClipData=this.mcFactory.generateMovieClipData("sh_clear"),this.boy.play(),this.boy.y=this.boy.y+33,this.FLAG_END_CLEAR=!0):(this.setMoveArea(),this.FLAG_ZOMBI_ACTION_END=0,SoundManager.getInstance().playSound(SoundEnum.ZOMBIMOVESOUND_MP3),this.HEROES_TURN=!0)),this.areaAlpha+=this.alphaChange,this.areaAlpha>=.8?this.alphaChange=-.05:this.areaAlpha<=.4&&(this.alphaChange=.05),this.leftArea.alpha=this.rightArea.alpha=this.upArea.alpha=this.downArea.alpha=this.areaAlpha))},e.prototype._remove=function(){egret.Tween.removeAllTweens()},e.prototype.registItem=function(t){},e.prototype.useItem=function(t,e,i){return!0},e.prototype.getDisplayArea=function(){return new egret.Rectangle},e.prototype.ctrl_right=function(){},e.prototype.ctrl_left=function(){},e.prototype.ctrl_up=function(){},e.prototype.ctrl_down=function(){},e.prototype.ctrl_ok=function(){},e.prototype.ctrl_cancel=function(){},e}(egret.DisplayObjectContainer);__reflect(Stage8.prototype,"Stage8",["IFKaihiStage"]);var Stage9=function(t){function e(){var e=t.call(this)||this;return e.STAGE_ID=9,e.FLAG_IS_INITED=!1,e.FLAG_SHOW_PANGXIE=!1,e.FLAG_SHOW_WUZEI=!1,e.FLAG_LANG_IS_HERE=!1,e.FLAG_ITEM_MIZUGUMO_USED=!1,e.FLAG_BOY_HAS_UKIWA=!0,e.FLAG_BOY_SINKED=!1,e.FLAG_GAME_OVER=!1,e.FLAG_GAME_CLEAR=!1,e.FLAG_NINJA_STATUS=0,e.COUNTER_BOY_SINK=0,e.COUNTER_GAMEOVER=0,e.COUNTER_CLEAR=0,e.TWEEN_HELP_LANG_IS_PAUSE=!1,e.TWEEN_HELP_ITEM_PAUSE=!1,e.cards=[],e._init(),e}return __extends(e,t),e.prototype._init=function(){return __awaiter(this,void 0,void 0,function(){var t,e,i,s,h,a,o,n;return __generator(this,function(r){switch(r.label){case 0:return UIManager.getInstance().showLoading(),[4,this._loadRes()];case 1:return r.sent(),this.sheet=RES.getRes("stage9_texture"),this.mcFactory=new egret.MovieClipDataFactory(RES.getRes("stage9_action_json"),RES.getRes("stage9_action_png")),t=new TSBitmap("bg",this.sheet),t.x=-120,t.y=-100,this.addChild(t),e=new TSBitmap("sea",this.sheet),e.x=-120,e.y=574,this.addChild(e),i=new TSBitmap("tree",this.sheet),i.x=29,i.y=480,this.addChild(i),s=new TSBitmap("ball1",this.sheet),s.x=29.4,s.y=696.05,this.addChild(s),h=new TSBitmap("ball2",this.sheet),h.x=87.2,h.y=645.8,this.addChild(h),a=new TSBitmap("ball3",this.sheet),a.x=139.3,a.y=608.8,this.addChild(a),o=new TSBitmap("ball4",this.sheet),o.x=173.75,o.y=586.8,this.addChild(o),this.lang=new egret.MovieClip(this.mcFactory.generateMovieClipData("lang1")),this.lang.x=322.45,this.lang.y=564.05,this.lang.play(-1),this.addChild(this.lang),this.bubble1=new egret.MovieClip(this.mcFactory.generateMovieClipData("bubble")),this.bubble1.anchorOffsetX=this.bubble1.width/2,this.bubble1.anchorOffsetY=this.bubble1.height/2,this.bubble1.x=95.3,this.bubble1.y=786,this.bubble1.touchEnabled=!0,this.bubble1.gotoAndStop(1),this.addChild(this.bubble1),this.bubble2=new egret.MovieClip(this.mcFactory.generateMovieClipData("bubble")),this.bubble2.anchorOffsetX=this.bubble2.width/2,this.bubble2.anchorOffsetY=this.bubble2.height/2,this.bubble2.x=454.2,this.bubble2.y=752,this.bubble2.touchEnabled=!0,this.bubble2.gotoAndStop(5),this.addChild(this.bubble2),this.langEffect(),this.clearSprite=new egret.Sprite,this.clearSprite.visible=!1,n=new TSBitmap("bg",this.sheet),n.x=t.x,n.y=t.y,this.clearSprite.addChild(n),this.clearMc=new egret.MovieClip(this.mcFactory.generateMovieClipData("clear")),this.clearMc.x=320,this.clearMc.y=560,this.clearMc.gotoAndStop(1),this.clearSprite.addChild(this.clearMc),this.addChild(this.clearSprite),this.clearFire=new egret.MovieClip(this.mcFactory.generateMovieClipData("ninja_naminori1")),this.clearFire.anchorOffsetX=this.clearFire.width/2,this.clearFire.anchorOffsetY=this.clearFire.height/2,this.clearFire.visible=!1,this.clearSprite.addChild(this.clearFire),this.wood=new TSBitmap("wood",this.sheet),this.wood.anchorOffsetX=this.wood.width/2,this.wood.anchorOffsetY=this.wood.height/2,this.wood.visible=!1,this.clearSprite.addChild(this.wood),this.boyBmp=new TSBitmap("boy1",this.sheet),this.boyBmp.anchorOffsetX=this.boyBmp.width/2,this.boyBmp.anchorOffsetY=this.boyBmp.height/2,this.boyBmp.x=311.5,this.boyBmp.y=775.8,this.boyBmp.touchEnabled=!0,this.addChild(this.boyBmp),this.boyMc=new egret.MovieClip(this.mcFactory.generateMovieClipData("sh_obore_bad1")),this.boyMc.x=311.5,this.boyMc.y=775.8,this.boyMc.visible=!1,this.addChild(this.boyMc),this.boy_help_mc=new egret.MovieClip(this.mcFactory.generateMovieClipData("sh_obore_bad2")),this.boy_help_mc.x=329,this.boy_help_mc.y=858.3,this.boy_help_mc.visible=!1,this.addChild(this.boy_help_mc),this.ninja=new egret.MovieClip(this.mcFactory.generateMovieClipData("ninja_hide")),this.ninja.anchorOffsetX=this.ninja.width/2,this.ninja.anchorOffsetY=this.ninja.height/2,this.ninja_help_mc=new egret.MovieClip(this.mcFactory.generateMovieClipData("ninja_hide2")),this.ninja_help_mc.anchorOffsetX=this.ninja_help_mc.width/2,this.ninja_help_mc.anchorOffsetY=this.ninja_help_mc.height/2,this.ninja_help_mc.x=this.ninja.x=574.1,this.ninja_help_mc.y=this.ninja.y=814.75,this.ninja_help_mc.play(-1),this.addChild(this.ninja),this.addChild(this.ninja_help_mc),this.boyArea=new egret.Shape,this.boyArea.graphics.beginFill(0),this.boyArea.graphics.drawRect(182.8,702,212,150),this.boyArea.graphics.endFill(),this.boyArea.alpha=0,this.boyArea.touchEnabled=!0,this.addChild(this.boyArea),this.ninjaArea=new egret.Shape,this.ninjaArea.graphics.beginFill(0),this.ninjaArea.graphics.drawRect(481.65,733,100,60),this.ninjaArea.graphics.endFill(),this.ninjaArea.alpha=0,this.ninjaArea.touchEnabled=!0,this.addChild(this.ninjaArea),this.bubble1Area=new egret.Shape,this.bubble1Area.graphics.beginFill(0),this.bubble1Area.graphics.drawRect(55.3,746,80,80),this.bubble1Area.graphics.endFill(),this.bubble1Area.alpha=0,this.bubble1Area.touchEnabled=!0,this.addChild(this.bubble1Area),this.bubble2Area=new egret.Shape,this.bubble2Area.graphics.beginFill(0),this.bubble2Area.graphics.drawRect(414.2,712,80,80),this.bubble2Area.graphics.endFill(),this.bubble2Area.alpha=0,this.bubble2Area.touchEnabled=!0,this.addChild(this.bubble2Area),this.screen_splash=new egret.Shape,this.screen_splash.graphics.beginFill(16777215),this.screen_splash.graphics.drawRect(0,0,Util.curWidth(),Util.curHeight()),this.screen_splash.graphics.endFill(),this.screen_splash.alpha=0,this.screen_splash.visible=!1,this.screen_splash.touchEnabled=!1,this.addChild(this.screen_splash),this.inited(),this.FLAG_IS_INITED=!0,UIManager.getInstance().hideLoading(),this.addAllEventListener(),[2]}})})},e.prototype.inited=function(){this.bubble1.play(-1),this.bubble2.play(-1),this.ninja.play(-1),this.ninja_help_mc.play(-1)},e.prototype.addAllEventListener=function(){this.boyArea.touchEnabled=!0,this.bubble1Area.touchEnabled=!0,this.bubble2Area.touchEnabled=!0,this.ninjaArea.touchEnabled=!0,this.boyArea.addEventListener(egret.TouchEvent.TOUCH_TAP,this.boyAreaTouched,this),this.bubble1Area.addEventListener(egret.TouchEvent.TOUCH_TAP,this.bubble1Touched,this),this.bubble2Area.addEventListener(egret.TouchEvent.TOUCH_TAP,this.bubble2Touched,this)},e.prototype.removeAllEventListener=function(){this.boyArea.touchEnabled=!1,this.bubble1Area.touchEnabled=!1,this.bubble2Area.touchEnabled=!1,this.ninjaArea.touchEnabled=!1,this.boyArea.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.boyAreaTouched,this),this.bubble1Area.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.bubble1Touched,this),this.bubble2Area.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.bubble2Touched,this)},e.prototype.boyAreaTouched=function(t){this.FLAG_BOY_HAS_UKIWA&&(this.registItem(ItemEnum.ITEM_UKIWA),this.removeAllEventListener(),this.FLAG_BOY_HAS_UKIWA=!1,this.boyBmp.visible=!1,this.boyMc.visible=!0,this.boy_help_mc.visible=!0,this.boyMc.mask=this.boyArea,this.boy_help_mc.gotoAndPlay(1),this.boyMc.gotoAndPlay(1))},e.prototype.bubble1Touched=function(t){this.FLAG_SHOW_WUZEI?this.registItem(ItemEnum.ITEM_TAKO):(SoundManager.getInstance().playSound(SoundEnum.WATER2SOUND_MP3),this.bubble1.movieClipData=this.mcFactory.generateMovieClipData("tako_mc"),this.bubble1.gotoAndPlay(1),this.FLAG_SHOW_WUZEI=!0)},e.prototype.bubble2Touched=function(t){this.FLAG_SHOW_PANGXIE?this.registItem(ItemEnum.ITEM_KANI):(SoundManager.getInstance().playSound(SoundEnum.WATER2SOUND_MP3),this.bubble2.movieClipData=this.mcFactory.generateMovieClipData("kani_mc"),this.bubble2.gotoAndPlay(1),this.FLAG_SHOW_PANGXIE=!0)},e.prototype.ninjaTouched=function(t){this.ninja.visible=!1,this.ninja_help_bmp=new TSBitmap("ninjia",this.sheet),this.ninja_help_bmp.anchorOffsetX=this.ninja_help_bmp.width/2,this.ninja_help_bmp.anchorOffsetY=this.ninja_help_bmp.height/2,this.ninja_help_bmp.x=581,this.ninja_help_bmp.y=644.65,this.addChild(this.ninja_help_bmp),this.ninja_help_mc.movieClipData=this.mcFactory.generateMovieClipData("ninja_sizumi"),this.ninja_help_mc.x=581,this.ninja_help_mc.y=644.65,this.addChild(this.ninja_help_mc),this.FLAG_NINJA_STATUS=3,this.registItem(ItemEnum.ITEM_MIZUGUMO)},e.prototype.langEffect=function(){var t=this;egret.Tween.get(this.lang).to({scaleX:1.3,scaleY:1.3},50/30*1e3).call(function(){t.lang.visible=!1,t.lang.movieClipData=t.mcFactory.generateMovieClipData("lang2"),t.lang.play(-1),t.lang.visible=!0},this,[]).to({scaleX:.8,scaleY:.8}).to({scaleX:1,scaleY:1},50/30*1e3).call(function(){t.lang.visible=!1,t.lang.movieClipData=t.mcFactory.generateMovieClipData("lang3"),t.lang.play(-1),t.lang.visible=!0},this,[]).to({scaleX:.58,scaleY:.46}).to({scaleX:1,scaleY:1},2e3).call(function(){t.lang.visible=!1,t.lang.movieClipData=t.mcFactory.generateMovieClipData("lang4"),t.lang.play(-1),t.lang.visible=!0},this,[]).to({scaleX:.6,scaleY:.6}).to({scaleX:1.3,scaleY:1.3},50/30*1e3).call(function(){SoundManager.getInstance().playSound(SoundEnum.NAMISOUND_1_MP3)}).wait(1e3).call(function(){t.FLAG_LANG_IS_HERE=!0,t.removeAllEventListener(),t.screen_splash.visible=!0,egret.Tween.get(t.screen_splash).to({alpha:.15}).to({alpha:0},80).to({alpha:1},1e3).call(function(){t.clearSprite.visible=!0,t.lang.visible=!1,t.FLAG_ITEM_MIZUGUMO_USED?(t.boyBmp.visible=!0,t.boyBmp.x=t.clearMc.x+23.15+-2.7,t.boyBmp.y=t.clearMc.y-103.05+7.15,t.boyBmp.texture=t.sheet.getTexture("boy"),t.boyMc.visible=!1,t.boy_help_mc.visible=!1,t.wood.visible=!0,t.wood.x=t.clearMc.x+23.15+1.3-42,t.wood.y=t.clearMc.y-103.05+48.9-34,t.clearFire.x=t.clearMc.x+23.15+7.7,t.clearFire.y=t.clearMc.y-103.05-6.85,t.clearFire.visible=!0,t.clearFire.play(-1),t.ninja.visible=!1,t.ninja_help_bmp.visible=!1,t.ninja_help_mc.visible=!1):(t.boyBmp.visible=!1,t.boy_help_mc.visible=!1,t.boyMc.visible=!0,t.boyMc.movieClipData=t.mcFactory.generateMovieClipData("bad2"),t.boyMc.x=t.clearMc.x-30.85,t.boyMc.y=t.clearMc.y-103.05,t.boyMc.play(-1),2===t.FLAG_NINJA_STATUS?(t.ninja.movieClipData=t.mcFactory.generateMovieClipData("bad"),t.ninja.x=t.clearMc.x+117.65-12.9-5,t.ninja.y=t.clearMc.y-103.05-47.9+10,t.wood.visible=!0,t.wood.x=t.clearMc.x+117.65+1.3-42,t.wood.y=t.clearMc.y-103.05+48.9-34,t.clearFire.visible=!0,t.clearFire.x=t.clearMc.x+117.65+7.7,t.clearFire.y=t.clearMc.y-103.05-6.85,t.clearFire.play(-1)):(t.ninja.visible=!1,t.ninja_help_mc.visible=!1))}).wait(1500).to({alpha:0},1200).call(function(){t.FLAG_ITEM_MIZUGUMO_USED?(t.FLAG_GAME_CLEAR=!0,Util.singletonPush(t.cards,39)):(t.FLAG_GAME_OVER=!0,Util.singletonPush(t.cards,37))})})},e.prototype._loadRes=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,StageController.getInstance().loadStage(9)];case 1:return e.sent(),[3,3];case 2:return t=e.sent(),console.error(t),[3,3];case 3:return[2]}})})},e.prototype._start=function(){},e.prototype.item_pause=function(){this.removeAllEventListener(),egret.Tween.pauseTweens(this.lang),this.TWEEN_HELP_ITEM_PAUSE=!0},e.prototype.game_pause=function(){this.removeAllEventListener(),egret.Tween.pauseTweens(this.lang),this.TWEEN_HELP_LANG_IS_PAUSE=!0},e.prototype.game_resume=function(){this.addAllEventListener(),egret.Tween.resumeTweens(this.lang),this.TWEEN_HELP_LANG_IS_PAUSE=!1},e.prototype.play_loop=function(){(this.FLAG_GAME_OVER||this.FLAG_BOY_SINKED)&&(this.COUNTER_GAMEOVER++,45===this.COUNTER_GAMEOVER&&(2===this.FLAG_NINJA_STATUS&&Util.singletonPush(this.cards,38),StageController.getInstance().gameOverStage(this.STAGE_ID,this.cards))),this.FLAG_GAME_CLEAR&&(this.COUNTER_CLEAR++,60===this.COUNTER_CLEAR&&StageController.getInstance().clearStage(this.STAGE_ID,this.cards)),this.TWEEN_HELP_ITEM_PAUSE&&(this.addAllEventListener(),this.TWEEN_HELP_ITEM_PAUSE=!1,egret.Tween.resumeTweens(this.lang)),this.FLAG_BOY_SINKED||this.FLAG_BOY_HAS_UKIWA===!1&&(this.COUNTER_BOY_SINK>=72?(this.COUNTER_BOY_SINK=72,this.FLAG_BOY_SINKED=!0,Util.singletonPush(this.cards,34)):(this.boyMc.y++,this.COUNTER_BOY_SINK++)),1===this.FLAG_NINJA_STATUS?(38===this.ninja.currentFrame&&SoundManager.getInstance().playSound(SoundEnum.WATER2SOUND_MP3),this.ninja.totalFrames===this.ninja.currentFrame&&(this.ninja.movieClipData=this.mcFactory.generateMovieClipData("ninja_stand"),this.ninja.x=580.85,this.ninja.y=654.5,this.ninja.gotoAndPlay(1),this.ninjaArea.addEventListener(egret.TouchEvent.TOUCH_TAP,this.ninjaTouched,this),this.FLAG_NINJA_STATUS=2,this.game_pause())):2===this.FLAG_NINJA_STATUS?(this.game_resume(),Util.loopPlay(this.ninja)):3===this.FLAG_NINJA_STATUS&&(this.ninja_help_bmp.y++,this.ninja_help_bmp.y>this.ninja_help_mc.y&&(this.ninja_help_bmp.visible=!1,this.ninja_help_mc.visible=!1,this.FLAG_NINJA_STATUS=4)),this.FLAG_IS_INITED,this.FLAG_LANG_IS_HERE&&(Util.loopPlay(this.clearMc),this.item_pause())},e.prototype._remove=function(){egret.Tween.removeAllTweens()},e.prototype.registItem=function(t){this.item_pause(),ItemController.getInstance().addItem(t)&&(t===ItemEnum.ITEM_TAKO?this.bubble1.visible=!1:t===ItemEnum.ITEM_KANI?this.bubble2.visible=!1:t===ItemEnum.ITEM_UKIWA&&(this.boyMc.movieClipData=this.mcFactory.generateMovieClipData("sh_obore_bad1"),this.boyMc.play(-1)))},e.prototype.useItem=function(t,e,i){switch(t){case ItemEnum.ITEM_TAKO:return this.boyArea.hitTestPoint(e,i)?(this.boyBmp.visible=!1,this.boyMc.visible=!0,this.boyMc.movieClipData=this.mcFactory.generateMovieClipData("sh_tako_bad"),this.boyMc.play(-1),this.item_pause(),this.FLAG_GAME_OVER=!0,Util.singletonPush(this.cards,36),!0):this.ninjaArea.hitTestPoint(e,i)?(this.ninja_help_mc.visible=!1,this.ninja.movieClipData=this.mcFactory.generateMovieClipData("ninja_toujou"),this.ninja.x=594.85,this.ninja.y=814.75,this.ninja.gotoAndPlay(1),this.game_pause(),this.FLAG_NINJA_STATUS=1,!0):!1;case ItemEnum.ITEM_KANI:return this.boyArea.hitTestPoint(e,i)?(this.boyBmp.visible=!1,this.boyMc.visible=!0,this.boyMc.movieClipData=this.mcFactory.generateMovieClipData("sh_kani_bad"),this.boyMc.play(-1),this.item_pause(),this.FLAG_GAME_OVER=!0,Util.singletonPush(this.cards,35),!0):!1;case ItemEnum.ITEM_UKIWA:return this.boyArea.hitTestPoint(e,i)?(this.FLAG_BOY_HAS_UKIWA=!0,this.addAllEventListener(),this.boyMc.y=775.8,this.boyBmp.visible=!0,this.boyMc.visible=!1,this.boy_help_mc.visible=!1,!0):!1;case ItemEnum.ITEM_MIZUGUMO:return this.boyArea.hitTestPoint(e,i)?(this.boyBmp.visible=!1,this.boyMc.movieClipData=this.mcFactory.generateMovieClipData("sh_stand"),this.boyMc.visible=!0,this.boyMc.gotoAndPlay(-1),this.FLAG_ITEM_MIZUGUMO_USED=!0,!0):!1;default:return!1}},e.prototype.getDisplayArea=function(){return new egret.Rectangle},e.prototype.ctrl_right=function(){},e.prototype.ctrl_left=function(){},e.prototype.ctrl_up=function(){},e.prototype.ctrl_down=function(){},e.prototype.ctrl_ok=function(){},e.prototype.ctrl_cancel=function(){},e}(egret.DisplayObjectContainer);__reflect(Stage9.prototype,"Stage9",["IFKaihiStage"]);